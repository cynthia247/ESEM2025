{
  "v1.8.1-windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Access an existing light in the world",
    "Destroy the light",
    "Create a new light at the same pose",
    "Change the light's intensity",
    "asset_name = random.choice(assets)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "save pic",
    "Change the below dimensions appropriately for the camera settings",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "connect to the AirSim simulator",
    "set the controls for car",
    "let car drive a bit",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Sleep for some time to wait for other vehicles to be created",
    "driveCar(vehicle_name, client)",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "----------------------------------- Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "time - of - day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo : in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector < uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "CinemAirSim",
    "End CinemAirSim",
    "gets the static meshes in the unreal scene",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "----------------------------------- Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low - level control API",
    "query vehicle state",
    "query rotor states",
    "----------------------------------- Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "TODO: ros::TransportHints().tcpNoDelay();",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "!/usr/bin/env python",
    "capture joystick events using ROS and convert to AirSim Car API commands",
    "to enable:",
    "rosrun joy joy_node",
    "Below was an earlier typo, written like this for compatibility",
    "gearing: -1 reverse, 0 N, >= 1 drive",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "CinemAirSim",
    "end CinemAirSim",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "CinemAirSim",
    "End CinemAirSim",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "Ensure new non-matching name for the object",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "CinemAirSim",
    "End CinemAirSim",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "CinemAirSim",
    "CinemAirSim",
    "set initial focal length",
    "by default all image types are disabled",
    "use final color for all calculations",
    "We set all cameras to start as nodisplay",
    "This improves performance because the capture components are no longer updating every frame and only update while requesting an image",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "CinemAirSim",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "CinemAirSim methods",
    "Copy all of the post processing settings",
    "But restore the original blendables",
    "end CinemAirSim methods",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "Get name of current level",
    "Only load new level if different from current level",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "Prevent a MavLink connection being established if changing levels",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "sub-window captures don't count as a request, set bCaptureEveryFrame and bCaptureOnMovement to display so we can show correctly the subwindow",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"-settings=\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe -settings=\"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -settings={\"foo\":\"bar\"} -> settingsText will be set to {\"foo\":\"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "create vehicle params",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "Reset the vehicle as well before registering it",
    "Similar to what happens in initializeForPlay() above",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "Convert to lowercase as done during settings loading",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "CinemAirSim",
    "End CinemAirSim",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "can we just take origin in Unity here?",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Create the launch description and populate",
    "Declare the launch options",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_->get_parameter(\"max_vert_vel_\", max_vert_vel_);",
    "nh_->get_parameter(\"max_horz_vel\", max_horz_vel_)",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_->create_service(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "add takeoff and land all services if more than 2 drones",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "QoS - The depth of the publisher message queue.",
    "more details here - https://docs.ros.org/en/foxy/Concepts/About-Quality-of-Service-Settings.html",
    "todo: error check. if state is not landed, return error.",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove wait_on_last_task",
    "todo expose wait_on_last_task or nah?",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose wait_on_last_task or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = rclcpp::Time(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.8.1": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Access an existing light in the world",
    "Destroy the light",
    "Create a new light at the same pose",
    "Change the light's intensity",
    "asset_name = random.choice(assets)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "save pic",
    "Change the below dimensions appropriately for the camera settings",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "connect to the AirSim simulator",
    "set the controls for car",
    "let car drive a bit",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Sleep for some time to wait for other vehicles to be created",
    "driveCar(vehicle_name, client)",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/main/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "----------------------------------- Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "time - of - day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo : in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector < uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "CinemAirSim",
    "End CinemAirSim",
    "gets the static meshes in the unreal scene",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "----------------------------------- Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low - level control API",
    "query vehicle state",
    "query rotor states",
    "----------------------------------- Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "TODO: ros::TransportHints().tcpNoDelay();",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "!/usr/bin/env python",
    "capture joystick events using ROS and convert to AirSim Car API commands",
    "to enable:",
    "rosrun joy joy_node",
    "Below was an earlier typo, written like this for compatibility",
    "gearing: -1 reverse, 0 N, >= 1 drive",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "CinemAirSim",
    "end CinemAirSim",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "CinemAirSim",
    "End CinemAirSim",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "Ensure new non-matching name for the object",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "CinemAirSim",
    "End CinemAirSim",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "CinemAirSim",
    "CinemAirSim",
    "set initial focal length",
    "by default all image types are disabled",
    "use final color for all calculations",
    "We set all cameras to start as nodisplay",
    "This improves performance because the capture components are no longer updating every frame and only update while requesting an image",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "CinemAirSim",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "CinemAirSim methods",
    "Copy all of the post processing settings",
    "But restore the original blendables",
    "end CinemAirSim methods",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "Get name of current level",
    "Only load new level if different from current level",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "Prevent a MavLink connection being established if changing levels",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "sub-window captures don't count as a request, set bCaptureEveryFrame and bCaptureOnMovement to display so we can show correctly the subwindow",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"-settings=\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe -settings=\"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -settings={\"foo\":\"bar\"} -> settingsText will be set to {\"foo\":\"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "create vehicle params",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "Reset the vehicle as well before registering it",
    "Similar to what happens in initializeForPlay() above",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "Convert to lowercase as done during settings loading",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "CinemAirSim",
    "End CinemAirSim",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "can we just take origin in Unity here?",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Create the launch description and populate",
    "Declare the launch options",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_->get_parameter(\"max_vert_vel_\", max_vert_vel_);",
    "nh_->get_parameter(\"max_horz_vel\", max_horz_vel_)",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_->create_service(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "add takeoff and land all services if more than 2 drones",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "QoS - The depth of the publisher message queue.",
    "more details here - https://docs.ros.org/en/foxy/Concepts/About-Quality-of-Service-Settings.html",
    "todo: error check. if state is not landed, return error.",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove wait_on_last_task",
    "todo expose wait_on_last_task or nah?",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose wait_on_last_task or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = rclcpp::Time(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.8.0-windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Access an existing light in the world",
    "Destroy the light",
    "Create a new light at the same pose",
    "Change the light's intensity",
    "asset_name = random.choice(assets)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "save pic",
    "Change the below dimensions appropriately for the camera settings",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "connect to the AirSim simulator",
    "set the controls for car",
    "let car drive a bit",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Sleep for some time to wait for other vehicles to be created",
    "driveCar(vehicle_name, client)",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "----------------------------------- Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "time - of - day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo : in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector < uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "CinemAirSim",
    "End CinemAirSim",
    "gets the static meshes in the unreal scene",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "----------------------------------- Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low - level control API",
    "query vehicle state",
    "query rotor states",
    "----------------------------------- Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "TODO: ros::TransportHints().tcpNoDelay();",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "!/usr/bin/env python",
    "capture joystick events using ROS and convert to AirSim Car API commands",
    "to enable:",
    "rosrun joy joy_node",
    "Below was an earlier typo, written like this for compatibility",
    "gearing: -1 reverse, 0 N, >= 1 drive",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "CinemAirSim",
    "end CinemAirSim",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "CinemAirSim",
    "End CinemAirSim",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "Ensure new non-matching name for the object",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "CinemAirSim",
    "End CinemAirSim",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "CinemAirSim",
    "CinemAirSim",
    "set initial focal length",
    "by default all image types are disabled",
    "use final color for all calculations",
    "We set all cameras to start as nodisplay",
    "This improves performance because the capture components are no longer updating every frame and only update while requesting an image",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "CinemAirSim",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "CinemAirSim methods",
    "Copy all of the post processing settings",
    "But restore the original blendables",
    "end CinemAirSim methods",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "sub-window captures don't count as a request, set bCaptureEveryFrame and bCaptureOnMovement to display so we can show correctly the subwindow",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"-settings=\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe -settings=\"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -settings={\"foo\":\"bar\"} -> settingsText will be set to {\"foo\":\"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "create vehicle params",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "Reset the vehicle as well before registering it",
    "Similar to what happens in initializeForPlay() above",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "Convert to lowercase as done during settings loading",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "CinemAirSim",
    "End CinemAirSim",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "can we just take origin in Unity here?",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Create the launch description and populate",
    "Declare the launch options",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_->get_parameter(\"max_vert_vel_\", max_vert_vel_);",
    "nh_->get_parameter(\"max_horz_vel\", max_horz_vel_)",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_->create_service(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "add takeoff and land all services if more than 2 drones",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "QoS - The depth of the publisher message queue.",
    "more details here - https://docs.ros.org/en/foxy/Concepts/About-Quality-of-Service-Settings.html",
    "todo: error check. if state is not landed, return error.",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove wait_on_last_task",
    "todo expose wait_on_last_task or nah?",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose wait_on_last_task or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = rclcpp::Time(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.8.0-linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Access an existing light in the world",
    "Destroy the light",
    "Create a new light at the same pose",
    "Change the light's intensity",
    "asset_name = random.choice(assets)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "save pic",
    "Change the below dimensions appropriately for the camera settings",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "connect to the AirSim simulator",
    "set the controls for car",
    "let car drive a bit",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Sleep for some time to wait for other vehicles to be created",
    "driveCar(vehicle_name, client)",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "----------------------------------- Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "time - of - day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo : in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector < uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "CinemAirSim",
    "End CinemAirSim",
    "gets the static meshes in the unreal scene",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "----------------------------------- Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low - level control API",
    "query vehicle state",
    "query rotor states",
    "----------------------------------- Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "TODO: ros::TransportHints().tcpNoDelay();",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "!/usr/bin/env python",
    "capture joystick events using ROS and convert to AirSim Car API commands",
    "to enable:",
    "rosrun joy joy_node",
    "Below was an earlier typo, written like this for compatibility",
    "gearing: -1 reverse, 0 N, >= 1 drive",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "CinemAirSim",
    "end CinemAirSim",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "CinemAirSim",
    "End CinemAirSim",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "Ensure new non-matching name for the object",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "CinemAirSim",
    "End CinemAirSim",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "CinemAirSim",
    "CinemAirSim",
    "set initial focal length",
    "by default all image types are disabled",
    "use final color for all calculations",
    "We set all cameras to start as nodisplay",
    "This improves performance because the capture components are no longer updating every frame and only update while requesting an image",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "CinemAirSim",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "CinemAirSim methods",
    "Copy all of the post processing settings",
    "But restore the original blendables",
    "end CinemAirSim methods",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "sub-window captures don't count as a request, set bCaptureEveryFrame and bCaptureOnMovement to display so we can show correctly the subwindow",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"-settings=\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe -settings=\"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -settings={\"foo\":\"bar\"} -> settingsText will be set to {\"foo\":\"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "create vehicle params",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "Reset the vehicle as well before registering it",
    "Similar to what happens in initializeForPlay() above",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "Convert to lowercase as done during settings loading",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "CinemAirSim",
    "End CinemAirSim",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "can we just take origin in Unity here?",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Create the launch description and populate",
    "Declare the launch options",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_->get_parameter(\"max_vert_vel_\", max_vert_vel_);",
    "nh_->get_parameter(\"max_horz_vel\", max_horz_vel_)",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_->create_service(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "add takeoff and land all services if more than 2 drones",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "QoS - The depth of the publisher message queue.",
    "more details here - https://docs.ros.org/en/foxy/Concepts/About-Quality-of-Service-Settings.html",
    "todo: error check. if state is not landed, return error.",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove wait_on_last_task",
    "todo expose wait_on_last_task or nah?",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose wait_on_last_task or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = rclcpp::Time(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.7.0-linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Access an existing light in the world",
    "Destroy the light",
    "Create a new light at the same pose",
    "Change the light's intensity",
    "asset_name = random.choice(assets)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "save pic",
    "Change the below dimensions appropriately for the camera settings",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "connect to the AirSim simulator",
    "set the controls for car",
    "let car drive a bit",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Sleep for some time to wait for other vehicles to be created",
    "driveCar(vehicle_name, client)",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "----------------------------------- Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "time - of - day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo : in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector < uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "CinemAirSim",
    "End CinemAirSim",
    "gets the static meshes in the unreal scene",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "----------------------------------- Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low - level control API",
    "query vehicle state",
    "query rotor states",
    "----------------------------------- Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "TODO: ros::TransportHints().tcpNoDelay();",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "!/usr/bin/env python",
    "capture joystick events using ROS and convert to AirSim Car API commands",
    "to enable:",
    "rosrun joy joy_node",
    "Below was an earlier typo, written like this for compatibility",
    "gearing: -1 reverse, 0 N, >= 1 drive",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "CinemAirSim",
    "end CinemAirSim",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "CinemAirSim",
    "End CinemAirSim",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "Ensure new non-matching name for the object",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "CinemAirSim",
    "End CinemAirSim",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "CinemAirSim",
    "CinemAirSim",
    "set initial focal length",
    "by default all image types are disabled",
    "use final color for all calculations",
    "We set all cameras to start as nodisplay",
    "This improves performance because the capture components are no longer updating every frame and only update while requesting an image",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "CinemAirSim",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "CinemAirSim methods",
    "Copy all of the post processing settings",
    "But restore the original blendables",
    "end CinemAirSim methods",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "sub-window captures don't count as a request, set bCaptureEveryFrame and bCaptureOnMovement to display so we can show correctly the subwindow",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "create vehicle params",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "Reset the vehicle as well before registering it",
    "Similar to what happens in initializeForPlay() above",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "Convert to lowercase as done during settings loading",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "CinemAirSim",
    "End CinemAirSim",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "can we just take origin in Unity here?",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Create the launch description and populate",
    "Declare the launch options",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_->get_parameter(\"max_vert_vel_\", max_vert_vel_);",
    "nh_->get_parameter(\"max_horz_vel\", max_horz_vel_)",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_->create_service(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "add takeoff and land all services if more than 2 drones",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "QoS - The depth of the publisher message queue.",
    "more details here - https://docs.ros.org/en/foxy/Concepts/About-Quality-of-Service-Settings.html",
    "todo: error check. if state is not landed, return error.",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove wait_on_last_task",
    "todo expose wait_on_last_task or nah?",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose wait_on_last_task or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo do actual body frame?",
    "airsim uses degrees",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.7.0-windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Access an existing light in the world",
    "Destroy the light",
    "Create a new light at the same pose",
    "Change the light's intensity",
    "asset_name = random.choice(assets)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "save pic",
    "Change the below dimensions appropriately for the camera settings",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "connect to the AirSim simulator",
    "set the controls for car",
    "let car drive a bit",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Sleep for some time to wait for other vehicles to be created",
    "driveCar(vehicle_name, client)",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "----------------------------------- Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "time - of - day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo : in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector < uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "CinemAirSim",
    "End CinemAirSim",
    "gets the static meshes in the unreal scene",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO : below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "----------------------------------- Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low - level control API",
    "query vehicle state",
    "query rotor states",
    "----------------------------------- Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "TODO: ros::TransportHints().tcpNoDelay();",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "!/usr/bin/env python",
    "capture joystick events using ROS and convert to AirSim Car API commands",
    "to enable:",
    "rosrun joy joy_node",
    "Below was an earlier typo, written like this for compatibility",
    "gearing: -1 reverse, 0 N, >= 1 drive",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "CinemAirSim",
    "end CinemAirSim",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "CinemAirSim",
    "End CinemAirSim",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "Ensure new non-matching name for the object",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "CinemAirSim",
    "End CinemAirSim",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "CinemAirSim",
    "CinemAirSim",
    "set initial focal length",
    "by default all image types are disabled",
    "use final color for all calculations",
    "We set all cameras to start as nodisplay",
    "This improves performance because the capture components are no longer updating every frame and only update while requesting an image",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "CinemAirSim",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "CinemAirSim methods",
    "Copy all of the post processing settings",
    "But restore the original blendables",
    "end CinemAirSim methods",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "sub-window captures dont count as a request, set bCaptureEveryFrame and bCaptureOnMovement to display so we can show correctly the subwindow",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "create vehicle params",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "Reset the vehicle as well before registering it",
    "Similar to what happens in initializeForPlay() above",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "Convert to lowercase as done during settings loading",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "CinemAirSim",
    "End CinemAirSim",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "can we just take origin in Unity here?",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Create the launch description and populate",
    "Declare the launch options",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_->get_parameter(\"max_vert_vel_\", max_vert_vel_);",
    "nh_->get_parameter(\"max_horz_vel\", max_horz_vel_)",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_->create_service(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "add takeoff and land all services if more than 2 drones",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "QoS - The depth of the publisher message queue.",
    "more details here - https://docs.ros.org/en/foxy/Concepts/About-Quality-of-Service-Settings.html",
    "todo: error check. if state is not landed, return error.",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "response->success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove wait_on_last_task",
    "todo expose wait_on_last_task or nah?",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose wait_on_last_task or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo do actual body frame?",
    "airsim uses degrees",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "RCLCPP_INFO_STREAM(\"geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.6.0-windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "query rotor states",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "new_actor_spawn_params.NameMode = FActorSpawnParameters::ESpawnActorNameMode::Required_ReturnNull;",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "Can't be done before the vehicle apis have been created",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.6.0-linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "Just change the below to test different cameras easily!",
    "Test Camera info",
    "Test Image APIs",
    "Test FoV API",
    "Test Pose APIs",
    "Test Distortion params APIs",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "set camera name and image type to request images and detections",
    "set detection radius in [cm]",
    "add desired object name to detect in wild card/regex format",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'SensorLocalFrame' as DataFrame under settings.json.",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Python client example to get Lidar data from a drone, although this script works for any AirSim-supported vehicle",
    "This script is for Lidar sensors using 'VehicleInertialFrame' as DataFrame under settings.json",
    "Sample settings.json used for this script:",
    "connect to the AirSim simulator",
    "main",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "query rotor states",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "This timeout is important as it allows the MavLinkConnection readPackets",
    "thread to iterate and notice the connection is now closed. This allows",
    "AirSim to shutdown properly when drone is not connected.",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "try and reconnect",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, the receive just timed out, no problem, we'll try again later.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "Minor TODO: consider msgpack magic for GeoPoint, so we can have one arg instead of three",
    "Convert",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "new_actor_spawn_params.NameMode = FActorSpawnParameters::ESpawnActorNameMode::Required_ReturnNull;",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Testing actor enum for world bounds...",
    "Same as with the Object Iterator, access the subclass instance with the * or -> operators.",
    "TODO think more about how best to determine/indicate ground level, if anyone cares",
    "Convert Uvectors to LLAs",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Set this component to be initialized when the game starts, and to be ticked every frame.  You can turn these features",
    "off to improve performance if you don't need them.",
    "get render target for texture size",
    "initialize viewinfo for projection matrix",
    "calculate 3D corner Points of bounding box",
    "initialize pixel values",
    "initialize projection data for sceneview",
    "do some voodoo rotation that is somehow mandatory and stolen from UGameplayStatics::ProjectWorldToScreen",
    "Project Points to pixels and get the corner pixels",
    "If actor in camera view - check if it's actually visible or hidden",
    "Check against 8 extend points",
    "If actor in camera view but didn't hit any point out of 8 extend points,",
    "check against 10 random points",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "Check pointer equality first for performance",
    "KeyHash = HashCombine(KeyHash, GetTypeHash(Key.WildcardMeshNames));",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "We need to run this code on the main game thread, since it iterates over actors",
    "This default NedTransform is part of how we anchor the AirSim primary LLA origin at 0, 0, 0 in Unreal",
    "Transform from LLA to NED",
    "KM911 remove logging",
    "common_utils::Utils::log(\"NED from LLA: \" + std::to_string(target_location.X) + \", \" + std::to_string(target_location.Y) + \", \" + std::to_string(target_location.Z), common_utils::Utils::kLogLevelInfo);",
    "No LOS, so draw red line",
    "Yes LOS, so draw green line",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "wait if no new frame is renderd",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "Can't be done before the vehicle apis have been created",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "Create External Cameras",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Load gazebo",
    "Create our node for communication",
    "Listen to Gazebo topics",
    "Make sure to shut everything down.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Remove '' from the list, representing default vehicle",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "This is so that getCarControls API works correctly",
    "API is enabled, so we use the controls set by API",
    "Update whether to use API controls or keyboard controls",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.5.0-windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "query rotor states",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "new_actor_spawn_params.NameMode = FActorSpawnParameters::ESpawnActorNameMode::Required_ReturnNull;",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "Can't be done before the vehicle apis have been created",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "not implemented",
    "not implemented",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.5.0-linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     speaker.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open speakers so we can hear what it is processing...",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "This example shows how to use the External Physics Engine",
    "It allows you to control the drone through setVehiclePose and obtain collision information.",
    "It is especially useful for injecting your own flight dynamics model to the AirSim drone.",
    "Use Blocks environment to see the drone colliding and seeing the collision information",
    "in the command prompt.",
    "Add this line to your settings.json before running AirSim:",
    "\"PhysicsEngineName\":\"ExternalPhysicsEngine\"",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "Takeoff or hover",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "fly for 2 minutes",
    "more than 50 centimeter drift is unacceptable.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "##################################################################################################",
    "",
    "Project:  Embedded Learning Library (ELL)",
    "File:     wav_reader.py",
    "Authors:  Chris Lovett",
    "",
    "Requires: Python 3.x",
    "",
    "##################################################################################################",
    "open a stream on the audio input file.",
    "assumes signed integer used in raw audio, so for example, the max for 16bit is 2^15 (32768)",
    "convert int16 data to scaled floats",
    "configure output stream to match what we are resampling to...",
    "convert the audio to the desired recording rate",
    "split into separate channels",
    "drop the channels we don't want",
    "zip the resulting channels back up.",
    "convert back to packed bytes in PCM 16 format",
    "deal with any accumulation of tails, if the tail grows to a full",
    "buffer then return it!",
    "we have a tail from previous frame, so prepend it",
    "now the caller needs us to stick to our sample_size contract, but when",
    "rate conversion happens we can't be sure that 'data' is exactly that size.",
    "usually one byte extra so add this to our accumulating tail",
    "might have reached the end of a file, so pad with zeros.",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "add new vehicle",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "For high speed ascent and descent on PX4 you may need to set these properties:",
    "param set MPC_Z_VEL_MAX_UP 5",
    "param set MPC_Z_VEL_MAX_DN 5",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -50 is 50 meters above the original launch point.",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "Add new vehicle via RPC",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "query rotor states",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "Licensed under the MIT License.",
    "This is a bit crude, but give it a moment to settle on the ground, else takeoff will fail",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "Altitude difference between each platform, in meters",
    "Count down, so the first one can easily go the highest (without knowing count)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "SITL setup info",
    "The local ethernet interface to use (default localhost).",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode on UDP is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.  Server mode on TCP means mavlinktest will do an \"accept\" socket which is",
    "what PX4 is waiting for when it is running in TCP mode.  Here the serverEndPoint is different from the",
    "offboardEndPoint.  The serverEndPoint specifies which local address to use in case your computer has",
    "multiple network interfaces.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "need a retry loop here because we don't know how quickly px4 will start accepting these connections...",
    "failed to connect",
    "then we need 2 mavlink channels, one for sending/receiving HIL_* messages and the other",
    "for controlling the drone.",
    "this is the control channel.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"received\"",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "has to be one or the other!",
    "24 bits.",
    "24 bits.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "assume this was successful, we'll find out if so in the next heartbeat.",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanar, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanar / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "mimics void ASimHUD::initializeSettings()",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "Rotor state getter",
    "Multirotor state getter",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "Rotor state",
    "Multirotor state",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "new_actor_spawn_params.NameMode = FActorSpawnParameters::ESpawnActorNameMode::Required_ReturnNull;",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "Write PNG image, already compressed in binary",
    "write to CSV file",
    "Either images were saved successfully, or there were no images",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "Just need any 1 instance, to set the header line of the record file",
    "Set is_ready at the end, setting this before can cause a race when the file isn't open yet",
    "make sure all vars are set up",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "update private rotor variable",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overriden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "compute initial pose",
    "spawn vehicle pawn",
    "create vehicle sim api",
    "TODO: Figure out a better way to add more fields",
    "Maybe allow passing a JSON string for the vehicle settings?",
    "Retroactively adjust AirSimSettings, so it's like we knew about this vehicle all along",
    "Usually physics registration happens at init, in ASimModeWorldBase::initializeForPlay(), but not in this case",
    "Can't be done before the vehicle apis have been created",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "create API objects for each pawn we have",
    "TODO: better handle no FPV vehicles scenario",
    "derived class shoudl override this method to add new vehicle to the physics engine",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "not implemented",
    "not implemented",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.4.0-windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "vehicle_setting_vec_.push_back(*vehicle_setting.get());",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanner, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanner / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "check if path exists",
    "todo airsim's simhud.cpp does error checking here",
    "mimics void ASimHUD::initializeSettings()",
    "not sure where settings_json initialized in AirSimSettings::initializeSettings() is actually used",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "new_actor_spawn_params.NameMode = FActorSpawnParameters::ESpawnActorNameMode::Required_ReturnNull;",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "BG: Workaround to get sync ground truth. See https://github.com/Microsoft/AirSim/issues/1494 for details",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "not implemented",
    "not implemented",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.4.0-linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "-*- coding: utf-8 -*-",
    "",
    "Configuration file for the Sphinx documentation builder.",
    "",
    "This file does only contain a selection of the most common options. For a",
    "full list see the documentation:",
    "http://www.sphinx-doc.org/en/master/config",
    "-- Path setup --------------------------------------------------------------",
    "If extensions (or modules to document with autodoc) are in another directory,",
    "add these directories to sys.path here. If the directory is relative to the",
    "documentation root, use os.path.abspath to make it absolute, like shown here.",
    "",
    "-- Project information -----------------------------------------------------",
    "The short X.Y version",
    "The full version, including alpha/beta/rc tags",
    "-- General configuration ---------------------------------------------------",
    "If your documentation needs a minimal Sphinx version, state it here.",
    "",
    "needs_sphinx = '1.0'",
    "Add any Sphinx extension module names here, as strings. They can be",
    "extensions coming with Sphinx (named 'sphinx.ext.*') or your custom",
    "ones.",
    "Add any paths that contain templates here, relative to this directory.",
    "The suffix(es) of source filenames.",
    "You can specify multiple suffix as a list of string:",
    "",
    "source_suffix = ['.rst', '.md']",
    "The master toctree document.",
    "The language for content autogenerated by Sphinx. Refer to documentation",
    "for a list of supported languages.",
    "",
    "This is also used if you do content translation via gettext catalogs.",
    "Usually you set \"language\" from the command line for these cases.",
    "List of patterns, relative to source directory, that match files and",
    "directories to ignore when looking for source files.",
    "This pattern also affects html_static_path and html_extra_path.",
    "The name of the Pygments (syntax highlighting) style to use.",
    "-- Options for HTML output -------------------------------------------------",
    "The theme to use for HTML and HTML Help pages.  See the documentation for",
    "a list of builtin themes.",
    "",
    "html_theme = 'alabaster'",
    "Theme options are theme-specific and customize the look and feel of a theme",
    "further.  For a list of options available for each theme, see the",
    "documentation.",
    "",
    "html_theme_options = {}",
    "Add any paths that contain custom static files (such as style sheets) here,",
    "relative to this directory. They are copied after the builtin static files,",
    "so a file named \"default.css\" will overwrite the builtin \"default.css\".",
    "Custom sidebar templates, must be a dictionary that maps document names",
    "to template names.",
    "",
    "The default sidebars (for documents that don't match any pattern) are",
    "defined by theme itself.  Builtin themes are using these templates by",
    "default: ``['localtoc.html', 'relations.html', 'sourcelink.html',",
    "'searchbox.html']``.",
    "",
    "html_sidebars = {}",
    "-- Options for HTMLHelp output ---------------------------------------------",
    "Output file base name for HTML help builder.",
    "-- Options for LaTeX output ------------------------------------------------",
    "The paper size ('letterpaper' or 'a4paper').",
    "",
    "'papersize': 'letterpaper',",
    "The font size ('10pt', '11pt' or '12pt').",
    "",
    "'pointsize': '10pt',",
    "Additional stuff for the LaTeX preamble.",
    "",
    "'preamble': '',",
    "Latex figure (float) alignment",
    "",
    "'figure_align': 'htbp',",
    "Grouping the document tree into LaTeX files. List of tuples",
    "(source start file, target name, title,",
    "author, documentclass [howto, manual, or own class]).",
    "-- Options for manual page output ------------------------------------------",
    "One entry per manual page. List of tuples",
    "(source start file, name, description, authors, manual section).",
    "-- Options for Texinfo output ----------------------------------------------",
    "Grouping the document tree into Texinfo files. List of tuples",
    "(source start file, target name, title, author,",
    "dir menu entry, description, category)",
    "-- Options for Epub output -------------------------------------------------",
    "Bibliographic Dublin Core info.",
    "The unique identifier of the text. This can be a ISBN number",
    "or the project homepage.",
    "",
    "epub_identifier = ''",
    "A unique identification for the text.",
    "",
    "epub_uid = ''",
    "A list of files that should not be packed into the epub file.",
    "-- Extension configuration -------------------------------------------------",
    "-- Options for intersphinx extension ---------------------------------------",
    "Example configuration for intersphinx: refer to the Python standard library.",
    "-- Options for todo extension ----------------------------------------------",
    "If true, `todo` and `todoList` produce output, else they produce nothing.",
    "We ignore the 2D nature of the problem as it is not relevant here",
    "It makes multi-core processing more straightforward",
    "Allocations",
    "Add small number to avoid issues with log(I)",
    "Event sim keeps track of previous image automatically",
    "Using pickle dump in a per-frame fashion to save time, instead of savetxt",
    "Optimizations possible",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "Run this script with clock speed in settings.json",
    "\"ClockSpeed\": 1 then change it to 0.5",
    "connect to the AirSim simulator",
    "with ClockSpeed = 0.5 you will see that this takes 6s (system time) and not 3s",
    "with ClockSpeed = 0.5 you will see that this takes 10s (system time)",
    "and not 5s in each iteration",
    "that's enough fun for now. let's quit cleanly",
    "Takeoff or hover",
    "Set wind to 0",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "Please add \"EnableTrace\": true to your setting.json as shown below",
    "{",
    "\"SettingsVersion\": 1.2,",
    "\"SimMode\": \"Multirotor\",",
    "\"Vehicles\": {",
    "\"Drone\": {",
    "\"VehicleType\": \"SimpleFlight\",",
    "\"EnableTrace\": true",
    "}",
    "}",
    "}",
    "connect to the AirSim simulator",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "Recording APIs",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Create a DummyVecEnv for main airsim gym env",
    "Wrap env as VecTransposeImage to allow SB to handle frame observations",
    "Initialize RL algorithm type and parameters",
    "Create an evaluation callback with the same env, called every 10000 iterations",
    "Train for a certain number of timesteps",
    "Save policy weights",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Set home position and velocity",
    "print(dist)",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "vehicle_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> .cameras;",
    "vehicle_setting_vec_.push_back(*vehicle_setting.get());",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanner, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors",
    "we want fast access to the lidar sensors for callback handling, sort them out now",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "lidars update on their own callback/thread at a given rate",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setCameraPose which sets camera pose wrt world (or takeoff?) ned frame. todo",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "gps_msg.position_covariance_type =",
    "gps_msg.position_covariance =",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "airsim appears to use chrono::system_clock with nanosecond precision",
    "todo this is global origin",
    "get the basic vehicle pose and environmental state",
    "on init, will publish 0 to /clock as expected for use_sim_time compatibility",
    "airsim_client needs to provide the simulation time in a future version of the API",
    "publish the simulation clock",
    "publish vehicle state, odom, and all basic sensor types",
    "send any commands out to the vehicles",
    "should be easier way to get the sim time through API, something like:",
    "msr::airlib::Environment::State env = airsim_client_->simGetGroundTruthEnvironment(\"\");",
    "curr_ros_time = airsim_timestamp_to_ros(env.clock().nowNanos());",
    "iterate over drones",
    "get drone state from airsim",
    "vehicle environment, we can get ambient temperature here and other truths",
    "convert airsim drone state to ROS msgs",
    "simulation environment truth",
    "dashboard reading from car, RPM, gear, etc",
    "odom and transforms",
    "ground truth GPS position from sim/HITL",
    "handled via callback",
    "send control commands from the last callback to airsim",
    "send control commands from the last callback to airsim",
    "Only camera rotation, no translation movement of camera",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanner / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "Already have goal, and have reached it",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "Already have goal, this shouldn't happen",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "check if path exists",
    "todo airsim's simhud.cpp does error checking here",
    "mimics void ASimHUD::initializeSettings()",
    "not sure where settings_json initialized in AirSimSettings::initializeSettings() is actually used",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    "connect to the AirSim simulator",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Add loading screen to viewport",
    "Remove Loading screen from viewport",
    "Create struct for Location and Rotation of actor in Unreal",
    "new_actor_spawn_params.NameMode = FActorSpawnParameters::ESpawnActorNameMode::Required_ReturnNull;",
    "Write the binvox file using run-length encoding",
    "where each pair of bytes is of the format (run value, run length)",
    "This is a run (repeated bit value)",
    "End of a run",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "AActor* actor = UAirBlueprintLib::FindActor<AActor>(simmode_, FString(object_name.c_str()));",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "Recording APIs",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "Check whether requested map exists, this could be very slow if LevelName is a short package name",
    "Create Unique Name for sub-level package",
    "Setup streaming level object that will load specified map",
    "Transform",
    "Map to Load",
    "Add the new level to world.",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "context->GetWorld()->SetNewWorldOrigin(FIntVector(0, 0, 0));",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "if hidden, clear any existing messages",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "Find mesh in /Game and /AirSim asset registry. When more plugins are added this function will have to change",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Takes a UStaticMeshComponent, USkinnedMeshComponent or ALandscapeProxy and returns their custom stencil ID if",
    "their meshes's name or their owner's name (depending on the naming method in mesh_naming_method_) equals mesh_name",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings file path or the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example (Path): AirSim.exe --settings \"C:\\path\\to\\settings.json\"",
    "Example (Text): AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "BG: Workaround to get sync ground truth. See https://github.com/Microsoft/AirSim/issues/1494 for details",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "Grab player location",
    "Move the world origin to the player's location (this moves the coordinate system and adds",
    "a corresponding offset to all positions to compensate for the shift)",
    "Regrab the player's position after the offset has been added (which should be 0,0,0 now)",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Draw debug-point on main viewport for Distance sensor hit",
    "Find position of point hit",
    "Similar to UnrealDistanceSensor.cpp#L19",
    "order of Pose addition is important here because it also adds quaternions which is not commutative!",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Recording APIs",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "not implemented",
    "not implemented",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.3.1-windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "intitialize placeholder control commands",
    "vel_cmd_ = VelCmd();",
    "gimbal_cmd_ = GimbalCmd();",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "vehicle_setting_vec_.clear();",
    "vehicle_imu_map_;",
    "callback_queues_.clear();",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "auto vehicle_setting_local = vehicle_setting.get();",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "multirotor_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> cameras;",
    "vehicle_setting_vec_.push_back(*vehicle_setting.get());",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanner, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors std::map<std::string, std::unique_ptr<SensorSetting>> sensors;",
    "todo this is pretty non scalable, refactor airsim and ros api and maintain a vehicle <-> sensor (setting) map",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "todo mimic gazebo's /use_sim_time feature which publishes airsim's clock time..via an rpc call?!",
    "clock_pub_ = nh_private_.advertise<rosgraph_msgs::Clock>(\"clock\", 10);",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setcameraorientation which sets camera orientation wrt world (or takeoff?) ned frame. todo",
    "odom_ned_msg.header.frame_id = world_frame_id_;",
    "odom_ned_msg.child_frame_id = \"/airsim/odom_local_ned\"; // todo make param",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo unused",
    "void AirsimROSWrapper::set_zero_vel_cmd()",
    "{",
    "vel_cmd_.x = 0.0;",
    "vel_cmd_.y = 0.0;",
    "vel_cmd_.z = 0.0;",
    "vel_cmd_.drivetrain = msr::airlib::DrivetrainType::MaxDegreeOfFreedom;",
    "vel_cmd_.yaw_mode.is_rate = false;",
    "// todo make class member or a fucntion",
    "double roll, pitch, yaw;",
    "tf2::Matrix3x3(get_tf2_quat(curr_drone_state_.kinematics_estimated.pose.orientation)).getRPY(roll, pitch, yaw); // ros uses xyzw",
    "vel_cmd_.yaw_mode.yaw_or_rate = yaw;",
    "}",
    "todo this is global origin",
    "iterate over drones",
    "get drone state from airsim",
    "convert airsim drone state to ROS msgs",
    "publish to ROS!",
    "send control commands from the last callback to airsim",
    "\"clear\" control cmds",
    "IMUS",
    "imu_msg.header.stamp = ros::Time::now();",
    "we've sent these static transforms, so no need to keep sending them",
    "todo add and expose a gimbal angular velocity to airlib",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "std::lock_guard<std::recursive_mutex> guard(drone_control_mutex_);",
    "std::lock_guard<std::recursive_mutex> guard(lidar_mutex_);",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "if a render request failed for whatever reason, this img will be empty.",
    "Attempting to use a make_ts(0) results in ros::Duration runtime error.",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanner / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "check if path exists",
    "todo airsim's simhud.cpp does error checking here",
    "mimics void ASimHUD::initializeSettings()",
    "not sure where settings_json initialized in AirSimSettings::initializeSettings() is actually used",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "BG: Workaround to get sync ground truth. See https://github.com/Microsoft/AirSim/issues/1494 for details",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.3.1-linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "gets the static meshes in the unreal scene",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "intitialize placeholder control commands",
    "vel_cmd_ = VelCmd();",
    "gimbal_cmd_ = GimbalCmd();",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "vehicle_setting_vec_.clear();",
    "vehicle_imu_map_;",
    "callback_queues_.clear();",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "auto vehicle_setting_local = vehicle_setting.get();",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "multirotor_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> cameras;",
    "vehicle_setting_vec_.push_back(*vehicle_setting.get());",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanner, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors std::map<std::string, std::unique_ptr<SensorSetting>> sensors;",
    "todo this is pretty non scalable, refactor airsim and ros api and maintain a vehicle <-> sensor (setting) map",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "todo mimic gazebo's /use_sim_time feature which publishes airsim's clock time..via an rpc call?!",
    "clock_pub_ = nh_private_.advertise<rosgraph_msgs::Clock>(\"clock\", 10);",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setcameraorientation which sets camera orientation wrt world (or takeoff?) ned frame. todo",
    "odom_ned_msg.header.frame_id = world_frame_id_;",
    "odom_ned_msg.child_frame_id = \"/airsim/odom_local_ned\"; // todo make param",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo unused",
    "void AirsimROSWrapper::set_zero_vel_cmd()",
    "{",
    "vel_cmd_.x = 0.0;",
    "vel_cmd_.y = 0.0;",
    "vel_cmd_.z = 0.0;",
    "vel_cmd_.drivetrain = msr::airlib::DrivetrainType::MaxDegreeOfFreedom;",
    "vel_cmd_.yaw_mode.is_rate = false;",
    "// todo make class member or a fucntion",
    "double roll, pitch, yaw;",
    "tf2::Matrix3x3(get_tf2_quat(curr_drone_state_.kinematics_estimated.pose.orientation)).getRPY(roll, pitch, yaw); // ros uses xyzw",
    "vel_cmd_.yaw_mode.yaw_or_rate = yaw;",
    "}",
    "todo this is global origin",
    "iterate over drones",
    "get drone state from airsim",
    "convert airsim drone state to ROS msgs",
    "publish to ROS!",
    "send control commands from the last callback to airsim",
    "\"clear\" control cmds",
    "IMUS",
    "imu_msg.header.stamp = ros::Time::now();",
    "we've sent these static transforms, so no need to keep sending them",
    "todo add and expose a gimbal angular velocity to airlib",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "std::lock_guard<std::recursive_mutex> guard(drone_control_mutex_);",
    "std::lock_guard<std::recursive_mutex> guard(lidar_mutex_);",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "if a render request failed for whatever reason, this img will be empty.",
    "Attempting to use a make_ts(0) results in ros::Duration runtime error.",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanner / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "check if path exists",
    "todo airsim's simhud.cpp does error checking here",
    "mimics void ASimHUD::initializeSettings()",
    "not sure where settings_json initialized in AirSimSettings::initializeSettings() is actually used",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "yaw is not within margin",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "The skybox is ignored here as it is huge, and really is of no use to the end user typically. Also the associated meshes with the cameras",
    "Various checks if there is even a valid mesh",
    "Need to force the render command to go through cause on the next iteration the buffer no longer exists",
    "Unreal stores more vertices than triangles. So here we find the highest referenced vertex and ignore any after that",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "BG: Workaround to get sync ground truth. See https://github.com/Microsoft/AirSim/issues/1494 for details",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "----------------Plotting APIs-----------/",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.3.0-linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "!/usr/bin/env python",
    "connect to the AirSim simulator",
    "start = time.time()",
    "get state of the car",
    "milliseconds = (time.time() - start) * 1000",
    "populate PoseStamped ros message",
    "log PoseStamped message",
    "publish PoseStamped message",
    "sleeps until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "AirSim Python API",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "intitialize placeholder control commands",
    "vel_cmd_ = VelCmd();",
    "gimbal_cmd_ = GimbalCmd();",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "vehicle_setting_vec_.clear();",
    "vehicle_imu_map_;",
    "callback_queues_.clear();",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "auto vehicle_setting_local = vehicle_setting.get();",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "multirotor_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> cameras;",
    "vehicle_setting_vec_.push_back(*vehicle_setting.get());",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanner, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors std::map<std::string, std::unique_ptr<SensorSetting>> sensors;",
    "todo this is pretty non scalable, refactor airsim and ros api and maintain a vehicle <-> sensor (setting) map",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "todo mimic gazebo's /use_sim_time feature which publishes airsim's clock time..via an rpc call?!",
    "clock_pub_ = nh_private_.advertise<rosgraph_msgs::Clock>(\"clock\", 10);",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setcameraorientation which sets camera orientation wrt world (or takeoff?) ned frame. todo",
    "odom_ned_msg.header.frame_id = world_frame_id_;",
    "odom_ned_msg.child_frame_id = \"/airsim/odom_local_ned\"; // todo make param",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo unused",
    "void AirsimROSWrapper::set_zero_vel_cmd()",
    "{",
    "vel_cmd_.x = 0.0;",
    "vel_cmd_.y = 0.0;",
    "vel_cmd_.z = 0.0;",
    "vel_cmd_.drivetrain = msr::airlib::DrivetrainType::MaxDegreeOfFreedom;",
    "vel_cmd_.yaw_mode.is_rate = false;",
    "// todo make class member or a fucntion",
    "double roll, pitch, yaw;",
    "tf2::Matrix3x3(get_tf2_quat(curr_drone_state_.kinematics_estimated.pose.orientation)).getRPY(roll, pitch, yaw); // ros uses xyzw",
    "vel_cmd_.yaw_mode.yaw_or_rate = yaw;",
    "}",
    "todo this is global origin",
    "iterate over drones",
    "get drone state from airsim",
    "convert airsim drone state to ROS msgs",
    "publish to ROS!",
    "send control commands from the last callback to airsim",
    "\"clear\" control cmds",
    "IMUS",
    "imu_msg.header.stamp = ros::Time::now();",
    "we've sent these static transforms, so no need to keep sending them",
    "todo add and expose a gimbal angular velocity to airlib",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "std::lock_guard<std::recursive_mutex> guard(drone_control_mutex_);",
    "std::lock_guard<std::recursive_mutex> guard(lidar_mutex_);",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "if a render request failed for whatever reason, this img will be empty.",
    "Attempting to use a make_ts(0) results in ros::Duration runtime error.",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanner / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "check if path exists",
    "todo airsim's simhud.cpp does error checking here",
    "mimics void ASimHUD::initializeSettings()",
    "not sure where settings_json initialized in AirSimSettings::initializeSettings() is actually used",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "change yaw by moving to same position but constant yaw mode",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "BG: Workaround to get sync ground truth. See https://github.com/Microsoft/AirSim/issues/1494 for details",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.3.0-Windows": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "plot red arrows for 30 seconds",
    "plot magenta arrows for 15 seconds",
    "plot red arrows for 10 seconds",
    "plot 2 white arrows which are persistent",
    "plot points",
    "plot line strip. 0-1, 1-2, 2-3",
    "plot line list. 0-1, 2-3, 4-5. Must be even.",
    "plot transforms",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=0.0, yaw=yaw)) for x, y, yaw in zip(np.linspace(0,10,10), np.linspace(0,0,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "client.simPlotTransforms(poses = [Pose(position_val=Vector3r(x,y,0), orientation_val=to_quaternion(pitch=0.0, roll=roll, yaw=0.0)) for x, y, roll in zip(np.linspace(0,10,10), np.linspace(1,1,10), np.linspace(0,np.pi,10))],",
    "scale = 35, thickness = 5, duration = 1200.0, is_persistent = False)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "!/usr/bin/env python",
    "connect to the AirSim simulator",
    "start = time.time()",
    "get state of the car",
    "milliseconds = (time.time() - start) * 1000",
    "populate PoseStamped ros message",
    "log PoseStamped message",
    "publish PoseStamped message",
    "sleeps until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "AirSim Python API",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "drone will over-shoot so we bring it back to the start point before landing.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "Plotting APIs",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "low-level control API",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "setThreadName is a helper function that is useful when debugging because your threads",
    "show up in the debugger with the name you set which makes it easier to find the threads",
    "that you are interested in.",
    "unfortunately this is only available on Windows 10, and AirSim is not limited to that.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "don't need to accept any more, so we can close this one.",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "intitialize placeholder control commands",
    "vel_cmd_ = VelCmd();",
    "gimbal_cmd_ = GimbalCmd();",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "vehicle_setting_vec_.clear();",
    "vehicle_imu_map_;",
    "callback_queues_.clear();",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "auto vehicle_setting_local = vehicle_setting.get();",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "multirotor_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> cameras;",
    "vehicle_setting_vec_.push_back(*vehicle_setting.get());",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanner, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors std::map<std::string, std::unique_ptr<SensorSetting>> sensors;",
    "todo this is pretty non scalable, refactor airsim and ros api and maintain a vehicle <-> sensor (setting) map",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "todo mimic gazebo's /use_sim_time feature which publishes airsim's clock time..via an rpc call?!",
    "clock_pub_ = nh_private_.advertise<rosgraph_msgs::Clock>(\"clock\", 10);",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setcameraorientation which sets camera orientation wrt world (or takeoff?) ned frame. todo",
    "odom_ned_msg.header.frame_id = world_frame_id_;",
    "odom_ned_msg.child_frame_id = \"/airsim/odom_local_ned\"; // todo make param",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo unused",
    "void AirsimROSWrapper::set_zero_vel_cmd()",
    "{",
    "vel_cmd_.x = 0.0;",
    "vel_cmd_.y = 0.0;",
    "vel_cmd_.z = 0.0;",
    "vel_cmd_.drivetrain = msr::airlib::DrivetrainType::MaxDegreeOfFreedom;",
    "vel_cmd_.yaw_mode.is_rate = false;",
    "// todo make class member or a fucntion",
    "double roll, pitch, yaw;",
    "tf2::Matrix3x3(get_tf2_quat(curr_drone_state_.kinematics_estimated.pose.orientation)).getRPY(roll, pitch, yaw); // ros uses xyzw",
    "vel_cmd_.yaw_mode.yaw_or_rate = yaw;",
    "}",
    "todo this is global origin",
    "iterate over drones",
    "get drone state from airsim",
    "convert airsim drone state to ROS msgs",
    "publish to ROS!",
    "send control commands from the last callback to airsim",
    "\"clear\" control cmds",
    "IMUS",
    "imu_msg.header.stamp = ros::Time::now();",
    "we've sent these static transforms, so no need to keep sending them",
    "todo add and expose a gimbal angular velocity to airlib",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "std::lock_guard<std::recursive_mutex> guard(drone_control_mutex_);",
    "std::lock_guard<std::recursive_mutex> guard(lidar_mutex_);",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "if a render request failed for whatever reason, this img will be empty.",
    "Attempting to use a make_ts(0) results in ros::Duration runtime error.",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanner / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "check if path exists",
    "todo airsim's simhud.cpp does error checking here",
    "mimics void ASimHUD::initializeSettings()",
    "not sure where settings_json initialized in AirSimSettings::initializeSettings() is actually used",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "this deadlocks UI thread if async_run was called while there are pending rpc calls.",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "Exit if already resetting.",
    "Reset",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "change yaw by moving to same position but constant yaw mode",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Split the tag string into individual tags.",
    "Texture swap on actors that have all of those tags.",
    "----------- Plotting APIs ----------/",
    "plot line for points 0-1, 1-2, 2-3",
    "plot line for points 0-1, 2-3, 4-5... must be even number of points",
    "assert points_start.size() == poinst_end.size()",
    "assert positions.size() == strings.size()",
    "assert poses.size() == names.size()",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "todo unused. need to manually plots tf axes' line in right handed FLU instead of using DrawDebugCoordinateSystem",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "BG: Workaround to get sync ground truth. See https://github.com/Microsoft/AirSim/issues/1494 for details",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Store the segmentation id of the hit object.",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v.1.2.2": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "(2.99792458 * 10^14 [micron/s])^2 * 10^12 to convert",
    "denominator from microns^3 to microns * m^2)",
    "First set everything to 0.",
    "Next set all objects of interest provided to corresponding object IDs",
    "segIdDict values MUST match tempEmissivityNew labels.",
    "Connect to AirSim, UAV mode.",
    "Choose temperature values for winter or summer.",
    "\"\"\"",
    "winter",
    "\"\"\"",
    "summer",
    "Read camera response.",
    "Calculate radiance.",
    "Set IDs in AirSim environment.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "cv2.imwrite(os.path.normpath(filename + '.png'), img_rgb) # write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "This script expects object available in UE environment of type AAirSimCharater",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "airsim.wait_key('Press any key to set face expression')",
    "client.simCharSetFaceExpression(\"BlendShapeNode_Smile\", 1);",
    "Roll is applied first, then pitch, then yaw.",
    "Turn the camera position into a column vector.",
    "Convert the camera's quaternion rotation to yaw, pitch, roll angles.",
    "Create a rotation matrix from camera pitch, roll, and yaw angles.",
    "Change coordinates to get subjectXYZ in the camera's local coordinate system.",
    "Recreate the perspective projection of the camera.",
    "Move origin to the upper-left corner of the screen and multiply by size to get pixel values. Note that screen is in y,-z plane.",
    "Set pose and sleep after to ensure the pose sticks before capturing image.",
    "Capture segmentation (IR) and scene images.",
    "Change images into numpy arrays.",
    "Capture images for a certain amount of time in seconds (half hour now)",
    "Capture image - pose.position x_val access may change w/ AirSim",
    "version (pose.position.x_val new, pose.position[b'x_val'] old)",
    "Convert color scene image to BGR for write out with cv2.",
    "Connect to AirSim, UAV mode.",
    "Look for objects with names that match a regular expression.",
    "Sample calls to main, varying camera angle and altitude.",
    "straight down, 400ft",
    "straight down, 200ft",
    "45 degrees, 200ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "45 degrees, 400ft -- note that often object won't be scene since position",
    "is set exactly to object's",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "Python client example to change time-of-day using APIs",
    "",
    "Changes time of the day and makes the car move around",
    "connect to the AirSim simulator",
    "flip between specific time and default time",
    "go forward",
    "Go forward + steer right",
    "main",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "!/usr/bin/env python",
    "connect to the AirSim simulator",
    "start = time.time()",
    "get state of the car",
    "milliseconds = (time.time() - start) * 1000",
    "populate PoseStamped ros message",
    "log PoseStamped message",
    "publish PoseStamped message",
    "sleeps until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "AirSim Python API",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "teleport the drone + 10 meters in x-direction",
    "teleport the drone back",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "after hovering we need to re-enabled api control for next leg of the trip",
    "now compute the survey path required to fill the box",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "time-of-day control",
    "weather",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "sensor APIs",
    "----------- APIs to control ACharacter in scene ----------/",
    "legacy handling",
    "TODO: remove below legacy wrappers in future major releases",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "ignore any failures here because we are running in our own thread here.",
    "this is called for all messages received on the connection.",
    "we received a heartbeat, so let's get the capabilities.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "mavlink2 supports trimming the payload of trailing zeros so the messages",
    "are variable length as a result.",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "tell the remote connection to expect mavlink2 messages.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "import airsim",
    "todo expose airsimsettings.hpp via pybind11? this should be done for the full API *some*day",
    "self.args = args",
    "arrange drones in a rectangle. todo make classes for different swarm spawn shapes?",
    "pdb.set_trace()",
    "#include <pluginlib/class_list_macros.h>",
    "PLUGINLIB_EXPORT_CLASS(AirsimROSWrapper, nodelet::Nodelet)",
    "intitialize placeholder control commands",
    "vel_cmd_ = VelCmd();",
    "gimbal_cmd_ = GimbalCmd();",
    "todo do not reset if already in air?",
    "todo there's only one global origin geopoint for environment. but airsim API accept a parameter vehicle_name? inside carsimpawnapi.cpp, there's a geopoint being assigned in the constructor. by?",
    "ros params",
    "todo enforce dynamics constraints in this node as well?",
    "nh_.getParam(\"max_vert_vel_\", max_vert_vel_);",
    "nh_.getParam(\"max_horz_vel\", max_horz_vel_)",
    "XmlRpc::XmlRpcValue can't be const in this case",
    "subscribe to control commands on global nodehandle",
    "vehicle_setting_vec_.clear();",
    "vehicle_imu_map_;",
    "callback_queues_.clear();",
    "iterate over std::map<std::string, std::unique_ptr<VehicleSetting>> vehicles;",
    "auto vehicle_setting_local = vehicle_setting.get();",
    "bind to a single callback. todo optimal subs queue length",
    "bind multiple topics to a single callback, but keep track of which vehicle name it was by passing curr_vehicle_name as the 2nd argument",
    "multirotor_ros.reset_srvr = nh_private_.advertiseService(curr_vehicle_name + \"/reset\",&AirsimROSWrapper::reset_srv_cb, this);",
    "iterate over camera map std::map<std::string, CameraSetting> cameras;",
    "vehicle_setting_vec_.push_back(*vehicle_setting.get());",
    "camera_setting.gimbal",
    "iterate over capture_setting std::map<int, CaptureSetting> capture_settings",
    "todo why does AirSimSettings::loadCaptureSettings calls AirSimSettings::initializeCaptureSettings()",
    "which initializes default capture settings for _all_ NINE msr::airlib::ImageCaptureBase::ImageType",
    "if scene / segmentation / surface normals / infrared, get uncompressed image with pixels_as_floats = false",
    "if {DepthPlanner, DepthPerspective,DepthVis, DisparityNormalized}, get float image",
    "push back pair (vector of image captures, current vehicle name)",
    "iterate over sensors std::map<std::string, std::unique_ptr<SensorSetting>> sensors;",
    "todo this is pretty non scalable, refactor airsim and ros api and maintain a vehicle <-> sensor (setting) map",
    "add takeoff and land all services if more than 2 drones",
    "gimbal_angle_quat_cmd_sub_ = nh_.subscribe(\"gimbal_angle_quat_cmd\", 50, &AirsimROSWrapper::gimbal_angle_quat_cmd_cb, this);",
    "todo add per vehicle reset in AirLib API",
    "todo mimic gazebo's /use_sim_time feature which publishes airsim's clock time..via an rpc call?!",
    "clock_pub_ = nh_private_.advertise<rosgraph_msgs::Clock>(\"clock\", 10);",
    "if >0 cameras, add one more thread for img_request_timer_cb",
    "nh_private_.setCallbackQueue(&lidar_timer_cb_queue_);",
    "todo: error check. if state is not landed, return error.",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "response.success =",
    "todo add reset by vehicle_name API to airlib",
    "todo not async remove waitonlasttask",
    "void AirsimROSWrapper::vel_cmd_body_frame_cb(const airsim_ros_pkgs::VelCmd& msg, const std::string& vehicle_name)",
    "todo do actual body frame?",
    "airsim uses degrees",
    "todo do actual body frame?",
    "airsim uses degrees",
    "void AirsimROSWrapper::vel_cmd_all_body_frame_cb(const airsim_ros_pkgs::VelCmd::ConstPtr& msg)",
    "todo expose waitOnLastTask or nah?",
    "todo do actual body frame?",
    "airsim uses degrees",
    "this is kinda unnecessary but maybe it makes life easier for the end user.",
    "todo expose waitOnLastTask or nah?",
    "todo support multiple gimbal commands",
    "todo support multiple gimbal commands",
    "1. find quaternion of default gimbal pose",
    "2. forward multiply with quaternion equivalent to desired euler commands (in degrees)",
    "3. call airsim client's setcameraorientation which sets camera orientation wrt world (or takeoff?) ned frame. todo",
    "odom_ned_msg.header.frame_id = world_frame_id_;",
    "odom_ned_msg.child_frame_id = \"/airsim/odom_local_ned\"; // todo make param",
    "https://docs.ros.org/jade/api/sensor_msgs/html/point__cloud__conversion_8h_source.html#l00066",
    "look at UnrealLidarSensor.cpp UnrealLidarSensor::getPointCloud() for math",
    "read this carefully https://docs.ros.org/kinetic/api/sensor_msgs/html/msg/PointCloud2.html",
    "msg = []",
    "todo covariances",
    "imu_msg.header.frame_id = \"/airsim/odom_local_ned\";// todo multiple drones",
    "todo radians per second",
    "meters/s2^m",
    "imu_msg.orientation_covariance = ;",
    "imu_msg.angular_velocity_covariance = ;",
    "imu_msg.linear_acceleration_covariance = ;",
    "todo unused",
    "void AirsimROSWrapper::set_zero_vel_cmd()",
    "{",
    "vel_cmd_.x = 0.0;",
    "vel_cmd_.y = 0.0;",
    "vel_cmd_.z = 0.0;",
    "vel_cmd_.drivetrain = msr::airlib::DrivetrainType::MaxDegreeOfFreedom;",
    "vel_cmd_.yaw_mode.is_rate = false;",
    "// todo make class member or a fucntion",
    "double roll, pitch, yaw;",
    "tf2::Matrix3x3(get_tf2_quat(curr_drone_state_.kinematics_estimated.pose.orientation)).getRPY(roll, pitch, yaw); // ros uses xyzw",
    "vel_cmd_.yaw_mode.yaw_or_rate = yaw;",
    "}",
    "todo this is global origin",
    "iterate over drones",
    "get drone state from airsim",
    "convert airsim drone state to ROS msgs",
    "publish to ROS!",
    "send control commands from the last callback to airsim",
    "\"clear\" control cmds",
    "IMUS",
    "todo add and expose a gimbal angular velocity to airlib",
    "airsim uses nans for zeros in settings.json. we set them to zeros here for handling tfs in ROS",
    "if any nan's in camera pose, set them to match vehicle pose (which has already converted any potential nans to zeros)",
    "std::lock_guard<std::recursive_mutex> guard(drone_control_mutex_);",
    "std::lock_guard<std::recursive_mutex> guard(lidar_mutex_);",
    "todo using img_response.image_data_float direclty as done get_img_msg_from_response() throws an error,",
    "hence the dependency on opencv and cv_bridge. however, this is an extremely fast op, so no big deal.",
    "todo have a special stereo pair mode and get projection matrix by calculating offset wrt drone body frame?",
    "todo focal length in Y direction should be same as X it seems. this can change in future a scene capture component which exactly correponds to a cine camera",
    "float f_y = (capture_setting.height / 2.0) / tan(math_common::deg2rad(fov_degrees / 2.0));",
    "todo add option to use airsim time (image_response.TTimePoint) like Gazebo /use_sim_time param",
    "todo publishing a tf for each capture type seems stupid. but it foolproofs us against render thread's async stuff, I hope.",
    "Ideally, we should loop over cameras and then captures, and publish only one tf.",
    "todo simGetCameraInfo is wrong + also it's only for image type -1.",
    "msr::airlib::CameraInfo camera_info = airsim_client_.simGetCameraInfo(curr_img_response.camera_name);",
    "update timestamp of saved cam info msgs",
    "DepthPlanner / DepthPerspective / DepthVis / DisparityNormalized",
    "Scene / Segmentation / SurfaceNormals / Infrared",
    "publish camera transforms",
    "camera poses are obtained from airsim's client API which are in (local) NED frame.",
    "We first do a change of basis to camera optical frame (Z forward, X right, Y down)",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body * matrix_cam_body_to_optical_inverse_;",
    "tf2::Matrix3x3 mat_cam_optical = matrix_cam_body_to_optical_ * mat_cam_body;",
    "ROS params",
    "ROS publishers",
    "ROS subscribers",
    "todo publish this under global nodehandle / \"airsim node\" and hide it from user",
    "ROS timers",
    "todo maintain internal representation as eigen vec?",
    "todo check if low velocity if within thresh?",
    "todo maintain separate errors for XY and Z",
    "todo save this in degrees somewhere to avoid repeated conversion",
    "this tells the update timer callback to not do active hovering",
    "todo maintain array of position goals",
    "todo error checks",
    "todo fill response",
    "this tells the update timer callback to not do active hovering",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo do relative altitude, or add an option for the same?",
    "convert GPS goal to NED goal",
    "ROS_INFO_STREAM(\"[PIDPositionController] geodetic_converter_ GPS reference initialized correctly (lat long in radians) \" << initial_latitude << \", \"<< initial_longitude << \", \" << initial_altitude);",
    "todo error checks",
    "todo fill response",
    "todo check if odometry is too old!!",
    "if no odom, don't do anything.",
    "dear future self, this function doesn't return coz we need to keep on actively hovering at last goal pose. don't act smart",
    "only compute and send control commands for hovering / moving to pose, if we received a goal at least once in the past",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "todo yaw limits",
    "todo just add a sgn funciton in common utils? return double to be safe.",
    "template <typename T> double sgn(T val) { return (T(0) < val) - (val < T(0)); }",
    "check if path exists",
    "todo airsim's simhud.cpp does error checking here",
    "mimics void ASimHUD::initializeSettings()",
    "not sure where settings_json initialized in AirSimSettings::initializeSettings() is actually used",
    "int num_threads = 1;",
    "ros::MultiThreadedSpinner multi_thread(num_threads);",
    "multi_thread.spin();",
    "ros::AsyncSpinner async_spinner(num_threads);",
    "async_spinner.start();",
    "single threaded spinner",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "----------- APIs to control ACharacter in scene ----------/",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "----------- APIs to control ACharacter in scene ----------/",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "change yaw by moving to same position but constant yaw mode",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "reset any chars we have",
    "------------------------------------------------- Char APIs -----------------------------------------------------------/",
    "choose first character if name was blank or find by name",
    "------------------------------------------------- Char APIs -----------------------------------------------------------/",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is taller than it is wide",
    "The FPerspectiveMatrix() constructor actually returns the transpose of the perspective matrix.",
    "Takes a vector from NORTH-EAST-DOWN coordinates (AirSim) to EAST-UP-SOUTH coordinates (Unreal). Leaves W coordinate unchanged.",
    "Copy the result to an airlib::ProjectionMatrix while taking transpose.",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "TODO: Validate framerate of sensor data when the NoDisplay setting is turned on.",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "update kinematics from pawn's movement instead of physics engine",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Fill out your copyright notice in the Description page of Project Settings.",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GetWorld();",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "still need the menu class for f10",
    "UClass* Class, FTransform const* Transform, const FActorSpawnParameters& SpawnParameters = FActorSpawnParameters()",
    "showWeatherMenu(WorldContextObject);",
    "if weather is not enabled, dont allow any weather values to be set",
    "must be called after SetScalarParam, because WeatherEnabled is a scalar param",
    "and must be set to true or false before this.",
    "WeatherEnabled will always be false",
    "NOTE: weather enabled must be set first, before other params for this to work",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "UWorld* World = GEngine->GetWorldFromContextObject(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);",
    "get all menu actors, if any",
    "hacky test to make sure we are getting the right class. for some reason cast above doesn't work, so we use this instead to test for class",
    "get all menu actors, if any, then hide the menu",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "*** End: UpdatableState implementation ***//",
    "TODO: implement arming for car",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "UWeatherLib::showWeatherMenu(World);",
    "else don't init",
    "this is a bit odd but given how advanceTimeOfDay() works currently,",
    "tod_sim_clock_start_ needs to be reset here.",
    "Going from enabled to disabled",
    "do these in the end to ensure that advanceTimeOfDay() doesn't see",
    "any inconsistent state.",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "<< \"magnetometer_data.magnetic_field_covariance\" << magnetometer_data.magnetic_field_covariance // not implemented in sensor",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "TODO: implement weather for Unity",
    "TODO: implement weather for Unity",
    "Not implemented, just added for compilation.",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "Enabling all LogLevels,",
    "delete ltm;",
    "initialize state",
    "compute our home point",
    "default behavior is to call update every tick",
    "for custom physics engine, this method should be overridden and update should be",
    "called from every physics tick",
    "these will be available for devices like steering wheels",
    "sync environment from kinematics",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "FVector unrealPosition = getUUPosition();",
    "reporter.writeValue(\"unreal pos\", Vector3r(unrealPosition.X, unrealPosition.Y, unrealPosition.Z));",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default we update kinematics from UE pawn",
    "if SimMod uses its own physics engine then this should be overriden",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "update kinematics from pawn's movement instead of physics engine",
    "TODO: update other fields?",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "For multirotors the vehicle_sim_api are in PhysicsWOrld container and then get reseted when world gets reseted",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "*** End: UpdatableState implementation ***//",
    "TODO: should do reset() here?",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "void CarPawnSimApi::reportState(StateReporter& reporter)",
    "{",
    "// report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "AirSimPose pose = GetPose(getVehicleName().c_str());",
    "reporter.writeValue(\"unreal pos\", Vector3r(pose.position.x, pose.position.y, pose.position.z));",
    "}",
    "*** End: UpdatableState implementation ***//",
    "TODO: implement arming for car",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "commenting this out for now to avoid unintentional Unity startup failure",
    "throw std::domain_error(\"setTimeOfDay is not implemented by SimMode\");",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.2.0Linux": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "airsim.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "This script expects object available in UE environment of type AAirSimCharater",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "airsim.wait_key('Press any key to set face expression')",
    "client.simCharSetFaceExpression(\"BlendShapeNode_Smile\", 1);",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply brakes",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "!/usr/bin/env python",
    "connect to the AirSim simulator",
    "start = time.time()",
    "get state of the car",
    "milliseconds = (time.time() - start) * 1000",
    "populate PoseStamped ros message",
    "log PoseStamped message",
    "publish PoseStamped message",
    "sleeps until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "AirSim Python API",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "now compute the survey path required to fill the box",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "lidar APIs",
    "----------- APIs to control ACharacter in scene ----------/",
    "legacy handling",
    "TODO: remove below legacy wrappers in future major releases",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "----------- APIs to control ACharacter in scene ----------/",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "----------- APIs to control ACharacter in scene ----------/",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "change yaw by moving to same position but constant yaw mode",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "reset any chars we have",
    "choose first character if name was blank or find by name",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is wider than it is tall",
    "if the viewport is taller than it is wide",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "update position from kinematics so we have latest position after physics update",
    "kinematics_->update();",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "TODO: update other fields?",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "TODO: implement arming for car",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "else don't init",
    "else ignore",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "normalize FOV start/end",
    "shoot lasers",
    "check if the laser is outside the requested horizontal FOV",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "We need to compose rotations here rather than rotate a vector by a quaternion",
    "Hence using coordOrientationAdd(..) rather than rotateQuaternion(..)",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "decide the frame for the point-cloud",
    "current detault behavior; though it is probably not very useful.",
    "not changing the default for now to maintain backwards-compat.",
    "point in vehicle intertial frame",
    "tranform to lidar frame",
    "The above should be same as first transforming to vehicle-body frame and then to lidar frame",
    "Vector3r point_v_b = VectorMath::transformToBodyFrame(point_v_i, vehicle_pose, true);",
    "point = VectorMath::transformToBodyFrame(point_v_b, lidar_pose, true);",
    "On the client side, if it is needed to transform this data back to the world frame,",
    "then do the equivalent of following,",
    "Vector3r point_w = VectorMath::transformToWorldFrame(point, lidar_pose + vehicle_pose, true);",
    "See SimModeBase::drawLidarDebugPoints()",
    "TODO: Optimization -- instead of doing this for every point, it should be possible to do this",
    "for the point-cloud together? Need to look into matrix operations to do this together for all points.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "Not implemented, just added for compilation.",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "Enabling all LogLevels,",
    "initialize state",
    "compute our home point",
    "these will be available for devices like steering wheels",
    "update position from kinematics so we have latest position after physics update",
    "kinematics_->update();",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "TODO: implement arming for car",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.2.1": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "define abstract class to return next vector in the format (x,y,yaw)",
    "compute vector, distance and angle to goal",
    "compute box of interest",
    "scale by weight matrix (optional)",
    "img2d_box = np.multiply(img2d_box,w_mtx)",
    "detect collision",
    "compute box of interest",
    "detect collision",
    "Same as above but decide to go left or right based on average or some metric like that",
    "compute resultant normalized vector, distance and angle",
    "compute bounding box size",
    "convert horizonal fov to vertical fov",
    "matrix with all ones",
    "matrix with max weight in center and decreasing linearly with distance from center",
    "matrix with max weight in center and decreasing quadratically with distance from center",
    "print (\"Saving images to %s\" % tmp_dir)",
    "airsim.wait_key('Press any key to start')",
    "Define start position, goal and size of UAV",
    "Define parameters and thresholds",
    "initial position",
    "predictControl = AvoidLeftIgonreGoal(hfov, coll_thres, yaw, limit_yaw, step)",
    "time.sleep(1)",
    "get response",
    "get numpy array",
    "reshape array to 2D array H X W",
    "write to png",
    "imsave(os.path.normpath(os.path.join(tmp_dir, \"depth_\" + str(z) + '.png')), generate_depth_viz(img2d,5))",
    "pose = client.simGetPose()",
    "pp.pprint(pose)",
    "time.sleep(5)",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "################### OLD CODE",
    "timer = 0",
    "time_obs = 50",
    "bObstacle = False",
    "if (bObstacle):",
    "timer = timer + 1",
    "if timer > time_obs:",
    "bObstacle = False",
    "timer = 0",
    "else:",
    "yaw = target_angle",
    "print (target_angle,target_vec,target_dist,x,y,goal[0],goal[1])",
    "if (np.average(img2d_box) < coll_thres):",
    "img2d_box_l = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)-50:int((w+roi_w)/2)-50]",
    "img2d_box_r = img2d_box = img2d[int((h-roi_h)/2):int((h+roi_h)/2),int((w-roi_w)/2)+50:int((w+roi_w)/2)+50]",
    "img2d_box_l_avg = np.average(np.multiply(img2d_box_l,w_mtx))",
    "img2d_box_r_avg = np.average(np.multiply(img2d_box_r,w_mtx))",
    "print('left: ', img2d_box_l_avg)",
    "print('right: ', img2d_box_r_avg)",
    "if img2d_box_l_avg > img2d_box_r_avg:",
    "##Go LEFT",
    "#y_offset = y_offset-1",
    "yaw = yaw - radians(10)",
    "bObstacle = True",
    "else:",
    "##Go RIGHT",
    "#y_offset = y_offset+1",
    "yaw = yaw + radians(10)",
    "bObstacle = true",
    "print('yaw: ', yaw)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "airsim.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "objects can be named in two ways:",
    "1. In UE Editor, select and object and change its name to something else. Note that you must *change* its name because",
    "default name is auto-generated and varies from run-to-run.",
    "2. OR you can do this: In UE Editor select the object and then go to \"Actor\" section, click down arrow to see \"Tags\" property and add a tag there.",
    "",
    "The simGetObjectPose and simSetObjectPose uses first object that has specified name OR tag.",
    "more info: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "https://answers.unrealengine.com/revisions/790629.html",
    "below works in Blocks environment",
    "------------------------------------ Get current pose ------------------------------------------------",
    "search object by name:",
    "search another object by tag",
    "search non-existent object",
    "------------------------------------ Set new pose ------------------------------------------------",
    "here we move with teleport enabled so collisions are ignored",
    "here we move with teleport enabled so collisions are not ignored",
    "move non-existent object",
    "------------------------------------ Get new pose ------------------------------------------------",
    "search another object by tag",
    "search non-existent object",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "This script expects object available in UE environment of type AAirSimCharater",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "airsim.wait_key('Press any key to set face expression')",
    "client.simCharSetFaceExpression(\"BlendShapeNode_Smile\", 1);",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "xn = 1 + x*5  # some random number",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "Python client example to get Lidar data from a car",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "go forward",
    "Go forward + steer right",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "Use below in settings.json with blocks environment",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "!/usr/bin/env python",
    "connect to the AirSim simulator",
    "start = time.time()",
    "get state of the car",
    "milliseconds = (time.time() - start) * 1000",
    "populate PoseStamped ros message",
    "log PoseStamped message",
    "publish PoseStamped message",
    "sleeps until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "AirSim Python API",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "!/usr/bin/env python",
    "Example ROS node for publishing AirSim images.",
    "ROS Image message",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "Populate image message",
    "log time and size of published image",
    "publish image message",
    "sleep until next cycle",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "MultirotorClient.wait_key('Press any key to takeoff')",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "Python client example to get Lidar data from a drone",
    "",
    "Makes the drone fly and get Lidar data",
    "connect to the AirSim simulator",
    "print(\"state: %s\" % s)",
    "print(\"state: %s\" % pprint.pformat(state))",
    "reshape array of floats to array of [X,Y,Z]",
    "TODO",
    "main",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "now compute the survey path required to fill the box",
    "Use below in settings.json with Blocks environment",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "this script moves the drone to a location, then rests it thousands of time",
    "purpose of this script is to stress test reset API",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "This constant is used as an upper bound  for normalizing the car's speed to be between 0 and 1",
    "Remove alpha channel if exists",
    "compute average steering over 3 consecutive recorded images, this will serve as the label",
    "Data is expected to be a dict of <image: (label, previousious_state)>",
    "Flatten and yield as tuple",
    "Initialize a resizable dataset to hold the output",
    "Resize the dataset to accommodate the next chunk of rows",
    "Create the next chunk",
    "Increment the row count",
    "Arguments",
    "Returns",
    "use composition of homographies",
    "to generate final transform that needs to be applied",
    "Arguments",
    "Returns",
    "Keeps under lock only the mechanism which advances",
    "the indexing of each batch.",
    "The transformation of images is not under thread lock",
    "so it can be done in parallel",
    "Trained model path",
    "Connect to AirSim",
    "Start driving",
    "Initialize image buffer",
    "Update throttle value according to steering angle",
    "Prediction",
    "Rescale prediction to [-1,1] and factor by 0.82 for drive smoothness",
    "Print progress",
    "Update next car state",
    "Wait a bit between iterations",
    "%matplotlib inline",
    "chunk size for training batches",
    "No test set needed, since testing in our case is running the model on an unseen map in AirSim",
    "Point this to the directory containing the raw data",
    "Point this to the desired output directory for the cooked (.h5) data",
    "Choose The folders to search for data under RAW_DATA_DIR",
    "if COOK_ALL_DATA is set to False, append your desired data folders here",
    "data_folder.append('folder_name1')",
    "data_folder.append('folder_name2')",
    "...",
    "Hyper-parameters",
    "Activation functions",
    "Stop training if in the last 20 epochs, there was no change of the best recorded validation loss",
    "<< The directory containing the cooked data from the previous step >>",
    "<< The directory in which the model output will be placed >>",
    "Use ROI of [78,144,27,227] for FOV 60 with Formula car",
    "Network definition",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "lidar APIs",
    "----------- APIs to control ACharacter in scene ----------/",
    "legacy handling",
    "TODO: remove below legacy wrappers in future major releases",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "#include <fileapi.h>",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "----------- APIs to control ACharacter in scene ----------/",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "----------- APIs to control ACharacter in scene ----------/",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "change yaw by moving to same position but constant yaw mode",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "reset any chars we have",
    "choose first character if name was blank or find by name",
    "by default all image types are disabled",
    "use final color for all calculations",
    "TODO: avoid the need to override const cast here",
    "if the viewport is wider than it is tall",
    "if the viewport is taller than it is wide",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "We don't do game/render thread synchronization for safe method.",
    "We just blindly sleep for 200ms (the old way)",
    "Currently, we don't have a way to synthronize image capturing and camera pose when safe method is used,",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "derived class should override this",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "add listener for pawn's collision event",
    "compute our home point",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "update position from kinematics so we have latest position after physics update",
    "kinematics_->update();",
    "void playBack()",
    "{",
    "if (params_.pawn->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "params_.pawn->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "TODO: update other fields?",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of querying camera pose in the game thread and synchronizing render thread with camera pose",
    "capture CameraPose for this frame",
    "The completion is called immeidately after GameThread sends the",
    "rendering commands to RenderThread. Hence, our ExecuteTask will",
    "execute *immediately* after RenderThread renders the scene!",
    "while we're still on GameThread, enqueue request for capture the scene!",
    "wait for this task to complete",
    "log a message and continue wait",
    "lamda function still references a few objects for which there is no refcount.",
    "Walking away will cause memory corruption, which is much more difficult to debug.",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "decide which derived BP to use",
    "we don't have real vehicle so no vehicle API",
    "put camera little bit above vehicle",
    "update ground level",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "vehicle_sim_api->reset();",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "setup clock in PhysX",
    "-------------------------------- overrides -----------------------------------------------//",
    "decide which derived BP to use",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "TODO: implement arming for car",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "else don't init",
    "else ignore",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "get UU origin of global NED frame",
    "determine camera director camera default pose and spawn it",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of type for derived SimMode and auto creatable",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "Draws debug-points on main viewport for Lidar laser hits.",
    "Used for debugging only.",
    "Currently we are checking the sensor-collection instead of sensor-settings.",
    "Also using variables to optimize not checking the collection if not needed.",
    "TODO: Is it incorrect to assume LidarSimple here?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "ctor",
    "initializes information based on lidar configuration",
    "calculate verticle angle distance between each laser",
    "store vertical angles for each laser",
    "returns a point-cloud for the tick",
    "cap the points to scan via ray-tracing; this is currently needed for car/Unreal tick scenarios",
    "since SensorBase mechanism uses the elapsed clock time instead of the tick delta-time.",
    "calculate number of points needed for each laser/channel",
    "UAirBlueprintLib::LogMessageString(\"Lidar: \", \"No points requested this frame\", LogDebugLevel::Failure);",
    "calculate needed angle/distance between each point",
    "shoot lasers",
    "shoot laser and get the impact point, if any",
    "simulate shooting a laser via Unreal ray-tracing.",
    "start position",
    "get ray quaternion in lidar frame (angles must be in radians)",
    "get ray quaternion in body frame",
    "get ray quaternion in world frame",
    "get ray vector (end position)",
    "Debug code for very specific cases.",
    "Mostly shouldn't be needed. Use SimModeBase::drawLidarDebugPoints()",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "Not implemented, just added for compilation.",
    "Function pointers to hold the addresses of the functions that are defined in Unity",
    "initialize state",
    "compute our home point",
    "these will be available for devices like steering wheels",
    "update position from kinematics so we have latest position after physics update",
    "kinematics_->update();",
    "parameters in NED frame",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "implements getImages() method in the ImageCaptureBase class.",
    "update ray tracing",
    "TODO: index check",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "-------------------------------- overrides -----------------------------------------------//",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "TODO: implement arming for car",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "API server start/stop",
    "determine camera director camera default pose and spawn it",
    "derived class should override this method to retrieve types of pawns they support",
    "derived class should override this method to retrieve types of pawns they support",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);",
    "Pose goalPose = client.simGetObjectPose(\"OrangeBall\");",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "DepthNavThreshold depthNav;",
    "DepthNavOptAStar depthNav;",
    "Cleanup",
    "runDepthNavGT();",
    "runDepthNavSGM();",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "first row",
    "last row",
    "Local quadratic fit of cost and subpixel refinement.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "uint64_t x64 = (uint64_t)x;",
    "uint64_t y64 = (uint64_t)y;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "by Sudipta Sinha",
    "adapted for AirSim by Matthias Mueller",
    "ensure that disparity range is a multiple of 8",
    "sgm stereo"
  ],
  "v1.2.0": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "monitor car state while you drive it manually.",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensitive",
    "#for neighborhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "airsim.write_pfm(os.path.normpath(filename + '.pfm'), airsim.get_pfm_array(response))",
    "airsim.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "airsim.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "Go to object in Unreal Editor, click on it and then look for Tags property.",
    "Add a tag \"MyObject\" (without quotes), save and the query using following line",
    "see more about tags here: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "connect to the AirSim simulator",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "connect to the AirSim simulator",
    "go forward",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "import pkgutil",
    "airsim_loader = pkgutil.find_loader('airsim')",
    "if airsim_loader is not None:",
    "return",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using airsim.DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "center is just a direction vector, so normalize it to compute the actual cx,cy locations.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggressively.",
    "compute current angle",
    "compute lookahead",
    "if we did the takeoff then also do the landing.",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore the click over from 360 back to 0",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "first hold our current position so drone doesn't try and keep flying while we take the picture.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing timeout_sec=0.",
    "change clock speed in settings.json",
    "\"ClockSpeed\": 0.5",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quit cleanly",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "now compute the survey path required to fill the box",
    "connect to the AirSim simulator",
    "Import this module to automatically setup path to local airsim module",
    "This module first tries to see if airsim module is installed via pip",
    "If it does then we don't do anything else",
    "Else we look up grand-parent folder to see if it has airsim folder",
    "and if it does then we add that in sys.path",
    "this class simply tries to see if airsim",
    "if airsim module is installed then don't do anything else",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "-----------------------------------  Common vehicle APIs ---------------------------------------------",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "todo: in future remove below, it's only for compatibility to pre v1.2",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the ImageType members",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "TODO: below str() conversion is only needed for legacy reason and should be removed in future",
    "legacy handling",
    "TODO: remove below legacy wrappers in future major releases",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "APIs for control",
    "query vehicle state",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "todo: in future remove str(), it's only for compatibility to pre v1.2",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilon = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make sure from <= to",
    "normalize the ticks so both are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "if we don't suppress then server will bomb out for exceptions raised by any method",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "should be implemented by derived class if it supports async task,",
    "for example using futures",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "return value of last task. It should be true if task completed without",
    "cancellation or timeout",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include pre-compiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "after landing we detect if drone has stopped moving",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "if timeout occurred then command completed successfully otherwise it was interrupted",
    "change yaw by moving to same position but constant yaw mode",
    "by default we say that this command is not supported",
    "executes a given function until it returns true. Each execution is spaced apart at command period.",
    "return value is true if exit was due to given function returning true, otherwise false (due to timeout)",
    "get trims",
    "take average",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in forward-only mode",
    "else no adjustment needed",
    "if auto mode requested for lookahead then calculate based on velocity",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "ExternalCamera->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "TODO: should we be ignoring position and orientation settings here?",
    "TODO: can we eliminate storing NedTransform?",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessary calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "TODO: may be we should have these methods non-const?",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "nothing to do for now",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogTemp, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "PNGs are saved as RGBA but FColors are stored as BGRA. An option to swap the order upon compression may be added at",
    "some point. At the moment, manually swapping Red and Blue",
    "Copy scaled image into destination thumb",
    "Compress data - convert into a .png",
    "if we already have attached actor",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* AAirSimGameMode::GetGameUserSettings()",
    "{",
    "if (GEngine != nullptr)",
    "{",
    "return GEngine->GameUserSettings;",
    "}",
    "return nullptr;",
    "}",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "normally pawns have their center as origin. If we use this as 0,0,0 in NED then",
    "when we tell vehicle to go to 0,0,0 - it will try to go in the ground",
    "so we get the bounds and subtract z to get bottom as 0,0,0",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "initialize state",
    "compute our home point",
    "add listener for pawn's collision event",
    "add cameras that already exists in pawn",
    "create or replace cameras specified in settings",
    "setup individual cameras",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "for each camera in settings",
    "get pose",
    "spawn and attach camera to pawn",
    "add on to our collection",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "-1 to 1 --> 0 to 1",
    "-1 to 1",
    "these will be available for devices like steering wheels",
    "switch index 0 to 7 for FrSky Taranis RC is:",
    "front-upper-left, front-upper-right, top-right-left, top-right-left, top-left-right, top-right-right, top-left-left, top-right-left",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "update position from kinematics so we have latest position after physics update",
    "kinematics_->update();",
    "void playBack()",
    "{",
    "if (pawn_->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "}",
    "parameters in NED frame",
    "translate to new PawnSimApi position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "TODO: update other fields?",
    "no default action in this base class",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "remove warnings for using safe VC++ APIs",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Magnitude ranges from -1 to 1",
    "Strength ranges from 0 to 1",
    "Autocenter",
    "Rumble",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then it's an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new index",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previous one",
    "open new device",
    "if open was successful",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "TODO: implement this for linux",
    "TODO: implement this for linux",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: anyway to workaround const_cast?",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "spawn at origin. We will use this to do global NED transforms, for ex, non-vehicle objects in environment",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "build image file name",
    "write image file",
    "write to CSV file",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "TODO: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "TODO: get this from settings",
    "no effect in this sim mode",
    "no effect in this sim mode",
    "get UU origin of global NED frame",
    "TODO:make this configurable",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of multirotor type and auto creatable",
    "decide which derived BP to use",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "initialize each vehicle pawn we found",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "put camera little bit above vehicle",
    "update ground level",
    "TODO: get this from settings",
    "let base class setup physics world",
    "stop physics thread before we dismantle",
    "get UU origin of global NED frame",
    "TODO:make this configurable",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of multirotor type and auto creatable",
    "decide which derived BP to use",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "initialize the pawn",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "setup clock in ClockFactory",
    "scalable clock returns interval same as wall clock but multiplied by a scale factor",
    "steppable clock returns interval that is a constant number irrespective of wall clock",
    "we can either multiply this fixed interval by scale factor to speed up/down the clock",
    "but that would cause vehicles like quadrotors to become unstable",
    "so alternative we use here is instead to scale control loop frequency. The downside is that",
    "depending on compute power available, we will max out control loop frequency and therefore can no longer",
    "get increase in clock speed",
    "Approach 1: scale clock period, no longer used now due to quadrotor instability",
    "ClockFactory::get(std::make_shared<msr::airlib::SteppableClock>(",
    "static_cast<msr::airlib::TTimeDelta>(getPhysicsLoopPeriod() * 1E-9 * clock_speed)));",
    "Approach 2: scale control loop frequency if clock is speeded up",
    "for slowing down, this don't generate instability",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "create vehicle API",
    "setup physics vehicle",
    "initialize private vars",
    "calls to update* are handled by physics engine and in SimModeWorldBase",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update rotor poses",
    "if we did reset then don't worry about synchronizing states for this tick",
    "Continue to wait for reset",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "environment update for current position",
    "update forces on vertices",
    "update to controller must be done after kinematics have been updated by physics engine",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "get references of existing camera",
    "TODO: get this from settings",
    "setup clock in PhysX",
    "get UU origin of global NED frame",
    "TODO:make this configurable",
    "find all vehicle pawns",
    "add vehicles from settings",
    "if vehicle is of multirotor type and auto creatable",
    "decide which derived BP to use",
    "compute initial pose",
    "spawn vehicle pawn",
    "create API objects for each pawn we have",
    "initialize each vehicle pawn we found",
    "create vehicle sim api",
    "TODO: better handle no FPV vehicles scenario",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tires",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "update physics material",
    "Update the strings used in the HUD (in-car and on-screen)",
    "Set the string in the in-car HUD",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "This method must be in pawn because Unreal doesn't allow key bindings to non UObject pointers",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: should do reset() here?",
    "create vehicle params",
    "std::shared_ptr<UnrealSensorFactory> sensor_factory = std::make_shared<UnrealSensorFactory>(getPawn(), &getNedTransform());",
    "these are called on render ticks",
    "TODO: do we need this for cars?",
    "TODO: move this to SimModeBase?",
    "if ((joystick_state_.buttons & 4) | (joystick_state_.buttons & 1024)) { //X button or Start button",
    "reset();",
    "return;",
    "}",
    "Thrustmaster devices",
    "Anything else, typically Logitech G920 wheel",
    "Two steel levers behind wheel",
    "if API-client control is not active then we route keyboard/joystick control to car",
    "all car controls from anywhere must be routed through API component",
    "*** Start: UpdatableState implementation ***//",
    "physics tick",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "TODO: implement arming for car",
    "TODO: directly accept getVehicleSimApis() using generic container",
    "remove everything that we created in BeginPlay",
    "we use custom debug reporting for this class",
    "perform any expensive rendering update outside of lock region",
    "no need to call base reset because of our custom implementation",
    "TODO: this is going to cause circular references which is fine here but",
    "in future we should consider moving SimMode not derived from AActor and move",
    "it to AirLib and directly implement WorldSimApiBase interface",
    "get player start",
    "this must be done from within actor otherwise we don't get player start",
    "else don't init",
    "else ignore",
    "should be overridden by derived class",
    "should be overridden by derived class",
    "this will be the case when compilation with RPCLIB is disabled or simmode doesn't support APIs",
    "default setup - this should be overridden in derived modes as needed",
    "setup clock in ClockFactory",
    "default implementation",
    "create director",
    "create external camera required for the director",
    "API server start/stop",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& param, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fall back when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.10": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "connect to the AirSim simulator",
    "monitor car state while you drive it manually.",
    "get state of the car",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "Make the drone fly in a circle.",
    "check that our home position is stable",
    "AirSim uses NED coordinates so negative axis is up.",
    "ramp up time",
    "ramp up to full speed in smooth increments so we don't start too aggresively.",
    "compute current angle",
    "compute lookahead",
    "tracking # of completed orbits is surprisingly tricky to get right in order to handle random wobbles",
    "about the starting point.  So we watch for complete 1/2 orbits to avoid that problem.",
    "now we just have to watch for a smooth crossing from negative diff to positive diff",
    "ignore any large discontinuities",
    "watch direction this diff is moving if it switches from shrinking to growing",
    "then we passed the starting point.",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "now compute the survey path required to fill the box",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensetive",
    "#for neighbourhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "AirSimClientBase.write_pfm(os.path.normpath(filename + '.pfm'), AirSimClientBase.getPfmArray(response))",
    "AirSimClientBase.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "AirSimClientBase.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Go to object in Unreal Editor, click on it and then look for Tags property.",
    "Add a tag \"MyObject\" (without quotes), save and the query using following line",
    "see more about tags here: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "get trims",
    "take average",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "find out which RC we should use",
    "find out which RC we should use",
    "initialize state",
    "compute our home point",
    "should be overridden in derived class",
    "if (pawn_->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "Computer transform using the actor that this camera is attached to",
    "if this is free floting camera like external observer camera then just use",
    "itself to select origin point",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "nothing to do for now",
    "UE_LOG(LogAirSim, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Log, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Error, TEXT(\"%s%s\"), *prefix, *suffix);",
    "UE_LOG(LogAirSim, Verbose, TEXT(\"%s%s\"), *prefix, *suffix);",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "UAirBlueprintLib::LogMessage(name + TEXT(\" Actor not found!\"), TEXT(\"\"), LogDebugLevel::Failure);",
    "common_utils::Utils::DebugBreak();",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "Explicitly set the custom depth state on the components so the",
    "render state is marked dirty and the update actually takes effect",
    "immediately.",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "create control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "fpv_vehicle_connectors_.Empty();",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "Can't obtain NedTransform from wrapper because it's not initialized yet, so make our own.",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "if we did reset then don't worry about synchrnozing states for this tick",
    "Continue to wait for reset",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response_info.collision_count_raw), LogDebugLevel::Unimportant);",
    "Kinematics::State kinematics_estimated = controller_->getKinematicsEstimated();",
    "Kinematics::State kinematics_true = vehicle_.getKinematics();",
    "UAirBlueprintLib::LogMessageString(\"Position (true): \", VectorMath::toString(kinematics_true.pose.position), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Position (est): \", VectorMath::toString(kinematics_estimated.pose.position), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Velocity (true): \", VectorMath::toString(kinematics_true.twist.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Velocity (est): \", VectorMath::toString(kinematics_estimated.twist.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Velocity (true): \", VectorMath::toString(kinematics_true.twist.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Velocity (est): \", VectorMath::toString(kinematics_estimated.twist.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Accel (true): \", VectorMath::toString(kinematics_true.accelerations.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Accel (est): \", VectorMath::toString(kinematics_estimated.accelerations.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Accel (true): \", VectorMath::toString(kinematics_true.accelerations.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Accel (est): \", VectorMath::toString(kinematics_estimated.accelerations.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Orien (true): \", VectorMath::toString(kinematics_true.pose.orientation), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Orien (est): \", VectorMath::toString(kinematics_estimated.pose.orientation), LogDebugLevel::Informational);",
    "*** Start: UpdatableState implementation ***//",
    "schedule the task which we will execute in tick event when World object is locked",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "put camera little bit above vehicle",
    "TODO: should do reset() here?",
    "joystick",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::onReverseReleased, false);",
    "TODO: update other fields",
    "update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Two steel levers behind wheel",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "else don't save",
    "movement_->ResetMoveState();",
    "movement_->SetActive(false);",
    "movement_->SetActive(true, true);",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "else don't init",
    "else ignore",
    "setup clock in PhysX",
    "setup clock in ClockFactory",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.9": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "connect to the AirSim simulator",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "now compute the survey path required to fill the box",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensetive",
    "#for neighbourhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "AirSimClientBase.write_pfm(os.path.normpath(filename + '.pfm'), AirSimClientBase.getPfmArray(response))",
    "AirSimClientBase.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "AirSimClientBase.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Go to object in Unreal Editor, click on it and then look for Tags property.",
    "Add a tag \"MyObject\" (without quotes), save and the query using following line",
    "see more about tags here: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "get trims",
    "take average",
    "freeze the quaternion",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing, spring arm is pulling the camera with it",
    "do nothing, we have camera turned off",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "detach spring arm",
    "Re-enable rendering",
    "Remove any existing key bindings for manual mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "if new mode is manual mode then add key bindings",
    "if we switched to spring arm mode then attach to spring arm (detachment was done earlier in method)",
    "other modes don't need special setup",
    "make switch official",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "find out which RC we should use",
    "initialize state",
    "compute our home point",
    "should be overridden in derived class",
    "if (pawn_->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: refactor below code used for playback",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "Computer transform using the actor that this camera is attached to",
    "if this is free floting camera like external observer camera then just use",
    "itself to select origin point",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "APlayerController* controller = this->GetWorld()->GetFirstPlayerController();",
    "if (controller && controller->GetViewTarget() == this)",
    "controller->SetViewTarget(nullptr);",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "Enable/disable primary viewport rendering flag",
    "This disables rendering of the main viewport in the same way as the",
    "console command \"show rendering\" would do.",
    "When getting an image through the API, the image is produced after the render",
    "thread has finished rendering the current and the subsequent frame. This means",
    "that the frame rate for obtaining images through the API is only half as high as",
    "it could be, since only every other image is actually captured. We work around",
    "this by telling the viewport to flush the rendering queue at the end of each",
    "drawn frame so that it executes our render request at that point already.",
    "Do this only if the main viewport is not being rendered anyway in case there are",
    "any adverse performance effects during main rendering.",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "HACK: FViewPort doesn't expose this field so we are doing dirty work around by maintaining count by ourselves",
    "nothing to do for now",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "UAirBlueprintLib::LogMessage(name + TEXT(\" Actor not found!\"), TEXT(\"\"), LogDebugLevel::Failure);",
    "common_utils::Utils::DebugBreak();",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "Explicitly set the custom depth state on the components so the",
    "render state is marked dirty and the update actually takes effect",
    "immediately.",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "create control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "fpv_vehicle_connectors_.Empty();",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "UStaticMeshComponent* bodyMesh = UAirBlueprintLib::GetActorComponent<UStaticMeshComponent>(this, TEXT(\"BodyMesh\"));",
    "Can't obtain NedTransform from wrapper because it's not initialized yet, so make our own.",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "if we did reset then don't worry about synchrnozing states for this tick",
    "Continue to wait for reset",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response_info.collision_count_raw), LogDebugLevel::Unimportant);",
    "Kinematics::State kinematics_estimated = controller_->getKinematicsEstimated();",
    "Kinematics::State kinematics_true = vehicle_.getKinematics();",
    "UAirBlueprintLib::LogMessageString(\"Position (true): \", VectorMath::toString(kinematics_true.pose.position), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Position (est): \", VectorMath::toString(kinematics_estimated.pose.position), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Velocity (true): \", VectorMath::toString(kinematics_true.twist.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Velocity (est): \", VectorMath::toString(kinematics_estimated.twist.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Velocity (true): \", VectorMath::toString(kinematics_true.twist.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Velocity (est): \", VectorMath::toString(kinematics_estimated.twist.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Accel (true): \", VectorMath::toString(kinematics_true.accelerations.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Accel (est): \", VectorMath::toString(kinematics_estimated.accelerations.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Accel (true): \", VectorMath::toString(kinematics_true.accelerations.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Accel (est): \", VectorMath::toString(kinematics_estimated.accelerations.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Orien (true): \", VectorMath::toString(kinematics_true.pose.orientation), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Orien (est): \", VectorMath::toString(kinematics_estimated.pose.orientation), LogDebugLevel::Informational);",
    "*** Start: UpdatableState implementation ***//",
    "schedule the task which we will execute in tick event when World object is locked",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Try to find the high polycount vehicle",
    "If not found, spawn the default class (go-kart)",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find out which RC we should use",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "TODO: should do reset() here?",
    "joystick",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReverseReleased, false);",
    "TODO: update other fields",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Two steel levers behind wheel",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "else don't save",
    "movement_->ResetMoveState();",
    "movement_->SetActive(false);",
    "movement_->SetActive(true, true);",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "else don't init",
    "else ignore",
    "setup clock in PhysX",
    "setup clock in ClockFactory",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.8": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "obj.__dict__ = {k.decode('utf-8'): (from_msgpack(v.__class__, v) if hasattr(v, \"__dict__\") else v) for k, v in encoded.items()}",
    "return cls(**msgpack.unpack(encoded))",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quit cleanly",
    "import gym #pip install gym",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "###########################################",
    "######### This is work in progress! #######",
    "###########################################",
    "file will be saved in PythonClient folder (i.e. same folder as script)",
    "point cloud ASCII format, use viewers like CloudCompare http://www.danielgm.net/cc/ or see http://www.geonext.nl/wp-content/uploads/2014/05/Point-Cloud-Viewers.pdf",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "AirSim uses NED coordinates so negative axis is up.",
    "let it settle there a bit.",
    "now compute the survey path required to fill the box",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensetive",
    "#for neighbourhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "AirSimClientBase.write_pfm(os.path.normpath(filename + '.pfm'), AirSimClientBase.getPfmArray(response))",
    "AirSimClientBase.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "AirSimClientBase.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "Go to object in Unreal Editor, click on it and then look for Tags property.",
    "Add a tag \"MyObject\" (without quotes), save and the query using following line",
    "see more about tags here: https://answers.unrealengine.com/questions/543807/whats-the-difference-between-tag-and-tag.html",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "if prev mode was spring arm but new mode isn't then detach spring arm",
    "else someone else is bound to manual pose controller, leave it alone",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "find out which RC we should use",
    "set up key variables",
    "initialize state",
    "should be overridden in derived class",
    "if (pawn_->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "if (!std::isnan(setting.target_gamma))",
    "camera-> = setting.target_gamma;",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "UAirBlueprintLib::LogMessage(name + TEXT(\" Actor not found!\"), TEXT(\"\"), LogDebugLevel::Failure);",
    "common_utils::Utils::DebugBreak();",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "Explicitly set the custom depth state on the components so the",
    "render state is marked dirty and the update actually takes effect",
    "immediately.",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "TODO: is below really needed?",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "FGenericPlatformMisc::PlatformInit();",
    "FGenericPlatformMisc::MessageBoxExt(EAppMsgType::Ok, TEXT(\"Error at Startup\"), ANSI_TO_TCHAR(ex.what()));",
    "TODO: index check",
    "create main widget",
    "synchronize PIP views",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "during startup we init stencil IDs to random hash and it takes long time for large environments",
    "we get error that GameThread has timed out after 30 sec waiting on render thread",
    "setup defaults",
    "Attempts to parse the settings text from one of multiple locations.",
    "First, check the command line for settings provided via \"-s\" or \"--settings\" arguments",
    "Next, check the executable's working directory for the settings file.",
    "Finally, check the user's documents folder.",
    "If the settings file cannot be read, throw an exception",
    "Attempts to parse the settings text from the command line",
    "Looks for the flag \"--settings\". If it exists, settingsText will be set to the value.",
    "Example: AirSim.exe -s '{\"foo\" : \"bar\"}' -> settingsText will be set to {\"foo\": \"bar\"}",
    "Returns true if the argument is present, false otherwise.",
    "create control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "fpv_vehicle_connectors_.Empty();",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "if we did reset then don't worry about synchrnozing states for this tick",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response_info.collision_count_raw), LogDebugLevel::Unimportant);",
    "Kinematics::State kinematics_estimated = controller_->getKinematicsEstimated();",
    "Kinematics::State kinematics_true = vehicle_.getKinematics();",
    "UAirBlueprintLib::LogMessageString(\"Position (true): \", VectorMath::toString(kinematics_true.pose.position), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Position (est): \", VectorMath::toString(kinematics_estimated.pose.position), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Velocity (true): \", VectorMath::toString(kinematics_true.twist.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Velocity (est): \", VectorMath::toString(kinematics_estimated.twist.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Velocity (true): \", VectorMath::toString(kinematics_true.twist.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Velocity (est): \", VectorMath::toString(kinematics_estimated.twist.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Accel (true): \", VectorMath::toString(kinematics_true.accelerations.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Lin Accel (est): \", VectorMath::toString(kinematics_estimated.accelerations.linear), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Accel (true): \", VectorMath::toString(kinematics_true.accelerations.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Ang Accel (est): \", VectorMath::toString(kinematics_estimated.accelerations.angular), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Orien (true): \", VectorMath::toString(kinematics_true.pose.orientation), LogDebugLevel::Informational);",
    "UAirBlueprintLib::LogMessageString(\"Orien (est): \", VectorMath::toString(kinematics_estimated.pose.orientation), LogDebugLevel::Informational);",
    "*** Start: UpdatableState implementation ***//",
    "schedule the task which we will execute in tick event when World object is locked",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Try to find the high polycount vehicle",
    "If not found, spawn the default class (go-kart)",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find out which RC we should use",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "TODO: should do reset() here?",
    "joystick",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReverseReleased, false);",
    "TODO: update other fields",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Two steel levers behind wheel",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "else don't save",
    "movement_->ResetMoveState();",
    "movement_->SetActive(false);",
    "movement_->SetActive(true, true);",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "else don't init",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "update ray tracing",
    "FString hit_name = FString(\"None\");",
    "if (dist_hit.GetActor())",
    "hit_name=dist_hit.GetActor()->GetName();",
    "UAirBlueprintLib::LogMessage(FString(\"Distance to \"), hit_name+FString(\": \")+FString::SanitizeFloat(distance), LogDebugLevel::Informational);",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.7": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quite cleanly",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensetive",
    "#for neighbourhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "AirSimClientBase.write_pfm(os.path.normpath(filename + '.pfm'), AirSimClientBase.getPfmArray(response))",
    "AirSimClientBase.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "AirSimClientBase.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "restore to original state",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "connect to the AirSim simulator",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "if prev mode was spring arm but new mode isn't then detach spring arm",
    "else someone else is bound to manual pose controller, leave it alone",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "set up key variables",
    "initialize state",
    "should be overridden in derived class",
    "should be overridden in derived class",
    "if (pawn_->GetRootPrimitiveComponent()->IsAnySimulatingPhysics()) {",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(false);",
    "pawn_->GetRootPrimitiveComponent()->SetSimulatePhysics(true);",
    "}",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "set default for brigher images",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "else we will set this after this components get created",
    "else we will set this after this components get created",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "common_utils::Utils::DebugBreak();",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "create main widget",
    "synchronize PIP views",
    "setup defaults",
    "TODO: should this be done somewhere else?",
    "load settings file if found",
    "create default settings",
    "write some settings in new file otherwise the string \"null\" is written if all settigs are empty",
    "TODO: there is a crash in Linux due to settings.saveJSonString(). Remove this workaround after we only support Unreal 4.17",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "create its control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "if reset is pending then do it first, no need to do other things until next tick",
    "move collision info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "if we did reset then don't worry about synchrnozing states for this tick",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response_info.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "schedule the task which we will execute in tick event when World object is locked",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "If render command is complete, save image along with position and orientation",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Try to find the high polycount vehicle",
    "If not found, spawn the default class (go-kart)",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear \\t ImageName",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find out which RC we should use",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "TODO: should do reset() here?",
    "joystick",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReverseReleased, false);",
    "TODO: update other fields",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Two steel levers behind wheel",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "else don't save",
    "movement_->ResetMoveState();",
    "movement_->SetActive(false);",
    "movement_->SetActive(true, true);",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "set defaults in case exception occurs",
    "we had spelling mistake so we are currently supporting SettingsVersion or SettingdVersion :(",
    "no warnings because we have default settings",
    "by default we spawn server at local endpoint. Do not use 127.0.0.1 as default below",
    "because for docker container default is 0.0.0.0 and people get really confused why things",
    "don't work",
    "By default this is the column header. Override it in BeginPlay of pawn mode",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.6": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "currently reset() doesn't work in CV mode. Below is the workaround",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quite cleanly",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for block environment",
    "regex are case insensetive",
    "#for neighbourhood environment",
    "set object ID for sky",
    "below doesn't work yet. You must set CustomDepthStencilValue in Unreal Editor for now",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "AirSimClientBase.write_pfm(os.path.normpath(filename + '.pfm'), AirSimClientBase.getPfmArray(response))",
    "AirSimClientBase.write_file(os.path.normpath(filename + '.png'), response.image_data_uint8)",
    "AirSimClientBase.write_png(os.path.normpath(filename + '.numpy.png'), img_rgba) #write to png",
    "find unique colors",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "if prev mode was spring arm but new mode isn't then detach spring arm",
    "else someone else is bound to manual pose controller, leave it alone",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "set up key variables",
    "initialize state",
    "should be overridden in derived class",
    "should be overridden in derived class",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "set default for brigher images",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "else we will set this after this components get created",
    "else we will set this after this components get created",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "#include \"Runtime/Foliage/Public/FoliageType.h\"",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "common_utils::Utils::DebugBreak();",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "for (TObjectIterator<UFoliageType> comp; comp; ++comp)",
    "{",
    "InitializeObjectStencilID(*comp);",
    "}",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "#include <libudev.h>",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "create main widget",
    "synchronize PIP views",
    "setup defaults",
    "TODO: should this be done somewhere else?",
    "load settings file if found",
    "create default settings",
    "write some settings in new file otherwise the string \"null\" is written if all settigs are empty",
    "TODO: there is a crash in Linux due to settings.saveJSonString(). Remove this workaround after we only support Unreal 4.17",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "create its control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "move collision info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response_info.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "If render command is complete, save image along with position and orientation",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Try to find the high polycount vehicle",
    "If not found, spawn the default class (go-kart)",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear \\t ImageName",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReverseReleased, false);",
    "TODO: update other fields",
    "Setup the flag to say we are in reverse gear",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "set defaults in case exception occurs",
    "we had spelling mistake so we are currently supporting SettingsVersion or SettingdVersion :(",
    "no warnings because we have default settings",
    "by default we spawn server at local endpoint. Do not use 127.0.0.1 as default below",
    "because for docker container default is 0.0.0.0 and people get really confused why things",
    "don't work",
    "By default this is the column header. Override it in BeginPlay of pawn mode",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.5": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "connect to the AirSim simulator",
    "Make RL agent",
    "Train",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quite cleanly",
    "Local variable access is faster in loops",
    "if not wrapping over current pointer,",
    "then check if there is terminal state wrapped inside",
    "If index > history_length, take from a slice",
    "Metrics accumulator",
    "Action Value model (used by agent to interact with the environment)",
    "Target model used to compute the target Q-values in training, updated",
    "less frequently for increased stability.",
    "Function computing Q-values targets as part of the computation graph",
    "Define the loss, using Huber Loss (more robust to outliers)",
    "Compute the q_targets",
    "actions is a 1-hot encoding of the action done by the agent",
    "Define training criterion as the Huber Loss function",
    "Adam based SGD",
    "self._trainer.restore_from_checkpoint('models/oldmodels/model800000')",
    "Append the state to the short term memory (ie. History)",
    "If policy requires agent to explore, sample random action",
    "Use the network to output the best action",
    "Append batch axis with only one sample to evaluate",
    "Return the value maximizing the expected reward",
    "Keep track of interval action counter",
    "If done, reset short term memory (ie. History)",
    "Plot the metrics through Tensorboard and reset buffers",
    "Reset the short term memory",
    "Append to long term memory",
    "Update the Target Network if needed",
    "print(dist)",
    "Make RL agent",
    "Train",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "for neighbourhood environment",
    "get segmentation image in various formats",
    "save segmentation images in various formats",
    "find unique colors",
    "from keras.models import load_model",
    "if (len(sys.argv) != 2):",
    "print('usage: python drive.py <modelName>')",
    "sys.exit()",
    "print('Loading model...')",
    "model = load_model(sys.argv[1])",
    "connect to the AirSim simulator",
    "image_buf[0] = get_image()",
    "state_buf[0] = np.array([car_controls.steering, car_controls.throttle, car_controls.brake, car_state.speed])",
    "model_output = model.predict([image_buf, state_buf])",
    "car_controls.steering = float(model_output[0][0])",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "if prev mode was spring arm but new mode isn't then detach spring arm",
    "else someone else is bound to manual pose controller, leave it alone",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "set up key variables",
    "initialize state",
    "should be overridden in derived class",
    "should be overridden in derived class",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "set default for brigher images",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "else we will set this after this components get created",
    "else we will set this after this components get created",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "mesh->SetRenderCustomDepth(false);",
    "mesh->SetRenderCustomDepth(true);",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "if (! is_name_regex)",
    "return true;",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "create main widget",
    "synchronize PIP views",
    "setup defaults",
    "TODO: should this be done somewhere else?",
    "load settings file if found",
    "create default settings",
    "write some settings in new file otherwise the string \"null\" is written if all settigs are empty",
    "TODO: there is a crash in Linux due to settings.saveJSonString(). Remove this workaround after we only support Unreal 4.17",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "create its control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "move collision info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response_info.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "If render command is complete, save image along with position and orientation",
    "UAirBlueprintLib::LogMessage(TEXT(\"Screenshot saved to:\"), filePath, LogDebugLevel::Success);",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "UAirBlueprintLib::LogMessage(TEXT(\"Stopped recording thread\"), TEXT(\"\"), LogDebugLevel::Success);",
    "Try to find the high polycount vehicle",
    "If not found, spawn the default class (go-kart)",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear \\t ImageName",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReverseReleased, false);",
    "TODO: update other fields",
    "Setup the flag to say we are in reverse gear",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "set defaults in case exception occurs",
    "we had spelling mistake so we are currently supporting SettingsVersion or SettingdVersion :(",
    "no warnings because we have default settings",
    "by default we spawn server at local endpoint. Do not use 127.0.0.1 as default below",
    "because for docker container default is 0.0.0.0 and people get really confused why things",
    "don't work",
    "By default this is the column header. Override it in BeginPlay of pawn mode",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.4": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "connect to the AirSim simulator",
    "go forward",
    "get state of the car",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "else someone else is bound to manual pose controller, leave it alone",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "set up key variables",
    "initialize state",
    "should be overridden in derived class",
    "should be overridden in derived class",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collision before we set pose. Setting pose will immediately call NotifyHit if there was collision",
    "if there was no collision than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisions are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisions can't be detected",
    "set default for brigher images",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "else we will set this after this components get created",
    "else we will set this after this components get created",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "mesh->SetRenderCustomDepth(false);",
    "mesh->SetRenderCustomDepth(true);",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "if (! is_name_regex)",
    "return true;",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "create main widget",
    "synchronize PIP views",
    "setup defaults",
    "TODO: should this be done somewhere else?",
    "load settings file if found",
    "create default settings",
    "write some settings in new file otherwise the string \"null\" is written if all settigs are empty",
    "TODO: there is a crash in Linux due to settings.saveJSonString(). Remove this workaround after we only support Unreal 4.17",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "create its control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "move collision info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collision (raw) Count:\"), FString::FromInt(collision_response_info.collision_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "If render command is complete, save image along with position and orientation",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "Try to find the high polycount vehicle",
    "If not found, spawn the default class (go-kart)",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear \\t ImageName",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReverseReleased, false);",
    "TODO: update other fields",
    "Setup the flag to say we are in reverse gear",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "set defaults in case exception occurs",
    "we had spelling mistake so we are currently supporting SettingsVersion or SettingdVersion :(",
    "no warnings because we have default settings",
    "by default we spawn server at local endpoint. Do not use 127.0.0.1 as default below",
    "because for docker container default is 0.0.0.0 and people get really confused why things",
    "don't work",
    "By default this is the column header. Override it in BeginPlay of pawn mode",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.3": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "reverse the vertical line order and add null bytes at the start",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "connect to the AirSim simulator",
    "get camera images from the car",
    "that's enough fun for now. let's quite cleanly",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse",
    "apply breaks",
    "get camera images from the car",
    "restore to original state",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "suppress",
    "OneCoreFindSerialPorts.obj : warning LNK4221: This object file does not define any previously undefined public symbols, so it will not be used by any link operation that consumes this library",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "status getters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing",
    "set initial view mode",
    "If we do have actor to follow AND don't have sprint arm attached to that actor, we will attach it",
    "For car, we want a bit of camera lag, as that is customary of racing video games",
    "If the lag is missing, the camera will also occasionally shake.",
    "But, lag is not desired when piloting a drone",
    "attach spring arm to actor",
    "remember current parent for external camera. Later when we remove external",
    "camera from spring arm, we will attach it back to its last parent",
    "now attach camera to spring arm",
    "For car, we need to move the camera back a little more than for a drone.",
    "Otherwise, the camera will be stuck inside the car",
    "external_camera_->bUsePawnControlRotation = false;",
    "else someone else is bound to manual pose controller, leave it alone",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "set up key variables",
    "initialize state",
    "should be overridden in derived class",
    "should be overridden in derived class",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collison before we set pose. Setting pose will immediately call NotifyHit if there was collison",
    "if there was no collison than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisons are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisons can't be detected",
    "set default for brigher images",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "else we will set this after this components get created",
    "else we will set this after this components get created",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "mesh->SetRenderCustomDepth(false);",
    "mesh->SetRenderCustomDepth(true);",
    "mesh->SetVisibility(false);",
    "mesh->SetVisibility(true);",
    "if (! is_name_regex)",
    "return true;",
    "Access the subclass instance with the * or -> operators.",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "create main widget",
    "synchronize PIP views",
    "setup defaults",
    "TODO: should this be done somewhere else?",
    "load settings file if found",
    "create default settings",
    "write some settings in new file otherwise the string \"null\" is written if all settigs are empty",
    "TODO: there is a crash in Linux due to settings.saveJSonString(). Remove this workaround after we only support Unreal 4.17",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "create its control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "move collison info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collison (raw) Count:\"), FString::FromInt(collision_response_info.collison_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "If render command is complete, save image along with position and orientation",
    "TODO: check FPlatformProcess::SupportsMultithreading()?",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "Try to find the high polycount vehicle",
    "If not found, spawn the default class (go-kart)",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear \\t ImageName",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "below is not needed",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReversePressed, true);",
    "UAirBlueprintLib::BindActionToKey(\"Reverse\", EKeys::Down, this, &ACarPawn::OnReverseReleased, false);",
    "TODO: update other fields",
    "Setup the flag to say we are in reverse gear",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "Timestamp \\t Speed \\t Throttle \\t Steering \\t Brake \\t gear",
    "timestamp",
    "Speed",
    "Gear",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "set defaults in case exception occurs",
    "we had spelling mistake so we are currently supporting SettingsVersion or SettingdVersion :(",
    "no warnings because we have default settings",
    "by default we spawn server at local endpoint. Do not use 127.0.0.1 as default below",
    "because for docker container default is 0.0.0.0 and people get really confused why things",
    "don't work",
    "By default this is the column header. Override it in BeginPlay of pawn mode",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "TODO: shouldn't we pass folder path?",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.1.1": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "In settings.json first activate computer vision mode:",
    "https://github.com/Microsoft/AirSim/blob/master/docs/image_apis.md#computer-vision-mode",
    "you can also use MultirotorClient.toQuaternion(0, 0, x) to generate quaternion",
    "connect to the AirSim simulator",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "connect to the AirSim simulator",
    "get state of the car",
    "go forward",
    "Go forward + steer right",
    "go reverse, steer left",
    "apply breaks",
    "get camera images from the car",
    "basic flight control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "-----------------------------------  Multirotor APIs ---------------------------------------------",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "-----------------------------------  Car APIs ---------------------------------------------",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "derived flight controller class should provide implementation if they support exclusive sim*** methods",
    "derived class should override this if it supports sim**** methods",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "status getters",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "getters",
    "required for pimpl",
    "Create a spring arm component for our chase camera",
    "do nothing",
    "set initial view mode",
    "external_camera_->bUsePawnControlRotation = false;",
    "else someone else is bound to manual pose controller, leave it alone",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "set up key variables",
    "initialize state",
    "should be overridden in derived class",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new VehiclePawnWrapper position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collison before we set pose. Setting pose will immediately call NotifyHit if there was collison",
    "if there was no collison than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisons are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisons can't be detected",
    "set default for brigher images",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "else we will set this after this components get created",
    "else we will set this after this components get created",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "UGameUserSettings* game_settings = GetGameUserSettings();",
    "game_settings->SetFullscreenMode(EWindowMode::WindowedFullscreen);",
    "game_settings->ApplySettings(true);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "create main widget",
    "synchronize PIP views",
    "setup defaults",
    "TODO: should this be done somewhere else?",
    "load settings file if found",
    "create default settings",
    "write some settings in new file otherwise the string \"null\" is written if all settigs are empty",
    "TODO: there is a crash in Linux due to settings.saveJSonString(). Remove this workaround after we only support Unreal 4.17",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "create its control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "get references of components so we can use later",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "move collison info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "this must be the first call so controller can change the state before anything else we do",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collison (raw) Count:\"), FString::FromInt(collision_response_info.collison_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "If render command is complete, save image along with position and orientation",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "find all vehicle pawns",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Setup suspension forces",
    "Find the tire object and set the data for it",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Needed for VR Headset",
    "this->AutoReceiveInput = EAutoReceiveInput::Player0;",
    "Car mesh",
    "Setup friction materials",
    "Wheels/Tyres",
    "Setup the wheels",
    "Adjust the tire loading",
    "Engine",
    "Torque setup",
    "Adjust the steering",
    "Transmission",
    "We want 4wd",
    "Drive the front wheels a little more than the rear",
    "Automatic gearbox",
    "Disable reverse as brake, this is needed for SetBreakInput() to take effect",
    "Physics settings",
    "Adjust the center of mass - the buggy is quite low",
    "Set the inertia scale. This controls how the mass of the vehicle is distributed.",
    "Create In-Car camera component",
    "In car HUD",
    "Create text render component for in car speed display",
    "Create text render component for in car gear display",
    "Setup the audio component and allocate it a sound cue",
    "Colors for the in-car gear display. One for normal one for reverse",
    "put camera little bit above vehicle",
    "if (Val < 0)",
    "OnReversePressed();",
    "else",
    "OnReverseReleased();",
    "Setup the flag to say we are in reverse gear",
    "Update phsyics material",
    "Update the strings used in the hud (incar and onscreen)",
    "Set the string in the incar hud",
    "Pass the engine RPM to the sound component",
    "Start an engine sound playing",
    "Using FText because this is display text that should be localizable",
    "Setup the text render component strings",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "set defaults in case exception occurs",
    "we had spelling mistake so we are currently supporting SettingsVersion or SettingdVersion :(",
    "no warnings because we have default settings",
    "by default we spawn server at local endpoint. Do not use 127.0.0.1 as default below",
    "because for docker container default is 0.0.0.0 and people get really confused why things",
    "don't work",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "enable API control",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ],
  "v1.0.0": [
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "read settings and override defaults",
    "allow json overrides on a per-vehicle basis.",
    "start server in async mode",
    "check messages",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "connect to the AirSim simulator",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "use open cv to create point cloud from depth image.",
    "skip it",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -7 is 7 meters above the original launch point.",
    "Fly given velocity vector for 5 seconds",
    "using DrivetrainType.MaxDegreeOfFreedom means we can control the drone yaw independently",
    "from the direction the drone is flying.  I've set values here that make the drone always point inwards",
    "towards the inside of the box (which would be handy if you are building a 3d scan of an object in the real world).",
    "AirSim uses NED coordinates so negative axis is up.",
    "z of -5 is 5 meters above the original launch point.",
    "see https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo",
    "this method is async and we are not waiting for the result since we are passing max_wait_seconds=0.",
    "basic flight control",
    "query vehicle state",
    "def getRCData(self):",
    "return self.client.call('getRCData')",
    "APIs for control",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "because this method returns std::vector<uint8>, msgpack decides to encode it as a string unfortunately.",
    "camera control",
    "simGetImage returns compressed png in array of bytes",
    "image_type uses one of the AirSimImageType members",
    "helper method for converting getOrientation to roll/pitch/yaw",
    "https:#en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles",
    "roll (x-axis rotation)",
    "pitch (y-axis rotation)",
    "yaw (z-axis rotation)",
    "DEY: I don't know why this was there.",
    "data = np.flipud(data)",
    "use open cv to show new images from AirSim",
    "requires Python 3.5.3 :: Anaconda 4.4.0",
    "pip install opencv-python",
    "you must first press \"1\" in the AirSim view to turn on the depth capture",
    "get depth image",
    "this will return png width= 256, height= 144",
    "slice the image so we only check what we are headed into (and not what is down on the ground below us).",
    "now look at 4 horizontal bands (far left, left, right, far right) and see which is most open.",
    "the depth map uses black for far away (0) and white for very close (255), so we invert that",
    "to get an estimate of distance.",
    "sanity check on what is directly in front of us (slot 2 in our hsplit)",
    "we have a 90 degree field of view (pi/2), we've sliced that into 5 chunks, each chunk then represents",
    "an angular delta of the following pi/10.",
    "in header only mode, control library is not available",
    "if using Unreal Build system then include precompiled header file first",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "WIN32 will create the wrong file names if we don't first convert them to UTF-16.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "convert from std::path '/' to windows backslash.",
    "make the current thread run with maximum priority.",
    "THREAD_PRIORITY_HIGHEST is too high and makes animation a bit jumpy.",
    "TODO: How to handle POSIX thread priorities on OSX?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavlinkMoCap.cpp : Defines the entry point for the console application.",
    "",
    "Treat all errors as failure conditions.",
    "parse command line",
    "motive gives a weird error if the project is not found, so we look for it.",
    "Do an update to pick up any recently-arrived cameras.",
    "List all detected cameras.",
    "List all defined rigid bodies.",
    "throttle to 50 messages per second.",
    "OptiTrack uses 'y' axis for vertical.",
    "stdafx.cpp : source file that includes just the standard includes",
    "MavlinkMoCap.pch will be the pre-compiled header",
    "stdafx.obj will contain the pre-compiled type information",
    "TODO: reference any additional headers you need in STDAFX.H",
    "and not in this file",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "PX4.cpp : Defines the entry point for the console application.",
    "static const int pixhawkFMUV1ProductId = 16;     ///< Product ID for PX4 FMU V1 board",
    "how do you write to the debug output windows on Unix ?",
    "The remote app is connected to Pixhawk, and is also \"serving\" UDP packets, this tells us what remote",
    "connection to create to talke to that server.",
    "this is used if you want to connect MavLinkTest to the serial port of the Pixhawk directly",
    "server mode is when you want another app to connect to Pixhawk and publish data back to this process.",
    "this server will be listening for UDP packets, this is mutually exclusive with 'offboard' as this",
    "server will become the primary \"droneConnection\".  For example, jMAVSim can talk to this server",
    "using their the -qgc option.",
    "These are used to echo the mavlink messages to other 3rd party apps like QGC or LogViewer.",
    "this switch controls whether we turn off the RC remote active link loss detection",
    "if you do not have radio connected this is needed to stop \"failsafe\" override in pixhawk",
    "from kicking in when you try and fly.",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "parse the json",
    "flatten inner mavlink object",
    "flatten inner mavlink object",
    "todo",
    "todo",
    "const char* outLogFileOption = \"outlogfile\";",
    "parse command line",
    "forward all PX4 messages to the remote proxy and all messages from remote proxy to PX4.",
    "then we have a serial connection as the primary droneConnection, so publish all PX4 messages out to the server",
    "no local serial connection, so this is the primary droneConnection.",
    "failed to connect",
    "local connection, then we own sending the heartbeat.",
    "this is advanced command that can get us into trouble on real drone, so remove it for now.",
    "cmdTable.push_back(new AltHoldCommand());",
    "DebugOutput(\"q1 : %f\\t%f\\t%f\\t%g\", target.q[0], target.q[1], target.q[2], target.q[3]);",
    "DebugOutput(\"q2 : %f\\t%f\\t%f\\t%g\", q2[0], q2[1], q2[2], q2[3]);",
    "DebugOutput(\"target roll: %f\\tpitch: %f\\tyaw:%f\\tthrust: %f\", roll, pitch, yaw, target.thrust);",
    "this stops us from being able to connect to SITL mode PX4.",
    "checkPulse();",
    "add command text in log",
    "close previous command.",
    "FilterLogFiles(logDirectory);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "send a heartbeat",
    "accept one incoming connection",
    "send a heartbeat to the client",
    "printf(\"    Received message %d\\n\", static_cast<int>(msg.msgid));",
    "this is the server code, it will accept 1 connection from a client on port 14588",
    "for this unit test we are expecting a request to send an image.",
    "add a drone connection so the mavLinkCom can use it to send requests to the above server.",
    "hmmm",
    "================ ls",
    "================ put file",
    "I wish there was a cleaner way to do this, but I can't use tempPath.native() because on windows that is a wstring and on our linux build it is a string.",
    "================ get file",
    "verify the file contents.",
    "================ remove file",
    "================ make directory",
    "D:\\px4\\src\\lovettchris\\Firmware\\rootfs\\fs\\microsd",
    "================ remove directory",
    "Now verification",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "from main.cpp.",
    "you must call this method if you want HandleMessage to be called subsequently.",
    "treat literals as one word",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "request gps info",
    "convert target altitude to a 'z' coordinate (in NED coordinates).",
    "find relative position since command start so we can compare two commands better",
    "TODO: make below future proof (i.e. usable by C++17 compiler) - also change same in main.cpp",
    "can't use experimental stuff on Linux because of potential ABI issues",
    "these PID values are important, so set these to match",
    "sync clocks all the time so that the yellow ribbon also plays back at the right speed.",
    "we can skip ahead.",
    "our clock fell behind somehow (debug breakpoint?) So fix it by moving our start time forwards by this amount.",
    "TODO: avoid passing hadcoded HIL flag",
    "com->setMode(last_basemode | static_cast<int>(MAV_MODE_FLAG::MAV_MODE_FLAG_HIL_ENABLED), last_custommode);",
    "The global position, as returned by the Global Positioning System (GPS).",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "subscribe to get subsequent messages so we can track our progress towards the requested altitude.",
    "Provides state for additional features",
    "The general system state",
    "Provides state for additional features",
    "The general system state",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable MAV_USEHILGPS",
    "note: we do not reset com when Close() is called because we want to keep running.",
    "user has to invoke \"hil stop\" to stop the hil thread.",
    "generate random between 0 and 1",
    "move to range -1 to 1",
    "scale it",
    "apply iy",
    "wait for the Execute method to be called.",
    "add MAV_MODE_FLAG_HIL_ENABLED flag to current mode",
    "gps is much slower frequency than IMU.",
    "MAVLINK_MSG_ID_HIL_GPS",
    "disable HIL mode",
    "Enumeration of landed detector states",
    "MAV landed state is unknown",
    "MAV is landed (on ground)",
    "MAV is in air",
    "control works better if we get about 50 of these per second (20ms interval, if we can).",
    "The filtered local position",
    "must send these regularly to keep offboard control.",
    "ok, now we can safely switch to loiter.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "must send these regularly to keep offboard control.",
    "integrate the heading so it is smoother.",
    "fly to radius",
    "it takes about 10 cm to stop and turn.",
    "next time around switch to orbiting!",
    "heading points to center of circle.",
    "interpoloate the speed ramp up time over 2 seconds from start time",
    "printf(\"speeding up to %f\\n\", orbitSpeed);",
    "monitor the sin curves so we can see how on track or off track it actually is.",
    "the shape of the curve will also tell us if we are progressing at a consistent",
    "speed, the more deformed the sin curve the worse our progress.",
    "pack this tracking info into mavlink_vicon_position_estimate_t just because we can....",
    "degrees just flipped from 359 to 0.",
    "this enables us to test what happens when offboard control is lost and resumed.",
    "in case we are flying fast, we first do a Goto to get to a fixed stationary position before we try and start rotating.",
    "ok, now we can start moving by velocity",
    "recompute to new target.",
    "start by moving right with 10 degree roll.",
    "haven't started yet.",
    "these PID values were calculated experimentally using AltHoldCommand, this provides the best",
    "control over thrust to achieve minimal over/under shoot in a reasonable amount of time.",
    "track how our actual pitch is coming along compared to our target",
    "and check position",
    "the amount of pitch should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the pitch as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(pitch affects the x-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep y on target by using roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "track how our actual roll is coming along compared to our target",
    "and check position",
    "the amount of roll should depend on our speed in that direction.",
    "passed the midpoint.",
    "fade out the roll as we pick up speed so we don't overshoot.",
    "see if we just crossed the wiggle distance threshold.",
    "(roll affects the y-position).",
    "reverse direction with a -30 degrees quick stop",
    "reverse direction with a 30 degrees quick stop",
    "try and keep x on target by using pitch, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "for testing PID controller.",
    "class AltHoldCommand : public Command",
    "{",
    "std::shared_ptr<MavLinkVehicle> channel;",
    "float sx_, sy_, sz_;",
    "MavLinkAttitudeTarget _current;",
    "PidController thrust_controller_;",
    "public:",
    "this->sz_ = pos.z; // user defined target.",
    "move to local position keeps the offboard control happy.",
    "haven't started yet.",
    "and check position",
    "double dx = this->sx_ - pos.x;",
    "double dy = this->sy_ - pos.y;",
    "try and keep x & y on target by using pitch & roll, but only use a little bit since it shouldn't wander",
    "too much in that direction.",
    "adjust thrust so we keep steady height target",
    "DebugOutput(\"ctrl=%f, sz=%f, z=%f, dz=%f, new thrust=%f\", ctrl, sz_, z, sz_ - z, thrust);",
    "\"ftp [ls|cd name|get source [target]|put source target]\";",
    "local remote",
    "already handled by the parse method.",
    "we only support very simple patterns for now.",
    "each wildcard must be separated by literal.",
    "back to back wildcards with no literal in between is too complex.",
    "we only support simple matching for now, we can add full regex later if we need it.",
    "yep!",
    "'*' is done we found the next matching char",
    "this is ok.",
    "this is an ERASE_END_LINE command which we ignore.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "unpack the message...",
    "pack the payload buffer.",
    "json can't handle \"nan\", so we convert it to null.",
    "ostringstream tries to convert uint8_t to 'char' which is not what we want here.",
    "ostringstream tries to convert int8_t to 'char' which is not what we want here.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "stop listening to the connection.",
    "get the connection",
    "Get the local system and component id",
    "send a command to the remote node",
    "MavLinkNode::MavLinkNode() = default;",
    "MavLinkNode::MavLinkNode(MavLinkNode&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "WaitOne indefinitely for one Signal.  If a Signal has already been posted then WaitOne returns immediately",
    "decrementing the count so the next WaitOne may block.",
    "perhaps we have WAIT_IO_COMPLETION interrupt...",
    "convert to absolute time.",
    "use mach_timespec",
    "convert to absolute time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "return true if we still have offboard control (can lose this if user flips the switch).",
    "MavLinkVehicle::MavLinkVehicle() = default;",
    "MavLinkVehicle::MavLinkVehicle(MavLinkVehicle&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "MavLinkTcpServer::MavLinkTcpServer(MavLinkTcpServer&&) = default;",
    "MavLinkTcpServer& MavLinkTcpServer::operator=(MavLinkTcpServer&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "============================== CLIENT ============================================",
    "image APIs",
    "or if you are implementing the client side call this function to get the most recent frame.",
    "returns false if there is no new frame available.",
    "============================== SERVER ============================================",
    "call this to send the image back over the connection given to start function.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "log every message that is \"sent\" using sendMessage.",
    "get the next telemetry snapshot, then clear the internal counters and start over.  This way each snapshot",
    "gives you a picture of what happened in whatever timeslice you decide to call this method.",
    "MavLinkConnection::MavLinkConnection(MavLinkConnection&&) = default;",
    "MavLinkConnection& MavLinkConnection::operator=(MavLinkConnection&&) = default;",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "for compatibility with QGroundControl we have to save the time field in big endian.",
    "todo: mavlink2 support?",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "start listening to this connection",
    "Send heartbeat to drone.  You should not do this if some other node is",
    "already doing it.",
    "send a heart beat so that the remote node knows we are still alive",
    "(otherwise drone will trigger a failsafe operation).",
    "this is called for all messages received on the connection.",
    "this is for the subclasses to play with.  We put nothing here so we are not dependent on the",
    "subclasses remembering to call this base implementation.",
    "stop listening to the connection.",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "wait for a heartbeat msg since this will give us the port to send commands to...",
    "this->setMessageInterval(static_cast<int>(MavLinkMessageIds::MAVLINK_MSG_ID_HEARTBEAT), 1);",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "we only have 4 bytes for the value in mavlink_param_value_t, so how does this one work?",
    "MAVLINK_MSG_ID_PARAM_REQUEST_LIST",
    "timeout, so we'll drop through to the code below which will try and fix this...",
    "note that UDP does not guarantee delivery of messages, so we have to also check if some parameters are missing and get them individually.",
    "nested loop is inefficient, but it is needed because UDP also doesn't guarantee in-order delivery",
    "ok, now fetch the missing parameters.",
    "confirmation of the PARAM_SET is to receive the updated PARAM_VALUE.",
    "silently fail since we are on a background thread here...",
    "tell the caller this is complete.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "add our custom telemetry message length.",
    "todo: if we support signing then initialize",
    "mavlink_intermediate_status_.signing callbacks",
    "std::shared_ptr<MavLinkCom> owner, const std::string& nodeName",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "just a little sanity check on the local address, if remoteAddr is localhost then localAddr must be also.",
    "send this right away just in case serial link is not already configured",
    "log every message that is \"sent\" using sendMessage.",
    "as per  https://github.com/mavlink/mavlink/blob/master/doc/MAVLink2.md",
    "pack the payload buffer.",
    "calculate checksum",
    "form the header as a byte array for the crc",
    "these macros use old style cast.",
    "forward messages from our connected node to the remote proxy.",
    "forward messages from remote proxy to local connected node",
    "CurrentThread::setMaximumPriority();",
    "hmmm, wait till it is opened?",
    "error? well let's try again, but we should be careful not to spin too fast and kill the CPU",
    "pick up the sysid/compid of the remote node we are connected to.",
    "then this is a mavlink 1 message",
    "then this mavlink sender supports mavlink 2",
    "queue event for publishing.",
    "publish the message from this thread, this is safer than publishing from the readPackets thread",
    "as it ensures we don't lose messages if the listener is slow.",
    "this is tricky, the clear has to be done outside the lock because it is destructing the handlers",
    "and the handler might try and call unsubscribe, which needs to be able to grab the lock, otherwise",
    "we would get a deadlock.",
    "CurrentThread::setMaximumPriority();",
    "reset counters",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "------------------------------------------------------------------------------",
    "Defines",
    "------------------------------------------------------------------------------",
    "bit number  876543210987654321",
    "status messages should usually be only sent by actual PX4. However if someone else is sending it to, we should listen it.",
    "in future it would be good to have ability to add system IDs we are interested in",
    "if (msg.sysid != getTargetSystemId())",
    "{",
    "// we only care about messages from our intended remote node.",
    "return;",
    "}",
    "user may have changed modes on us! So we need to honor that and not",
    "try and take it back.",
    "Utils::logMessage(\"Received attitude, acc=[%2.2f %2.2f %2.2f]\", att.pitch, att.roll, att.yaw);",
    "we can store up to 16 channels in rc_channels_scaled.",
    "The RAW values of the servo outputs",
    "Metrics typically displayed on a HUD for fixed wing aircraft",
    "The IMU readings in SI units in NED body frame",
    "printSystemStatus(&msg);",
    "todo: use this to determine when we need to do emergency landing...",
    "Reports the current commanded attitude of the vehicle as specified by the autopilot",
    "Provides state for additional features",
    "The general system state",
    "This one is tricky, we can't do sendCommandAndWaitForAck in this case because it takes too long",
    "but we do want to know when we get the ack.  So this is async ACK processing!",
    "careful here, we are doing a tricky conversion from local coordinates to global coordinates.",
    "if threshold < 0 then the threshold is inverted.",
    "RC channel 1 value scaled, (-100%) -10000, (0%) 0, (100%) 10000, (invalid) INT16_MAX.",
    "Convert it to a floating point number between -1 and 1.",
    "PX4 expects the move commands to happen IMMEDIATELY after this call, so we don't actually request control here",
    "until the move commands start happening.",
    "return true if user calls requestControl and has not called releaseControl.",
    "Ok, now's the time to actually request it since the caller is about to send MavLinkSetPositionTargetGlobalInt, but",
    "PX4 will reject this thinking 'offboard_control_loss_timeout' because we haven't actually sent any offboard messages",
    "yet.  I know the PX4 protocol is kind of weird.  So we prime the pump here with some dummy messages that tell the",
    "drone to stay where it is, this will reset the 'offboard_control_loss_timeout', then we should be able to get control.",
    "send a few to make sure it gets through...",
    "now the command should succeed.",
    "Note: we can't wait for ACK here, I've tried it.  The ACK takes too long to get back to",
    "us by which time the PX4 times out offboard mode!!",
    "this mode change take precedence over offboard mode.",
    "thrust must be between -1 and 1.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "These definitions are copied from PX4 implementation",
    "/ @brief This is the payload which is in mavlink_file_transfer_protocol_t.payload. We pad the structure ourselves to",
    "/ 32 bit alignment to avoid usage of any pack pragmas.",
    "/ @brief Command opcodes",
    "/ @brief Error codes returned in Nak response PayloadHeader.data[0].",
    "request capabilities, it will respond with AUTOPILOT_VERSION.",
    "must trim trailing slashes so PX4 doesn't hang!",
    "user was lazy, only told us where to put the file, so we borrow the name of the file",
    "from the source.",
    "check if directory exists.",
    "perfect.",
    "use last_message_ so we preserve the sessionid.",
    "could not create the local file, so stop.",
    "must use last_message_ so we preserve the session id.",
    "todo: wait for any pending responses from PX4 so we can safely start a new command.",
    "todo: error handling here? sequence is out of order...",
    "directory must be empty then, can't do nextStep because",
    "it will just loop for ever re-requesting zero offset into",
    "empty directory.",
    "result should be a list of null terminated file names.",
    "skipping this entry",
    "remove the file size field.",
    "printf(\"%s\\n\", name.c_str());",
    "request the next batch.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "perhaps this was a late response after we did a retry, so ignore it.",
    "payload->size contains the bytes_written from PX4, so that's how much we advance.",
    "reached the end of the list or the file.",
    "end of file or directory listing.",
    "success, data should be following...",
    "ack on this cmd is a noop",
    "todo: how to handle this? For now we ignore it and let the watchdog kick in and do a retry.",
    "give up then.",
    "tell watchdog we are sending a request",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "================================= CLIENT ==============================================================",
    "Check if we have a valid transaction",
    "emit signal if all packets arrived",
    "Restart statemachine",
    "image APIs",
    "================================= SERVER ==============================================================",
    "Prepare and send acknowledgment packet",
    "Copy PACKET_PAYLOAD bytes of image data to send buffer",
    "Send ENCAPSULATED_IMAGE packet",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "todo: alternative:  probably need to do an lstat on '/dev/serial/by-id' and find",
    "something that looks like PX4 and return that name, or follow the symbolic link to /dev/ttyACM0...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "{4d36e978-e325-11ce-bfc1-08002be10318}",
    "parse out the VID number",
    "now the PID",
    "parse out the VID number",
    "examples:",
    "PX4: USB\\VID_26AC&PID_0011\\0",
    "FTDI cable: FTDIBUS\\VID_0403+PID_6001+FTUAN9UJA\\0000\"",
    "printf(\"Found: %S\\n\", buffer.c_str());",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This has not been properly tested",
    "struct iw_statistics stats;",
    "struct iwreq req;",
    "memset(&stats, 0, sizeof(stats));",
    "memset(&req, 0, sizeof(iwreq));",
    "",
    "strncpy(req.ifr_name, ifaceName, 16);",
    "req.u.data.pointer = &stats;",
    "req.u.data.length = sizeof(iw_statistics);",
    "",
    "#ifdef CLEAR_UPDATED",
    "req.u.data.flags = 1;",
    "#endif",
    "",
    "/* Perform the ioctl */",
    "if (ioctl(socket, SIOCGIWSTATS, &req) == -1) {",
    "//printf(\"Error performing SIOCGIWSTATS on %s\\n\", ifaceName);",
    "return -127;",
    "}",
    "",
    "return stats.qual.level;",
    "todo: windows version of this...",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "limit the socket to only send/receive to/from this remote address/port, this ensures our",
    "subsequent recvfrom calls don't steal messages from other UdpClientPorts.",
    "write to the serial port",
    "well if we are creating a server, we don't know when the client is going to connect, so skip this exception for now.",
    "throw std::runtime_error(\"UdpClientPort cannot send until we've received something first so we can find out what port to send to.\\n\");",
    "perhaps the client is gone, and may want to come back on a different port, in which case let's reset our remote port to allow that.",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "skip this, it is was interrupted, and if user is closing the port closed_ will be true.",
    "try again - this can happen if server recreates the socket on their side.",
    "printf(\"#### recv failed with error: %d\\n\", hr);",
    "we now have it.",
    "this is from someone we are not interested in.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "Initialize Winsock",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "windows",
    "Need to link with Ws2_32.lib",
    "posix",
    "found it!",
    "bind socket to local address.",
    "bind socket to local address.",
    "start listening for incoming connection",
    "accept 1",
    "write to the serial port",
    "try and receive something, up until port is closed anyway.",
    "message was too large for the buffer, no problem, return what we have.",
    "try again - this can happen if server recreates the socket on their side.",
    "skip this, it is was interrupted.",
    "printf(\"Connection closed\\n\");",
    "-----------------------------------------------------------------------------------------",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "FIXME: The windows api docs are not very clear about read timeouts,",
    "and we have to simulate infinite with a big value (uint.MaxValue - 1)",
    "set signal",
    "Clear Handshake flags",
    "Set Handshake flags",
    "return GetLastError();",
    "return GetLastError();",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "Utils::logMessage(\"unsupported data size %d (expecting 5,6,7, or 8)\", dataBits);",
    "enable reading",
    "posix doesn't have mark/space parity.",
    "posix doesn't have mark/space parity.",
    "this is the default.",
    "not sure this is supported...",
    "Utils::logMessage(\"error %d from tcsetattr\", errno);",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "First do those specified by POSIX.",
    "Now conditionally handle a bunch of extended rates.",
    "Utils::logMessage(\"error %d from tcgetattr\", errno);",
    ",",
    "std::unique_ptr<TestBase>(new PixhawkTest()),",
    "std::unique_ptr<TestBase>(new RosFlightTest()),",
    "std::unique_ptr<TestBase>(new QuaternionTest()),",
    "std::unique_ptr<TestBase>(new WorkerThreadTest())",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "TODO: something defines max macro which interfears with code here",
    "is cur_pos within fence?",
    "destination risk is not available then consider it zero",
    "if dest risk is lower than its more safe",
    "are we doing better than closest obstacle?",
    "if we stay where we are, what is the risk distance?",
    "else we are better of moving to dest",
    "this function should work even when dest_pos == cur_pos",
    "is this dest_pos cur_pos within the fence?",
    "transform dest_pos vector to body frame",
    "check for approx zero vectors to avoid random yaw angles",
    "we are hovering",
    "get yaw in body frame, ie, front is always 0 radians",
    "yaw to ticks",
    "get obstacles in the window at the tick direction around the window",
    "less risk distance is better",
    "check obstacles around current position and see if it has lower risk",
    "else obstacle is too far",
    "if we detected unsafe condition due to obstacle, find direction to move away to",
    "look for each surrounding tick to see if we have obstacle free angle",
    "else no suggestions required",
    "3.2 comes from inverse CDF for epsilone = 0.05 (i.e. 95% confidence), author: akapoor",
    "evaluate right and left side of circle",
    "find right and left risk distances",
    "at this point we have already determined hover is better than going to dest",
    "we now determine is moving to suggested angle better than hovering?",
    "check if dest_pos is safe",
    "breaking distance at this velocity",
    "calculate dest_pos cur_pos we will be if we had to break suddenly",
    "check if dest_pos is safe",
    "float/vec parameters can have NaN which makes them optional",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "handles +/- tick and wraps around circle",
    "return value of this function is always >= 0 and < ticks_ (i.e. valid indices)",
    "update the specified window on the map",
    "make dure from <= to",
    "normalize the ticks so bothe are valid indices",
    "if from is still larger then",
    "to ticks is then added one full circle to make it larger than from_tick",
    "find closest obstacle in given window",
    "search whole map to find closest obstacle",
    "in header only mode, control library is not available",
    "File names are unicode (std::wstring), because users can create folders containing unicode characters on both",
    "Windows, OSX and Linux.",
    "Windows users can move the Documents folder to any location they want",
    "SHGetFolderPath knows how to find it.",
    "fall back in case SHGetFolderPath failed for some reason.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "if auto mode requested for lookahead then calculate based on velocity",
    "no-op by default. derived class can override it if needed",
    "no-op by default. derived class can override it if needed",
    "validate path size",
    "validate yaw mode",
    "validate and set auto-lookahead value",
    "if auto mode requested for lookahead then calculate based on velocity",
    "add current position as starting point",
    "append the input path and compute segments",
    "add last segment as zero length segment so we have equal number of segments and points.",
    "path_segs[i] refers to segment that starts at point i",
    "when path ends, we want to slow down",
    "else no need to change velocities for last segments",
    "setup current position on path to 0 offset",
    "initialize next path position",
    "until we are at the end of the path (last seg is always zero size)",
    "Utils::logMessage(\"path_length_remaining = %f, Switched to breaking vel %f\", path_length_remaining, seg_velocity);",
    "send drone command to get to next lookahead",
    "sleep for rest of the cycle",
    "how much have we moved towards last goal?",
    "project actual vector on goal vector",
    "if adaptive lookahead is enabled the calculate lookahead error (see above fig)",
    "TODO: below should be lower than 1E3 and configurable",
    "but lower values like 100 doesn't work for simple_flight + ScalableClock",
    "Utils::logMessage(\"PF: cur=%s, goal_dist=%f, cur_path_loc=%s, next_path_loc=%s, lookahead_error=%f\",",
    "VectorMath::toString(getPosition()).c_str(), goal_dist, VectorMath::toString(cur_path_loc.position).c_str(),",
    "VectorMath::toString(next_path_loc.position).c_str(), lookahead_error);",
    "if drone moved backward, we don't want goal to move backward as well",
    "so only climb forward on the path, never back. Also note >= which means",
    "we climb path even if distance was 0 to take care of duplicated points on path",
    "else",
    "Utils::logMessage(\"goal_dist was negative: %f\", goal_dist);",
    "compute next target on path",
    "last command is to hold on to position",
    "commandPosition(0, 0, getTakeoffZ(), YawMode::Zero());",
    "derived flight controller class should provide implementation if they support exclusive sim*** methods",
    "derived class should override this if it supports sim**** methods",
    "default strategy is for move. In hover mode we set new strategy temporarily",
    "freeze the quaternion",
    "get trims",
    "take average",
    "convert RC commands to velocity vector",
    "find yaw as per terrain and remote setting",
    "execute command",
    "Only raise exception is time out occurred. If preempted then return status.",
    "are we supposed to do EM?",
    "get suggested velocity vector",
    "use the unchecked command",
    "tell caller not to execute planned command",
    "other wise throw exception",
    "otherwise there is some other reason why we are in unsafe situation",
    "send last command to come to full stop",
    "else no unsafe situation",
    "note: cur_path_loc and next_path_loc may both point to same object",
    "otherwise use up this segment, move on to next one",
    "if we are here then we ran out of segments",
    "consider last segment as zero length segment",
    "adjust yaw for the direction of travel in foward-only mode",
    "else no adjustment needed",
    "validate dest",
    "what is the distance we will travel at this velocity?",
    "get velocity vector",
    "yaw for the direction of travel",
    "find velocity vector",
    "Utils::logMessage(\"velocity_vect=%s\", VectorMath::toString(velocity_vect).c_str());",
    "generate velocity vector that is same size as cur_dest_norm / command period",
    "this velocity vect when executed for command period would yield cur_dest_norm",
    "send commands",
    "try to maintain altitude if path was in XY plan only, velocity based control is not as good",
    "by default indicate that we don't have alternative pose info",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "#undef check",
    "TODO: HACK: UE4 defines macro with stupid names like \"check\" that conflicts with msgpack library",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "getters",
    "required for pimpl",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "in header only mode, control library is not available",
    "RPC code requires C++14. If build system like Unreal doesn't support it then use compiled binaries",
    "if using Unreal Build system then include precompiled header file first",
    "some long flight path commands can take a while, so we give it up to 1 hour max.",
    "sim only",
    "rpclib has a bug with serializing empty vectors, so we return a 1 byte vector instead.",
    "status getters",
    "make sure we can talk to the DroneServer",
    "std::cout << \"Contacting DroneServer...\" << std::flush;",
    "command_context.client.ping();",
    "std::cout << \"DroneServer is responding.\" << std::endl;",
    "set initial view mode",
    "else someone else is bound to manual pose controller, leave it alone",
    "TODO: explore screenshot option",
    "addScreenCaptureHandler(camera->GetWorld());",
    "Wait for render so that view is ready for capture",
    "not sure why this doesn't work.",
    "DECLARE_CYCLE_STAT(TEXT(\"FNullGraphTask.CheckRenderStatus\"), STAT_FNullGraphTask_CheckRenderStatus, STATGROUP_TaskGraphTasks);",
    "auto renderStatus = TGraphTask<FNullGraphTask>::CreateTask(NULL).ConstructAndDispatchWhenReady(GET_STATID(STAT_FNullGraphTask_CheckRenderStatus), ENamedThreads::RenderThread);",
    "FTaskGraphInterface::Get().WaitUntilTaskCompletes(renderStatus);",
    "Make sure that all alpha values are opaque.",
    "set default for brigher images",
    "by default all image types are disabled",
    "use final color for all calculations",
    "use final color for all calculations",
    "else we will set this after this components get created",
    "else we will set this after this components get created",
    "do not make unnecessory calls to Activate() which otherwise causes crash in Unreal",
    "else nothing to enable",
    "get references of components so we can use later",
    "set stencil IDs",
    "UAirBlueprintLib::EnableInput(this);",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "TODO: change naming conventions to same as other files?",
    "GEngine->AddOnScreenDebugMessage(key + 10, 60.0f, color, FString::FromInt(key));",
    "can we see followee?",
    "remove mapping",
    "removing binding",
    "TODO: can't do remove because there is no \"stamp\" on who established binding",
    "removeInputBindings();",
    "Deflect along the surface when we collide.",
    "FRotator CurrentRotation = GetActorRotation(RootComponent);",
    "SetActorRotation(FQuat::Slerp(CurrentRotation.Quaternion(), HitNormal.ToOrientationQuat(), 0.025f));",
    "set up key variables",
    "initialize state",
    "call derived class reset which in turn should call base class reset",
    "nothing to do in base",
    "should be overridden in derived class",
    "TODO: delete below",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\sim_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\circle\\\\real_cmd_006_orbit 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "std::ifstream sim_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\sim_cmd_005_square 5 1.txt.pos.txt\");",
    "plot(sim_log, FColor::Purple, Vector3r(0, 0, -3));",
    "std::ifstream real_log(\"C:\\\\temp\\\\mavlogs\\\\square\\\\real_cmd_012_square 5 1.txt.pos.txt\");",
    "plot(real_log, FColor::Yellow, Vector3r(0, 0, -3));",
    "parameters in NED frame",
    "translate to new AVehiclePawnBase position & orientation from NED to NEU",
    "quaternion formula comes from http://stackoverflow.com/a/40334755/207661",
    "must reset collison before we set pose. Setting pose will immediately call NotifyHit if there was collison",
    "if there was no collison than has_collided would remain false, else it will be set so its value can be",
    "checked at the start of next tick",
    "allow teleportation",
    "if collisons are not enabled",
    "or we have collided but passthrough is enabled",
    "we will flip-flop was_last_move_teleport flag so on one tick we have passthrough and other tick we don't",
    "without flip flopping, collisons can't be detected",
    "//for OutputDebugString",
    "#ifdef _MSC_VER",
    "#define WIN32_LEAN_AND_MEAN",
    "#include <windows.h>",
    "#endif",
    "#ifdef _MSC_VER",
    "//print to VS output window",
    "OutputDebugString(std::wstring(message.begin(), message.end()).c_str());",
    "#endif",
    "also do default logging",
    "module loading is not allowed outside of the main thread, so we load the ImageWrapper module ahead of time.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "plugin startup",
    "plugin shutdown",
    "read pixels from render target using render thread, then compress the result into PNG",
    "argument on the thread that calls this method.",
    "make sure we are not on the rendering thread",
    "TODO: below doesn't work right now because it must be running in game thread",
    "below is documented method but more expensive because it forces flush",
    "wait for render thread to pick up our task",
    "Queue up the task of rendering the scene in the render thread",
    "wait for this task to complete",
    "should we be using ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER which was in original commit by @saihv",
    "https://github.com/Microsoft/AirSim/pull/162/commits/63e80c43812300a8570b04ed42714a3f6949e63f#diff-56b790f9394f7ca1949ddbb320d8456fR64",
    "below is undocumented method that avoids flushing, but it seems to segfault every 2000 or so calls",
    "reset roll & pitch of vehicle as multirotors required to be on plain surface at start",
    "-1 to 1 --> 0 to 1",
    "convert 0 to 1 -> -1 to 1",
    "TODO: add fields for z axis?",
    "last 8 bits are not used for now",
    "TODO: should below be at controller level info?",
    "else don't waste time",
    "Utils::log(\"------Render tick-------\");",
    "move collison info from rendering engine to vehicle",
    "update ground level",
    "update rotor poses",
    "this must be the first call so controller can change the state before anything else we do",
    "update rotor animations",
    "UAirBlueprintLib::LogMessage(TEXT(\"Collison (raw) Count:\"), FString::FromInt(collision_response_info.collison_count_raw), LogDebugLevel::Unimportant);",
    "*** Start: UpdatableState implementation ***//",
    "TODO: should this be done in MultiRotor.hpp",
    "controller_->reset();",
    "this is high frequency physics tick, flier gets ticked at rendering frame rate",
    "report actual location in unreal coordinates so we can plug that into the UE editor to move the drone.",
    "*** End: UpdatableState implementation ***//",
    "Stuff to filter out XInput devices",
    "-----------------------------------------------------------------------------",
    "Defines, constants, and global variables",
    "-----------------------------------------------------------------------------",
    "Register with the DirectInput subsystem and get a pointer",
    "to a IDirectInput interface we can use.",
    "Create a DInput object",
    "Look for a simple joystick we can use for this sample program.",
    "Make sure we got a joystick",
    "Set the data format to \"simple joystick\" - a predefined data format",
    "",
    "A data format specifies which controls on a device we are interested in,",
    "and how they should be reported. This tells DInput that we will be",
    "passing a DIJOYSTATE2 structure to IDirectInputDevice::GetDeviceState().",
    "Set the cooperative level to let DInput know how this device should",
    "interact with the system and with other DInput applications.",
    "Enumerate the joystick objects. The callback function enabled user",
    "interface elements for objects that are found, and sets the min/max",
    "values property for discovered axes.",
    "-----------------------------------------------------------------------------",
    "Enum each PNP device using WMI and check each device ID to see if it contains",
    "\"IG_\" (ex. \"VID_045E&PID_028E&IG_00\").  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput.",
    "Checking against a VID/PID of 0x028E/0x045E won't find 3rd party or future",
    "XInput devices.",
    "",
    "This function stores the list of xinput devices in a linked list",
    "at g_pXInputDeviceList, and IsXInputDevice() searchs that linked list",
    "-----------------------------------------------------------------------------",
    "CoInit if needed",
    "Create WMI",
    "Create BSTRs for WMI",
    "Connect to WMI",
    "Switch security level to IMPERSONATE",
    "Get list of Win32_PNPEntity devices",
    "Loop over all devices",
    "Get 20 at a time",
    "For each device, get its device ID",
    "Check if the device ID contains \"IG_\".  If it does, then its an XInput device",
    "Unfortunately this information can not be found by just using DirectInput",
    "If it does, then get the VID/PID from var.bstrVal",
    "Add the VID/PID to a linked list",
    "-----------------------------------------------------------------------------",
    "Returns true if the DirectInput device is also an XInput device.",
    "Call SetupForIsXInputDevice() before, and CleanupForIsXInputDevice() after",
    "-----------------------------------------------------------------------------",
    "Check each xinput device to see if this device's vid/pid matches",
    "-----------------------------------------------------------------------------",
    "Cleanup needed for IsXInputDevice()",
    "-----------------------------------------------------------------------------",
    "Cleanup linked list",
    "-----------------------------------------------------------------------------",
    "Name: EnumJoysticksCallback()",
    "Desc: Called once for each enumerated joystick. If we find one, create a",
    "device interface on it so we can play with it.",
    "-----------------------------------------------------------------------------",
    "Skip anything other than the perferred joystick device as defined by the control panel.",
    "Instead you could store all the enumerated joysticks and let the user pick.",
    "Obtain an interface to the enumerated joystick.",
    "If it failed, then we can't use this joystick. (Maybe the user unplugged",
    "it while we were in the middle of enumerating it.)",
    "Stop enumeration. Note: we're just taking the first joystick we get. You",
    "could store all the enumerated joysticks and let the user pick.",
    "-----------------------------------------------------------------------------",
    "Name: EnumObjectsCallback()",
    "Desc: Callback function for enumerating objects (axes, buttons, POVs) on a",
    "joystick. This function enables user interface elements for objects",
    "that are found to exist, and scales axes min/max values.",
    "-----------------------------------------------------------------------------",
    "For axes that are returned, set the DIPROP_RANGE property for the",
    "enumerated axis in order to scale min/max values.",
    "Set the range for the axis",
    "Set the UI to reflect what objects the joystick supports",
    "-----------------------------------------------------------------------------",
    "Name: UpdateInputState()",
    "Desc: Get the input device's state and display it.",
    "-----------------------------------------------------------------------------",
    "Poll the device to read the current state",
    "DInput is telling us that the input stream has been",
    "interrupted. We aren't tracking any state between polls, so",
    "we don't have any special reset that needs to be done. We",
    "just re-acquire and try again.",
    "while (hr == DIERR_INPUTLOST)",
    "hr = g_pJoystick->Acquire();",
    "hr may be DIERR_OTHERAPPHASPRIO or other errors.  This",
    "may occur when the app is minimized or in the process of",
    "switching, so just try again later",
    "Get the input's device state",
    "Axes",
    "Slider controls",
    "Points of view",
    "Buttons",
    "-----------------------------------------------------------------------------",
    "Name: FreeDirectInput()",
    "Desc: Initialize the DirectInput variables.",
    "-----------------------------------------------------------------------------",
    "Unacquire the device one last time just in case",
    "the app tried to exit while the device is still acquired.",
    "Release any DirectInput objects.",
    "nop",
    "normalize min to max --> 0 to 1",
    "normalize 0 to 1 --> -1 to 1",
    "implementation for unsupported OS",
    "if this is new indec",
    "getJoystickInfo(1, manufacturerID, productID, state.message);",
    "close previos one",
    "open new device",
    "if open was sucessfull",
    "read the device",
    "if we didn't had valid read",
    "NOTE if this condition is not met, we're probably out of sync and this",
    "Joystick instance is likely unusable",
    "TODO: set below to false?",
    "state.is_valid = false;",
    "else ignore",
    "bool getJoystickInfo(int index, std::string& manufacturerID, std::string& productID, std::string& message)",
    "{",
    "manufacturerID = productID = \"\";",
    "// Use udev to look up the product and manufacturer IDs",
    "struct udev *udev = udev_new();",
    "if (udev) {",
    "char sysname[32];",
    "std::snprintf(sysname, sizeof(sysname), \"js%u\", index);",
    "struct udev_device *dev = udev_device_new_from_subsystem_sysname(udev, \"input\", sysname);",
    "dev = udev_device_get_parent_with_subsystem_devtype(dev, \"usb\", \"usb_device\");",
    "if (!dev)",
    "{",
    "message = \"Unable to find parent USB device\";",
    "return false;",
    "}",
    "std::stringstream ss;",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idVendor\");",
    "ss >> manufacturerID;",
    "ss.clear();",
    "ss.str(\"\");",
    "ss << std::hex << udev_device_get_sysattr_value(dev, \"idProduct\");",
    "ss >> productID;",
    "udev_device_unref(dev);",
    "}",
    "else",
    "{",
    "message = \"Cannot create udev\";",
    "return false;",
    "}",
    "udev_unref(udev);",
    "return true;",
    "}",
    "required for pimpl",
    "TODO: should we only do below on SceneCapture2D components and cameras?",
    "avoid motion blur so capture images don't get",
    "use two different methods to set console var because sometime it doesn't seem to work",
    "Equivalent to enabling Custom Stencil in Project > Settings > Rendering > Postprocessing",
    "create main widget",
    "create simmode",
    "synchronize PIP views",
    "setup defaults",
    "If render command is complete, save image along with position and orientation",
    "TODO: because this bug we are using alternative code with stringstream",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "std::stringstream ss;",
    "ss << timestamp_millis << \"\\t\";",
    "ss << kinematics.pose.position.x() << \"\\t\" << kinematics.pose.position.y() << \"\\t\" << kinematics.pose.position.z() << \"\\t\";",
    "ss << kinematics.pose.orientation.w() << \"\\t\" << kinematics.pose.orientation.x() << \"\\t\" << kinematics.pose.orientation.y() << \"\\t\" << kinematics.pose.orientation.z() << \"\\t\";",
    "ss << \"\\n\";",
    "return ss.str();",
    "make sire all vars are set up",
    "todo: should we go as fast as possible, or should we limit this to a particular number of",
    "frames per second?",
    "create its control server",
    "stop physics thread before we dismental",
    "for (AActor* actor : spawned_actors_) {",
    "actor->Destroy();",
    "}",
    "get player controller",
    "put camera little bit above vehicle",
    "we will either find external camera if it already exist in evironment or create one",
    "find all BP camera directors in the environment",
    "create director",
    "create external camera required for the director",
    "find all vehicle pawns",
    "if no vehicle pawns exists in environment",
    "create vehicle pawn",
    "set up vehicle pawns",
    "initialize each vehicle pawn we found",
    "chose first pawn as FPV if none is designated as FPV",
    "now create the connector for each pawn",
    "else we don't have vehicle for this pawn",
    "find vehicles and cameras available in environment",
    "if none available then we will create one",
    "call virtual method in derived class",
    "remove everything that we created in BeginPlay",
    "perfom any expensive rendering update outside of lock region",
    "should be overridden by derived class",
    "Unreal doesn't allow pure abstract methods in actors",
    "needs to be done before we call base class",
    "TODO: should this be done somewhere else?",
    "load settings file if found",
    "create default settings",
    "write some settings in new file otherwise the string \"null\" is written if all settigs are empty",
    "TODO: there is a crash in Linux due to settings.saveJSonString(). Remove this workaround after we only support Unreal 4.17",
    "https://answers.unrealengine.com/questions/664905/unreal-crashes-on-two-lines-of-extremely-simple-st.html",
    "no warnings because we have default settings",
    "by default we spawn server at local endpoint. Do not use 127.0.0.1 as default below",
    "because for docker container default is 0.0.0.0 and people get really confused why things",
    "don't work",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Should be overridden by derived classes",
    "Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "move commands",
    "else leave as it is",
    "TODO: get these in one call",
    "shell.addCommand(\"PlayPose\", &playPoseCommand, \"Play position, quaternion and GPS coordinates of drone from log file\");",
    "parse",
    "group the images by the current date.",
    "std::string beforeScriptStartCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return \"\";",
    "}",
    "bool afterScriptEndCallback(const DroneCommandParameters& params, std::string scriptFilePath)",
    "{",
    "return false;",
    "}",
    "std::string beforeScriptCommandStartCallback(const DroneCommandParameters& params) {",
    "params.context->client.newTask();",
    "}",
    "bool afterScriptCommandEndCallback(const DroneCommandParameters& params, bool commandReturnValue) {",
    "params.context->client.WaitForCompletion(0);",
    "}",
    "void beforeCommandStartCallback(const DroneCommandParameters& params, std::string command_line)",
    "{",
    "}",
    "parse command line",
    "Shell callbacks",
    "shell.beforeScriptStartCallback(std::bind(&beforeScriptStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptEndCallback(std::bind(&afterScriptEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.afterScriptCommandEndCallback(std::bind(&afterScriptCommandEndCallback, std::placeholders::_1, std::placeholders::_2));",
    "shell.beforeCommandStartCallback(std::bind(&beforeCommandStartCallback, std::placeholders::_1, std::placeholders::_2));",
    "Add shell commands",
    "TODO: add WaitForCompletion command",
    "TODO: add command line args help, arg count validation",
    "Copyright (c) Microsoft Corporation. All rights reserved.",
    "Licensed under the MIT License.",
    "This assumes you are running DroneServer already on the same machine.",
    "DroneServer must be running first.",
    "switch to explicit hover mode so that this is the fallback when",
    "move* commands are finished.",
    "moveByVelocityZ is an offboard operation, so we need to set offboard mode.",
    "60 acres park:",
    "GeoPoint testLocation(47.7037051477, -122.1415384809, 9.93f);",
    "marymoore park",
    "GeoPoint testLocation(47.662804385, -122.1167039875, 9.93f);"
  ]
}