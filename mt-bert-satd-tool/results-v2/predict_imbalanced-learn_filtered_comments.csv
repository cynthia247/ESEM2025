Commit Message,predict
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
use legacy numpy print options to avoid failures due to NumPy 2.+ scalar,0
representation,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
Specify how to identify the prompt when copying code snippets,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Unwrap the object to get the correct source,0
file in case that is wrapped by a decorator,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.linear_model.LogisticRegression`,0
classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targeted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
predict_proba was removed in tensorflow 2.6,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"in older versions of scikit-learn, only METHODS is used",0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
we only get here if the above didn't raise,0
"If the parameter is a tuple, transform each element of the",0
tuple. This is needed to support the pattern present in,0
`lightgbm` and `xgboost` where users can pass multiple,0
validation sets.,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
we only need to process step_params if transform_input is set,0
and metadata is given by the user.,0
here we get the metadata required by sub_pipeline.transform,0
"`step_params` is the output of `process_routing`, so it has a dict for each",0
"method (e.g. fit, transform, predict), which are the args to be passed to",0
those methods. We need to transform the parameters which are in the,0
"`transform_input`, before returning these dicts.",0
"An example of `(param_name, param_value)` is",0
"`('sample_weight', array([0.5, 0.5, ...]))`",0
"This parameter now needs to be transformed by the sub_pipeline, to",0
this step. We cache these computations to avoid repeating them.,0
Estimator interface,0
"def _fit(self, X, y=None, **fit_params_steps):",0
Setup the memory,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
The `fit_*` methods need to be overridden to support the samplers.,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
metadata routing enabled,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
TODO: remove the following methods when the minimum scikit-learn >= 1.4,1
They do not depend on resampling but we need to redefine them for the,0
compatibility with the metadata routing framework.,0
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
metadata routing enabled,0
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
not branching here since params is only available if,0
enable_metadata_routing=True,0
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
metadata routing enabled,0
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
not branching here since params is only available if,0
enable_metadata_routing=True,0
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
"we don't have to branch here, since params is only non-empty if",0
enable_metadata_routing=True.,0
TODO(0.15): Remove the context manager and use check_is_fitted(self),1
metadata routing is enabled.,0
"TODO: once scikit-learn >= 1.4, the following function should be simplified by",1
calling `super().get_metadata_routing()`,0
first we add all steps except the last one,0
"fit, fit_predict, and fit_transform call fit_transform if it",0
"exists, or else fit and transform",0
handling sampler if the fit_* stage,0
then we add the last step,0
"without metadata routing, fit_transform and fit_predict",0
get all the same params and pass it to the last fit.,0
First find the last step that is not 'passthrough',0
"All steps are 'passthrough', so the pipeline is considered fitted",0
check if the last step of the pipeline is fitted,0
"we only check the last step since if the last step is fit, it",0
means the previous steps should also be fit. This is faster than,0
checking if every step of the pipeline is fit.,0
"This happens when the `steps` is not a list of (name, estimator)",0
tuples and `fit` is not called yet to validate the steps.,0
"This happens when the `steps` is not a list of (name, estimator)",0
tuples and `fit` is not called yet to validate the steps.,0
"if we have a weight for this transformer, multiply output",0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
empty cluster,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
the input of the OneHotEncoder needs to be dense,0
SMOTE resampling starts here,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inverting the OHE,0
This variable will be used when generating data,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"With one-hot encoding, the median will be repeated twice. We need",0
to divide by sqrt(2) such that we only have one median value,0
contributing to the Euclidean distance,0
SMOTE resampling ends here,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
backward compatibility when passing a NearestNeighbors object,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
add an additional sample since the query points contains the original dataset,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"with a large `threshold_cleaning`, the algorithm is equivalent to ENN",0
set a threshold that we should consider only the class #2,0
making the threshold slightly smaller to take into account class #1,0
we should have a more aggressive cleaning with n_neighbors is larger,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
TODO(0.15): change warning to checking for NotFittedError,1
transform_input tests,0
=====================,0
end of transform_input tests,0
=============================,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
#######################################################################################,0
The following code does not depend on the sklearn version,0
#######################################################################################,0
tags infrastructure,0
"Array-API was introduced in 1.3, we need to default to False if not inside",0
the old-tags.,0
#######################################################################################,0
Upgrading for scikit-learn 1.3,0
#######################################################################################,0
parameter validation,0
parameter validation,0
#######################################################################################,0
Upgrading for scikit-learn 1.4,0
#######################################################################################,0
#######################################################################################,0
Upgrading for scikit-learn 1.5,0
#######################################################################################,0
chunking,0
extmath,0
fixes,0
indexing,0
mask,0
missing,0
optional dependencies,0
user interface,0
validation,0
chunking,0
indexing,0
mask,0
missing,0
optional dependencies,0
user interface,0
extmath,0
fixes,0
validation,0
#######################################################################################,0
Upgrading for scikit-learn 1.6,0
#######################################################################################,0
test_common,0
fix for raise_unknown which is introduced in scikit-learn 1.6,0
validation,0
tags infrastructure,0
Get tags from class-level _more_tags,0
Update with the xfail checks,0
Patch both class and instance level,0
"legacy, on_skip, on_fail, and callback are not supported and ignored",0
legacy is not supported and ignored,0
test_common,0
tags infrastructure,0
validation,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
We lost the y.index during resampling. We can safely use X.index to align,0
them.,0
We special case the following error:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/1055,0
"There is no easy way to have a generic workaround. Here, we detect",1
that we have a column with only null values that is datetime64,0
(resulting from the np.vstack of the resampling).,0
try again,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The following dictionary is to indicate constructor arguments suitable for the test,0
"suite, which uses very small datasets, and is intended to run rather quickly.",0
estimator,0
AdaBoostClassifier does not allow nan values,0
DecisionTreeClassifier allows nan values,0
over-sampling,0
under-sampling,0
combination,0
This dictionary stores parameters for specific checks. It also enables running the,0
same check with multiple instances of the same estimator with different parameters.,0
"The special key ""*"" allows to apply the parameters to all checks.",0
TODO(devtools): allow third-party developers to pass test specific params to checks,1
raise additional warning to be shown by pytest,0
TODO(devtools): enable this behavior for third party estimators as well,1
partial tests,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
local import to not import the file with Python < 3.11,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
pyproject.toml,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
support for missing values,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
use scikit-learn support for monotonic constraints,0
create an attribute for compatibility with other scikit-learn tools such,0
as HTML representation.,0
Validate or convert input data,0
TODO: remove when the minimum supported version of scipy will be 1.4,1
Support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
_compute_missing_values_in_feature_mask checks if X has missing values and,0
will raise an error if the underlying tree base estimator can't handle,0
missing values. Only the criterion is required to determine if the tree,0
supports missing values.,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
TODO(0.14): remove this method because algorithm is deprecated.,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Create dataset with missing values,0
Train forest with missing values,0
Train forest without missing values,0
Score is still 80 percent of the forest's score that had no missing values,0
Create a predictive feature using `y` and with some noise,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
use legacy numpy print options to avoid failures due to NumPy 2.+ scalar,0
representation,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
Specify how to identify the prompt when copying code snippets,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.linear_model.LogisticRegression`,0
classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targeted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
predict_proba was removed in tensorflow 2.6,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
TODO: remove this file when scikit-learn minimum version is 1.3,1
Return a copy of the threadlocal configuration so that users will,0
not be able to modify the configuration with the returned dict.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
"def _fit(self, X, y=None, **fit_params_steps):",0
Setup the memory,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
The `fit_*` methods need to be overridden to support the samplers.,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
metadata routing enabled,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
TODO: remove the following methods when the minimum scikit-learn >= 1.4,1
They do not depend on resampling but we need to redefine them for the,0
compatibility with the metadata routing framework.,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
"we don't have to branch here, since params is only non-empty if",0
enable_metadata_routing=True.,0
metadata routing is enabled.,0
"TODO: once scikit-learn >= 1.4, the following function should be simplified by",1
calling `super().get_metadata_routing()`,0
first we add all steps except the last one,0
"fit, fit_predict, and fit_transform call fit_transform if it",0
"exists, or else fit and transform",0
then we add the last step,0
"without metadata routing, fit_transform and fit_predict",0
get all the same params and pass it to the last fit.,0
"if we have a weight for this transformer, multiply output",0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
empty cluster,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
the input of the OneHotEncoder needs to be dense,0
SMOTE resampling starts here,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inverting the OHE,0
This variable will be used when generating data,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"With one-hot encoding, the median will be repeated twice. We need",0
to divide by sqrt(2) such that we only have one median value,0
contributing to the Euclidean distance,0
SMOTE resampling ends here,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
TODO: only use `sparse_output` when sklearn >= 1.2,1
TODO(0.13): remove this test,1
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
backward compatibility when passing a NearestNeighbors object,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
add an additional sample since the query points contains the original dataset,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"with a large `threshold_cleaning`, the algorithm is equivalent to ENN",0
set a threshold that we should consider only the class #2,0
making the threshold slightly smaller to take into account class #1,0
we should have a more aggressive cleaning with n_neighbors is larger,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
TODO: remove when scikit-learn minimum version is 1.3,1
we don't want to validate again for each call to partial_fit,0
TODO: remove when scikit-learn minimum version is 1.3,1
"Likely a pandas DataFrame, we explicitly check the type to confirm.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
TODO: remove in 0.13,1
future default in 0.13,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Adrin Jalali <adrin.jalali@gmail.com>,0
License: BSD 3 clause,0
Only the following methods are supported in the routing mechanism. Adding new,0
methods at the moment involves monkeypatching this list.,0
"Note that if this list is changed or monkeypatched, the corresponding method",0
needs to be added under a TYPE_CHECKING condition like the one done here in,0
_MetadataRequester,0
These methods are a composite of other methods and one cannot set their,0
requests directly. Instead they should be set by setting the requests of the,0
simple methods which make the composite ones.,0
Request values,0
==============,0
"Each request value needs to be one of the following values, or an alias.",0
this is used in `__metadata_request__*` attributes to indicate that a,0
metadata is not present even though it may be present in the,0
corresponding method's signature.,0
"this is used whenever a default value is changed, and therefore the user",0
"should explicitly set the value, otherwise a warning is shown. An example",0
"is when a meta-estimator is only a router, but then becomes also a",0
consumer in a new release.,0
this is the default used in `set_{method}_request` methods to indicate no,0
change requested by the user.,0
item is only an alias if it's a valid identifier,0
Metadata Request for Simple Consumers,0
=====================================,0
This section includes MethodMetadataRequest and MetadataRequest which are,0
used in simple consumers.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
Called when the default attribute access fails with an AttributeError,0
(either __getattribute__() raises an AttributeError because name is,0
not an instance attribute or an attribute in the class tree for self;,0
or __get__() of a name property raises AttributeError). This method,0
should either return the (computed) attribute value or raise an,0
AttributeError exception.,0
https://docs.python.org/3/reference/datamodel.html#object.__getattr__,0
Metadata Request for Routers,0
============================,0
This section includes all objects required for MetadataRouter which is used,0
"in routers, returned by their ``get_metadata_routing``.",0
"This namedtuple is used to store a (mapping, routing) pair. Mapping is a",0
"MethodMapping object, and routing is the output of `get_metadata_routing`.",0
MetadataRouter stores a collection of these namedtuples.,0
A namedtuple storing a single method route. A collection of these namedtuples,0
is stored in a MetadataRouter.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance`` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
`_self_request` is used if the router is also a consumer.,0
"_self_request, (added using `add_self_request()`) is treated",0
differently from the other objects which are stored in,0
_route_mappings.,0
"conflicts are okay if the passed objects are the same, but it's",0
an issue if they're different objects.,0
doing this instead of a try/except since an AttributeError could be raised,0
for other reasons.,0
Request method,0
==============,0
This section includes what's needed for the request method descriptor and,0
their dynamic generation in a meta class.,0
These strings are used to dynamically generate the docstrings for,0
set_{method}_request methods.,0
we would want to have a method which accepts only the expected args,0
This makes it possible to use the decorated method as an unbound,0
"method, for instance when monkeypatching.",0
https://github.com/scikit-learn/scikit-learn/issues/28632,0
Replicating python's behavior when positional args are given other,0
"than `self`, and `self` is only allowed if this method is unbound.",0
Now we set the relevant attributes of the function so that it seems,0
"like a normal method to the end user, with known expected arguments.",0
"This code is never run in runtime, but it's here for type checking.",0
Type checkers fail to understand that the `set_{method}_request`,0
"methods are dynamically generated, and they complain that they are",0
not defined. We define them here to make type checkers happy.,0
During type checking analyzers assume this to be True.,0
The following list of defined methods mirrors the list of methods,0
in SIMPLE_METHODS.,0
fmt: off,0
fmt: on,0
"if there are any issues in the default values, it will be raised",0
when ``get_metadata_routing`` is called. Here we are going to,0
ignore all the issues such as bad defaults etc.,0
set ``set_{method}_request``` methods,0
Here we use `isfunction` instead of `ismethod` because calling `getattr`,0
on a class instead of an instance returns an unbound function.,0
"ignore the first parameter of the method, which is usually ""self""",0
Then overwrite those defaults with the ones provided in,0
__metadata_request__* attributes. Defaults set in,0
__metadata_request__* attributes take precedence over signature,0
sniffing.,0
need to go through the MRO since this is a class attribute and,0
``vars`` doesn't report the parent class attributes. We go through,0
the reverse of the MRO so that child classes have precedence over,0
their parents.,0
we don't check for attr.startswith() since python prefixes attrs,0
starting with __ with the `_ClassName`.,0
Process Routing in Routers,0
==========================,0
This is almost always the only method used in routers to process and route,0
given metadata. This is to minimize the boilerplate required in routers.,0
Here the first two arguments are positional only which makes everything,0
passed as keyword argument a metadata. The first two args also have an `_`,0
"prefix to reduce the chances of name collisions with the passed metadata, and",0
"since they're positional only, users will never type those underscores.",0
"If routing is not enabled and kwargs are empty, then we don't have to",0
"try doing any routing, we can simply return a structure which returns",0
an empty dict on routed_params.ANYTHING.ANY_METHOD.,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
Inherits from ValueError and TypeError to keep backward compatibility.,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
Ignore constraints that we don't want to expose in the error,0
"message, i.e. options that are for internal purpose or not",0
officially supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
"When the function is just a wrapper around an estimator, we allow",0
"the function to delegate validation to the estimator, but we",0
replace the name of the estimator by the name of the function in,0
the error message to avoid confusion.,0
better repr if the bounds were given as integers,0
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
"There's no integer outside (-inf, +inf)",0
"bounds are -inf, +inf",0
"interval is [-inf, +inf]",0
special case for ndarray since it can't be instantiated without,0
arguments,0
special case for Integral and Real since they are abstract classes,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
We lost the y.index during resampling. We can safely use X.index to align,0
them.,0
We special case the following error:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/1055,0
"There is no easy way to have a generic workaround. Here, we detect",1
that we have a column with only null values that is datetime64,0
(resulting from the np.vstack of the resampling).,0
try again,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfere with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
does not raise,0
calls f with a bad parameter type,0
Validation for g is never skipped.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
resample before to fit the tree,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.1,1
change of signature in scikit-learn 1.1,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
use scikit-learn support for monotonic constraints,0
create an attribute for compatibility with other scikit-learn tools such,0
as HTML representation.,0
TODO: remove in 0.13,1
Validate or convert input data,0
TODO: remove when the minimum supported version of scipy will be 1.4,1
Support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
_compute_missing_values_in_feature_mask checks if X has missing values and,0
will raise an error if the underlying tree base estimator can't handle,0
missing values. Only the criterion is required to determine if the tree,0
supports missing values.,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
TODO: remove when minimum supported version of scikit-learn is 1.5,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
TODO: remove in 0.13,1
Create dataset with missing values,0
Train forest with missing values,0
Train forest without missing values,0
Score is still 80 percent of the forest's score that had no missing values,0
Create a predictive feature using `y` and with some noise,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
Specify how to identify the prompt when copying code snippets,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.linear_model.LogisticRegression`,0
classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targeted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
predict_proba was removed in tensorflow 2.6,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
TODO: remove this file when scikit-learn minimum version is 1.3,1
Return a copy of the threadlocal configuration so that users will,0
not be able to modify the configuration with the returned dict.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
"def _fit(self, X, y=None, **fit_params_steps):",0
Setup the memory,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
The `fit_*` methods need to be overridden to support the samplers.,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
metadata routing enabled,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
TODO: remove the following methods when the minimum scikit-learn >= 1.4,1
They do not depend on resampling but we need to redefine them for the,0
compatibility with the metadata routing framework.,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
"we don't have to branch here, since params is only non-empty if",0
enable_metadata_routing=True.,0
metadata routing is enabled.,0
"TODO: once scikit-learn >= 1.4, the following function should be simplified by",1
calling `super().get_metadata_routing()`,0
first we add all steps except the last one,0
"fit, fit_predict, and fit_transform call fit_transform if it",0
"exists, or else fit and transform",0
then we add the last step,0
"without metadata routing, fit_transform and fit_predict",0
get all the same params and pass it to the last fit.,0
"if we have a weight for this transformer, multiply output",0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
empty cluster,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
the input of the OneHotEncoder needs to be dense,0
SMOTE resampling starts here,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inverting the OHE,0
This variable will be used when generating data,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"With one-hot encoding, the median will be repeated twice. We need",0
to divide by sqrt(2) such that we only have one median value,0
contributing to the Euclidean distance,0
SMOTE resampling ends here,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
TODO: only use `sparse_output` when sklearn >= 1.2,1
TODO(0.13): remove this test,1
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
backward compatibility when passing a NearestNeighbors object,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
add an additional sample since the query points contains the original dataset,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"with a large `threshold_cleaning`, the algorithm is equivalent to ENN",0
set a threshold that we should consider only the class #2,0
making the threshold slightly smaller to take into account class #1,0
we should have a more aggressive cleaning with n_neighbors is larger,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
TODO: remove when scikit-learn minimum version is 1.3,1
we don't want to validate again for each call to partial_fit,0
TODO: remove when scikit-learn minimum version is 1.3,1
"Likely a pandas DataFrame, we explicitly check the type to confirm.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
TODO: remove in 0.13,1
future default in 0.13,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Adrin Jalali <adrin.jalali@gmail.com>,0
License: BSD 3 clause,0
Only the following methods are supported in the routing mechanism. Adding new,0
methods at the moment involves monkeypatching this list.,0
"Note that if this list is changed or monkeypatched, the corresponding method",0
needs to be added under a TYPE_CHECKING condition like the one done here in,0
_MetadataRequester,0
These methods are a composite of other methods and one cannot set their,0
requests directly. Instead they should be set by setting the requests of the,0
simple methods which make the composite ones.,0
Request values,0
==============,0
"Each request value needs to be one of the following values, or an alias.",0
this is used in `__metadata_request__*` attributes to indicate that a,0
metadata is not present even though it may be present in the,0
corresponding method's signature.,0
"this is used whenever a default value is changed, and therefore the user",0
"should explicitly set the value, otherwise a warning is shown. An example",0
"is when a meta-estimator is only a router, but then becomes also a",0
consumer in a new release.,0
this is the default used in `set_{method}_request` methods to indicate no,0
change requested by the user.,0
item is only an alias if it's a valid identifier,0
Metadata Request for Simple Consumers,0
=====================================,0
This section includes MethodMetadataRequest and MetadataRequest which are,0
used in simple consumers.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
Called when the default attribute access fails with an AttributeError,0
(either __getattribute__() raises an AttributeError because name is,0
not an instance attribute or an attribute in the class tree for self;,0
or __get__() of a name property raises AttributeError). This method,0
should either return the (computed) attribute value or raise an,0
AttributeError exception.,0
https://docs.python.org/3/reference/datamodel.html#object.__getattr__,0
Metadata Request for Routers,0
============================,0
This section includes all objects required for MetadataRouter which is used,0
"in routers, returned by their ``get_metadata_routing``.",0
"This namedtuple is used to store a (mapping, routing) pair. Mapping is a",0
"MethodMapping object, and routing is the output of `get_metadata_routing`.",0
MetadataRouter stores a collection of these namedtuples.,0
A namedtuple storing a single method route. A collection of these namedtuples,0
is stored in a MetadataRouter.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance`` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
`_self_request` is used if the router is also a consumer.,0
"_self_request, (added using `add_self_request()`) is treated",0
differently from the other objects which are stored in,0
_route_mappings.,0
"conflicts are okay if the passed objects are the same, but it's",0
an issue if they're different objects.,0
doing this instead of a try/except since an AttributeError could be raised,0
for other reasons.,0
Request method,0
==============,0
This section includes what's needed for the request method descriptor and,0
their dynamic generation in a meta class.,0
These strings are used to dynamically generate the docstrings for,0
set_{method}_request methods.,0
we would want to have a method which accepts only the expected args,0
This makes it possible to use the decorated method as an unbound,0
"method, for instance when monkeypatching.",0
https://github.com/scikit-learn/scikit-learn/issues/28632,0
Replicating python's behavior when positional args are given other,0
"than `self`, and `self` is only allowed if this method is unbound.",0
Now we set the relevant attributes of the function so that it seems,0
"like a normal method to the end user, with known expected arguments.",0
"This code is never run in runtime, but it's here for type checking.",0
Type checkers fail to understand that the `set_{method}_request`,0
"methods are dynamically generated, and they complain that they are",0
not defined. We define them here to make type checkers happy.,0
During type checking analyzers assume this to be True.,0
The following list of defined methods mirrors the list of methods,0
in SIMPLE_METHODS.,0
fmt: off,0
fmt: on,0
"if there are any issues in the default values, it will be raised",0
when ``get_metadata_routing`` is called. Here we are going to,0
ignore all the issues such as bad defaults etc.,0
set ``set_{method}_request``` methods,0
Here we use `isfunction` instead of `ismethod` because calling `getattr`,0
on a class instead of an instance returns an unbound function.,0
"ignore the first parameter of the method, which is usually ""self""",0
Then overwrite those defaults with the ones provided in,0
__metadata_request__* attributes. Defaults set in,0
__metadata_request__* attributes take precedence over signature,0
sniffing.,0
need to go through the MRO since this is a class attribute and,0
``vars`` doesn't report the parent class attributes. We go through,0
the reverse of the MRO so that child classes have precedence over,0
their parents.,0
we don't check for attr.startswith() since python prefixes attrs,0
starting with __ with the `_ClassName`.,0
Process Routing in Routers,0
==========================,0
This is almost always the only method used in routers to process and route,0
given metadata. This is to minimize the boilerplate required in routers.,0
Here the first two arguments are positional only which makes everything,0
passed as keyword argument a metadata. The first two args also have an `_`,0
"prefix to reduce the chances of name collisions with the passed metadata, and",0
"since they're positional only, users will never type those underscores.",0
"If routing is not enabled and kwargs are empty, then we don't have to",0
"try doing any routing, we can simply return a structure which returns",0
an empty dict on routed_params.ANYTHING.ANY_METHOD.,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
Inherits from ValueError and TypeError to keep backward compatibility.,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
Ignore constraints that we don't want to expose in the error,0
"message, i.e. options that are for internal purpose or not",0
officially supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
"When the function is just a wrapper around an estimator, we allow",0
"the function to delegate validation to the estimator, but we",0
replace the name of the estimator by the name of the function in,0
the error message to avoid confusion.,0
better repr if the bounds were given as integers,0
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
"There's no integer outside (-inf, +inf)",0
"bounds are -inf, +inf",0
"interval is [-inf, +inf]",0
special case for ndarray since it can't be instantiated without,0
arguments,0
special case for Integral and Real since they are abstract classes,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
We lost the y.index during resampling. We can safely use X.index to align,0
them.,0
We special case the following error:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/1055,0
"There is no easy way to have a generic workaround. Here, we detect",1
that we have a column with only null values that is datetime64,0
(resulting from the np.vstack of the resampling).,0
try again,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfere with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
does not raise,0
calls f with a bad parameter type,0
Validation for g is never skipped.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
resample before to fit the tree,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.1,1
change of signature in scikit-learn 1.1,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
use scikit-learn support for monotonic constraints,0
create an attribute for compatibility with other scikit-learn tools such,0
as HTML representation.,0
TODO: remove in 0.13,1
Validate or convert input data,0
TODO: remove when the minimum supported version of scipy will be 1.4,1
Support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
_compute_missing_values_in_feature_mask checks if X has missing values and,0
will raise an error if the underlying tree base estimator can't handle,0
missing values. Only the criterion is required to determine if the tree,0
supports missing values.,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
TODO: remove when minimum supported version of scikit-learn is 1.5,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
TODO: remove in 0.13,1
Create dataset with missing values,0
Train forest with missing values,0
Train forest without missing values,0
Score is still 80 percent of the forest's score that had no missing values,0
Create a predictive feature using `y` and with some noise,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
Specify how to identify the prompt when copying code snippets,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.linear_model.LogisticRegression`,0
classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targeted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
predict_proba was removed in tensorflow 2.6,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
TODO: remove this file when scikit-learn minimum version is 1.3,1
Return a copy of the threadlocal configuration so that users will,0
not be able to modify the configuration with the returned dict.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
"def _fit(self, X, y=None, **fit_params_steps):",0
Setup the memory,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
The `fit_*` methods need to be overridden to support the samplers.,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
metadata routing enabled,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
TODO: remove the following methods when the minimum scikit-learn >= 1.4,1
They do not depend on resampling but we need to redefine them for the,0
compatibility with the metadata routing framework.,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
"we don't have to branch here, since params is only non-empty if",0
enable_metadata_routing=True.,0
metadata routing is enabled.,0
"TODO: once scikit-learn >= 1.4, the following function should be simplified by",1
calling `super().get_metadata_routing()`,0
first we add all steps except the last one,0
"fit, fit_predict, and fit_transform call fit_transform if it",0
"exists, or else fit and transform",0
then we add the last step,0
"without metadata routing, fit_transform and fit_predict",0
get all the same params and pass it to the last fit.,0
"if we have a weight for this transformer, multiply output",0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
empty cluster,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
the input of the OneHotEncoder needs to be dense,0
SMOTE resampling starts here,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inverting the OHE,0
This variable will be used when generating data,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"With one-hot encoding, the median will be repeated twice. We need",0
to divide by sqrt(2) such that we only have one median value,0
contributing to the Euclidean distance,0
SMOTE resampling ends here,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
TODO: only use `sparse_output` when sklearn >= 1.2,1
TODO(0.13): remove this test,1
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
backward compatibility when passing a NearestNeighbors object,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
add an additional sample since the query points contains the original dataset,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"with a large `threshold_cleaning`, the algorithm is equivalent to ENN",0
set a threshold that we should consider only the class #2,0
making the threshold slightly smaller to take into account class #1,0
we should have a more aggressive cleaning with n_neighbors is larger,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
TODO: remove when scikit-learn minimum version is 1.3,1
we don't want to validate again for each call to partial_fit,0
TODO: remove when scikit-learn minimum version is 1.3,1
"Likely a pandas DataFrame, we explicitly check the type to confirm.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
TODO: remove in 0.13,1
future default in 0.13,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Adrin Jalali <adrin.jalali@gmail.com>,0
License: BSD 3 clause,0
Only the following methods are supported in the routing mechanism. Adding new,0
methods at the moment involves monkeypatching this list.,0
"Note that if this list is changed or monkeypatched, the corresponding method",0
needs to be added under a TYPE_CHECKING condition like the one done here in,0
_MetadataRequester,0
These methods are a composite of other methods and one cannot set their,0
requests directly. Instead they should be set by setting the requests of the,0
simple methods which make the composite ones.,0
Request values,0
==============,0
"Each request value needs to be one of the following values, or an alias.",0
this is used in `__metadata_request__*` attributes to indicate that a,0
metadata is not present even though it may be present in the,0
corresponding method's signature.,0
"this is used whenever a default value is changed, and therefore the user",0
"should explicitly set the value, otherwise a warning is shown. An example",0
"is when a meta-estimator is only a router, but then becomes also a",0
consumer in a new release.,0
this is the default used in `set_{method}_request` methods to indicate no,0
change requested by the user.,0
item is only an alias if it's a valid identifier,0
Metadata Request for Simple Consumers,0
=====================================,0
This section includes MethodMetadataRequest and MetadataRequest which are,0
used in simple consumers.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
Called when the default attribute access fails with an AttributeError,0
(either __getattribute__() raises an AttributeError because name is,0
not an instance attribute or an attribute in the class tree for self;,0
or __get__() of a name property raises AttributeError). This method,0
should either return the (computed) attribute value or raise an,0
AttributeError exception.,0
https://docs.python.org/3/reference/datamodel.html#object.__getattr__,0
Metadata Request for Routers,0
============================,0
This section includes all objects required for MetadataRouter which is used,0
"in routers, returned by their ``get_metadata_routing``.",0
"This namedtuple is used to store a (mapping, routing) pair. Mapping is a",0
"MethodMapping object, and routing is the output of `get_metadata_routing`.",0
MetadataRouter stores a collection of these namedtuples.,0
A namedtuple storing a single method route. A collection of these namedtuples,0
is stored in a MetadataRouter.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance`` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
`_self_request` is used if the router is also a consumer.,0
"_self_request, (added using `add_self_request()`) is treated",0
differently from the other objects which are stored in,0
_route_mappings.,0
"conflicts are okay if the passed objects are the same, but it's",0
an issue if they're different objects.,0
doing this instead of a try/except since an AttributeError could be raised,0
for other reasons.,0
Request method,0
==============,0
This section includes what's needed for the request method descriptor and,0
their dynamic generation in a meta class.,0
These strings are used to dynamically generate the docstrings for,0
set_{method}_request methods.,0
we would want to have a method which accepts only the expected args,0
Now we set the relevant attributes of the function so that it seems,0
"like a normal method to the end user, with known expected arguments.",0
"This code is never run in runtime, but it's here for type checking.",0
Type checkers fail to understand that the `set_{method}_request`,0
"methods are dynamically generated, and they complain that they are",0
not defined. We define them here to make type checkers happy.,0
During type checking analyzers assume this to be True.,0
The following list of defined methods mirrors the list of methods,0
in SIMPLE_METHODS.,0
fmt: off,0
fmt: on,0
"if there are any issues in the default values, it will be raised",0
when ``get_metadata_routing`` is called. Here we are going to,0
ignore all the issues such as bad defaults etc.,0
set ``set_{method}_request``` methods,0
Here we use `isfunction` instead of `ismethod` because calling `getattr`,0
on a class instead of an instance returns an unbound function.,0
"ignore the first parameter of the method, which is usually ""self""",0
Then overwrite those defaults with the ones provided in,0
__metadata_request__* attributes. Defaults set in,0
__metadata_request__* attributes take precedence over signature,0
sniffing.,0
need to go through the MRO since this is a class attribute and,0
``vars`` doesn't report the parent class attributes. We go through,0
the reverse of the MRO so that child classes have precedence over,0
their parents.,0
we don't check for attr.startswith() since python prefixes attrs,0
starting with __ with the `_ClassName`.,0
Process Routing in Routers,0
==========================,0
This is almost always the only method used in routers to process and route,0
given metadata. This is to minimize the boilerplate required in routers.,0
Here the first two arguments are positional only which makes everything,0
passed as keyword argument a metadata. The first two args also have an `_`,0
"prefix to reduce the chances of name collisions with the passed metadata, and",0
"since they're positional only, users will never type those underscores.",0
"If routing is not enabled and kwargs are empty, then we don't have to",0
"try doing any routing, we can simply return a structure which returns",0
an empty dict on routed_params.ANYTHING.ANY_METHOD.,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
Inherits from ValueError and TypeError to keep backward compatibility.,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
Ignore constraints that we don't want to expose in the error,0
"message, i.e. options that are for internal purpose or not",0
officially supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
"When the function is just a wrapper around an estimator, we allow",0
"the function to delegate validation to the estimator, but we",0
replace the name of the estimator by the name of the function in,0
the error message to avoid confusion.,0
better repr if the bounds were given as integers,0
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
"There's no integer outside (-inf, +inf)",0
"bounds are -inf, +inf",0
"interval is [-inf, +inf]",0
special case for ndarray since it can't be instantiated without,0
arguments,0
special case for Integral and Real since they are abstract classes,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
We lost the y.index during resampling. We can safely use X.index to align,0
them.,0
We special case the following error:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/1055,0
"There is no easy way to have a generic workaround. Here, we detect",1
that we have a column with only null values that is datetime64,0
(resulting from the np.vstack of the resampling).,0
try again,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfere with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
does not raise,0
calls f with a bad parameter type,0
Validation for g is never skipped.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
resample before to fit the tree,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.1,1
change of signature in scikit-learn 1.1,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
use scikit-learn support for monotonic constraints,0
create an attribute for compatibility with other scikit-learn tools such,0
as HTML representation.,0
TODO: remove in 0.13,1
Validate or convert input data,0
TODO: remove when the minimum supported version of scipy will be 1.4,1
Support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
_compute_missing_values_in_feature_mask checks if X has missing values and,0
will raise an error if the underlying tree base estimator can't handle,0
missing values. Only the criterion is required to determine if the tree,0
supports missing values.,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
TODO: remove in 0.13,1
Create dataset with missing values,0
Train forest with missing values,0
Train forest without missing values,0
Score is still 80 percent of the forest's score that had no missing values,0
Create a predictive feature using `y` and with some noise,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
Specify how to identify the prompt when copying code snippets,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.linear_model.LogisticRegression`,0
classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targeted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
predict_proba was removed in tensorflow 2.6,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
TODO: remove this file when scikit-learn minimum version is 1.3,1
Return a copy of the threadlocal configuration so that users will,0
not be able to modify the configuration with the returned dict.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
"def _fit(self, X, y=None, **fit_params_steps):",0
Setup the memory,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
The `fit_*` methods need to be overridden to support the samplers.,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
metadata routing enabled,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
TODO: remove the following methods when the minimum scikit-learn >= 1.4,1
They do not depend on resampling but we need to redefine them for the,0
compatibility with the metadata routing framework.,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
"we don't have to branch here, since params is only non-empty if",0
enable_metadata_routing=True.,0
metadata routing is enabled.,0
"TODO: once scikit-learn >= 1.4, the following function should be simplified by",1
calling `super().get_metadata_routing()`,0
first we add all steps except the last one,0
"fit, fit_predict, and fit_transform call fit_transform if it",0
"exists, or else fit and transform",0
then we add the last step,0
"without metadata routing, fit_transform and fit_predict",0
get all the same params and pass it to the last fit.,0
"if we have a weight for this transformer, multiply output",0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
empty cluster,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
the input of the OneHotEncoder needs to be dense,0
SMOTE resampling starts here,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inverting the OHE,0
This variable will be used when generating data,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"With one-hot encoding, the median will be repeated twice. We need",0
to divide by sqrt(2) such that we only have one median value,0
contributing to the Euclidean distance,0
SMOTE resampling ends here,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
TODO: only use `sparse_output` when sklearn >= 1.2,1
TODO(0.13): remove this test,1
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
backward compatibility when passing a NearestNeighbors object,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
add an additional sample since the query points contains the original dataset,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"with a large `threshold_cleaning`, the algorithm is equivalent to ENN",0
set a threshold that we should consider only the class #2,0
making the threshold slightly smaller to take into account class #1,0
we should have a more aggressive cleaning with n_neighbors is larger,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
TODO: remove when scikit-learn minimum version is 1.3,1
we don't want to validate again for each call to partial_fit,0
TODO: remove when scikit-learn minimum version is 1.3,1
"Likely a pandas DataFrame, we explicitly check the type to confirm.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
TODO: remove in 0.13,1
future default in 0.13,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Adrin Jalali <adrin.jalali@gmail.com>,0
License: BSD 3 clause,0
Only the following methods are supported in the routing mechanism. Adding new,0
methods at the moment involves monkeypatching this list.,0
"Note that if this list is changed or monkeypatched, the corresponding method",0
needs to be added under a TYPE_CHECKING condition like the one done here in,0
_MetadataRequester,0
These methods are a composite of other methods and one cannot set their,0
requests directly. Instead they should be set by setting the requests of the,0
simple methods which make the composite ones.,0
Request values,0
==============,0
"Each request value needs to be one of the following values, or an alias.",0
this is used in `__metadata_request__*` attributes to indicate that a,0
metadata is not present even though it may be present in the,0
corresponding method's signature.,0
"this is used whenever a default value is changed, and therefore the user",0
"should explicitly set the value, otherwise a warning is shown. An example",0
"is when a meta-estimator is only a router, but then becomes also a",0
consumer in a new release.,0
this is the default used in `set_{method}_request` methods to indicate no,0
change requested by the user.,0
item is only an alias if it's a valid identifier,0
Metadata Request for Simple Consumers,0
=====================================,0
This section includes MethodMetadataRequest and MetadataRequest which are,0
used in simple consumers.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
Called when the default attribute access fails with an AttributeError,0
(either __getattribute__() raises an AttributeError because name is,0
not an instance attribute or an attribute in the class tree for self;,0
or __get__() of a name property raises AttributeError). This method,0
should either return the (computed) attribute value or raise an,0
AttributeError exception.,0
https://docs.python.org/3/reference/datamodel.html#object.__getattr__,0
Metadata Request for Routers,0
============================,0
This section includes all objects required for MetadataRouter which is used,0
"in routers, returned by their ``get_metadata_routing``.",0
"This namedtuple is used to store a (mapping, routing) pair. Mapping is a",0
"MethodMapping object, and routing is the output of `get_metadata_routing`.",0
MetadataRouter stores a collection of these namedtuples.,0
A namedtuple storing a single method route. A collection of these namedtuples,0
is stored in a MetadataRouter.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance`` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
`_self_request` is used if the router is also a consumer.,0
"_self_request, (added using `add_self_request()`) is treated",0
differently from the other objects which are stored in,0
_route_mappings.,0
"conflicts are okay if the passed objects are the same, but it's",0
an issue if they're different objects.,0
doing this instead of a try/except since an AttributeError could be raised,0
for other reasons.,0
Request method,0
==============,0
This section includes what's needed for the request method descriptor and,0
their dynamic generation in a meta class.,0
These strings are used to dynamically generate the docstrings for,0
set_{method}_request methods.,0
we would want to have a method which accepts only the expected args,0
Now we set the relevant attributes of the function so that it seems,0
"like a normal method to the end user, with known expected arguments.",0
"This code is never run in runtime, but it's here for type checking.",0
Type checkers fail to understand that the `set_{method}_request`,0
"methods are dynamically generated, and they complain that they are",0
not defined. We define them here to make type checkers happy.,0
During type checking analyzers assume this to be True.,0
The following list of defined methods mirrors the list of methods,0
in SIMPLE_METHODS.,0
fmt: off,0
fmt: on,0
"if there are any issues in the default values, it will be raised",0
when ``get_metadata_routing`` is called. Here we are going to,0
ignore all the issues such as bad defaults etc.,0
set ``set_{method}_request``` methods,0
Here we use `isfunction` instead of `ismethod` because calling `getattr`,0
on a class instead of an instance returns an unbound function.,0
"ignore the first parameter of the method, which is usually ""self""",0
Then overwrite those defaults with the ones provided in,0
__metadata_request__* attributes. Defaults set in,0
__metadata_request__* attributes take precedence over signature,0
sniffing.,0
need to go through the MRO since this is a class attribute and,0
``vars`` doesn't report the parent class attributes. We go through,0
the reverse of the MRO so that child classes have precedence over,0
their parents.,0
we don't check for attr.startswith() since python prefixes attrs,0
starting with __ with the `_ClassName`.,0
Process Routing in Routers,0
==========================,0
This is almost always the only method used in routers to process and route,0
given metadata. This is to minimize the boilerplate required in routers.,0
Here the first two arguments are positional only which makes everything,0
passed as keyword argument a metadata. The first two args also have an `_`,0
"prefix to reduce the chances of name collisions with the passed metadata, and",0
"since they're positional only, users will never type those underscores.",0
"If routing is not enabled and kwargs are empty, then we don't have to",0
"try doing any routing, we can simply return a structure which returns",0
an empty dict on routed_params.ANYTHING.ANY_METHOD.,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
Inherits from ValueError and TypeError to keep backward compatibility.,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
Ignore constraints that we don't want to expose in the error,0
"message, i.e. options that are for internal purpose or not",0
officially supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
"When the function is just a wrapper around an estimator, we allow",0
"the function to delegate validation to the estimator, but we",0
replace the name of the estimator by the name of the function in,0
the error message to avoid confusion.,0
better repr if the bounds were given as integers,0
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
"There's no integer outside (-inf, +inf)",0
"bounds are -inf, +inf",0
"interval is [-inf, +inf]",0
special case for ndarray since it can't be instantiated without,0
arguments,0
special case for Integral and Real since they are abstract classes,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
We lost the y.index during resampling. We can safely use X.index to align,0
them.,0
We special case the following error:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/1055,0
"There is no easy way to have a generic workaround. Here, we detect",1
that we have a column with only null values that is datetime64,0
(resulting from the np.vstack of the resampling).,0
try again,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfere with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
does not raise,0
calls f with a bad parameter type,0
Validation for g is never skipped.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
resample before to fit the tree,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.1,1
change of signature in scikit-learn 1.1,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
use scikit-learn support for monotonic constraints,0
create an attribute for compatibility with other scikit-learn tools such,0
as HTML representation.,0
TODO: remove in 0.13,1
Validate or convert input data,0
TODO: remove when the minimum supported version of scipy will be 1.4,1
Support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
_compute_missing_values_in_feature_mask checks if X has missing values and,0
will raise an error if the underlying tree base estimator can't handle,0
missing values. Only the criterion is required to determine if the tree,0
supports missing values.,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
TODO: remove in 0.13,1
Create dataset with missing values,0
Train forest with missing values,0
Train forest without missing values,0
Score is still 80 percent of the forest's score that had no missing values,0
Create a predictive feature using `y` and with some noise,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
Specify how to identify the prompt when copying code snippets,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.linear_model.LogisticRegression`,0
classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targeted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
predict_proba was removed in tensorflow 2.6,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
TODO: remove this file when scikit-learn minimum version is 1.3,1
Return a copy of the threadlocal configuration so that users will,0
not be able to modify the configuration with the returned dict.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
"def _fit(self, X, y=None, **fit_params_steps):",0
Setup the memory,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
The `fit_*` methods need to be overridden to support the samplers.,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
metadata routing enabled,0
estimators in Pipeline.steps are not validated yet,0
estimators in Pipeline.steps are not validated yet,0
TODO: remove the following methods when the minimum scikit-learn >= 1.4,1
They do not depend on resampling but we need to redefine them for the,0
compatibility with the metadata routing framework.,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
metadata routing enabled,0
not branching here since params is only available if,0
enable_metadata_routing=True,0
"we don't have to branch here, since params is only non-empty if",0
enable_metadata_routing=True.,0
metadata routing is enabled.,0
"TODO: once scikit-learn >= 1.4, the following function should be simplified by",1
calling `super().get_metadata_routing()`,0
first we add all steps except the last one,0
"fit, fit_predict, and fit_transform call fit_transform if it",0
"exists, or else fit and transform",0
then we add the last step,0
"without metadata routing, fit_transform and fit_predict",0
get all the same params and pass it to the last fit.,0
"if we have a weight for this transformer, multiply output",0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
empty cluster,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
the input of the OneHotEncoder needs to be dense,0
SMOTE resampling starts here,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inverting the OHE,0
This variable will be used when generating data,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"With one-hot encoding, the median will be repeated twice. We need",0
to divide by sqrt(2) such that we only have one median value,0
contributing to the Euclidean distance,0
SMOTE resampling ends here,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
TODO: only use `sparse_output` when sklearn >= 1.2,1
TODO(0.13): remove this test,1
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
backward compatibility when passing a NearestNeighbors object,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
add an additional sample since the query points contains the original dataset,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"with a large `threshold_cleaning`, the algorithm is equivalent to ENN",0
set a threshold that we should consider only the class #2,0
making the threshold slightly smaller to take into account class #1,0
we should have a more aggressive cleaning with n_neighbors is larger,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove in 0.14,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
TODO: remove when scikit-learn minimum version is 1.3,1
we don't want to validate again for each call to partial_fit,0
TODO: remove when scikit-learn minimum version is 1.3,1
"Likely a pandas DataFrame, we explicitly check the type to confirm.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
TODO: remove in 0.13,1
future default in 0.13,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Adrin Jalali <adrin.jalali@gmail.com>,0
License: BSD 3 clause,0
Only the following methods are supported in the routing mechanism. Adding new,0
methods at the moment involves monkeypatching this list.,0
"Note that if this list is changed or monkeypatched, the corresponding method",0
needs to be added under a TYPE_CHECKING condition like the one done here in,0
_MetadataRequester,0
These methods are a composite of other methods and one cannot set their,0
requests directly. Instead they should be set by setting the requests of the,0
simple methods which make the composite ones.,0
Request values,0
==============,0
"Each request value needs to be one of the following values, or an alias.",0
this is used in `__metadata_request__*` attributes to indicate that a,0
metadata is not present even though it may be present in the,0
corresponding method's signature.,0
"this is used whenever a default value is changed, and therefore the user",0
"should explicitly set the value, otherwise a warning is shown. An example",0
"is when a meta-estimator is only a router, but then becomes also a",0
consumer in a new release.,0
this is the default used in `set_{method}_request` methods to indicate no,0
change requested by the user.,0
item is only an alias if it's a valid identifier,0
Metadata Request for Simple Consumers,0
=====================================,0
This section includes MethodMetadataRequest and MetadataRequest which are,0
used in simple consumers.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
Called when the default attribute access fails with an AttributeError,0
(either __getattribute__() raises an AttributeError because name is,0
not an instance attribute or an attribute in the class tree for self;,0
or __get__() of a name property raises AttributeError). This method,0
should either return the (computed) attribute value or raise an,0
AttributeError exception.,0
https://docs.python.org/3/reference/datamodel.html#object.__getattr__,0
Metadata Request for Routers,0
============================,0
This section includes all objects required for MetadataRouter which is used,0
"in routers, returned by their ``get_metadata_routing``.",0
"This namedtuple is used to store a (mapping, routing) pair. Mapping is a",0
"MethodMapping object, and routing is the output of `get_metadata_routing`.",0
MetadataRouter stores a collection of these namedtuples.,0
A namedtuple storing a single method route. A collection of these namedtuples,0
is stored in a MetadataRouter.,0
this is here for us to use this attribute's value instead of doing,0
"`isinstance`` in our checks, so that we avoid issues when people vendor",0
this file instead of using it directly from scikit-learn.,0
`_self_request` is used if the router is also a consumer.,0
"_self_request, (added using `add_self_request()`) is treated",0
differently from the other objects which are stored in,0
_route_mappings.,0
"conflicts are okay if the passed objects are the same, but it's",0
an issue if they're different objects.,0
doing this instead of a try/except since an AttributeError could be raised,0
for other reasons.,0
Request method,0
==============,0
This section includes what's needed for the request method descriptor and,0
their dynamic generation in a meta class.,0
These strings are used to dynamically generate the docstrings for,0
set_{method}_request methods.,0
we would want to have a method which accepts only the expected args,0
Now we set the relevant attributes of the function so that it seems,0
"like a normal method to the end user, with known expected arguments.",0
"This code is never run in runtime, but it's here for type checking.",0
Type checkers fail to understand that the `set_{method}_request`,0
"methods are dynamically generated, and they complain that they are",0
not defined. We define them here to make type checkers happy.,0
During type checking analyzers assume this to be True.,0
The following list of defined methods mirrors the list of methods,0
in SIMPLE_METHODS.,0
fmt: off,0
fmt: on,0
"if there are any issues in the default values, it will be raised",0
when ``get_metadata_routing`` is called. Here we are going to,0
ignore all the issues such as bad defaults etc.,0
set ``set_{method}_request``` methods,0
Here we use `isfunction` instead of `ismethod` because calling `getattr`,0
on a class instead of an instance returns an unbound function.,0
"ignore the first parameter of the method, which is usually ""self""",0
Then overwrite those defaults with the ones provided in,0
__metadata_request__* attributes. Defaults set in,0
__metadata_request__* attributes take precedence over signature,0
sniffing.,0
need to go through the MRO since this is a class attribute and,0
``vars`` doesn't report the parent class attributes. We go through,0
the reverse of the MRO so that child classes have precedence over,0
their parents.,0
we don't check for attr.startswith() since python prefixes attrs,0
starting with __ with the `_ClassName`.,0
Process Routing in Routers,0
==========================,0
This is almost always the only method used in routers to process and route,0
given metadata. This is to minimize the boilerplate required in routers.,0
Here the first two arguments are positional only which makes everything,0
passed as keyword argument a metadata. The first two args also have an `_`,0
"prefix to reduce the chances of name collisions with the passed metadata, and",0
"since they're positional only, users will never type those underscores.",0
"If routing is not enabled and kwargs are empty, then we don't have to",0
"try doing any routing, we can simply return a structure which returns",0
an empty dict on routed_params.ANYTHING.ANY_METHOD.,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
Inherits from ValueError and TypeError to keep backward compatibility.,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
Ignore constraints that we don't want to expose in the error,0
"message, i.e. options that are for internal purpose or not",0
officially supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
"When the function is just a wrapper around an estimator, we allow",0
"the function to delegate validation to the estimator, but we",0
replace the name of the estimator by the name of the function in,0
the error message to avoid confusion.,0
better repr if the bounds were given as integers,0
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
"There's no integer outside (-inf, +inf)",0
"bounds are -inf, +inf",0
"interval is [-inf, +inf]",0
special case for ndarray since it can't be instantiated without,0
arguments,0
special case for Integral and Real since they are abstract classes,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
We lost the y.index during resampling. We can safely use X.index to align,0
them.,0
We special case the following error:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/1055,0
"There is no easy way to have a generic workaround. Here, we detect",1
that we have a column with only null values that is datetime64,0
(resulting from the np.vstack of the resampling).,0
try again,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfere with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
does not raise,0
calls f with a bad parameter type,0
Validation for g is never skipped.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
resample before to fit the tree,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.1,1
change of signature in scikit-learn 1.1,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
use scikit-learn support for monotonic constraints,0
create an attribute for compatibility with other scikit-learn tools such,0
as HTML representation.,0
TODO: remove in 0.13,1
Validate or convert input data,0
TODO: remove when the minimum supported version of scipy will be 1.4,1
Support for missing values,0
TODO: remove when the minimum supported version of scikit-learn will be 1.4,1
_compute_missing_values_in_feature_mask checks if X has missing values and,0
will raise an error if the underlying tree base estimator can't handle,0
missing values. Only the criterion is required to determine if the tree,0
supports missing values.,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when minimum supported version of scikit-learn is 1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
The base class require to have the attribute defined. For scikit-learn,0
"> 1.2, we are going to raise an error.",0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
TODO: remove in 0.13,1
Create dataset with missing values,0
Train forest with missing values,0
Train forest without missing values,0
Score is still 80 percent of the forest's score that had no missing values,0
Create a predictive feature using `y` and with some noise,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
Specify how to identify the prompt when copying code snippets,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.linear_model.LogisticRegression`,0
classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
predict_proba was removed in tensorflow 2.6,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
TODO: remove this file when scikit-learn minimum version is 1.3,1
Return a copy of the threadlocal configuration so that users will,0
not be able to modify the configuration with the returned dict.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
empty cluster,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
TODO: only use `sparse_output` when sklearn >= 1.2,1
TODO(0.13): remove this test,1
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
TODO: remove when scikit-learn minimum version is 1.3,1
we don't want to validate again for each call to partial_fit,0
TODO: remove when scikit-learn minimum version is 1.3,1
"Likely a pandas DataFrame, we explicitly check the type to confirm.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
TODO: remove in 0.13,1
future default in 0.13,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
TODO: remove `if True` when we have clear support for:,1
- ignoring `*args` and `**kwargs` in the signature,0
Inherits from ValueError and TypeError to keep backward compatibility.,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
Ignore constraints that we don't want to expose in the error,0
"message, i.e. options that are for internal purpose or not",0
officially supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
"When the function is just a wrapper around an estimator,",0
we allow the function to delegate validation to the,0
"estimator, but we replace the name of the estimator by",0
the name of the function in the error message to avoid,0
confusion.,0
better repr if the bounds were given as integers,0
TODO(1.4) remove support for Integral.,1
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
"There's no integer outside (-inf, +inf)",0
"bounds are -inf, +inf",0
"interval is [-inf, +inf]",0
special case for ndarray since it can't be instantiated without,0
arguments,0
special case for Integral and Real since they are abstract classes,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
We lost the y.index during resampling. We can safely use X.index to align,0
them.,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfere with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
an int is also valid but deprecated,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
does not raise,0
calls f with a bad parameter type,0
Validation for g is never skipped.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
resample before to fit the tree,0
TODO: remove when the minimum version of scikit-learn supported is 1.1,1
make a deepcopy to not modify the original dictionary,0
scikit-learn < 1.2,0
TODO: remove in 0.13,1
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
TODO: remove when supporting scikit-learn>=1.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
make a deepcopy to not modify the original dictionary,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
TODO: remove in 0.13,1
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.svm.LinearSVC` classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` as a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
compute the median of the standard deviation of the minority class,0
scikit-learn >= 1.2,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
TODO: remove `if True` when we have clear support for:,1
- ignoring `*args` and `**kwargs` in the signature,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
"Ignore constraints that we don't want to expose in the error message,",0
i.e. options that are for internal purpose or not officially,0
supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
TODO(1.4) remove support for Integral.,1
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
constraint is an interval,0
generate a non-integer value such that it can't be valid even if there's,0
also an integer interval constraint.,0
We need to check if there's also a real interval constraint to generate a,0
value that is not valid for any of the 2 interval constraints.,0
Only the integer interval constraint -> easy,0
There's also a real interval constraint. Try to find a value left to both,0
or right to both or in between them.,0
redefine left and right bounds to be smallest and largest valid integers,0
in both intervals.,0
there exists an int left to both intervals,0
there exists an int right to both intervals,0
there exists an int between the 2 intervals,0
there exists an int between the 2 intervals,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfer with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
an int is also valid but deprecated,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
TODO: remove when the minimum version of scikit-learn supported is 1.1,1
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
scikit-learn < 1.2,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
TODO: remove when supporting scikit-learn>=1.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.svm.LinearSVC` classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decision tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each bootstrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\alpha_{us}` defined by",0
:math:`N_{rM} = \alpha_{us} \times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\alpha_{os}` defined by :math:`N_{rm} = \alpha_{os} \times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` has a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
scikit-learn >= 1.2,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: to be removed in 0.12,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: to be removed in 0.12,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: to be removed in 0.12,1
FIXME: to be removed in 0.12,1
compute the median of the standard deviation of the minority class,0
scikit-learn >= 1.2,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
FIXME: to be removed in 0.12,1
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: to be removed in 0.12,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Generate valid values for the required parameters,0
The parameters `*args` and `**kwargs` are ignored since we cannot generate,0
constraints.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
scikit-learn >= 1.2,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
transformer will not change `y` and sampler will always preserve the type of `y`,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: Remove when SciPy 1.9 is the minimum supported version,1
TODO: Remove when scikit-learn 1.1 is the minimum supported version,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
scikit-learn >= 1.2,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Check that an informative error is raised when the value of a constructor,0
parameter does not have an appropriate type or value.,0
check that there is a constraint for each parameter,0
this object does not have a valid type for sure for all params,0
This parameter is not validated,0
"First, check that the error is raised if param doesn't match any valid type.",0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
"Then, for constraints that are more than a type constraint, check that the",0
error is raised if param does match a valid type but does not match any valid,0
value for this type.,0
the method is not accessible with the current set of parameters,0
The estimator is a label transformer and take only `y`,0
Check that calling `fit` does not raise any warnings about feature names.,0
Only check imblearn estimators for feature_names_in_ in docstring,0
partial_fit checks on second call,0
Do not call partial fit if early_stopping is on,0
input_features names is not the same length as n_features_in_,0
error is raised when `input_features` do not match feature_names_in,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
mypy: ignore-errors,0
update the docstring of the descriptor,0
"delegate only on instances, not the classes.",0
this is to allow access to the docstrings.,0
This makes it possible to use the decorated method as an,0
"unbound method, for instance when monkeypatching.",0
mypy: ignore-errors,0
TODO: remove `if True` when we have clear support for:,1
- ignoring `*args` and `**kwargs` in the signature,0
We allow parameters to not have a constraint so that third party,0
estimators can inherit from sklearn estimators without having to,0
necessarily use the validation tools.,0
"this constraint is satisfied, no need to check further.",0
"No constraint is satisfied, raise with an informative message.",0
"Ignore constraints that we don't want to expose in the error message,",0
i.e. options that are for internal purpose or not officially,0
supported.,0
The dict of parameter constraints is set as an attribute of the function,0
to make it possible to dynamically introspect the constraints for,0
automatic testing.,0
Map *args/**kwargs to the function signature,0
ignore self/cls and positional/keyword markers,0
TODO(1.4) remove support for Integral.,1
we use an interval of Real to ignore np.nan that has its own,0
constraint,0
constraint is an interval,0
generate a non-integer value such that it can't be valid even if there's,0
also an integer interval constraint.,0
We need to check if there's also a real interval constraint to generate a,0
value that is not valid for any of the 2 interval constraints.,0
Only the integer interval constraint -> easy,0
There's also a real interval constraint. Try to find a value left to both,0
or right to both or in between them.,0
redefine left and right bounds to be smallest and largest valid integers,0
in both intervals.,0
there exists an int left to both intervals,0
there exists an int right to both intervals,0
there exists an int between the 2 intervals,0
there exists an int between the 2 intervals,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
_is_neighbors_object(nn_object),0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Some helpers for the tests,0
check in the presence of extra positional and keyword args,0
outer decorator does not interfer with validation,0
validated method can be decorated,0
no validation in init,0
list and dict are valid params,0
the list option is not exposed in the error message,0
"""auto"" and ""warn"" are valid params",0
"the ""warn"" option is not exposed in the error message",0
True/False and np.bool_(True/False) are valid params,0
an int is also valid but deprecated,0
param1 is validated,0
param2 is not validated: any type is valid.,0
"does not raise, even though ""b"" is not in the constraints dict and ""a"" is not",0
a parameter of the estimator.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
TODO: remove when the minimum version of scikit-learn supported is 1.1,1
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
scikit-learn < 1.2,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
SAMME-R requires predict_proba-enabled estimators,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
TODO: remove when supporting scikit-learn>=1.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
make a deepcopy to not modify the original dictionary,0
scikit-learn >= 1.2,0
TODO: remove when supporting scikit-learn>=1.2,1
scikit-learn < 1.2,0
TODO: remove when supporting scikit-learn>=1.4,1
TODO: remove when supporting scikit-learn>=1.2,1
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
TODO: remove when minimum supported version of scikit-learn is 1.1,1
Check data,0
Parallel loop,0
Reduce,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for math equations -----------------------------------------------,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.svm.LinearSVC` classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` has a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
validate the parameters,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that we deprecate the `n_jobs` parameter.,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
TODO: remove in 0.9,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
FIXME: we could consider to support multiclass-multioutput if,1
we introduce or reuse a constructor parameter (e.g.,0
oob_score) allowing our user to pass a callable defining the,0
scoring strategy on OOB sample.,0
Decapsulate classes_ attributes,0
drop the n_outputs axis if there is a single output,0
Prediction requires X to be in CSR format,0
n_classes_ is a ndarray at this stage,0
all the supported type of target will have the same number of,0
classes in all outputs,0
"for regression, n_classes_ does not exist and we create an empty",0
axis to be consistent with the classification case and make,0
the array operations compatible with the 2 settings,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./imblearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use imblearn from the local folder,0
rather than the one from site-packages.,0
! /usr/bin/env python,0
Python 2 compat: just to be able to declare that Python >=3.7 is needed.,0
This is a bit (!) hackish: we are setting a global variable so that the,1
main imblearn __init__ can detect if it is being loaded by the setup,0
"routine, to avoid attempting to load components that aren't built yet:",0
the numpy distutils extensions that are used by imbalanced-learn to,0
recursively build the compiled extensions in sub-packages is based on the,0
Python import machinery.,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for math equations -----------------------------------------------,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Dependencies generation ----------------------------------------------,0
get length of header,0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.svm.LinearSVC` classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
%% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` has a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
"- GL02: If there's a blank line, it should be before the",0
"first line of the Returns section, not after (it allows to have",0
short docstrings for properties).,0
Ignore PR02: Unknown parameters for properties. We sometimes use,0
"properties for ducktyping, i.e. SGDClassifier.predict_proba",0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
numpy scipy and cython should by in sync with pyproject.toml,0
We pinned PyWavelet (a scikit-image dependence) to 1.1.1 in the minimum,0
documentation CI builds that is the latest version that support our,0
"minimum NumPy version required. If PyWavelets 1.2+ is installed, it would",0
require NumPy 1.17+ that trigger a bug with Pandas 0.25:,0
https://github.com/numpy/numpy/issues/18355#issuecomment-774610226,0
"When upgrading NumPy, we can unpin PyWavelets but we need to update the",0
minimum version of Pandas >= 1.0.5.,0
'build' and 'install' is included to have structured metadata for CI.,0
It will NOT be included in setup's extras_require,0
"The values are (version_spec, comma separated tags)",0
create inverse mapping for setuptools,0
Used by CI to get the min dependencies,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
This variable is injected in the __builtins__ by the build,0
process. It is used to enable importing subpackages of sklearn when,0
the binaries are not built,0
mypy error: Cannot determine type of '__SKLEARN_SETUP__',0
We are not importing the rest of scikit-learn during the build,0
"process, as it may not be compiled yet",0
"FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
the following solution:,0
https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
validate the parameters,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: we should use to_numpy with pandas >= 0.25,1
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that we deprecate the `n_jobs` parameter.,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Alexandre Gramfort <alexandre.gramfort@inria.fr>,0
Raghav RV <rvraghav93@gmail.com>,0
License: BSD 3 clause,0
"walk_packages() ignores DeprecationWarnings, now we need to ignore",0
FutureWarnings,0
"mypy error: Module has no attribute ""__path__""",0
functions to ignore args / docstring of,0
Methods where y param should be ignored if y=None by default,0
numpydoc 0.8.0's docscrape tool raises because of collections.abc under,0
Python 3.7,0
Test module docstring formatting,0
Skip test if numpydoc is not found,0
XXX unreached code as of v0.22,1
"pytest tooling, not part of the scikit-learn API",0
Exclude non-scikit-learn classes,0
Now skip docstring test for y when y is None,0
by default for API reason,0
Exclude imported functions,0
Don't test private methods / functions,0
Test that there are no tabs in our source files,0
because we don't import,0
Minimal / degenerate instances: only useful to test the docstrings.,0
"As certain attributes are present ""only"" if a certain parameter is",0
"provided, this checks if the word ""only"" is present in the attribute",0
"description, and if not the attribute is required to be present.",0
ignore deprecation warnings,0
attributes,0
properties,0
ignore properties that raises an AttributeError and deprecated,0
properties,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
FIXME: we should use to_numpy with pandas >= 0.25,1
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Test that the minimum dependencies in the README.rst file are,0
consistent with the minimum dependencies defined at the file:,0
imblearn/_min_dependencies.py,0
Skip the test if the README.rst file is not available.,0
"For instance, when installing scikit-learn from wheels",0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
TODO: remove in 0.9,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
"with the resampling, we are likely to have rows not included",0
for the OOB score leading to division by zero,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
overwrite the base class method by disallowing `sample_weight`,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
overwrite the base class method by disallowing `sample_weight`,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for math equations -----------------------------------------------,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.svm.LinearSVC` classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` has a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"# FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
# the following solution:,0
# https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
validate the parameters,0
negate diagonal elements,0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that we deprecate the `n_jobs` parameter.,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
TODO: remove in 0.9,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
"with the resampling, we are likely to have rows not included",0
for the OOB score leading to division by zero,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix of source filenames.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
The name of the Pygments (syntax highlighting) style to use.,0
-- Options for math equations -----------------------------------------------,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
"""twitter_url"": ""https://twitter.com/pandas_dev"",",0
"""navbar_align"": ""right"",  # For testing that the navbar items align properly",0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Output file base name for HTML help builder.,0
-- Options for autodoc ------------------------------------------------------,0
generate autosummary even if no references,0
-- Options for numpydoc -----------------------------------------------------,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
-- Options for sphinxcontrib-bibtex -----------------------------------------,0
bibtex file,0
-- Options for intersphinx --------------------------------------------------,0
intersphinx configuration,0
-- Options for sphinx-gallery -----------------------------------------------,0
Generate the plot for the gallery,0
sphinx-gallery configuration,0
-- Options for github link for what's new -----------------------------------,0
Config for sphinx_issues,0
The following is used by sphinx.ext.linkcode to provide links to github,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
-- Additional temporary hacks -----------------------------------------------,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%%,0
"First, we will generate a toy classification dataset with only few samples.",0
The ratio between the classes will be imbalanced.,0
%%,0
%%,0
"Now, we will use a :class:`~imblearn.over_sampling.RandomOverSampler` to",0
generate a bootstrap for the minority class with as many samples as in the,0
majority class.,0
%%,0
%%,0
We observe that the minority samples are less transparent than the samples,0
"from the majority class. Indeed, it is due to the fact that these samples",0
of the minority class are repeated during the bootstrap generation.,0
,0
We can set `shrinkage` to a floating value to add a small perturbation to the,0
samples created and therefore create a smoothed bootstrap.,0
%%,0
%%,0
"In this case, we see that the samples in the minority class are not",0
overlapping anymore due to the added noise.,0
,0
The parameter `shrinkage` allows to add more or less perturbation. Let's,0
add more perturbation when generating the smoothed bootstrap.,0
%%,0
%%,0
Increasing the value of `shrinkage` will disperse the new samples. Forcing,0
the shrinkage to 0 will be equivalent to generating a normal bootstrap.,0
%%,0
%%,0
"Therefore, the `shrinkage` is handy to manually tune the dispersion of the",0
new samples.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
Illustration of the influence of the balancing ratio,0
----------------------------------------------------,0
,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a logistic regression classifier which is a linear model.,0
%%,0
%% [markdown],0
We will fit and show the decision boundary model to illustrate the impact of,0
dealing with imbalanced classes.,0
%%,0
%% [markdown],0
"Greater is the difference between the number of samples in each class, poorer",0
are the classification results.,0
,0
Random over-sampling to balance the data set,0
--------------------------------------------,0
,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biased toward the majority,0
class. The class :class:`~imblearn.over_sampling.RandomOverSampler`,0
implements such of a strategy.,0
%%,0
%% [markdown],0
"By default, random over-sampling generates a bootstrap. The parameter",0
`shrinkage` allows adding a small perturbation to the generated data,0
to generate a smoothed bootstrap instead. The plot below shows the difference,0
between the two data generation strategies.,0
%%,0
%% [markdown],0
It looks like more samples are generated with smoothed bootstrap. This is due,0
to the fact that the samples generated are not superimposing with the,0
original samples.,0
,0
More advanced over-sampling using ADASYN and SMOTE,0
--------------------------------------------------,0
,0
Instead of repeating the same samples when over-sampling or perturbating the,0
"generated bootstrap samples, one can use some specific heuristic instead.",0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE` can be used in this case.,0
%%,0
%% [markdown],0
The following plot illustrates the difference between,0
:class:`~imblearn.over_sampling.ADASYN` and,0
:class:`~imblearn.over_sampling.SMOTE`.,0
:class:`~imblearn.over_sampling.ADASYN` will focus on the samples which are,0
difficult to classify with a nearest-neighbors rule while regular,0
:class:`~imblearn.over_sampling.SMOTE` will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
%% [markdown],0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
%%,0
%% [markdown],0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version,0
(:class:`~imblearn.over_sampling.BorderlineSMOTE`) will detect which point to,0
select which are in the border between two classes. The SVM version,0
(:class:`~imblearn.over_sampling.SVMSMOTE`) will use the support vectors,0
found using an SVM algorithm to create new sample while the KMeans version,0
(:class:`~imblearn.over_sampling.KMeansSMOTE`) will make a clustering before,0
to generate samples in each cluster independently depending each cluster,0
density.,0
%%,0
%% [markdown],0
"When dealing with a mixed of continuous and categorical features,",0
:class:`~imblearn.over_sampling.SMOTENC` is the only method which can handle,0
this case.,0
%%,0
Create a dataset of a mix of numerical and categorical data,0
%% [markdown],0
"However, if the dataset is composed of only categorical features then one",0
should use :class:`~imblearn.over_sampling.SMOTEN`.,0
%%,0
Generate only categorical data,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first generate a dataset with imbalanced class distribution.,0
%%,0
%% [markdown],0
We will use an over-sampler :class:`~imblearn.over_sampling.SMOTE` followed,0
by a :class:`~sklearn.tree.DecisionTreeClassifier`. The aim will be to,0
search which `k_neighbors` parameter is the most adequate with the dataset,0
that we generated.,0
%%,0
%% [markdown],0
We can use the :class:`~sklearn.model_selection.validation_curve` to inspect,0
"the impact of varying the parameter `k_neighbors`. In this case, we need",0
to use a score to evaluate the generalization score during the,0
cross-validation.,0
%%,0
%%,0
%% [markdown],0
We can now plot the results of the cross-validation for the different,0
parameter values that we tried.,0
%%,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
"First, we will generate some imbalanced dataset.",0
%%,0
%% [markdown],0
We will split the data into a training and testing set.,0
%%,0
%% [markdown],0
We will create a pipeline made of a :class:`~imblearn.over_sampling.SMOTE`,0
over-sampler followed by a :class:`~sklearn.svm.LinearSVC` classifier.,0
%%,0
%% [markdown],0
"Now, we will train the model on the training set and get the prediction",0
associated with the testing set. Be aware that the resampling will happen,0
only when calling `fit`: the number of samples in `y_pred` is the same than,0
in `y_test`.,0
%%,0
%% [markdown],0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
%%,0
%% [markdown],0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Dataset generation,0
------------------,0
,0
We will create an imbalanced dataset with a couple of samples. We will use,0
:func:`~sklearn.datasets.make_classification` to generate this dataset.,0
%%,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%% [markdown],0
":class:`~imblearn.over_sampling.SMOTE` allows to generate samples. However,",0
this method of over-sampling does not have any knowledge regarding the,0
"underlying distribution. Therefore, some noisy samples can be generated, e.g.",0
"when the different classes cannot be well separated. Hence, it can be",0
beneficial to apply an under-sampling algorithm to clean the noisy samples.,0
Two methods are usually used in the literature: (i) Tomek's link and (ii),0
edited nearest neighbours cleaning methods. Imbalanced-learn provides two,0
ready-to-use samplers :class:`~imblearn.combine.SMOTETomek` and,0
":class:`~imblearn.combine.SMOTEENN`. In general,",0
:class:`~imblearn.combine.SMOTEENN` cleans more noisy data than,0
:class:`~imblearn.combine.SMOTETomek`.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load an imbalanced dataset,0
--------------------------,0
,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
%%,0
%% [markdown],0
Classification using a single decision tree,0
-------------------------------------------,0
,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
%%,0
%%,0
%%,0
%% [markdown],0
Classification using bagging classifier with and without sampling,0
-----------------------------------------------------------------,0
,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
%%,0
%% [markdown],0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
%%,0
%%,0
%% [markdown],0
Classification using random forest classifier with and without sampling,0
-----------------------------------------------------------------------,0
,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
%%,0
%% [markdown],0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
%%,0
%%,0
%% [markdown],0
Boosting classifier,0
-------------------,0
,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
%%,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate an imbalanced dataset,0
------------------------------,0
,0
"For this example, we will create a synthetic dataset using the function",0
:func:`~sklearn.datasets.make_classification`. The problem will be a toy,0
classification problem with a ratio of 1:9 between the two classes.,0
%%,0
%%,0
%% [markdown],0
"In the following sections, we will show a couple of algorithms that have",0
been proposed over the years. We intend to illustrate how one can reuse the,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier` by passing different,0
sampler.,0
%%,0
%% [markdown],0
Exactly Balanced Bagging and Over-Bagging,0
-----------------------------------------,0
,0
The :class:`~imblearn.ensemble.BalancedBaggingClassifier` can use in,0
conjunction with a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler`. These methods are,0
"referred as Exactly Balanced Bagging and Over-Bagging, respectively and have",0
been proposed first in [1]_.,0
%%,0
Exactly Balanced Bagging,0
%%,0
Over-bagging,0
%% [markdown],0
SMOTE-Bagging,0
-------------,0
,0
Instead of using a :class:`~imblearn.over_sampling.RandomOverSampler` that,0
"make a bootstrap, an alternative is to use",0
:class:`~imblearn.over_sampling.SMOTE` as an over-sampler. This is known as,0
SMOTE-Bagging [2]_.,0
%%,0
SMOTE-Bagging,0
%% [markdown],0
Roughly Balanced Bagging,0
------------------------,0
While using a :class:`~imblearn.under_sampling.RandomUnderSampler` or,0
:class:`~imblearn.over_sampling.RandomOverSampler` will create exactly the,0
"desired number of samples, it does not follow the statistical spirit wanted",0
in the bagging framework. The authors in [3]_ proposes to use a negative,0
binomial distribution to compute the number of samples of the majority,0
class to be selected and then perform a random under-sampling.,0
,0
"Here, we illustrate this method by implementing a function in charge of",0
resampling and use the :class:`~imblearn.FunctionSampler` to integrate it,0
within a :class:`~imblearn.pipeline.Pipeline` and,0
:class:`~sklearn.model_selection.cross_validate`.,0
%%,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
%% [markdown],0
.. topic:: References:,0
,0
".. [1] R. Maclin, and D. Opitz. ""An empirical evaluation of bagging and",0
"boosting."" AAAI/IAAI 1997 (1997): 546-551.",0
,0
".. [2] S. Wang, and X. Yao. ""Diversity analysis on imbalanced data sets by",0
"using ensemble models."" 2009 IEEE symposium on computational",0
"intelligence and data mining. IEEE, 2009.",0
,0
".. [3] S. Hido, H. Kashima, and Y. Takahashi. ""Roughly balanced bagging",0
"for imbalanced data."" Statistical Analysis and Data Mining: The ASA",0
Data Science Journal 2.5‚Äê6 (2009): 412-426.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
The following function will be used to create toy dataset. It uses the,0
:func:`~sklearn.datasets.make_classification` from scikit-learn but fixing,0
some parameters.,0
%%,0
%% [markdown],0
The following function will be used to plot the sample space after resampling,0
to illustrate the specificities of an algorithm.,0
%%,0
%% [markdown],0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
%%,0
%%,0
%% [markdown],0
Prototype generation: under-sampling by generating new samples,0
--------------------------------------------------------------,0
,0
:class:`~imblearn.under_sampling.ClusterCentroids` under-samples by replacing,0
the original samples by the centroids of the cluster found.,0
%%,0
%% [markdown],0
Prototype selection: under-sampling by selecting existing samples,0
-----------------------------------------------------------------,0
,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified.,0
:class:`~imblearn.under_sampling.RandomUnderSampler` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.NearMiss` algorithms implement some,0
heuristic rules in order to select samples. NearMiss-1 selects samples from,0
the majority class for which the average distance of the :math:`k`` nearest,0
samples of the minority class is the smallest. NearMiss-2 selects the samples,0
from the majority class for which the average distance to the farthest,0
samples of the negative class is the smallest. NearMiss-3 is a 2-step,0
"algorithm: first, for each minority sample, their :math:`m`",0
"nearest-neighbors will be kept; then, the majority samples selected are the",0
on for which the average distance to the :math:`k` nearest neighbors is the,0
largest.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` removes samples of,0
the majority class for which their class differ from the one of their,0
nearest-neighbors. This sieve can be repeated which is the principle of the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours`.,0
:class:`~imblearn.under_sampling.AllKNN` is slightly different from the,0
:class:`~imblearn.under_sampling.RepeatedEditedNearestNeighbours` by changing,0
"the :math:`k` parameter of the internal nearest neighors algorithm,",0
increasing it at each iteration.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.CondensedNearestNeighbour` makes use of a,0
1-NN to iteratively decide if a sample should be kept in a dataset or not.,0
The issue is that :class:`~imblearn.under_sampling.CondensedNearestNeighbour`,0
is sensitive to noise by preserving the noisy samples.,0
:class:`~imblearn.under_sampling.OneSidedSelection` also used the 1-NN and,0
use :class:`~imblearn.under_sampling.TomekLinks` to remove the samples,0
considered noisy. The,0
:class:`~imblearn.under_sampling.NeighbourhoodCleaningRule` use a,0
:class:`~imblearn.under_sampling.EditedNearestNeighbours` to remove some,0
"sample. Additionally, they use a 3 nearest-neighbors to remove samples which",0
do not agree with this rule.,0
%%,0
%% [markdown],0
:class:`~imblearn.under_sampling.InstanceHardnessThreshold` uses the,0
prediction of classifier to exclude samples. All samples which are classified,0
with a low probability will be removed.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
This function allows to make nice plotting,0
%%,0
%% [markdown],0
We will generate some toy data that illustrates how,0
:class:`~imblearn.under_sampling.TomekLinks` is used to clean a dataset.,0
%%,0
%% [markdown],0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbors of each other.,0
highlight the samples of interest,0
%% [markdown],0
We can run the :class:`~imblearn.under_sampling.TomekLinks` sampling to,0
remove the corresponding samples. If `sampling_strategy='auto'` only the,0
sample from the majority class will be removed. If `sampling_strategy='all'`,0
both samples will be removed.,0
%%,0
highlight the samples of interest,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
We define a function allowing to make some nice decoration on the plot.,0
%%,0
%% [markdown],0
We can start by generating some data to later illustrate the principle of,0
each :class:`~imblearn.under_sampling.NearMiss` heuristic rules.,0
%%,0
%% [mardown],0
NearMiss-1,0
----------,0
,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
%%,0
%% [mardown],0
NearMiss-2,0
----------,0
,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
%%,0
%% [mardown],0
NearMiss-3,0
----------,0
,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
%%,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Let's first create an imbalanced dataset and split in to two sets.,0
%%,0
%% [markdown],0
"Now, we will create each individual steps that we would like later to combine",0
%%,0
%% [markdown],0
"Now, we can finally create a pipeline to specify in which order the different",0
transformers and samplers should be executed before to provide the data to,0
the final classifier.,0
%%,0
%% [markdown],0
We can now use the pipeline created as a normal classifier where resampling,0
"will happen when calling `fit` and disabled when calling `decision_function`,",0
"`predict_proba`, or `predict`.",0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`~sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Problem definition,0
------------------,0
,0
We are dropping the following features:,0
,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
%%,0
%% [markdown],0
"The ""adult"" dataset as a class ratio of about 3:1",0
%%,0
%% [markdown],0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
%%,0
%% [markdown],0
We will perform a cross-validation evaluation to get an estimate of the test,0
score.,0
,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
%%,0
%% [markdown],0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
%%,0
%% [markdown],0
Strategies to learn from an imbalanced dataset,0
----------------------------------------------,0
We will use a dictionary and a list to continuously store the results of,0
our experiments and show them as a pandas dataframe.,0
%%,0
%% [markdown],0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our :class:`~sklearn.dummy.DummyClassifier`.,0
%%,0
%% [markdown],0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a,0
":class:`~sklearn.linear_model.LogisticRegression` classifier. In this regard,",0
we will need to one-hot encode the categorical columns and standardized the,0
numerical columns before to inject the data into the,0
:class:`~sklearn.linear_model.LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
%%,0
%% [markdown],0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
%%,0
%% [markdown],0
"Finally, we connect our preprocessor with our",0
:class:`~sklearn.linear_model.LogisticRegression`. We can then evaluate our,0
model.,0
%%,0
%%,0
%% [markdown],0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
such as :class:`~sklearn.ensemble.RandomForestClassifier`. With this type of,0
"classifier, we will not need to scale the numerical data, and we will only",0
need to ordinal encode the categorical data.,0
%%,0
%%,0
%% [markdown],0
The :class:`~sklearn.ensemble.RandomForestClassifier` is as well affected by,0
"the class imbalanced, slightly less than the linear model. Now, we will",0
present different approach to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
%%,0
%%,0
%% [markdown],0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
the :class:`~sklearn.ensemble.RandomForestClassifier` is still biased toward,0
"the majority class, mainly due to the criterion which is not suited enough to",0
fight the class imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
%%,0
%%,0
%%,0
%%,0
%% [markdown],0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of specific balanced algorithms from imbalanced-learn,0
.........................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the :class:`imblearn.ensemble.BalancedRandomForestClassifier` and,0
:class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%%,0
%%,0
%% [markdown],0
The performance with the,0
:class:`~imblearn.ensemble.BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a :class:`~imblearn.ensemble.BalancedBaggingClassifier`.,0
%% [markdown],0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Load the dataset,0
----------------,0
,0
We will use a dataset containing image from know person where we will,0
build a model to recognize the person on the image. We will make this problem,0
a binary problem by taking picture of only George W. Bush and Bill Clinton.,0
%%,0
%%,0
%% [markdown],0
We can check the ratio between the two classes.,0
%%,0
%% [markdown],0
We see that we have an imbalanced classification problem with ~95% of the,0
data belonging to the class G.W. Bush.,0
,0
Compare over-sampling approaches,0
--------------------------------,0
,0
We will use different over-sampling approaches and use a kNN classifier,0
to check if we can recognize the 2 presidents. The evaluation will be,0
performed through cross-validation and we will plot the mean ROC curve.,0
,0
We will create different pipelines and evaluate them.,0
%%,0
%%,0
%% [markdown],0
We will compute the mean ROC curve for each pipeline using a different splits,0
provided by the :class:`~sklearn.model_selection.StratifiedKFold`,0
cross-validation.,0
%%,0
compute the mean fpr/tpr to get the mean ROC curve,0
Create a display that we will reuse to make the aggregated plots for,0
all methods,0
%% [markdown],0
"In the previous cell, we created the different mean ROC curve and we can plot",0
them on the same plot.,0
%%,0
%% [markdown],0
"We see that for this task, methods that are generating new samples with some",0
interpolation (i.e. ADASYN and SMOTE) perform better than random,0
over-sampling or no resampling.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Setting the data set,0
--------------------,0
,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
%%,0
%%,0
% [markdown],0
The usual scikit-learn pipeline,0
-------------------------------,0
,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
%%,0
%%,0
%% [markdown],0
Balancing the class before classification,0
-----------------------------------------,0
,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a :class:`~imblearn.under_sampling.RandomUnderSampler` to equalize the,0
number of samples in all the classes before the training.,0
,0
It is also important to note that we are using the,0
:class:`~imblearn.pipeline.make_pipeline` function implemented in,0
imbalanced-learn to properly handle the samplers.,0
%%,0
%% [markdown],0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`~imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`~sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`~imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Generate the dataset,0
--------------------,0
,0
"First, we will generate a dataset and convert it to a",0
:class:`~pandas.DataFrame` with arbitrary column names. We will plot the,0
original dataset.,0
%%,0
%% [markdown],0
Make a dataset imbalanced,0
-------------------------,0
,0
"Now, we will show the helpers :func:`~imblearn.datasets.make_imbalance`",0
that is useful to random select a subset of samples. It will impact the,0
class distribution as specified by the parameters.,0
%%,0
%%,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
%%,0
%% [markdown],0
Create an imbalanced dataset,0
----------------------------,0
,0
"First, we will create an imbalanced data set from a the iris data set.",0
%%,0
%%,0
%% [markdown],0
Using ``sampling_strategy`` in resampling algorithms,0
====================================================,0
,0
`sampling_strategy` as a `float`,0
--------------------------------,0
,0
`sampling_strategy` can be given a `float`. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
%%,0
select only 2 classes since the ratio make sense in this case,0
%%,0
%% [markdown],0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
%%,0
%% [markdown],0
`sampling_strategy` has a `str`,0
-------------------------------,0
,0
`sampling_strategy` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
%%,0
%% [markdown],0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
%%,0
%% [markdown],0
`sampling_strategy as a `dict`,0
------------------------------,0
,0
"When `sampling_strategy` is a `dict`, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a `list` instead.,0
%%,0
%% [markdown],0
`sampling_strategy` as a `list`,0
-------------------------------,0
,0
"When `sampling_strategy` is a `list`, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
%%,0
%% [markdown],0
`sampling_strategy` as a callable,0
---------------------------------,0
,0
"When callable, function taking `y` and returns a `dict`. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
%%,0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
we need to overwrite SamplerMixin.fit to bypass the validation,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transformer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"# FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
# the following solution:,0
# https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
categories are expected to be encoded from 0 to n_categories - 1,0
"list of length n_features of ndarray (n_categories, n_classes)",0
compute the counts,0
normalize by the summing over the classes,0
silence potential warning due to in-place division by zero,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Check basic feature of the metric:,0
"* the shape of the distance matrix is (n_samples, n_samples)",0
* computing pairwise distance of X is the same than explicitely between,0
X and X.,0
Check the property of the vdm distance. Let's check the property,0
"described in ""Improved Heterogeneous Distance Functions"", D.R. Wilson and",0
"T.R. Martinez, Journal of Artificial Intelligence Research 6 (1997) 1-34",0
https://arxiv.org/pdf/cs/9701101.pdf,0
,0
"""if an attribute color has three values red, green and blue, and the",0
"application is to identify whether or not an object is an apple, red and",0
green would be considered closer than red and blue because the former two,0
"both have similar correlations with the output class apple.""",0
defined our feature,0
0 - not an apple / 1 - an apple,0
computing the distance between a sample of the same category should,0
give a null distance,0
check the property explained in the introduction example,0
green and red are very close,0
blue is closer to red than green,0
"Check that ""auto"" is equivalent to provide the number categories",0
beforehand,0
Check that we raise an error if n_categories is inconsistent with the,0
number of features in X,0
Check that we don't get issue when a category is missing between 0,0
n_categories - 1,0
remove a categories that could be between 0 and n_categories,0
Check that we raise a NotFittedError when `fit` is not not called before,0
pairwise.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
smoothed bootstrap imposes to make numerical operation; we need,0
to be sure to have only numerical data in X,0
generate a smoothed bootstrap with a perturbation,0
generate a bootstrap,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
validate the parameters,0
negate diagonal elements,0
target_class_indices = np.flatnonzero(y == class_sample),0
"X_class = _safe_indexing(X, target_class_indices)",0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
generate sample indices that will be used to generate new samples,0
"for each drawn samples, select its k-neighbors and generate a sample",0
"where for each feature individually, each category generated is the",0
most common category,0
the kneigbors search will include the sample itself which is,0
expected from the original algorithm,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
overall check for SMOTEN,0
check if the SMOTEN resample data as expected,0
"we generate data such that ""not apple"" will be the minority class and",0
"samples from this class will be generated. We will force the ""blue""",0
"category to be associated with this class. Therefore, the new generated",0
"samples should as well be from the ""blue"" category.",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check the random over-sampling with a multiclass problem,0
check that resampling with heterogeneous dtype is working with basic,0
resampling,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
check that we raise an error when heterogeneous dtype data are given,0
and a smoothed bootstrap is requested,0
check that smoothed bootstrap is working for numerical array,0
check that a shrinkage factor of 0 is equivalent to not create a smoothed,0
bootstrap,0
check the behaviour of the shrinkage parameter,0
the covariance of the data generated with the larger shrinkage factor,0
should also be larger.,0
check the validation of the shrinkage parameter,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
fmt: off,0
fmt: on,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that we deprecate the `n_jobs` parameter.,0
check that the samples selecting by the hard voting corresponds to the,0
targeted class,0
non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/738,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Check that the validation is bypass when calling `fit`,0
Non-regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/782,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
we don't filter samplers based on their tag here because we want to make,0
sure that the fitted attribute does not exist if the tag is not,0
stipulated,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
TODO: remove in 0.9,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
"with the resampling, we are likely to have rows not included",0
for the OOB score leading to division by zero,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
the sampler needs to be validated before to call _fit because,0
_validate_y is called before _validate_estimator and would require,0
to know which type of sampler we are using.,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
check that we can pass any kind of sampler to a bagging classifier,0
check that we have balanced class with the right counts of class,0
sample depending on the sampling strategy,0
check that we can provide a FunctionSampler in BalancedBaggingClassifier,0
find the minority and majority classes,0
compute the number of sample to draw from the majority class using,0
a negative binomial distribution,0
draw randomly with or without replacement,0
Roughly Balanced Bagging,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new sample while,0
the KMeans version will make a clustering before to generate samples in each,0
cluster independently depending each cluster density.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Problem definition,0
##############################################################################,0
we are dropping the following features:,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
##############################################################################,0
"The ""adult"" dataset as a class ratio of about 3:1",0
##############################################################################,0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
##############################################################################,0
"For the rest of the notebook, we will make a single split to get training",0
and testing data. Note that you should use cross-validation to have an,0
estimate of the performance variation in practice.,0
##############################################################################,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
#############################################################################,0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
##############################################################################,0
Strategies to learn from an imbalanced dataset,0
##############################################################################,0
##############################################################################,0
We will first define a helper function which will train a given model,0
and compute both accuracy and balanced accuracy. The results will be stored,0
in a dataframe,0
Let's define an empty dataframe to store the results,0
##############################################################################,0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our `DummyClassifier`.,0
##############################################################################,0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a `LogisticRegression`,0
"classifier. In this regard, we will need to one-hot encode the categorical",0
columns and standardized the numerical columns before to inject the data into,0
the `LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
##############################################################################,0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
##############################################################################,0
"Finally, we connect our preprocessor with our `LogisticRegression`. We can",0
then evaluate our model.,0
##############################################################################,0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
"such as `RandomForestClassifier`. With this type of classifier, we will not",0
"need to scale the numerical data, and we will only need to ordinal encode the",0
categorical data.,0
##############################################################################,0
"The `RandomForestClassifier` is as well affected by the class imbalanced,",0
"slightly less than the linear model. Now, we will present different approach",0
to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
##############################################################################,0
,0
##############################################################################,0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
"the `RandomForestClassifier` is still biased toward the majority class,",0
mainly due to the criterion which is not suited enough to fight the class,0
imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
##############################################################################,0
,0
##############################################################################,0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of `BalancedRandomForestClassifier` and `BalancedBaggingClassifier`,0
.......................................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the `BalancedRandomForestClassifier` and,0
`BalancedBaggingClassifier`.,0
##############################################################################,0
The performance with the `BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a `BalancedBaggingClassifier`.,0
##############################################################################,0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
,0
We will repeat the same experiment but with a ratio of 100:1 and make a,0
similar analysis.,0
##############################################################################,0
Increase imbalanced ratio,0
##############################################################################,0
##############################################################################,0
"When we analyse the results, we can draw similar conclusions than in the",0
"previous discussion. However, we can observe that the strategy",0
"`class_weight=""balanced""` does not improve the performance when using a",0
`RandomForestClassifier`. A resampling is indeed required. The most effective,0
method remains the `BalancedBaggingClassifier` using a GBDT as a base,0
learner.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"# FIXME: When we get Python 3.7 as minimal version, we will need to switch to",1
# the following solution:,0
# https://snarky.ca/lazy-importing-in-python-3-7/,0
Import the target module and insert it into the parent's namespace,0
Update this object's dict so that if someone keeps a reference to the,0
"LazyLoader, lookups are efficient (__getattr__ is only called on",0
lookups that fail).,0
delay the import of keras since we are going to import either tensorflow,0
or keras,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
check that the scoring function does not need a score,0
and only a prediction,0
We do not support multilabel so the only average supported,0
is binary,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
@Substitution(,0
"sampling_strategy=BaseOverSampler._sampling_strategy_docstring,",0
random_state=_random_state_docstring),0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
"In the edge case where the median of the std is equal to 0, the 1s",0
"entries will be also nullified. In this case, we store the original",0
categorical encoding which will be later used for inversing the OHE,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
"In the case that the median std was equal to zeros, we have to",0
create non-null entry based on the encoded of OHE,0
tie breaking argmax,0
validate the parameters,0
negate diagonal elements,0
target_class_indices = np.flatnonzero(y == class_sample),0
"X_class = _safe_indexing(X, target_class_indices)",0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Non-regression test for #662,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/662,0
check that the categorical feature is not random but correspond to the,0
categories seen in the minority class samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
check that we deprecate the `n_jobs` parameter.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
"For NearMiss, let's check the three algorithms",0
Common tests for estimator instances,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
trigger our checks if this is a SamplerMixin,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Non-regression test for #709,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/709,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ignore deprecation warnings triggered at import time and from walking,0
packages,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
ignore first 'self' argument for instance methods,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
The * is place before a keyword only argument without a default value,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
"with the resampling, we are likely to have rows not included",0
for the OOB score leading to division by zero,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new sample while,0
the KMeans version will make a clustering before to generate samples in each,0
cluster independently depending each cluster density.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Problem definition,0
##############################################################################,0
we are dropping the following features:,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
##############################################################################,0
"The ""adult"" dataset as a class ratio of about 3:1",0
##############################################################################,0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
##############################################################################,0
"For the rest of the notebook, we will make a single split to get training",0
and testing data. Note that you should use cross-validation to have an,0
estimate of the performance variation in practice.,0
##############################################################################,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
#############################################################################,0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
##############################################################################,0
Strategies to learn from an imbalanced dataset,0
##############################################################################,0
##############################################################################,0
We will first define a helper function which will train a given model,0
and compute both accuracy and balanced accuracy. The results will be stored,0
in a dataframe,0
Let's define an empty dataframe to store the results,0
##############################################################################,0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our `DummyClassifier`.,0
##############################################################################,0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a `LogisticRegression`,0
"classifier. In this regard, we will need to one-hot encode the categorical",0
columns and standardized the numerical columns before to inject the data into,0
the `LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
##############################################################################,0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
##############################################################################,0
"Finally, we connect our preprocessor with our `LogisticRegression`. We can",0
then evaluate our model.,0
##############################################################################,0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
"such as `RandomForestClassifier`. With this type of classifier, we will not",0
"need to scale the numerical data, and we will only need to ordinal encode the",0
categorical data.,0
##############################################################################,0
"The `RandomForestClassifier` is as well affected by the class imbalanced,",0
"slightly less than the linear model. Now, we will present different approach",0
to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
##############################################################################,0
,0
##############################################################################,0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
"the `RandomForestClassifier` is still biased toward the majority class,",0
mainly due to the criterion which is not suited enough to fight the class,0
imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
##############################################################################,0
,0
##############################################################################,0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of `BalancedRandomForestClassifier` and `BalancedBaggingClassifier`,0
.......................................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the `BalancedRandomForestClassifier` and,0
`BalancedBaggingClassifier`.,0
##############################################################################,0
The performance with the `BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a `BalancedBaggingClassifier`.,0
##############################################################################,0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
,0
We will repeat the same experiment but with a ratio of 100:1 and make a,0
similar analysis.,0
##############################################################################,0
Increase imbalanced ratio,0
##############################################################################,0
##############################################################################,0
"When we analyse the results, we can draw similar conclusions than in the",0
"previous discussion. However, we can observe that the strategy",0
"`class_weight=""balanced""` does not improve the performance when using a",0
`RandomForestClassifier`. A resampling is indeed required. The most effective,0
method remains the `BalancedBaggingClassifier` using a GBDT as a base,0
learner.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib <= 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
@Substitution(,0
"sampling_strategy=BaseOverSampler._sampling_strategy_docstring,",0
random_state=_random_state_docstring),0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
tie breaking argmax,0
validate the parameters,0
negate diagonal elements,0
target_class_indices = np.flatnonzero(y == class_sample),0
"X_class = _safe_indexing(X, target_class_indices)",0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
trigger our checks if this is a SamplerMixin,0
scikit-learn common tests,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return the same type for dataframes or series types,0
Check that the can samplers handle simple lists,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
DataFrame and DataFrame case,0
DataFrames and Series case,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
"with the resampling, we are likely to have rows not included",0
for the OOB score leading to division by zero,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new sample while,0
the KMeans version will make a clustering before to generate samples in each,0
cluster independently depending each cluster density.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Problem definition,0
##############################################################################,0
we are dropping the following features:,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
##############################################################################,0
"The ""adult"" dataset as a class ratio of about 3:1",0
##############################################################################,0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
##############################################################################,0
"For the rest of the notebook, we will make a single split to get training",0
and testing data. Note that you should use cross-validation to have an,0
estimate of the performance variation in practice.,0
##############################################################################,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
#############################################################################,0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
##############################################################################,0
Strategies to learn from an imbalanced dataset,0
##############################################################################,0
##############################################################################,0
We will first define a helper function which will train a given model,0
and compute both accuracy and balanced accuracy. The results will be stored,0
in a dataframe,0
Let's define an empty dataframe to store the results,0
##############################################################################,0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our `DummyClassifier`.,0
##############################################################################,0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a `LogisticRegression`,0
"classifier. In this regard, we will need to one-hot encode the categorical",0
columns and standardized the numerical columns before to inject the data into,0
the `LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
##############################################################################,0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
##############################################################################,0
"Finally, we connect our preprocessor with our `LogisticRegression`. We can",0
then evaluate our model.,0
##############################################################################,0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
"such as `RandomForestClassifier`. With this type of classifier, we will not",0
"need to scale the numerical data, and we will only need to ordinal encode the",0
categorical data.,0
##############################################################################,0
"The `RandomForestClassifier` is as well affected by the class imbalanced,",0
"slightly less than the linear model. Now, we will present different approach",0
to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
##############################################################################,0
,0
##############################################################################,0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
"the `RandomForestClassifier` is still biased toward the majority class,",0
mainly due to the criterion which is not suited enough to fight the class,0
imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
##############################################################################,0
,0
##############################################################################,0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of `BalancedRandomForestClassifier` and `BalancedBaggingClassifier`,0
.......................................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the `BalancedRandomForestClassifier` and,0
`BalancedBaggingClassifier`.,0
##############################################################################,0
The performance with the `BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a `BalancedBaggingClassifier`.,0
##############################################################################,0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
,0
We will repeat the same experiment but with a ratio of 100:1 and make a,0
similar analysis.,0
##############################################################################,0
Increase imbalanced ratio,0
##############################################################################,0
##############################################################################,0
"When we analyse the results, we can draw similar conclusions than in the",0
"previous discussion. However, we can observe that the strategy",0
"`class_weight=""balanced""` does not improve the performance when using a",0
`RandomForestClassifier`. A resampling is indeed required. The most effective,0
method remains the `BalancedBaggingClassifier` using a GBDT as a base,0
learner.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
store information to build dataframe,0
store information to build a series,0
store the columns name to reconstruct a dataframe,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib <= 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store information to build dataframe,0
store information to build a series,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
@Substitution(,0
"sampling_strategy=BaseOverSampler._sampling_strategy_docstring,",0
random_state=_random_state_docstring),0
store information to build dataframe,0
store information to build a series,0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
tie breaking argmax,0
validate the parameters,0
negate diagonal elements,0
target_class_indices = np.flatnonzero(y == class_sample),0
"X_class = _safe_indexing(X, target_class_indices)",0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store information to build dataframe,0
store information to build a series,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
trigger our checks if this is a SamplerMixin,0
scikit-learn common tests,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return a pandas dataframe if a dataframe was given in,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
"with the resampling, we are likely to have rows not included",0
for the OOB score leading to division by zero,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
Temporary work-around for spacing problem between parameter and parameter,1
"type in the doc, see https://github.com/numpy/numpydoc/issues/215. The bug",0
has been fixed in sphinx (https://github.com/sphinx-doc/sphinx/pull/5976) but,0
through a change in sphinx basic.css except rtd_theme does not use basic.css.,0
"In an ideal world, this would get fixed in this PR:",0
https://github.com/readthedocs/sphinx_rtd_theme/pull/747/files,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new sample while,0
the KMeans version will make a clustering before to generate samples in each,0
cluster independently depending each cluster density.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Problem definition,0
##############################################################################,0
we are dropping the following features:,0
"- ""fnlwgt"": this feature was created while studying the ""adult"" dataset.",0
"Thus, we will not use this feature which is not acquired during the survey.",0
"- ""education-num"": it is encoding the same information than ""education"".",0
"Thus, we are removing one of these 2 features.",0
##############################################################################,0
"The ""adult"" dataset as a class ratio of about 3:1",0
##############################################################################,0
This dataset is only slightly imbalanced. To better highlight the effect of,0
"learning from an imbalanced dataset, we will increase its ratio to 30:1",0
##############################################################################,0
"For the rest of the notebook, we will make a single split to get training",0
and testing data. Note that you should use cross-validation to have an,0
estimate of the performance variation in practice.,0
##############################################################################,0
"As a baseline, we could use a classifier which will always predict the",0
majority class independently of the features provided.,0
#############################################################################,0
"Instead of using the accuracy, we can use the balanced accuracy which will",0
take into account the balancing issue.,0
##############################################################################,0
Strategies to learn from an imbalanced dataset,0
##############################################################################,0
##############################################################################,0
We will first define a helper function which will train a given model,0
and compute both accuracy and balanced accuracy. The results will be stored,0
in a dataframe,0
Let's define an empty dataframe to store the results,0
##############################################################################,0
Dummy baseline,0
..............,0
,0
"Before to train a real machine learning model, we can store the results",0
obtained with our `DummyClassifier`.,0
##############################################################################,0
Linear classifier baseline,0
..........................,0
,0
We will create a machine learning pipeline using a `LogisticRegression`,0
"classifier. In this regard, we will need to one-hot encode the categorical",0
columns and standardized the numerical columns before to inject the data into,0
the `LogisticRegression` classifier.,0
,0
"First, we define our numerical and categorical pipelines.",0
##############################################################################,0
"Then, we can create a preprocessor which will dispatch the categorical",0
columns to the categorical pipeline and the numerical columns to the,0
numerical pipeline,0
##############################################################################,0
"Finally, we connect our preprocessor with our `LogisticRegression`. We can",0
then evaluate our model.,0
##############################################################################,0
We can see that our linear model is learning slightly better than our dummy,0
"baseline. However, it is impacted by the class imbalance.",0
,0
We can verify that something similar is happening with a tree-based model,0
"such as `RandomForestClassifier`. With this type of classifier, we will not",0
"need to scale the numerical data, and we will only need to ordinal encode the",0
categorical data.,0
##############################################################################,0
"The `RandomForestClassifier` is as well affected by the class imbalanced,",0
"slightly less than the linear model. Now, we will present different approach",0
to improve the performance of these 2 models.,0
,0
Use `class_weight`,0
..................,0
,0
Most of the models in `scikit-learn` have a parameter `class_weight`. This,0
parameter will affect the computation of the loss in linear model or the,0
criterion in the tree-based model to penalize differently a false,0
classification from the minority and majority class. We can set,0
"`class_weight=""balanced""` such that the weight applied is inversely",0
proportional to the class frequency. We test this parametrization in both,0
linear model and tree-based model.,0
##############################################################################,0
,0
##############################################################################,0
We can see that using `class_weight` was really effective for the linear,0
"model, alleviating the issue of learning from imbalanced classes. However,",0
"the `RandomForestClassifier` is still biased toward the majority class,",0
mainly due to the criterion which is not suited enough to fight the class,0
imbalance.,0
,0
Resample the training set during learning,0
.........................................,0
,0
Another way is to resample the training set by under-sampling or,0
over-sampling some of the samples. `imbalanced-learn` provides some samplers,0
to do such processing.,0
##############################################################################,0
,0
##############################################################################,0
Applying a random under-sampler before the training of the linear model or,0
"random forest, allows to not focus on the majority class at the cost of",0
making more mistake for samples in the majority class (i.e. decreased,0
accuracy).,0
,0
We could apply any type of samplers and find which sampler is working best,0
on the current dataset.,0
,0
"Instead, we will present another way by using classifiers which will apply",0
sampling internally.,0
,0
Use of `BalancedRandomForestClassifier` and `BalancedBaggingClassifier`,0
.......................................................................,0
,0
We already showed that random under-sampling can be effective on decision,0
"tree. However, instead of under-sampling once the dataset, one could",0
under-sample the original dataset before to take a bootstrap sample. This is,0
the base of the `BalancedRandomForestClassifier` and,0
`BalancedBaggingClassifier`.,0
##############################################################################,0
The performance with the `BalancedRandomForestClassifier` is better than,0
applying a single random under-sampling. We will use a gradient-boosting,0
classifier within a `BalancedBaggingClassifier`.,0
##############################################################################,0
This last approach is the most effective. The different under-sampling allows,0
to bring some diversity for the different GBDT to learn and not focus on a,0
portion of the majority class.,0
,0
We will repeat the same experiment but with a ratio of 100:1 and make a,0
similar analysis.,0
##############################################################################,0
Increase imbalanced ratio,0
##############################################################################,0
##############################################################################,0
"When we analyse the results, we can draw similar conclusions than in the",0
"previous discussion. However, we can observe that the strategy",0
"`class_weight=""balanced""` does not improve the performance when using a",0
`RandomForestClassifier`. A resampling is indeed required. The most effective,0
method remains the `BalancedBaggingClassifier` using a GBDT as a base,0
learner.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
List of whitelisted modules and methods; regexp are supported.,0
These docstrings will fail because they are inheriting from scikit-learn,0
skip private classes,0
"We ignore following error code,",0
- RT02: The first line of the Returns section,0
"should contain only the type, ..",0
(as we may need refer to the name of the returned,0
object),0
- GL01: Docstring text (summary) should start in the line,0
"immediately after the opening quotes (not in the same line,",0
or leaving a blank line in between),0
Following codes are only taken into account for the,0
top level class docstrings:,0
- ES01: No extended summary found,0
- SA01: See Also section not found,0
- EX01: No examples section found,0
In particular we can't parse the signature of properties,0
"When applied to classes, detect class method. For functions",0
method = None.,0
TODO: this detection can be improved. Currently we assume that we have,1
class # methods if the second path element before last is in camel case.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
store information to build dataframe,0
store information to build a series,0
store the columns name to reconstruct a dataframe,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib <= 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
rounding may cause new amount for n_samples,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store information to build dataframe,0
store information to build a series,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
np.newaxis for backwards compatability with random_state,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
@Substitution(,0
"sampling_strategy=BaseOverSampler._sampling_strategy_docstring,",0
random_state=_random_state_docstring),0
store information to build dataframe,0
store information to build a series,0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
change in sparsity structure more efficient with LIL than CSR,0
convert to dense array since scipy.sparse doesn't handle 3D,0
tie breaking argmax,0
validate the parameters,0
negate diagonal elements,0
target_class_indices = np.flatnonzero(y == class_sample),0
"X_class = _safe_indexing(X, target_class_indices)",0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can oversample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store information to build dataframe,0
store information to build a series,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that we can undersample even with missing or infinite data,0
regression tests for #605,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that we can let a pass a regression variable by turning down the,0
validation,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
trigger our checks if this is a SamplerMixin,0
scikit-learn common tests,0
should raise warning if the target is continuous (we cannot raise error),0
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
check that we return a pandas dataframe if a dataframe was given in,0
Check that multiclass target lead to the same results than OVA encoding,0
Cast X and y to not default dtype,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is None,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is none,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Get bootstrap sample size,0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
"with the resampling, we are likely to have rows not included",0
for the OOB score leading to division by zero,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
First fit with no restriction on max samples,0
Second fit with max samples restricted to just 2,0
Regression test for #655: check that the oob score is closed to 0.5,0
a binomial experiment.,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
pngmath / imgmath compatibility layer for different sphinx versions,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
Format template for PR URI,0
e.g. 'https://github.com/sloria/marshmallow/pull/{issue},0
Format template for commit URI,0
e.g. 'https://github.com/sloria/marshmallow/commits/{commit},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{M}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new sample while,0
the KMeans version will make a clustering before to generate samples in each,0
cluster independently depending each cluster density.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
FIXME: remove in 0.6,1
FIXME: remove in 0.6,1
both ratio and sampling_strategy should not be set,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib < 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove the str tag once the following PR is merged:,1
https://github.com/scikit-learn/scikit-learn/pull/14043,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: remove in 0.6,1
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: rename _sample -> _fit_resample in 0.6,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: rename _sample -> _fit_resample in 0.6,1
"FIXME: In 0.6, SMOTE should inherit only from BaseSMOTE.",1
FIXME: in 0.6 call super(),1
FIXME: in 0.6 call super(),1
FIXME: remove in 0.6 after deprecation cycle,1
FIXME: to be removed in 0.6,1
FIXME: uncomment in version 0.6,1
self._validate_estimator(),0
@Substitution(,0
"sampling_strategy=BaseOverSampler._sampling_strategy_docstring,",0
random_state=_random_state_docstring),0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
"To avoid conversion and since there is only few samples used, we",0
convert those samples to dense array.,0
tie breaking argmax,0
validate the parameters,0
negate diagonal elements,0
FIXME: rename _sample -> _fit_resample in 0.6,1
target_class_indices = np.flatnonzero(y == class_sample),0
"X_class = safe_indexing(X, target_class_indices)",0
identify cluster which are answering the requirements,0
the cluster is already considered balanced,0
not enough samples to apply SMOTE,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check that m_neighbors is properly set. Regression test for:,0
https://github.com/scikit-learn-contrib/imbalanced-learn/issues/568,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
check for deprecated random_state,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
check for deprecated random_state,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
TODO: remove the str tag once the following PR is merged:,1
https://github.com/scikit-learn/scikit-learn/pull/14043,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Pipeline accepts steps as tuple,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check 'passthrough' step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Test that the score_samples method is implemented on a pipeline.,0
Test that the score_samples method on pipeline yields same results as,0
applying transform and score_samples steps separately.,0
Check the shapes,0
Check the values,0
Test that a pipeline does not have score_samples method when the final,0
step of the pipeline does not have score_samples defined.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: remove in 0.6,1
trigger our checks if this is a SamplerMixin,0
scikit-learn common tests,0
should raise warning if the target is continuous (we cannot raise error),0
FIXME: in 0.6 set the random_state for all,1
if the target is multilabel then we should raise an error,0
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
FIXME remove in 0.6 -> ratio will be deprecated,1
in this test we will force all samplers to not change the class 1,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
FIXME: in 0.6 set the random_state for all,1
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: in 0.6 set the random_state for all,1
Check that multiclass target lead to the same results than OVA encoding,0
FIXME: in 0.6 set the random_state for all,1
Cast X and y to not default dtype,0
FIXME: in 0.6 set the random_state for all,1
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
FIXME: Turn into an error in 0.6,1
clean-sampling can be more permissive since those samplers do not,0
use samples,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
Author: Alexander L. Hayes <hayesall@iu.edu>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is 1,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check if default job count is 1,0
Check if job count is set,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ensemble are a bit specific since they are returning an array of,0
resampled arrays.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a sampling_strategy,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME remove ratio at 0.6,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check an error is raised with we don't pass sampling_strategy and ratio,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
flag for keras sequence duck-typing,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
pngmath / imgmath compatibility layer for different sphinx versions,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{m}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
FIXME: remove in 0.6,1
FIXME: remove in 0.6,1
both ratio and sampling_strategy should not be set,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib < 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: remove in 0.6,1
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: rename _sample -> _fit_resample in 0.6,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: rename _sample -> _fit_resample in 0.6,1
"FIXME: In 0.6, SMOTE should inherit only from BaseSMOTE.",1
FIXME: in 0.6 call super(),1
FIXME: in 0.6 call super(),1
FIXME: remove in 0.6 after deprecation cycle,1
FIXME: to be removed in 0.6,1
FIXME: uncomment in version 0.6,1
self._validate_estimator(),0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
"To avoid conversion and since there is only few samples used, we",0
convert those samples to dense array.,0
tie breaking argmax,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
check for deprecated random_state,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
check for deprecated random_state,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: remove in 0.6,1
check that estimators treat dtype object as numeric if possible,0
trigger our checks if this is a SamplerMixin,0
monkey patch check_dtype_object for the sampler allowing strings,0
scikit-learn common tests,0
FIXME: in 0.6 set the random_state for all,1
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
FIXME remove in 0.6 -> ratio will be deprecated,1
in this test we will force all samplers to not change the class 1,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
FIXME: in 0.6 set the random_state for all,1
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: in 0.6 set the random_state for all,1
Check that multiclass target lead to the same results than OVA encoding,0
FIXME: in 0.6 set the random_state for all,1
Cast X and y to not default dtype,0
FIXME: in 0.6 set the random_state for all,1
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
FIXME: Turn into an error in 0.6,1
clean-sampling can be more permissive since those samplers do not,0
use samples,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ensemble are a bit specific since they are returning an array of,0
resampled arrays.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a sampling_strategy,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME remove ratio at 0.6,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check an error is raised with we don't pass sampling_strategy and ratio,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
pngmath / imgmath compatibility layer for different sphinx versions,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{m}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
FIXME: remove in 0.6,1
FIXME: remove in 0.6,1
both ratio and sampling_strategy should not be set,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib < 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: remove in 0.6,1
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: rename _sample -> _fit_resample in 0.6,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: rename _sample -> _fit_resample in 0.6,1
"FIXME: In 0.6, SMOTE should inherit only from BaseSMOTE.",1
FIXME: in 0.6 call super(),1
FIXME: in 0.6 call super(),1
FIXME: remove in 0.6 after deprecation cycle,1
FIXME: to be removed in 0.6,1
FIXME: uncomment in version 0.6,1
self._validate_estimator(),0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
"To avoid conversion and since there is only few samples used, we",0
convert those samples to dense array.,0
tie breaking argmax,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
check for deprecated random_state,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
check for deprecated random_state,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: remove in 0.6,1
check that estimators treat dtype object as numeric if possible,0
trigger our checks if this is a SamplerMixin,0
monkey patch check_dtype_object for the sampler allowing strings,0
scikit-learn common tests,0
FIXME: in 0.6 set the random_state for all,1
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
FIXME remove in 0.6 -> ratio will be deprecated,1
in this test we will force all samplers to not change the class 1,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
FIXME: in 0.6 set the random_state for all,1
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: in 0.6 set the random_state for all,1
Check that multiclass target lead to the same results than OVA encoding,0
FIXME: in 0.6 set the random_state for all,1
Cast X and y to not default dtype,0
FIXME: in 0.6 set the random_state for all,1
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
FIXME: Turn into an error in 0.6,1
clean-sampling can be more permissive since those samplers do not,0
use samples,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ensemble are a bit specific since they are returning an array of,0
resampled arrays.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a sampling_strategy,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME remove ratio at 0.6,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check an error is raised with we don't pass sampling_strategy and ratio,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
pngmath / imgmath compatibility layer for different sphinx versions,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{m}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
FIXME: remove in 0.6,1
FIXME: remove in 0.6,1
both ratio and sampling_strategy should not be set,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib < 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: remove in 0.6,1
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: rename _sample -> _fit_resample in 0.6,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: rename _sample -> _fit_resample in 0.6,1
"FIXME: In 0.6, SMOTE should inherit only from BaseSMOTE.",1
FIXME: in 0.6 call super(),1
FIXME: in 0.6 call super(),1
FIXME: remove in 0.6 after deprecation cycle,1
FIXME: to be removed in 0.6,1
FIXME: uncomment in version 0.6,1
self._validate_estimator(),0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
"To avoid conversion and since there is only few samples used, we",0
convert those samples to dense array.,0
tie breaking argmax,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
check for deprecated random_state,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
check for deprecated random_state,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: remove in 0.6,1
check that estimators treat dtype object as numeric if possible,0
trigger our checks if this is a SamplerMixin,0
monkey patch check_dtype_object for the sampler allowing strings,0
scikit-learn common tests,0
FIXME: in 0.6 set the random_state for all,1
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
FIXME remove in 0.6 -> ratio will be deprecated,1
in this test we will force all samplers to not change the class 1,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
FIXME: in 0.6 set the random_state for all,1
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: in 0.6 set the random_state for all,1
Check that multiclass target lead to the same results than OVA encoding,0
FIXME: in 0.6 set the random_state for all,1
Cast X and y to not default dtype,0
FIXME: in 0.6 set the random_state for all,1
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
FIXME: Turn into an error in 0.6,1
clean-sampling can be more permissive since those samplers do not,0
use samples,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ensemble are a bit specific since they are returning an array of,0
resampled arrays.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a sampling_strategy,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME remove ratio at 0.6,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check an error is raised with we don't pass sampling_strategy and ratio,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
This file is here so that when running from the root folder,0
./sklearn is added to sys.path by pytest.,0
See https://docs.pytest.org/en/latest/pythonpath.html for more details.,0
"For example, this allows to build extensions in place and run pytest",0
doc/modules/clustering.rst and use sklearn from the local folder,0
rather than the one from site-packages.,0
Set numpy array str/repr to legacy behaviour on numpy > 1.13 to make,0
the doctests pass,0
! /usr/bin/env python,0
get __version__ from _version.py,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
this is needed for some reason...,0
see https://github.com/numpy/numpydoc/issues/69,0
pngmath / imgmath compatibility layer for different sphinx versions,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plot for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
intersphinx configuration,0
sphinx-gallery configuration,0
-- Options for manual page output ---------------------------------------,0
"If false, no module index is generated.",0
latex_domain_indices = True,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"def generate_example_rst(app, what, name, obj, options, lines):",0
"# generate empty examples files, so that we don't get",0
# inclusion errors if there are no examples for a class / module,0
"examples_path = os.path.join(app.srcdir, ""generated"",",0
"""%s.examples"" % name)",0
if not os.path.exists(examples_path):,0
# touch file,0
"open(examples_path, 'w').close()",0
Config for sphinx_issues,0
"app.connect('autodoc-process-docstring', generate_example_rst)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
"First, we will create an imbalanced data set from a the iris data set.",0
##############################################################################,0
Using ``sampling_strategy`` in resampling algorithms,0
##############################################################################,0
##############################################################################,0
``sampling_strategy`` as a ``float``,0
....................................,0
,0
``sampling_strategy`` can be given a ``float``. For **under-sampling,0
"methods**, it corresponds to the ratio :math:`\\alpha_{us}` defined by",0
:math:`N_{rM} = \\alpha_{us} \\times N_{m}` where :math:`N_{rM}` and,0
:math:`N_{m}` are the number of samples in the majority class after,0
"resampling and the number of samples in the minority class, respectively.",0
select only 2 classes since the ratio make sense in this case,0
##############################################################################,0
"For **over-sampling methods**, it correspond to the ratio",0
:math:`\\alpha_{os}` defined by :math:`N_{rm} = \\alpha_{os} \\times N_{m}`,0
where :math:`N_{rm}` and :math:`N_{M}` are the number of samples in the,0
minority class after resampling and the number of samples in the majority,0
"class, respectively.",0
##############################################################################,0
``sampling_strategy`` has a ``str``,0
...................................,0
,0
``sampling_strategy`` can be given as a string which specify the class,0
"targeted by the resampling. With under- and over-sampling, the number of",0
samples will be equalized.,0
,0
Note that we are using multiple classes from now on.,0
##############################################################################,0
"With **cleaning method**, the number of samples in each class will not be",0
equalized even if targeted.,0
##############################################################################,0
``sampling_strategy`` as a ``dict``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``dict``, the keys correspond to the targeted",0
classes. The values correspond to the desired number of samples for each,0
targeted class. This is working for both **under- and over-sampling**,0
algorithms but not for the **cleaning algorithms**. Use a ``list`` instead.,0
##############################################################################,0
``sampling_strategy`` as a ``list``,0
...................................,0
,0
"When ``sampling_strategy`` is a ``list``, the list contains the targeted",0
classes. It is used only for **cleaning methods** and raise an error,0
otherwise.,0
##############################################################################,0
``sampling_strategy`` as a callable,0
...................................,0
,0
"When callable, function taking ``y`` and returns a ``dict``. The keys",0
correspond to the targeted classes. The values correspond to the desired,0
number of samples for each class.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
#############################################################################,0
Toy data generation,0
#############################################################################,0
#############################################################################,0
We are generating some non Gaussian data set contaminated with some unform,0
noise.,0
#############################################################################,0
We will generate some cleaned test data without outliers.,0
#############################################################################,0
How to use the :class:`imblearn.FunctionSampler`,0
#############################################################################,0
#############################################################################,0
We first define a function which will use,0
:class:`sklearn.ensemble.IsolationForest` to eliminate some outliers from,0
our dataset during training. The function passed to the,0
:class:`imblearn.FunctionSampler` will be called when using the method,0
``fit_resample``.,0
#############################################################################,0
Integrate it within a pipeline,0
#############################################################################,0
#############################################################################,0
"By elimnating outliers before the training, the classifier will be less",0
affected during the prediction.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
##############################################################################,0
"When dealing with a mixed of continuous and categorical features, SMOTE-NC",0
is the only method which can handle this case.,0
create a synthetic data set with continuous and categorical features,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Load an imbalanced dataset,0
##############################################################################,0
We will load the UCI SatImage dataset which has an imbalanced ratio of 9.3:1,0
(number of majority sample for a minority sample). The data are then split,0
into training and testing.,0
##############################################################################,0
Classification using a single decision tree,0
##############################################################################,0
We train a decision tree classifier which will be used as a baseline for the,0
rest of this example.,0
##############################################################################,0
The results are reported in terms of balanced accuracy and geometric mean,0
which are metrics widely used in the literature to validate model trained on,0
imbalanced set.,0
##############################################################################,0
Classification using bagging classifier with and without sampling,0
##############################################################################,0
"Instead of using a single tree, we will check if an ensemble of decsion tree",0
"can actually alleviate the issue induced by the class imbalancing. First, we",0
will use a bagging classifier and its counter part which internally uses a,0
random under-sampling to balanced each boostrap sample.,0
##############################################################################,0
Balancing each bootstrap sample allows to increase significantly the balanced,0
accuracy and the geometric mean.,0
##############################################################################,0
Classification using random forest classifier with and without sampling,0
##############################################################################,0
Random forest is another popular ensemble method and it is usually,0
"outperforming bagging. Here, we used a vanilla random forest and its balanced",0
counterpart in which each bootstrap sample is balanced.,0
"Similarly to the previous experiment, the balanced classifier outperform the",0
"classifier which learn from imbalanced bootstrap samples. In addition, random",0
forest outsperforms the bagging classifier.,0
##############################################################################,0
Boosting classifier,0
##############################################################################,0
"In the same manner, easy ensemble classifier is a bag of balanced AdaBoost",0
"classifier. However, it will be slower to train than random forest and will",0
achieve worse performance.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``sampling_strategy='auto'`` only the sample from the majority,0
class will be removed. If ``sampling_strategy='all'`` both samples will be,0
removed.,0
highlight the samples of interest,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Data loading,0
##############################################################################,0
##############################################################################,0
"First, you should download the Porto Seguro data set from Kaggle. See the",0
link in the introduction.,0
##############################################################################,0
The data set is imbalanced and it will have an effect on the fitting.,0
##############################################################################,0
Define the pre-processing pipeline,0
##############################################################################,0
##############################################################################,0
We want to standard scale the numerical features while we want to one-hot,0
"encode the categorical features. In this regard, we make use of the",0
:class:`sklearn.compose.ColumnTransformer`.,0
Create an environment variable to avoid using the GPU. This can be changed.,0
##############################################################################,0
Create a neural-network,0
##############################################################################,0
##############################################################################,0
We create a decorator to report the computation time,0
##############################################################################,0
The first model will be trained using the ``fit`` method and with imbalanced,0
mini-batches.,0
##############################################################################,0
"In the contrary, we will use imbalanced-learn to create a generator of",0
mini-batches which will yield balanced mini-batches.,0
##############################################################################,0
Classification loop,0
##############################################################################,0
##############################################################################,0
We will perform a 10-fold cross-validation and train the neural-network with,0
the two different strategies previously presented.,0
##############################################################################,0
Plot of the results and computation time,0
##############################################################################,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
define an alias for back-compatibility,0
FIXME: remove in 0.6,1
FIXME: remove in 0.6,1
both ratio and sampling_strategy should not be set,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
joblib >= 0.12,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
joblib < 0.11,0
we do not clone when caching is disabled to,0
preserve backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
FIXME: remove in 0.6,1
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
FIXME: rename _sample -> _fit_resample in 0.6,1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
FIXME: rename _sample -> _fit_resample in 0.6,1
"FIXME: In 0.6, SMOTE should inherit only from BaseSMOTE.",1
FIXME: in 0.6 call super(),1
FIXME: in 0.6 call super(),1
FIXME: remove in 0.6 after deprecation cycle,1
FIXME: to be removed in 0.6,1
FIXME: uncomment in version 0.6,1
self._validate_estimator(),0
compute the median of the standard deviation of the minority class,0
the input of the OneHotEncoder needs to be dense,0
we can replace the 1 entries of the categorical features with the,0
median of the standard deviation. It will ensure that whenever,0
"distance is computed between 2 samples, the difference will be equal",0
to the median of the standard deviation as in the original paper.,0
reverse the encoding of the categorical features,0
the matrix is supposed to be in the CSR format after the stacking,0
"To avoid conversion and since there is only few samples used, we",0
convert those samples to dense array.,0
tie breaking argmax,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
Dzianis Dudnik,0
License: MIT,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
return the categories,0
create 2 random continuous feature,0
create a categorical feature using some string,0
create a categorical feature using some integer,0
part of the common test which apply to SMOTE-NC even if it is not default,0
constructible,0
Check that the samplers handle pandas dataframe and pandas series,0
Cast X and y to not default dtype,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
helper functions,0
input and output,0
build the model and weights,0
"build the loss, predict, and train operator",0
Initialization of all variables in the graph,0
"For each epoch, run accuracy on train and test",0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
check for deprecated random_state,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
check for deprecated random_state,0
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
check for deprecated random_state,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1else:,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check for deprecated random_state,0
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
don't run twice the sampler tests. Meta-estimator do not have a,0
fit_resample method.,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
tests that Pipeline passes predict_params to the final estimator,0
when predict is invoked,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: remove in 0.6,1
check that estimators treat dtype object as numeric if possible,0
trigger our checks if this is a SamplerMixin,0
monkey patch check_dtype_object for the sampler allowing strings,0
scikit-learn common tests,0
FIXME: in 0.6 set the random_state for all,1
IHT does not enforce the number of samples but provide a number,0
of samples the closest to the desired target.,0
FIXME remove in 0.6 -> ratio will be deprecated,1
in this test we will force all samplers to not change the class 1,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
FIXME: in 0.6 set the random_state for all,1
Check that the samplers handle pandas dataframe and pandas series,0
FIXME: in 0.6 set the random_state for all,1
Check that multiclass target lead to the same results than OVA encoding,0
FIXME: in 0.6 set the random_state for all,1
Cast X and y to not default dtype,0
FIXME: in 0.6 set the random_state for all,1
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in sampling_strategy are also in y,0
check that there is no negative number,0
FIXME: Turn into an error in 0.6,1
clean-sampling can be more permissive since those samplers do not,0
use samples,0
check that all keys in sampling_strategy are also in y,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
We pass on purpose a non sorted dictionary and check that the resulting,0
dictionary is sorted. Refer to issue #428.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Otherwise create a default SMOTE,0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
resample before to fit the tree,0
Validate or convert input data,0
Pre-sort indices to avoid that each individual tree of the,0
ensemble sorts the indices.,0
Remap output,0
reshape is necessary to preserve the data contiguity against vs,0
"[:, np.newaxis] that does not.",0
Check parameters,0
"Free allocated memory, if any",0
We draw from the random state to get the random state we,0
would have got if we hadn't used a warm_start.,0
Parallel loop: we prefer the threading backend as the Cython code,0
for fitting the trees is internally releasing the Python GIL,0
making threading more efficient than multiprocessing in,0
"that case. However, we respect any parallel_backend contexts set",0
"at a higher level, since correctness does not rely on using",0
threads.,0
Collect newly grown trees,0
Create pipeline with the fitted samplers and trees,0
Decapsulate classes_ attributes,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Construct y coding as described in Zhu et al [2]:,0
,0
y_k = 1 if c == k else -1 / (K - 1),0
,0
"where K == n_classes_ and c, k in [0, K) are indices along the second",0
axis of the y coding with c being the index corresponding to the true,0
class label.,0
Displace zero probabilities so the log is defined.,0
Also fix negative elements which may occur with,0
negative sample weights.,0
Boost weight using multi-class AdaBoost SAMME.R alg,0
Only boost the weights if it will fit again,0
Only boost positive weights,0
Instances incorrectly classified,0
Error fraction,0
Stop if classification is perfect,0
Stop if the error is at least as bad as random guessing,0
Boost weight using multi-class AdaBoost SAMME alg,0
Only boost the weights if I will fit again,0
Only boost positive weights,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Ensemble are a bit specific since they are returning an array of,0
resampled arrays.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
check that we have an ensemble of samplers and estimators with a,0
consistent size,0
each sampler in the ensemble should have different random state,0
each estimator in the ensemble should have different random state,0
check the consistency of the feature importances,0
check the consistency of the prediction outpus,0
Predictions should be the same when sample_weight are all ones,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a sampling_strategy,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Define the sampling_strategy parameter,0
Create the sampling object,0
Get the different subset,0
Check classification for various parameter settings.,0
test the different prediction function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check warning if not enough estimators,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME remove ratio at 0.6,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check an error is raised with we don't pass sampling_strategy and ratio,0
"we are reusing part of utils.check_sampling_strategy, however this is not",0
cover in the common tests so we will repeat it here,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
This is a trick to avoid an error during tests collection with pytest. We,0
avoid the error when importing the package raise the error at the moment of,0
creating the instance.,0
FIXME: Remove in 0.6,1
shuffle the indices since the sampler are packing them by class,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
If extensions (or modules to document with autodoc) are in another,0
"directory, add these directories to sys.path here. If the directory",0
"is relative to the documentation root, use os.path.abspath to make it",0
"absolute, like shown here.",0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
to make references clickable,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Config for sphinx_issues,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Creation of an imbalanced data set from a balanced data set,0
##############################################################################,0
##############################################################################,0
We will show how to use the parameter ``ratio`` when dealing with the,0
"``make_imbalance`` function. For this function, this parameter accepts both",0
"dictionary and callable. When using a dictionary, each key will correspond to",0
the class of interest and the corresponding value will be the number of,0
samples desired in this class.,0
##############################################################################,0
You might required more flexibility and require your own heuristic to,0
determine the number of samples by class and you can define your own callable,0
as follow. In this case we will define a function which will use a float,0
multiplier to define the number of samples per class.,0
##############################################################################,0
Using ``ratio`` in resampling algorithm,0
##############################################################################,0
##############################################################################,0
"In all sampling algorithms, ``ratio`` can be used as illustrated earlier. In",0
"addition, some predefined functions are available and can be executed using a",0
``str`` with the following choices: (i) ``'minority'``: resample the minority,0
"class; (ii) ``'majority'``: resample the majority class, (iii) ``'not",0
"minority'``: resample all classes apart of the minority class, (iv)",0
"``'all'``: resample all classes, and (v) ``'auto'``: correspond to 'all' with",0
for over-sampling methods and 'not minority' for under-sampling methods. The,0
classes targeted will be over-sampled or under-sampled to achieve an equal,0
number of sample with the majority or minority class.,0
##############################################################################,0
"However, you can use the dictionary or the callable options as previously",0
mentioned.,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Remove axis for second plot,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Turning the balanced bagging classifier into a balanced random forest,0
##############################################################################,0
It is possible to turn the ``BalancedBaggingClassifier`` into a balanced,0
random forest by using a ``DecisionTreeClassifier`` with,0
``max_features='auto'``. We illustrate such changes below.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Andreas Mueller,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
remove Tomek links,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss,0
"Two subplots, unpack the axes array immediately",0
plot the missing samples,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
make nice plotting,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
Use hard voting instead of soft voting,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``ratio='auto'`` only the sample from the majority class will be,0
removed. If ``ratio='all'`` both samples will be removed.,0
highlight the samples of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
plot samples which have been removed,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check the consistency of X and y,0
self.sampling_type is already checked in check_ratio,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
we do not clone when caching is disabled to preserve,0
backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
XXX: Calling sample in pipeline it means that the,1
last estimator is a sampler. Samplers don't carry,0
"the sampled data. So, call 'fit_sample' in all intermediate",0
steps to get the sampled data for the last estimator.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
No average: zeros in array,0
Macro average is changed,0
Check for micro,0
Check for weighted,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
Compute the geometric mean for each of the classes,0
average tests,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Get the version,0
sensitivity scorer,0
specificity scorer,0
geometric_mean scorer,0
make a iba metric before a scorer,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
"FIXME Deprecated in 0.2, to be removed in 0.4",1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated from 0.2. To be removed in 0.4.,1
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
To be removed in 0.4,0
Select the appropriate classifier,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME remove at the end of the deprecation 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
some can just not be sensibly default constructed,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
make the checks from scikit-learn,0
trigger our checks if this is a SamplerMixin,0
FIXME already present in scikit-learn 0.19,1
test scikit-learn compatibility,0
Estimators in mono_output_task_error raise ValueError if y is of 1-D,0
Convert into a 2-D y for those estimators.,0
check that fit method only changes or sets private attributes,0
to not check deprecated classes,0
check that fit doesn't add any public attribute,0
check that fit doesn't change any public attribute,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in ratio are also in y,0
check that there is no negative number,0
clean-sampling can be more permissive since those samplers do not,0
use samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
"tests that the estimator actually fails on ""bad"" estimators.",0
"not a complete test of all checks, which are very extensive.",0
check that we have a set_params and can clone,0
check that we have a fit method,0
check that fit does input validation,0
check that predict does input validation (doesn't accept dicts in input),0
check that estimator state does not change,0
at transform/predict/predict_proba time,0
check that `fit` only changes attributes that,0
are private (start with an _ or end with a _).,0
check that `fit` doesn't add any public attribute,0
check for sparse matrix input handling,0
"the check for sparse input handling prints to the stdout,",0
"instead of raising an error, so as not to remove the original traceback.",0
that means we need to jump through some hoops to catch it.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
"If an object was given, affect",0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
To be removed in 0.4,0
Define the classifier to use,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
FIXME: uncomment when #9723 is merged in scikit-learn,1
def test_estimators_samples():,0
# Check that format of estimators_samples_ is correct and that results,0
# generated at fit time can be identically reproduced at a later time,0
# using data saved in object attributes.,0
"X, y = make_hastie_10_2(n_samples=200, random_state=1)",0
# remap the y outside of the BalancedBaggingclassifier,0
"# _, y = np.unique(y, return_inverse=True)",0
"bagging = BalancedBaggingClassifier(LogisticRegression(),",0
"max_samples=0.5,",0
"max_features=0.5, random_state=1,",0
bootstrap=False),0
"bagging.fit(X, y)",0
# Get relevant attributes,0
estimators_samples = bagging.estimators_samples_,0
estimators_features = bagging.estimators_features_,0
estimators = bagging.estimators_,0
# Test for correct formatting,0
assert len(estimators_samples) == len(estimators),0
assert len(estimators_samples[0]) == len(X),0
assert estimators_samples[0].dtype.kind == 'b',0
# Re-fit single estimator to test for consistent sampling,0
estimator_index = 0,0
estimator_samples = estimators_samples[estimator_index],0
estimator_features = estimators_features[estimator_index],0
estimator = estimators[estimator_index],0
"X_train = (X[estimator_samples])[:, estimator_features]",0
y_train = y[estimator_samples],0
orig_coefs = estimator.steps[-1][1].coef_,0
"estimator.fit(X_train, y_train)",0
new_coefs = estimator.steps[-1][1].coef_,0
"assert_array_almost_equal(orig_coefs, new_coefs)",0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a ratio,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME: deprecated in 0.2 to be removed in 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_ratio, however this is not cover in",0
the common tests so we will repeat it here,0
FIXME: to be removed in 0.4 due to deprecation,1
resample without using min_c_,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
If extensions (or modules to document with autodoc) are in another,0
"directory, add these directories to sys.path here. If the directory",0
"is relative to the documentation root, use os.path.abspath to make it",0
"absolute, like shown here.",0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
to make references clickable,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Config for sphinx_issues,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Creation of an imbalanced data set from a balanced data set,0
##############################################################################,0
##############################################################################,0
We will show how to use the parameter ``ratio`` when dealing with the,0
"``make_imbalance`` function. For this function, this parameter accepts both",0
"dictionary and callable. When using a dictionary, each key will correspond to",0
the class of interest and the corresponding value will be the number of,0
samples desired in this class.,0
##############################################################################,0
You might required more flexibility and require your own heuristic to,0
determine the number of samples by class and you can define your own callable,0
as follow. In this case we will define a function which will use a float,0
multiplier to define the number of samples per class.,0
##############################################################################,0
Using ``ratio`` in resampling algorithm,0
##############################################################################,0
##############################################################################,0
"In all sampling algorithms, ``ratio`` can be used as illustrated earlier. In",0
"addition, some predefined functions are available and can be executed using a",0
``str`` with the following choices: (i) ``'minority'``: resample the minority,0
"class; (ii) ``'majority'``: resample the majority class, (iii) ``'not",0
"minority'``: resample all classes apart of the minority class, (iv)",0
"``'all'``: resample all classes, and (v) ``'auto'``: correspond to 'all' with",0
for over-sampling methods and 'not minority' for under-sampling methods. The,0
classes targeted will be over-sampled or under-sampled to achieve an equal,0
number of sample with the majority or minority class.,0
##############################################################################,0
"However, you can use the dictionary or the callable options as previously",0
mentioned.,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Remove axis for second plot,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Turning the balanced bagging classifier into a balanced random forest,0
##############################################################################,0
It is possible to turn the ``BalancedBaggingClassifier`` into a balanced,0
random forest by using a ``DecisionTreeClassifier`` with,0
``max_features='auto'``. We illustrate such changes below.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Andreas Mueller,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
remove Tomek links,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss,0
"Two subplots, unpack the axes array immediately",0
plot the missing samples,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
make nice plotting,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
Use hard voting instead of soft voting,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``ratio='auto'`` only the sample from the majority class will be,0
removed. If ``ratio='all'`` both samples will be removed.,0
highlight the samples of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
plot samples which have been removed,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check the consistency of X and y,0
self.sampling_type is already checked in check_ratio,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
we do not clone when caching is disabled to preserve,0
backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
XXX: Calling sample in pipeline it means that the,1
last estimator is a sampler. Samplers don't carry,0
"the sampled data. So, call 'fit_sample' in all intermediate",0
steps to get the sampled data for the last estimator.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
No average: zeros in array,0
Macro average is changed,0
Check for micro,0
Check for weighted,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
Compute the geometric mean for each of the classes,0
average tests,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Get the version,0
sensitivity scorer,0
specificity scorer,0
geometric_mean scorer,0
make a iba metric before a scorer,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
"FIXME Deprecated in 0.2, to be removed in 0.4",1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated from 0.2. To be removed in 0.4.,1
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
To be removed in 0.4,0
Select the appropriate classifier,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME remove at the end of the deprecation 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
some can just not be sensibly default constructed,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
make the checks from scikit-learn,0
trigger our checks if this is a SamplerMixin,0
FIXME already present in scikit-learn 0.19,1
test scikit-learn compatibility,0
Estimators in mono_output_task_error raise ValueError if y is of 1-D,0
Convert into a 2-D y for those estimators.,0
check that fit method only changes or sets private attributes,0
to not check deprecated classes,0
check that fit doesn't add any public attribute,0
check that fit doesn't change any public attribute,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in ratio are also in y,0
check that there is no negative number,0
clean-sampling can be more permissive since those samplers do not,0
use samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
"tests that the estimator actually fails on ""bad"" estimators.",0
"not a complete test of all checks, which are very extensive.",0
check that we have a set_params and can clone,0
check that we have a fit method,0
check that fit does input validation,0
check that predict does input validation (doesn't accept dicts in input),0
check that estimator state does not change,0
at transform/predict/predict_proba time,0
check that `fit` only changes attributes that,0
are private (start with an _ or end with a _).,0
check that `fit` doesn't add any public attribute,0
check for sparse matrix input handling,0
"the check for sparse input handling prints to the stdout,",0
"instead of raising an error, so as not to remove the original traceback.",0
that means we need to jump through some hoops to catch it.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
"If an object was given, affect",0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
To be removed in 0.4,0
Define the classifier to use,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
FIXME: uncomment when #9723 is merged in scikit-learn,1
def test_estimators_samples():,0
# Check that format of estimators_samples_ is correct and that results,0
# generated at fit time can be identically reproduced at a later time,0
# using data saved in object attributes.,0
"X, y = make_hastie_10_2(n_samples=200, random_state=1)",0
# remap the y outside of the BalancedBaggingclassifier,0
"# _, y = np.unique(y, return_inverse=True)",0
"bagging = BalancedBaggingClassifier(LogisticRegression(),",0
"max_samples=0.5,",0
"max_features=0.5, random_state=1,",0
bootstrap=False),0
"bagging.fit(X, y)",0
# Get relevant attributes,0
estimators_samples = bagging.estimators_samples_,0
estimators_features = bagging.estimators_features_,0
estimators = bagging.estimators_,0
# Test for correct formatting,0
assert len(estimators_samples) == len(estimators),0
assert len(estimators_samples[0]) == len(X),0
assert estimators_samples[0].dtype.kind == 'b',0
# Re-fit single estimator to test for consistent sampling,0
estimator_index = 0,0
estimator_samples = estimators_samples[estimator_index],0
estimator_features = estimators_features[estimator_index],0
estimator = estimators[estimator_index],0
"X_train = (X[estimator_samples])[:, estimator_features]",0
y_train = y[estimator_samples],0
orig_coefs = estimator.steps[-1][1].coef_,0
"estimator.fit(X_train, y_train)",0
new_coefs = estimator.steps[-1][1].coef_,0
"assert_array_almost_equal(orig_coefs, new_coefs)",0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a ratio,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME: deprecated in 0.2 to be removed in 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_ratio, however this is not cover in",0
the common tests so we will repeat it here,0
FIXME: to be removed in 0.4 due to deprecation,1
resample without using min_c_,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
If extensions (or modules to document with autodoc) are in another,0
"directory, add these directories to sys.path here. If the directory",0
"is relative to the documentation root, use os.path.abspath to make it",0
"absolute, like shown here.",0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
to make references clickable,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Config for sphinx_issues,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Creation of an imbalanced data set from a balanced data set,0
##############################################################################,0
##############################################################################,0
We will show how to use the parameter ``ratio`` when dealing with the,0
"``make_imbalance`` function. For this function, this parameter accepts both",0
"dictionary and callable. When using a dictionary, each key will correspond to",0
the class of interest and the corresponding value will be the number of,0
samples desired in this class.,0
##############################################################################,0
You might required more flexibility and require your own heuristic to,0
determine the number of samples by class and you can define your own callable,0
as follow. In this case we will define a function which will use a float,0
multiplier to define the number of samples per class.,0
##############################################################################,0
Using ``ratio`` in resampling algorithm,0
##############################################################################,0
##############################################################################,0
"In all sampling algorithms, ``ratio`` can be used as illustrated earlier. In",0
"addition, some predefined functions are available and can be executed using a",0
``str`` with the following choices: (i) ``'minority'``: resample the minority,0
"class; (ii) ``'majority'``: resample the majority class, (iii) ``'not",0
"minority'``: resample all classes apart of the minority class, (iv)",0
"``'all'``: resample all classes, and (v) ``'auto'``: correspond to 'all' with",0
for over-sampling methods and 'not minority' for under-sampling methods. The,0
classes targeted will be over-sampled or under-sampled to achieve an equal,0
number of sample with the majority or minority class.,0
##############################################################################,0
"However, you can use the dictionary or the callable options as previously",0
mentioned.,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Remove axis for second plot,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Turning the balanced bagging classifier into a balanced random forest,0
##############################################################################,0
It is possible to turn the ``BalancedBaggingClassifier`` into a balanced,0
random forest by using a ``DecisionTreeClassifier`` with,0
``max_features='auto'``. We illustrate such changes below.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Andreas Mueller,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
remove Tomek links,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss,0
"Two subplots, unpack the axes array immediately",0
plot the missing samples,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
make nice plotting,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
Use hard voting instead of soft voting,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``ratio='auto'`` only the sample from the majority class will be,0
removed. If ``ratio='all'`` both samples will be removed.,0
highlight the samples of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
plot samples which have been removed,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check the consistency of X and y,0
self.sampling_type is already checked in check_ratio,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
we do not clone when caching is disabled to preserve,0
backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
XXX: Calling sample in pipeline it means that the,1
last estimator is a sampler. Samplers don't carry,0
"the sampled data. So, call 'fit_sample' in all intermediate",0
steps to get the sampled data for the last estimator.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
No average: zeros in array,0
Macro average is changed,0
Check for micro,0
Check for weighted,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
Compute the geometric mean for each of the classes,0
average tests,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Get the version,0
sensitivity scorer,0
specificity scorer,0
geometric_mean scorer,0
make a iba metric before a scorer,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
"FIXME Deprecated in 0.2, to be removed in 0.4",1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated from 0.2. To be removed in 0.4.,1
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
To be removed in 0.4,0
Select the appropriate classifier,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME remove at the end of the deprecation 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
some can just not be sensibly default constructed,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
make the checks from scikit-learn,0
trigger our checks if this is a SamplerMixin,0
FIXME already present in scikit-learn 0.19,1
test scikit-learn compatibility,0
Estimators in mono_output_task_error raise ValueError if y is of 1-D,0
Convert into a 2-D y for those estimators.,0
check that fit method only changes or sets private attributes,0
to not check deprecated classes,0
check that fit doesn't add any public attribute,0
check that fit doesn't change any public attribute,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in ratio are also in y,0
check that there is no negative number,0
clean-sampling can be more permissive since those samplers do not,0
use samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
"tests that the estimator actually fails on ""bad"" estimators.",0
"not a complete test of all checks, which are very extensive.",0
check that we have a set_params and can clone,0
check that we have a fit method,0
check that fit does input validation,0
check that predict does input validation (doesn't accept dicts in input),0
check that estimator state does not change,0
at transform/predict/predict_proba time,0
check that `fit` only changes attributes that,0
are private (start with an _ or end with a _).,0
check that `fit` doesn't add any public attribute,0
check for sparse matrix input handling,0
"the check for sparse input handling prints to the stdout,",0
"instead of raising an error, so as not to remove the original traceback.",0
that means we need to jump through some hoops to catch it.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
"If an object was given, affect",0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
To be removed in 0.4,0
Define the classifier to use,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
FIXME: uncomment when #9723 is merged in scikit-learn,1
def test_estimators_samples():,0
# Check that format of estimators_samples_ is correct and that results,0
# generated at fit time can be identically reproduced at a later time,0
# using data saved in object attributes.,0
"X, y = make_hastie_10_2(n_samples=200, random_state=1)",0
# remap the y outside of the BalancedBaggingclassifier,0
"# _, y = np.unique(y, return_inverse=True)",0
"bagging = BalancedBaggingClassifier(LogisticRegression(),",0
"max_samples=0.5,",0
"max_features=0.5, random_state=1,",0
bootstrap=False),0
"bagging.fit(X, y)",0
# Get relevant attributes,0
estimators_samples = bagging.estimators_samples_,0
estimators_features = bagging.estimators_features_,0
estimators = bagging.estimators_,0
# Test for correct formatting,0
assert len(estimators_samples) == len(estimators),0
assert len(estimators_samples[0]) == len(X),0
assert estimators_samples[0].dtype.kind == 'b',0
# Re-fit single estimator to test for consistent sampling,0
estimator_index = 0,0
estimator_samples = estimators_samples[estimator_index],0
estimator_features = estimators_features[estimator_index],0
estimator = estimators[estimator_index],0
"X_train = (X[estimator_samples])[:, estimator_features]",0
y_train = y[estimator_samples],0
orig_coefs = estimator.steps[-1][1].coef_,0
"estimator.fit(X_train, y_train)",0
new_coefs = estimator.steps[-1][1].coef_,0
"assert_array_almost_equal(orig_coefs, new_coefs)",0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a ratio,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME: deprecated in 0.2 to be removed in 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_ratio, however this is not cover in",0
the common tests so we will repeat it here,0
FIXME: to be removed in 0.4 due to deprecation,1
resample without using min_c_,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
If extensions (or modules to document with autodoc) are in another,0
"directory, add these directories to sys.path here. If the directory",0
"is relative to the documentation root, use os.path.abspath to make it",0
"absolute, like shown here.",0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
to make references clickable,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Config for sphinx_issues,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Creation of an imbalanced data set from a balanced data set,0
##############################################################################,0
##############################################################################,0
We will show how to use the parameter ``ratio`` when dealing with the,0
"``make_imbalance`` function. For this function, this parameter accepts both",0
"dictionary and callable. When using a dictionary, each key will correspond to",0
the class of interest and the corresponding value will be the number of,0
samples desired in this class.,0
##############################################################################,0
You might required more flexibility and require your own heuristic to,0
determine the number of samples by class and you can define your own callable,0
as follow. In this case we will define a function which will use a float,0
multiplier to define the number of samples per class.,0
##############################################################################,0
Using ``ratio`` in resampling algorithm,0
##############################################################################,0
##############################################################################,0
"In all sampling algorithms, ``ratio`` can be used as illustrated earlier. In",0
"addition, some predefined functions are available and can be executed using a",0
``str`` with the following choices: (i) ``'minority'``: resample the minority,0
"class; (ii) ``'majority'``: resample the majority class, (iii) ``'not",0
"minority'``: resample all classes apart of the minority class, (iv)",0
"``'all'``: resample all classes, and (v) ``'auto'``: correspond to 'all' with",0
for over-sampling methods and 'not minority' for under-sampling methods. The,0
classes targeted will be over-sampled or under-sampled to achieve an equal,0
number of sample with the majority or minority class.,0
##############################################################################,0
"However, you can use the dictionary or the callable options as previously",0
mentioned.,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Remove axis for second plot,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Andreas Mueller,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
remove Tomek links,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss,0
"Two subplots, unpack the axes array immediately",0
plot the missing samples,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
make nice plotting,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
Use hard voting instead of soft voting,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``ratio='auto'`` only the sample from the majority class will be,0
removed. If ``ratio='all'`` both samples will be removed.,0
highlight the samples of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
plot samples which have been removed,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check the consistency of X and y,0
self.sampling_type is already checked in check_ratio,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
we do not clone when caching is disabled to preserve,0
backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
XXX: Calling sample in pipeline it means that the,1
last estimator is a sampler. Samplers don't carry,0
"the sampled data. So, call 'fit_sample' in all intermediate",0
steps to get the sampled data for the last estimator.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
No average: zeros in array,0
Macro average is changed,0
Check for micro,0
Check for weighted,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
Compute the geometric mean for each of the classes,0
average tests,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Get the version,0
sensitivity scorer,0
specificity scorer,0
geometric_mean scorer,0
make a iba metric before a scorer,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
"FIXME Deprecated in 0.2, to be removed in 0.4",1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated from 0.2. To be removed in 0.4.,1
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
To be removed in 0.4,0
Select the appropriate classifier,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME remove at the end of the deprecation 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
some can just not be sensibly default constructed,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
make the checks from scikit-learn,0
trigger our checks if this is a SamplerMixin,0
FIXME already present in scikit-learn 0.19,1
test scikit-learn compatibility,0
Estimators in mono_output_task_error raise ValueError if y is of 1-D,0
Convert into a 2-D y for those estimators.,0
check that fit method only changes or sets private attributes,0
to not check deprecated classes,0
check that fit doesn't add any public attribute,0
check that fit doesn't change any public attribute,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in ratio are also in y,0
check that there is no negative number,0
clean-sampling can be more permissive since those samplers do not,0
use samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
"tests that the estimator actually fails on ""bad"" estimators.",0
"not a complete test of all checks, which are very extensive.",0
check that we have a set_params and can clone,0
check that we have a fit method,0
check that fit does input validation,0
check that predict does input validation (doesn't accept dicts in input),0
check that estimator state does not change,0
at transform/predict/predict_proba time,0
check that `fit` only changes attributes that,0
are private (start with an _ or end with a _).,0
check that `fit` doesn't add any public attribute,0
check for sparse matrix input handling,0
"the check for sparse input handling prints to the stdout,",0
"instead of raising an error, so as not to remove the original traceback.",0
that means we need to jump through some hoops to catch it.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
"If an object was given, affect",0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
To be removed in 0.4,0
Define the classifier to use,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a ratio,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME: deprecated in 0.2 to be removed in 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_ratio, however this is not cover in",0
the common tests so we will repeat it here,0
FIXME: to be removed in 0.4 due to deprecation,1
resample without using min_c_,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
If extensions (or modules to document with autodoc) are in another,0
"directory, add these directories to sys.path here. If the directory",0
"is relative to the documentation root, use os.path.abspath to make it",0
"absolute, like shown here.",0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
to make references clickable,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
Custom style,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {'prev_next_buttons_location': None},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Config for sphinx_issues,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
The following is used by sphinx.ext.linkcode to provide links to github,0
get the styles from the current theme,0
create and add the button to all the code blocks that contain >>>,0
tracebacks (.gt) contain bare text elements that need to be,0
wrapped in a span to work with .nextUntil() (see later),0
define the behavior of the button when it's clicked,0
hide the code output,0
show the code output,0
-*- coding: utf-8 -*-,0
Format template for issues URI,0
e.g. 'https://github.com/sloria/marshmallow/issues/{issue},0
"Shortcut for Github, e.g. 'sloria/marshmallow'",0
Format template for user profile URI,0
e.g. 'https://github.com/{user}',0
Python 2 only,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Creation of an imbalanced data set from a balanced data set,0
##############################################################################,0
##############################################################################,0
We will show how to use the parameter ``ratio`` when dealing with the,0
"``make_imbalance`` function. For this function, this parameter accepts both",0
"dictionary and callable. When using a dictionary, each key will correspond to",0
the class of interest and the corresponding value will be the number of,0
samples desired in this class.,0
##############################################################################,0
You might required more flexibility and require your own heuristic to,0
determine the number of samples by class and you can define your own callable,0
as follow. In this case we will define a function which will use a float,0
multiplier to define the number of samples per class.,0
##############################################################################,0
Using ``ratio`` in resampling algorithm,0
##############################################################################,0
##############################################################################,0
"In all sampling algorithms, ``ratio`` can be used as illustrated earlier. In",0
"addition, some predefined functions are available and can be executed using a",0
``str`` with the following choices: (i) ``'minority'``: resample the minority,0
"class; (ii) ``'majority'``: resample the majority class, (iii) ``'not",0
"minority'``: resample all classes apart of the minority class, (iv)",0
"``'all'``: resample all classes, and (v) ``'auto'``: correspond to 'all' with",0
for over-sampling methods and 'not minority' for under-sampling methods. The,0
classes targeted will be over-sampled or under-sampled to achieve an equal,0
number of sample with the majority or minority class.,0
##############################################################################,0
"However, you can use the dictionary or the callable options as previously",0
mentioned.,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Remove axis for second plot,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
generate some data points,0
plot the majority and minority samples,0
draw the circle in which the new sample will generated,0
plot the line on which the sample will be generated,0
create and plot the new sample,0
make the plot nicer with legend and label,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characterisitic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Illustration of the influence of the balancing ratio,0
##############################################################################,0
##############################################################################,0
We will first illustrate the influence of the balancing ratio on some toy,0
data using a linear SVM classifier. Greater is the difference between the,0
"number of samples in each class, poorer are the classfication results.",0
##############################################################################,0
Random over-sampling to balance the data set,0
##############################################################################,0
##############################################################################,0
Random over-sampling can be used to repeat some samples and balance the,0
number of samples between the dataset. It can be seen that with this trivial,0
approach the boundary decision is already less biaised toward the majority,0
class.,0
##############################################################################,0
More advanced over-sampling using ADASYN and SMOTE,0
##############################################################################,0
##############################################################################,0
"Instead of repeating the same samples when over-sampling, we can use some",0
specific heuristic instead. ADASYN and SMOTE can be used in this case.,0
Make an identity sampler,0
##############################################################################,0
The following plot illustrate the difference between ADASYN and SMOTE. ADASYN,0
will focus on the samples which are difficult to classify with a,0
nearest-neighbors rule while regular SMOTE will not make any distinction.,0
"Therefore, the decision function depending of the algorithm.",0
##############################################################################,0
"Due to those sampling particularities, it can give rise to some specific",0
issues as illustrated below.,0
##############################################################################,0
SMOTE proposes several variants by identifying specific samples to consider,0
during the resampling. The borderline version will detect which point to,0
select which are in the border between two classes. The SVM version will use,0
the support vectors found using an SVM algorithm to create new samples.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
"``SMOTE`` allows to generate samples. However, this method of over-sampling",0
"does not have any knowledge regarding the underlying distribution. Therefore,",0
"some noisy samples can be generated, e.g. when the different classes cannot",0
"be well separated. Hence, it can be beneficial to apply an under-sampling",0
algorithm to clean the noisy samples. Two methods are usually used in the,0
literature: (i) Tomek's link and (ii) edited nearest neighbours cleaning,0
methods. Imbalanced-learn provides two ready-to-use samplers ``SMOTETomek``,0
"and ``SMOTEENN``. In general, ``SMOTEENN`` cleans more noisy data than",0
``SMOTETomek``.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
Authors: Andreas Mueller,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
remove Tomek links,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss,0
"Two subplots, unpack the axes array immediately",0
plot the missing samples,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
make nice plotting,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
The following function will be used to create toy dataset. It using the,0
``make_classification`` from scikit-learn but fixing some parameters.,0
##############################################################################,0
The following function will be used to plot the sample space after resampling,0
to illustrate the characteristic of an algorithm.,0
make nice plotting,0
##############################################################################,0
The following function will be used to plot the decision function of a,0
classifier given some data.,0
##############################################################################,0
Prototype generation: under-sampling by generating new samples,0
##############################################################################,0
##############################################################################,0
``ClusterCentroids`` under-samples by replacing the original samples by the,0
centroids of the cluster found.,0
##############################################################################,0
Prototype selection: under-sampling by selecting existing samples,0
##############################################################################,0
##############################################################################,0
The algorithm performing prototype selection can be subdivided into two,0
groups: (i) the controlled under-sampling methods and (ii) the cleaning,0
under-sampling methods.,0
##############################################################################,0
"With the controlled under-sampling methods, the number of samples to be",0
selected can be specified. ``RandomUnderSampler`` is the most naive way of,0
performing such selection by randomly selecting a given number of samples by,0
the targetted class.,0
##############################################################################,0
``NearMiss`` algorithms implement some heuristic rules in order to select,0
samples. NearMiss-1 selects samples from the majority class for which the,0
average distance of the :math:`k`` nearest samples of the minority class is,0
the smallest. NearMiss-2 selects the samples from the majority class for,0
which the average distance to the farthest samples of the negative class is,0
"the smallest. NearMiss-3 is a 2-step algorithm: first, for each minority",0
"sample, their ::math:`m` nearest-neighbors will be kept; then, the majority",0
samples selected are the on for which the average distance to the :math:`k`,0
nearest neighbors is the largest.,0
##############################################################################,0
``EditedNearestNeighbours`` removes samples of the majority class for which,0
their class differ from the one of their nearest-neighbors. This sieve can be,0
repeated which is the principle of the,0
``RepeatedEditedNearestNeighbours``. ``AllKNN`` is slightly different from,0
the ``RepeatedEditedNearestNeighbours`` by changing the :math:`k` parameter,0
"of the internal nearest neighors algorithm, increasing it at each iteration.",0
##############################################################################,0
``CondensedNearestNeighbour`` makes use of a 1-NN to iteratively decide if a,0
sample should be kept in a dataset or not. The issue is that,0
``CondensedNearestNeighbour`` is sensitive to noise by preserving the noisy,0
samples. ``OneSidedSelection`` also used the 1-NN and use ``TomekLinks`` to,0
remove the samples considered noisy. The ``NeighbourhoodCleaningRule`` use a,0
"``EditedNearestNeighbours`` to remove some sample. Additionally, they use a 3",0
nearest-neighbors to remove samples which do not agree with this rule.,0
##############################################################################,0
``InstanceHardnessThreshold`` uses the prediction of classifier to exclude,0
samples. All samples which are classified with a low probability will be,0
removed.,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
make nice plotting,0
Authors: Fernando Nogueira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
Use hard voting instead of soft voting,0
"Two subplots, unpack the axes array immediately",0
make nice plotting,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
Generate some data with one Tomek link,0
minority class,0
majority class,0
##############################################################################,0
"In the figure above, the samples highlighted in green form a Tomek link since",0
they are of different classes and are nearest neighbours of each other.,0
highlight the samples of interest,0
##############################################################################,0
We can run the ``TomekLinks`` sampling to remove the corresponding,0
samples. If ``ratio='auto'`` only the sample from the majority class will be,0
removed. If ``ratio='all'`` both samples will be removed.,0
highlight the samples of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
make nice plotting,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
plot samples which have been removed,0
##############################################################################,0
This function allows to make nice plotting,0
##############################################################################,0
We can start by generating some data to later illustrate the principle of,0
each NearMiss heuritic rules.,0
minority class,0
majority class,0
##############################################################################,0
NearMiss-1,0
##############################################################################,0
##############################################################################,0
NearMiss-1 selects samples from the majority class for which the average,0
distance to some nearest neighbours is the smallest. In the following,0
"example, we use a 3-NN to compute the average distance on 2 specific samples",0
"of the majority class. Therefore, in this case the point linked by the",0
green-dashed line will be selected since the average distance is smaller.,0
##############################################################################,0
NearMiss-2,0
##############################################################################,0
##############################################################################,0
NearMiss-2 selects samples from the majority class for which the average,0
distance to the farthest neighbors is the smallest. With the same,0
"configuration as previously presented, the sample linked to the green-dashed",0
line will be selected since its distance the 3 farthest neighbors is the,0
smallest.,0
##############################################################################,0
NearMiss-3,0
##############################################################################,0
##############################################################################,0
"NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to",0
short-list samples from the majority class (i.e. correspond to the,0
"highlighted samples in the following plot). Then, the sample with the largest",0
average distance to the *k* nearest-neighbors are selected.,0
select only the majority point of interest,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create the classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Authors: Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Load the dataset,0
make nice plotting,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Create a folder to fetch the dataset,0
Create a pipeline,0
Classify and report the results,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
##############################################################################,0
Setting the data set,0
##############################################################################,0
##############################################################################,0
We use a part of the 20 newsgroups data set by loading 4 topics. Using the,0
"scikit-learn loader, the data are split into a training and a testing set.",0
,0
Note the class \#3 is the minority class and has almost twice less samples,0
than the majority class.,0
##############################################################################,0
The usual scikit-learn pipeline,0
##############################################################################,0
##############################################################################,0
You might usually use scikit-learn pipeline by combining the TF-IDF,0
vectorizer to feed a multinomial naive bayes classifier. A classification,0
report summarized the results on the testing set.,0
,0
"As expected, the recall of the class \#3 is low mainly due to the class",0
imbalanced.,0
##############################################################################,0
Balancing the class before classification,0
##############################################################################,0
##############################################################################,0
"To improve the prediction of the class \#3, it could be interesting to apply",0
"a balancing before to train the naive bayes classifier. Therefore, we will",0
use a ``RandomUnderSampler`` to equalize the number of samples in all the,0
classes before the training.,0
,0
It is also important to note that we are using the ``make_pipeline`` function,0
implemented in imbalanced-learn to properly handle the samplers.,0
##############################################################################,0
"Although the results are almost identical, it can be seen that the resampling",0
allowed to correct the poor recall of the class \#3 at the cost of reducing,0
"the other metrics for the other classes. However, the overall results are",0
slightly better.,0
Authors: Dayvid Oliveira,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check the consistency of X and y,0
self.sampling_type is already checked in check_ratio,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
Christos Aridas,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
validate names,0
validate estimators,0
We allow last estimator to be None as an identity transformation,0
Estimator interface,0
Setup the memory,0
we do not clone when caching is disabled to preserve,0
backward compatibility,0
Fit or load from cache the current transfomer,0
Replace the transformer of the step with the fitted,0
transformer. This is necessary when loading the transformer,0
from the cache.,0
XXX: Calling sample in pipeline it means that the,1
last estimator is a sampler. Samplers don't carry,0
"the sampled data. So, call 'fit_sample' in all intermediate",0
steps to get the sampled data for the last estimator.,0
"_final_estimator is None or has transform, otherwise attribute error",0
raise AttributeError if necessary for hasattr behaviour,0
"if we have a weight for this transformer, multiply output",0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
coding: utf-8,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dariusz Brzezinski,0
License: MIT,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Retain only selected labels,0
old version of scipy return MaskedConstant instead of 0.0,0
Create the list of tags,0
check that the scoring function does not need a score,0
and only a prediction,0
Compute the score from the scoring function,0
Square if desired,0
Get the signature of the sens/spec function,0
We need to extract from kwargs only the one needed by the,0
specificity and specificity,0
Make the intersection between the parameters,0
Create a sub dictionary,0
Check if the metric is the geometric mean,0
We do not support multilabel so the only average supported,0
is binary,0
Create the list of parameters through signature binding,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
No average: zeros in array,0
Macro average is changed,0
Check for micro,0
Check for weighted,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
but average != 'binary'; even if data is binary,0
compute the geometric mean for the binary problem,0
Compute the geometric mean for each of the classes,0
average tests,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Get the version,0
sensitivity scorer,0
specificity scorer,0
geometric_mean scorer,0
make a iba metric before a scorer,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
The ratio is computed using a one-vs-rest manner. Using majority,0
in multi-class would lead to slightly different results at the,0
cost of introducing a new parameter.,0
the nearest neighbors need to be fitted only on the current class,0
to find the class NN to generate new samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
"FIXME Deprecated in 0.2, to be removed in 0.4",1
divergence between borderline-1 and borderline-2,0
Create synthetic samples for borderline points.,0
only minority,0
we use a one-vs-rest policy to handle the multiclass in which,0
new samples will be created considering not only the majority,0
class but all over classes.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
select a sample from the current class,0
create the set composed of all minority samples and one,0
sample from the current class.,0
create the set S with removing the seed from S,0
since that it will be added anyway,0
apply Tomek cleaning,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
FIXME: Deprecated in 0.2. To be removed in 0.4.,1
idx_tmp is relative to the feature selected in the,0
previous step and we need to find the indirection,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Fernando Nogueira,0
Christos Aridas,0
License: MIT,0
find which class to not consider,0
there is a Tomek link between two samples if they are both nearest,0
neighbors of each others.,0
Find the nearest neighbour of every point,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
fit knn on C,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
fit a knn on C,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated from 0.2. To be removed in 0.4.,1
clean the neighborhood,0
compute which classes to consider for cleaning for the A2 group,0
compute a2 group,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
FIXME: Deprecated in 0.2. To be removed in 0.4,1
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Case 3,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
overwrite b_min_bec_maj,0
Case 2,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Dayvid Oliveira,0
Christos Aridas,0
License: MIT,0
To be removed in 0.4,0
Select the appropriate classifier,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
FIXME remove at the end of the deprecation 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
test that all_estimators doesn't find abstract classes.,0
some can just not be sensibly default constructed,0
input validation etc for non-meta estimators,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
store timestamp to figure out whether the result of 'fit' has been,0
cached or not,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't instantiate with non-transformers on the way,0
"Note that NoTrans implements fit, but not transform",0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
invalid parameters should raise an error message,0
Pipeline should pass sample_weight,0
When sample_weight is None it shouldn't be passed,0
Test pipeline raises set params error message for nested models.,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
"As pipeline doesn't clone estimators on construction,",0
it must have its own estimators,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
tests that Pipeline passes fit_params to intermediate steps,0
when fit_predict is invoked,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Directly setting attr,0
Using set_params,0
Using set_params to replace single step,0
With invalid data,0
Test setting Pipeline steps to None,0
"for other methods, ensure no AttributeErrors on None:",0
mult2 and mult3 are active,0
Check None step at construction time,0
Test that an error is raised when memory is not a string or a Memory,0
instance,0
Define memory as an integer,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test with Transformer + SVC,0
Memoize the transformer at the first fit,0
Get the time stamp of the tranformer in the cached pipeline,0
Check that cached_pipe and pipe yield identical results,0
Check that we are reading the cache while fitting,0
a second time,0
Check that cached_pipe and pipe yield identical results,0
Create a new pipeline with cloned estimators,0
Check that even changing the name step does not affect the cache hit,0
Check that cached_pipe and pipe yield identical results,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
We round the value near to zero. It seems that PCA has some issue,0
with that,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test pipeline using None as preprocessing step and a classifier,0
"Test pipeline using None, RUS and a classifier",0
"Test pipeline using RUS, None and a classifier",0
Test pipeline using None step and a sampler,0
Test pipeline using None and a transformer that implements transform and,0
inverse_transform,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Adapated from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
make the checks from scikit-learn,0
trigger our checks if this is a SamplerMixin,0
FIXME already present in scikit-learn 0.19,1
test scikit-learn compatibility,0
Estimators in mono_output_task_error raise ValueError if y is of 1-D,0
Convert into a 2-D y for those estimators.,0
check that fit method only changes or sets private attributes,0
to not check deprecated classes,0
check that fit doesn't add any public attribute,0
check that fit doesn't change any public attribute,0
in this test we will force all samplers to not change the class 1,0
check that sparse matrices can be passed through the sampler leading to,0
the same results than dense,0
set KMeans to full since it support sparse and dense,0
Check that the samplers handle pandas dataframe and pandas series,0
Adapted from scikit-learn,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
meta-estimators need another estimator to be instantiated.,0
estimators that there is no way to default-construct sensibly,0
some strange ones,0
get parent folder,0
get rid of abstract base classes,0
get rid of sklearn estimators which have been imported in some classes,1
possibly get rid of meta estimators,0
"drop duplicates, sort for reproducibility",0
itemgetter is used to ensure the sort does not extend to the 2nd item of,0
the tuple,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
FIXME: perfectly we should raise an error but the sklearn API does,1
not allow for it,0
check that all keys in ratio are also in y,0
check that there is no negative number,0
clean-sampling can be more permissive since those samplers do not,0
use samples,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
this function could create an equal number of samples,0
"tests that the estimator actually fails on ""bad"" estimators.",0
"not a complete test of all checks, which are very extensive.",0
check that we have a set_params and can clone,0
check that we have a fit method,0
check that fit does input validation,0
check that predict does input validation (doesn't accept dicts in input),0
check that estimator state does not change,0
at transform/predict/predict_proba time,0
check that `fit` only changes attributes that,0
are private (start with an _ or end with a _).,0
check that `fit` doesn't add any public attribute,0
check for sparse matrix input handling,0
"the check for sparse input handling prints to the stdout,",0
"instead of raising an error, so as not to remove the original traceback.",0
that means we need to jump through some hoops to catch it.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
check if the filtering is working with a list or a single string,0
check that all estimators are sampler,0
check that an error is raised when the type is unknown,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
"If an object was given, affect",0
Otherwise create a default TomekLinks,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
RandomUnderSampler is not supporting sample_weight. We need to pass,0
None.,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
doctest: +ELLIPSIS,0
To be removed in 0.4,0
Define the classifier to use,0
array to know which samples are available to be taken,0
where the different set will be stored,0
store the index of the data to under-sample,0
value which will be picked at each round,0
extract the data of interest for this round from the,0
current class,0
select randomly the desired features,0
store the set created,0
fit and predict using cross validation,0
extract the prediction about the targeted classes only,0
check the stopping criterion,0
check that there is enough samples for another round,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Check classification for various parameter settings.,0
Test that bootstrapping samples generate non-perfect base estimators.,0
"without bootstrap, all trees are perfect on the training set",0
disable the resampling by passing an empty dictionary.,0
"with bootstrap, trees are no longer perfect on the training set",0
Test that bootstrapping features may generate duplicate features.,0
Predict probabilities.,0
Normal case,0
"Degenerate case, where some classes are missing",0
Check that oob prediction is a good estimation of the generalization,0
error.,0
Test with few estimators,0
Check singleton ensembles.,0
Test that it gives proper exception on deficient input.,0
Test n_estimators,0
Test max_samples,0
Test max_features,0
Test support of decision_function,0
Check that bagging ensembles can be grid-searched.,0
Transform iris into a binary classification task,0
Grid search with scoring based on decision_function,0
Check base_estimator and its default values.,0
Test if fitting incrementally with warm start gives a forest of the,0
right size and the same results as a normal fit.,0
Test if warm start'ed second fit with smaller n_estimators raises error.,0
Test that nothing happens when fitting without increasing n_estimators,0
"modify X to nonsense values, this should not change anything",0
warm started classifier with 5+5 estimators should be equivalent to,0
one classifier with 10 estimators,0
Check using oob_score and warm_start simultaneously fails,0
"Make sure OOB scores are identical when random_state, estimator, and",0
training data are fixed and fitting is done twice,0
Check that format of estimators_samples_ is correct and that results,0
generated at fit time can be identically reproduced at a later time,0
using data saved in object attributes.,0
remap the y outside of the BalancedBaggingclassifier,0
"_, y = np.unique(y, return_inverse=True)",0
Get relevant attributes,0
Test for correct formatting,0
Re-fit single estimator to test for consistent sampling,0
Make sure validated max_samples and original max_samples are identical,0
when valid integer max_samples supplied by user,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
Generate a global dataset to use,0
Define a ratio,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Author: Guillaume Lemaitre,0
License: BSD 3 clause,0
"The index start at one, then we need to remove one",0
to not have issue with the indexing.,0
go through the list and check if the data are available,0
Authors: Dayvid Oliveira,0
Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
restrict ratio to be a dict or a callable,0
FIXME: deprecated in 0.2 to be removed in 0.4,1
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
"we are reusing part of utils.check_ratio, however this is not cover in",0
the common tests so we will repeat it here,0
FIXME: to be removed in 0.4 due to deprecation,1
resample without using min_c_,0
Authors: Guillaume Lemaitre <g.lemaitre58@gmail.com>,0
Christos Aridas,0
License: MIT,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Load the dataset,0
Create a folder to fetch the dataset,0
Make the dataset imbalanced,0
Select only half of the first class,0
Create a pipeline,0
Classify and report the results,0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Announce deprecation if necessary,0
Check that the target type is binary,0
Check that the target type is either binary or multiclass,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
XXX: Calling sample in pipeline it means that the,1
last estimator is a sampler. Samplers don't carry,0
"the sampled data. So, call 'fit_sample' in all intermediate",0
steps to get the sampled data for the last estimator.,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
coding: utf-8,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
Compute the score from the scoring function,0
Square if desired,0
Create the list of tags,0
Get the signature of the sens/spec function,0
Filter the inputs required by the sens/spec function,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
No average: zeros in array,0
Macro average is changed,0
Check for micro,0
Check for weighted,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
"but average != 'binary'; even if data is binary""""""",0
compute the geometric mean for the binary problem,0
Compute the geometric mean for each of the classes,0
average tests,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Get the version,0
sensitivity scorer,0
specificity scorer,0
geometric_mean scorer,0
make a iba metric before a scorer,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Create the object,0
Create the object,0
Create the object,0
Create the object,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
Announce deprecation if needed,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
"The indexes found are relative to the current class, we need to",0
find the absolute value,0
Build the array with the absolute position,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Set the number of sample for the estimator,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 3,0
"If this is a normal convergence, get the last data",0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
updating ENN size_ngh,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 2,0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
To be removed in 0.4,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Resample the data,0
Resample the data,0
Resample the data,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
"assert_raises(TypeError, lambda x: [][0])",0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Create a SMOTE and Tomek object,0
Create a SMOTE and Tomek object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Create a SMOTE and Tomek object,0
Create a SMOTE and Tomek object,0
Check the random state,0
To be removed in 0.4,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Get the indices of interest,0
"Draw samples, using sample weights, and then fit",0
"Draw samples, using a mask, and then fit",0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Specific case with n_max_subset = 1,0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
continuous case,0
multiclass case,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a zero ratio,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as a list which is not supported,0
Make y to be multiclass,0
Resample the data,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
Show the classification report,0
Generate a dataset,0
Split the data,0
Train the classifier with balancing,0
Test the classifier and get the prediction,0
##############################################################################,0
The geometric mean corresponds to the square root of the product of the,0
sensitivity and specificity. Combining the two metrics should account for,0
the balancing of the dataset.,0
##############################################################################,0
The index balanced accuracy can transform any metric to be used in,0
imbalanced learning problems.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Load the dataset,0
Create a folder to fetch the dataset,0
Make the dataset imbalanced,0
Select only half of the first class,0
Create a pipeline,0
Classify and report the results,0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Announce deprecation if necessary,0
Check that the target type is binary,0
Check that the target type is either binary or multiclass,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
XXX: Calling sample in pipeline it means that the,1
last estimator is a sampler. Samplers don't carry,0
"the sampled data. So, call 'fit_sample' in all intermediate",0
steps to get the sampled data for the last estimator.,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
coding: utf-8,0
Only negative labels,0
"Calculate tp_sum, pred_sum, true_sum ###",0
labels are now from 0 to len(labels) - 1 -> use bincount,0
Pathological case,0
Compute the true negative,0
Retain only selected labels,0
"Finally, we have all our sufficient statistics. Divide! #",0
"Divide, and on zero-division, set scores to 0 and warn:",0
"Oddly, we may get an ""invalid"" rather than a ""divide"" error",0
here.,0
Average the results,0
Compute the score from the scoring function,0
Square if desired,0
Create the list of tags,0
Get the signature of the sens/spec function,0
Filter the inputs required by the sens/spec function,0
Call the sens/spec function,0
Compute the dominance,0
Compute the different metrics,0
Precision/recall/f1,0
Specificity,0
Geometric mean,0
Index balanced accuracy,0
compute averages,0
##############################################################################,0
Utilities for testing,0
import some data to play with,0
restrict to a binary classification task,0
add noisy features to make the problem harder and avoid perfect results,0
"run classifier, get class probabilities and label predictions",0
only interested in probabilities of the positive case,0
XXX: do we really want a special API for the binary case?,1
##############################################################################,0
Tests,0
detailed measures for each class,0
individual scoring function that can be used for grid search: in the,0
binary class case the score is the value of the measure for the positive,0
class (e.g. label == 1). This is deprecated for average != 'binary'.,0
Such a case may occur with non-stratified cross-validation,0
No average: zeros in array,0
Macro average is changed,0
Check for micro,0
Check for weighted,0
ensure the above were meaningful tests:,0
Bad pos_label,0
Bad average option,0
"but average != 'binary'; even if data is binary""""""",0
compute the geometric mean for the binary problem,0
Compute the geometric mean for each of the classes,0
average tests,0
print classification report with class names,0
print classification report with label detection,0
print classification report with class names,0
print classification report with label detection,0
Get the version,0
sensitivity scorer,0
specificity scorer,0
geometric_mean scorer,0
make a iba metric before a scorer,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Create the object,0
Create the object,0
Create the object,0
Create the object,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
Announce deprecation if needed,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
"The indexes found are relative to the current class, we need to",0
find the absolute value,0
Build the array with the absolute position,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Set the number of sample for the estimator,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 3,0
"If this is a normal convergence, get the last data",0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
updating ENN size_ngh,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 2,0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
To be removed in 0.4,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Resample the data,0
Resample the data,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Resample the data,0
Resample the data,0
Resample the data,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Test the various methods of the pipeline (anova).,0
"assert_raises(TypeError, lambda x: [][0])",0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Check any parameters for SMOTE was provided,0
Anounce deprecation,0
We need to list each parameter and decide if we affect a default,0
value or not,0
"If an object was given, affect",0
Otherwise create a default SMOTE,0
Check any parameters for ENN was provided,0
Anounce deprecation,0
"If an object was given, affect",0
Otherwise create a default EditedNearestNeighbours,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Create a SMOTE and Tomek object,0
Create a SMOTE and Tomek object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Create a SMOTE and Tomek object,0
Create a SMOTE and Tomek object,0
Check the random state,0
To be removed in 0.4,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Get the indices of interest,0
"Draw samples, using sample weights, and then fit",0
"Draw samples, using a mask, and then fit",0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Specific case with n_max_subset = 1,0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
continuous case,0
multiclass case,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a zero ratio,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as a list which is not supported,0
Make y to be multiclass,0
Resample the data,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
"The indexes found are relative to the current class, we need to",0
find the absolute value,0
Build the array with the absolute position,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 3,0
"If this is a normal convergence, get the last data",0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Check the random state,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Specific case with n_max_subset = 1,0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
"The indexes found are relative to the current class, we need to",0
find the absolute value,0
Build the array with the absolute position,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 3,0
"If this is a normal convergence, get the last data",0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Check the random state,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Specific case with n_max_subset = 1,0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Apply the AllKNN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Check that the target type is binary,0
Check that the target type is either binary or multiclass,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
"The indexes found are relative to the current class, we need to",0
find the absolute value,0
Build the array with the absolute position,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 3,0
"If this is a normal convergence, get the last data",0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
updating ENN size_ngh,0
Check the stopping criterion,0
1. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
2. If one of the class is disappearing,0
Case 1,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 2,0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Data generated for the toy example,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Make y to be multiclass,0
Resample the data,0
Check the size of y,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
continuous case,0
multiclass case,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
continuous case,0
multiclass case,0
Check the random state,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Specific case with n_max_subset = 1,0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
continuous case,0
multiclass case,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
continuous case,0
Generate a global dataset to use,0
Define a zero ratio,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as a list which is not supported,0
Make y to be multiclass,0
Resample the data,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Throw a warning to tell the user that we did not have enough samples,0
to select and that we just select everything,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
"The indexes found are relative to the current class, we need to",0
find the absolute value,0
Build the array with the absolute position,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check the stopping criterion,0
1. If there is no changes for the vector y,0
2. If the number of samples in the other class become inferior to,0
the number of samples in the majority class,0
3. If one of the class is disappearing,0
Case 1,0
Case 2,0
Get the number of samples in the non-minority classes,0
Check the minority stop to be the minority,0
Case 3,0
"If this is a normal convergence, get the last data",0
Log the variables to explain the stop of the algorithm,0
Update the data for the next iteration,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Check the random state,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Specific case with n_max_subset = 1,0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Check the random state,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Check the random state,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Check the random state,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Check that we found at least some neighbours belonging to the,0
majority class,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Create the object for random under-sampling,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Create the object for random under-sampling,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
! /usr/bin/env python,0
"load all vars into globals, otherwise",0
the later function call using global vars doesn't work.,0
"Allow command-lines such as ""python setup.py build install""",0
Make sources available using relative paths from this file's directory.,0
-*- coding: utf-8 -*-,0
,0
"imbalanced-learn documentation build configuration file, created by",0
sphinx-quickstart on Mon Jan 18 14:44:12 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ---------------------------------------------------,0
Try to override the matplotlib configuration as early as possible,0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
path to your examples scripts,0
path where to save gallery generated examples,0
"Add any paths that contain templates here, relative to this directory.",0
generate autosummary even if no references,0
The suffix of source filenames.,0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
Generate the plots for the gallery,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
language = None,0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (within the static path) to use as favicon of the,0
docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
"generate empty examples files, so that we don't get",0
inclusion errors if there are no examples for a class / module,0
touch file,0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE SVM,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply regular SMOTE,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Borderline SMOTE 1,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random over-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + ENN,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply SMOTE + Tomek links,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Balance Cascade method,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Easy Ensemble,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
"Three subplots, unpack the axes array immediately",0
Apply the ENN,0
Apply the RENN,0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 3,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Edited Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Tomek Links cleaning,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply One-Sided Selection,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 2,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply neighbourhood cleaning rule,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Condensed Nearest Neighbours,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Cluster Centroids,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply the random under-sampling,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
"Two subplots, unpack the axes array immediately",0
Define some color for the plotting,0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Fit and transform x to visualise inside a 2D feature space,0
Apply Nearmiss 1,0
"Two subplots, unpack the axes array immediately",0
Generate the dataset,0
Instanciate a PCA object for the sake of easy visualisation,0
Create the samplers,0
Create teh classifier,0
Make the splits,0
Add one transformers and two samplers in the pipeline object,0
Based on NiLearn package,0
License: simplified BSD,0
"PEP0440 compatible formatted version, see:",0
https://www.python.org/dev/peps/pep-0440/,0
,0
Generic release markers:,0
X.Y,0
X.Y.Z # For bugfix releases,0
,0
Admissible pre-release markers:,0
X.YaN # Alpha release,0
X.YbN # Beta release,0
X.YrcN # Release Candidate,0
X.Y # Final release,0
,0
Dev branch marker is: 'X.Y.dev' or 'X.Y.devN' where N is an integer.,0
'X.Y.dev0' is the canonical version of 'X.Y.dev',0
,0
"This is a tuple to preserve order, so that dependencies are checked",0
in some meaningful order (more => less 'core').  We avoid using,0
collections.OrderedDict to preserve Python 2.6 compatibility.,0
Avoid choking on modules with no __version__ attribute,0
Skip check only when installing and it's a module that,0
will be auto-installed.,0
Check the consistency of X and y,0
Get all the unique elements in the target array,0
# Raise an error if there is only one class,0
if uniques.size == 1:,0
"raise RuntimeError(""Only one class detected, aborting..."")",0
Raise a warning for the moment to be compatible with BaseEstimator,0
Store the size of X to check at sampling time if we have the,0
same data,0
Create a dictionary containing the class statistics,0
Find the minority and majority classes,0
Check if the ratio provided at initialisation make sense,0
Check the consistency of X and y,0
Check that the data have been fitted,0
Check if the size of the data is identical than at fitting,0
The ratio correspond to the number of samples in the minority class,0
"over the number of samples in the majority class. Thus, the ratio",0
cannot be greater than 1.0,0
Adapted from scikit-learn,0
Author: Edouard Duchesnay,0
Gael Varoquaux,0
Virgile Fritsch,0
Alexandre Gramfort,0
Lars Buitinck,0
chkoar,0
License: BSD,0
BaseEstimator interface,0
shallow copy of steps,0
Estimator interface,0
Boolean controlling whether the joblib caches should be,0
"flushed if the version of certain modules changes (eg nibabel, as it",0
does not respect the backward compatibility in some of its internal,0
structures,0
This  is used in nilearn._utils.cache_mixin,0
list all submodules available in imblearn and version,0
Keep the samples from the majority class,0
Loop over the other classes over picking at random,0
"If this is the majority class, skip it",0
Define the number of sample to create,0
Pick some elements at random,0
Concatenate to the majority class,0
Keep the samples from the majority class,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
Print if verbose is true,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Get the distance to the NN,0
Compute the ratio of majority samples next to minority samples,0
Normalize the ratio,0
Compute the number of sample to be generated,0
For each minority samples,0
Pick-up the neighbors wanted,0
Create a new sample,0
Find the NN for each samples,0
Exclude the sample itself,0
Count how many NN belong to the minority class,0
Find the class corresponding to the label in x,0
Compute the number of majority samples in the NN,0
Samples are in danger for m/2 <= m' < m,0
Samples are noise for m = m',0
Check the consistency of X,0
Check the random state,0
A matrix to store the synthetic samples,0
# Set seeds,0
"seeds = random_state.randint(low=0,",0
"high=100 * len(nn_num.flatten()),",0
size=n_samples),0
Randomly pick samples to construct neighbours from,0
Loop over the NN matrix and create new samples,0
"NN lines relate to original sample, columns to its",0
nearest neighbours,0
"Take a step of random size (0,1) in the direction of the",0
n nearest neighbours,0
if self.random_state is None:,0
np.random.seed(seeds[i]),0
else:,0
np.random.seed(self.random_state),0
Construct synthetic sample,0
The returned target vector is simply a repetition of the,0
minority label,0
Define the number of sample to create,0
We handle only two classes problem for the moment.,0
Start by separating minority class features and target values.,0
If regular SMOTE is to be performed,0
"Look for k-th nearest neighbours, excluding, of course, the",0
point itself.,0
Matrix with k-th nearest neighbours indexes for each minority,0
element.,0
--- Generating synthetic samples,0
Use static method make_samples to generate minority samples,0
Concatenate the newly generated samples to the original data set,0
Find the NNs for all samples in the data set.,0
Boolean array with True for minority samples in danger,0
"If all minority samples are safe, return the original data set.",0
"All are safe, nothing to be done here.",0
"If we got here is because some samples are in danger, we need to",0
find the NNs among the minority class to create the new synthetic,0
samples.,0
,0
We start by changing the number of NNs to consider from m + 1,0
to k + 1,0
nns...#,0
B1 and B2 types diverge here!!!,0
Create synthetic samples for borderline points.,0
Concatenate the newly generated samples to the original,0
dataset,0
Reset the k-neighbours to m+1 neighbours,0
Split the number of synthetic samples between only minority,0
"(type 1), or minority and majority (with reduced step size)",0
(type 2).,0
The fraction is sampled from a beta distribution centered,0
around 0.5 with variance ~0.01,0
Only minority,0
Only majority with smaller step size,0
Concatenate the newly generated samples to the original,0
data set,0
Reset the k-neighbours to m+1 neighbours,0
The SVM smote model fits a support vector machine,0
classifier to the data and uses the support vector to,0
"provide a notion of boundary. Unlike regular smote, where",0
such notion relies on proportion of nearest neighbours,0
belonging to each class.,0
Fit SVM to the full data#,0
Find the support vectors and their corresponding indexes,0
"First, find the nn of all the samples to identify samples",0
in danger and noisy ones,0
"As usual, fit a nearest neighbour model to the data",0
"Now, get rid of noisy support vectors",0
Remove noisy support vectors,0
Proceed to find support vectors NNs among the minority class,0
Split the number of synthetic samples between interpolation and,0
extrapolation,0
The fraction are sampled from a beta distribution with mean,0
0.5 and variance 0.01#,0
Interpolate samples in danger,0
Extrapolate safe samples,0
Concatenate the newly generated samples to the original data set,0
not any support vectors in danger,0
All the support vector in danger,0
Reset the k-neighbours to m+1 neighbours,0
--- NN object,0
Import the NN object from scikit-learn library. Since in the smote,0
"variations we must first find samples that are in danger, we",0
initialize the NN object differently depending on the method chosen,0
"Regular smote does not look for samples in danger, instead it",0
creates synthetic samples directly from the k-th nearest,0
neighbours with not filtering,0
"Borderline1, 2 and SVM variations of smote must first look for",0
samples that could be considered noise and samples that live,0
"near the boundary between the classes. Therefore, before",0
"creating synthetic samples from the k-th nns, it first look",0
for m nearest neighbors to decide whether or not a sample is,0
noise or near the boundary.,0
--- SVM smote,0
"Unlike the borderline variations, the SVM variation uses the support",0
vectors to decide which samples are in danger (near the boundary).,0
Additionally it also introduces extrapolation for samples that are,0
considered safe (far from boundary) and interpolation for samples,0
in danger (near the boundary). The level of extrapolation is,0
controled by the out_step.,0
Store SVM object with any parameters,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C,0
Create the set S,0
Remove the seed from S since that it will be added anyway,0
Create a k-NN classifier,0
Fit C into the knn,0
Classify on S,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
We concatenate the misclassified samples with the seed and the,0
minority samples,0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Compute the distance considering the farthest neighbour,0
Sort the list of distance and get the index,0
Select the desired number of samples,0
Assign the parameter of the element of this class,0
Check that the version asked is implemented,0
Start with the minority class,0
All the minority class samples will be preserved,0
Compute the number of cluster needed,0
If we need to offer support for the indices,0
"For each element of the current class, find the set of NN",0
of the minority class,0
Call the constructor of the NN,0
Fit the minority class since that we want to know the distance,0
to these point,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the samples corresponding to the current class,0
Find the NN,0
Select the right samples,0
Find the NN,0
Select the right samples,0
We need a new NN object to fit the current class,0
Find the set of NN to the minority class,0
Create the subset containing the samples found during the NN,0
search. Linearize the indexes and remove the double values,0
Create the subset,0
Compute the NN considering the current class,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of clusters needed,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under-picking at random,0
"If the minority class is up, skip it",0
Pick some elements at random,0
If we need to offer support for the indices selected,0
Concatenate to the minority class,0
Check if the indices of the samples selected should be returned as,0
well,0
Return the indices of interest,0
"Initialize the boolean result as false, and also a counter",0
Loop through each sample and looks whether it belongs to the minority,0
"class. If it does, we don't consider it since we want to keep all",0
"minority samples. If, however, it belongs to the majority sample we",0
look at its first neighbour. If its closest neighbour also has the,0
"current sample as its closest neighbour, the two form a Tomek link.",0
"If they form a tomek link, put a True marker on this",0
"sample, and increase counter by one.",0
Find the nearest neighbour of every point,0
Send the information to is_tomek function to get boolean vector back,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Return data set without majority Tomek links.,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Randomly get one sample from the majority class,0
Generate the index to select,0
Create the set C - One majority samples and all minority,0
Create the set S - all majority samples,0
Create a k-NN classifier,0
Fit C into the knn,0
Check each sample in S if we keep it or drop it,0
Do not select sample which are already well classified,0
Classify on S,0
If the prediction do not agree with the true label,0
append it in C_x,0
Keep the index for later,0
Update C,0
Fit C into the knn,0
This experimental to speed up the search,0
Classify all the element in S and avoid to test the,0
well classified elements,0
Find the misclassified S_y,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Compute the number of cluster needed,0
Create the clustering object,0
Start with the minority class,0
All the minority class samples will be preserved,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it.",0
Find the centroids via k-means,0
Concatenate to the minority class,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the whole dataset,0
Loop over the other classes under picking at random,0
Get the sample of the current class,0
Get the samples associated,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make an AND operation through the three neighbours,0
If the minority class remove the majority samples,0
Get the index to exclude,0
Get the index to exclude,0
Create a vector with the sample to select,0
Exclude as well the minority sample since that they will be,0
concatenated later,0
Get the samples from the majority classes,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Start with the minority class,0
All the minority class samples will be preserved,0
If we need to offer support for the indices,0
Create a k-NN to fit the whole data,0
Fit the data,0
Loop over the other classes under picking at random,0
"If the minority class is up, skip it",0
Get the sample of the current class,0
Find the NN for the current class,0
Get the label of the corresponding to the index,0
Check which one are the same label than the current class,0
Make the majority vote,0
Get the samples which agree all together,0
If we need to offer support for the indices selected,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Check if the indices of the samples selected should be returned too,0
Return the indices of interest,0
Select the appropriate classifier,0
Create the different folds,0
Compute the number of cluster needed,0
Find the percentile corresponding to the top num_samples,0
Sample the data,0
If we need to offer support for the indices,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Resample the data,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Define the parameter for the under-sampling,0
Create the object,0
Fit and sample,0
Create the object,0
Generate a global dataset to use,0
Define a ratio,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Resample the data,0
Resample the data,0
Create the object,0
Test the various init parameters of the pipeline.,0
Check that we can't instantiate pipelines with objects without fit,0
method,0
Smoke test with only an estimator,0
Check that params are set,0
Smoke test the repr:,0
Test with two objects,0
Check that we can't use the same stage name twice,0
Check that params are set,0
Smoke test the repr:,0
Check that params are not set when naming them wrong,0
Test clone,0
"Check that apart from estimators, the parameters are the same",0
Remove estimators that where copied,0
Test the various methods of the pipeline (anova).,0
Test with Anova + LogisticRegression,0
Test that the pipeline can take fit parameters,0
classifier should return True,0
and transformer params should not be changed,0
Test pipeline raises set params error message for nested models.,0
expected error message,0
nested model check,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (preprocessing + svm).,0
check shapes of various prediction functions,0
test that the fit_predict method is implemented on a pipeline,0
test that the fit_predict on pipeline yields same results as applying,0
transform and clustering steps separately,0
first compute the transform and clustering step separately,0
use a pipeline to do the transform and clustering in one step,0
tests that a pipeline does not have fit_predict method when final,0
step of pipeline does not have fit_predict defined,0
Test whether pipeline works with a transformer at the end.,0
Also test pipeline.transform and pipeline.inverse_transform,0
test transform and fit_transform:,0
Test whether pipeline works with a transformer missing fit_transform,0
test fit_transform:,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test the various methods of the pipeline (pca + svm).,0
Test with PCA + SVC,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
test transform and fit_transform:,0
Test whether pipeline works with a sampler at the end.,0
Also test pipeline.sampler,0
Test the various methods of the pipeline (anova).,0
Test with RandomUnderSampling + Anova + LogisticRegression,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Fit using SMOTE,0
Transform using SMOTE,0
Fit and transform using ENN,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Create the object,0
Create the object,0
Fit the data,0
Create the object,0
Fit the data,0
Create the object,0
Create the object for random under-sampling,0
Define the classifier to use,0
Start with the minority class,0
Keep the indices of the minority class somewhere if we need to,0
return them later,0
Condition to initiliase before the search,0
Get the initial number of samples to select in the majority class,0
Create the array characterising the array containing the majority,0
class,0
Loop to create the different subsets,0
Generate an appropriate number of index to extract,0
from the majority class depending of the false classification,0
rate of the previous iteration,0
Mark these indexes as not being considered for next sampling,0
"For now, we will train and classify on the same data",0
"Let see if we should find another solution. Anyway,",0
random stuff are still random stuff,0
Push these data into a new subset,0
Apply a bootstrap on x_data,0
Train the classifier using the current data,0
Train the classifier using the current data,0
Predict using only the majority class,0
Basically let's find which sample have to be retained for the,0
next round,0
Find the misclassified index to keep them for the next round,0
Count how many random element will be selected,0
"We found a new subset, increase the counter",0
Check if we have to make an early stopping,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Also check that we will have enough sample to extract at the,0
next round,0
Select the remaining data,0
Select the final batch,0
Push these data into a new subset,0
"We found a new subset, increase the counter",0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Define the ratio parameter,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Check each array,0
Create the object,0
Generate a global dataset to use,0
Define a negative ratio,0
Define a ratio greater than 1,0
Define ratio as an unknown string,0
Define ratio as a list which is not supported,0
Define a ratio,0
Define the parameter for the under-sampling,0
Create the object,0
Resample the data,0
Create a wrong y,0
Create the object,0
Fit the data,0
Define the parameter for the under-sampling,0
Create the object,0
Fit the data,0
Check if the data information have been computed,0
Define the parameter for the under-sampling,0
Create the object,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Define the ratio parameter,0
Create the sampling object,0
Get the different subset,0
Create the object,0
