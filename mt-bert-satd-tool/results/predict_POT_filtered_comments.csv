Commit Message,predict
!/usr/bin/env python,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
the transport has been computed,0
check if classes are really separated,0
check the necessary inputs parameters are here,0
pairwise distance,0
"missing_labels is a (ns, nt) matrix of {0, 1} such that",0
"the cells (i, j) has 0 iff either ys[i] or yt[j] is masked",0
"labels_match is a (ns, nt) matrix of {True, False} such that",0
"the cells (i, j) has False if ys[i] != yt[i]",0
"cost correction is a (ns, nt) matrix of {-Inf, float, Inf} such",0
"that he cells (i, j) has -Inf where there's no correction necessary",0
by 'correction' we mean setting cost to a large value when,0
labels do not match,0
we suppress potential RuntimeWarning caused by Inf multiplication,0
(as we explicitly cover potential NANs later),0
this operation is necessary because 0 * Inf = NAN,0
thus is irrelevant when limit_max is finite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
coupling estimation,0
deal with the value of log,0
check the necessary inputs parameters are here,0
get the nearest neighbor in the source domain,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
init uniform,0
weak OT loss,0
weak OT gradient,0
solve with conditional gradient and return solution,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
solve the barycenter,0
solve OT with template,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
Main function,0
constant input variables,0
measures on rows and columns,0
pre-calculate cost constants,0
initialize coupling and dual vectors,0
initialize log,0
update sample coupling,0
update feature coupling,0
update error,0
COOT part,0
Entropic part,0
sanity check,0
measures on rows and columns,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
helper function for code factorisation,0
"horizontal source on the bottom, flipped vertically",0
vertical target on the left,0
coupling matrix in the middle,0
vertical source on the left,0
horizontal target on the top,0
coupling matrix in the middle,0
Set title below matrix plot,0
slice over the y values that are in the y range,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
Yikun Bai < yikun.bai@vanderbilt.edu >,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
convert to humpy,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
convert back to backend,0
"Next 3 lines equivalent to K=nx.exp(-M/reg), but faster to compute",0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
optimise the plan,0
optimise the values phi and the gradients G,0
convert back to backend,0
lower bound,0
upper bound,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
###############################################################################,0
Losses for stochastic optimization,0
###############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Jakub Zadrozny <jakub.r.zadrozny@gmail.com>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
marginals,0
print iterations,0
loop,0
Solve transport,0
Solve PCA,0
block coordinate descent,0
majorization-minimization,0
stop or not,0
print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
scipy<1.8.0,0
The corresponding scipy function does not work for matrices,0
it's necessary to check boundary condition here for the coefficient,0
as the callback could be evaluated for negative value of alpha by,0
`scalar_search_armijo` function here:,0
,0
https://github.com/scipy/scipy/blob/11509c4a98edded6c59423ac44ca1b7f28fba1fd/scipy/optimize/linesearch.py#L686,0
,0
see more details https://github.com/PythonOT/POT/issues/502,0
The callable function operates on nx backend,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
to not change G0 in place.,0
problem linearization,0
solve linear program,0
line search,0
the line-search does not allow to update the gradient,0
the line-search allows to update the gradient directly,0
e.g. while using quadratic losses as the gromov-wasserstein loss,0
test convergence,0
get minimum by rows as binary mask,0
instead of exact elements equal to min_ we consider a small margin (1e-15),0
for float precision issues. Then the mass is split uniformly,0
between these elements.,0
return by default an empty inner_log,0
add dummy nodes to Mi,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"V[nx.newaxis, :], max_nz, z, axis=1).ravel()",0
"For each row of V, find top max_nz values; arrange the",0
corresponding column indices such that their values are,0
in a descending order.,0
Extract the top max_nz values for each row,0
and then project to simplex.,0
"rho = nx.count_nonzero(cond, axis=1)",0
Put the projection of max_nz_values to their original column indices,0
while keeping other values zero.,0
"in Jax, we need to use the `at` property of `jax.numpy.ndarray`",0
to do in-place array modifications.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
I assume that other solvers may return directly,0
some primal objects?,0
"In the code below, let's define the main quantities",0
that may be of interest to users.,0
An OT solver returns an object that inherits from OTResult,0
(e.g. SinkhornOTResult) and implements the relevant,0
"methods (e.g. ""plan"" and ""lazy_plan"" but not ""sparse_plan"", etc.).",0
log is a dictionary containing potential information about the solver,0
Dual potentials --------------------------------------------,0
Transport plan -------------------------------------------,0
N.B.: We may catch out-of-memory errors and suggest,0
the use of lazy_plan or sparse_plan when appropriate.,0
Loss values --------------------------------,0
Marginal constraints -------------------------,0
Barycentric mappings -------------------------,0
Return the displacement vectors as an array,0
"that has the same shape as ""xa""/""xb"" (for samples)",0
"or ""a""/""b"" * D (for images)?",0
# Wasserstein barycenters ----------------------,0
@property,0
def masses(self):,0
"""""""Masses for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
@property,0
def samples(self):,0
"""""""Sample locations for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
Miscellaneous --------------------------------,0
The string below refers to the POT library:,0
successor methods may concatenate the relevant references,0
"to the original definitions, solvers and underlying numerical backends.",0
set attributes for named arguments/arrays,0
R[i] = Q[i] @ P[i].T,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
Julie Delon <julie.delon@math.cnrs.fr>,0
,0
License: MIT License,0
"C2[i, j] = Cs12[i] @ C_t[j] @ Cs12[i], shape (k_s, k_t, d, d)",0
"D_covs[i,j] = trace(C_s[i] + C_t[j] - 2C[i,j])",0
only need to compute for non-zero plan entries,0
gaussian mapping between components i and j applied to x,0
"A[i, j] is the linear part of the gaussian mapping between components",0
"i and j, b[i, j] is the translation part",0
only need to compute for non-zero plan entries,0
"(n_samples, k_s)",0
sample between 0 and k_s * k_t - 1,0
hand-made d-variate meshgrid in ij indexing,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
Tianlin Liu <t.liu@unibas.ch>,0
"For each column of X, find entries that are not among the top max_nz.",0
Set these entries to -inf.,0
Project the scaled X onto the simplex with sparsity constraint.,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
convert to humpy,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
Use envelope theorem differentiation for memory saving,0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for EMD solver,0
default values for exact unbalanced OT,0
default values for sinkhorn,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for solver,0
default values for EMD solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['log_u'], log['log_v'])  #TODO",0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v'])",0
default values for solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
for uniform weights,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
lazy solver of memory complexity O(n),0
lazy OT plan,0
Use envelope theorem differentiation for memory saving,0
automatic solver,0
force O(n) memory efficient solver,0
force pre-computed cost matrix,0
use multiscale solver,0
One can play with speed (small scaling factor) and precision (scaling close to 1),0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
recover the lazy low rank plan,0
recover the full low rank plan,0
recover the squared Gaussian Bures-Wasserstein distance,0
recover the squared Wasserstein distances,0
compute cost matrix M and use solve function,0
Detect backend,0
default values for solutions,0
return scaled potentials (to be consistent with other solvers),0
compute potentials,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test if sklearn is installed for linux-minimal-deps,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
First low rank decomposition of the cost matrix (A),0
Second low rank decomposition of the cost matrix (B),0
POT backend if None,0
----------------- Initialisation of Dykstra algorithm -----------------,0
--------------------- Dykstra algorithm -------------------------,0
"See Section 3.3 - ""Algorithm 2 LR-Dykstra"" in paper",0
Compute u^{(1)} and u^{(2)},0
"Compute g, g^{(3)}_1 and update \tilde{g}",0
Compute new value of g with \prod,0
Compute v^{(1)} and v^{(2)},0
"Compute q^{(1)}, q^{(2)} and q^{(3)}_2",0
"Update values of \tilde{v}^{(1)}, \tilde{v}^{(2)} and \tilde{g}",0
Compute error,0
"Compute low rank matrices Q, R",0
POT backend,0
"Initialize weights a, b",0
"Compute rank (see Section 3.1, def 1)",0
Dykstra won't converge if 1/rank < alpha (see Section 3.2),0
Low rank decomposition of the sqeuclidean cost matrix,0
"Initialize the low rank matrices Q, R, g",0
Gamma initialization,0
-------------------------- Low rank algorithm ------------------------------,0
"see ""Section 3.3, Algorithm 3 LOT""",0
Compute C*R dot using the lr decomposition of C,0
Compute C.T * Q using the lr decomposition of C,0
Compute omega,0
Rescale gamma at each iteration,0
LR Dykstra algorithm,0
"----------------- Compute lazy_plan, value and value_linear  ------------------",0
"see ""Section 3.2: The Low-rank OT Problem"" in the paper",0
Compute lazy plan (using LazyTensor class),0
Compute value_linear (using trace formula),0
"Compute value with entropy reg (see ""Section 3.2"" in the paper)",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Mapping between argument types and the existing backend,0
check that all arguments matched or not the type,0
Otherwise return an error,0
check that some arrays given,0
convert batch of tensors to numpy,0
convert a tensor to numpy,0
convert batch of arrays from numpy,0
convert an array from numpy,0
No gradients for numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
Q[...] = V[...] @ diag(L[...]),0
R[...] = Q[...] @ V[...].T,0
"available_devices = jax.devices(""cpu"")",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
Q[...] = V[...] @ diag(L[...]),0
R[...] = Q[...] @ V[...].T,0
Only register jax backend if it is installed,0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
"Since version 1.11.0, interpolation is available",0
"Else, use numpy",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
Q[...] = V[...] @ diag(L[...]),0
R[...] = Q[...] @ V[...].T,0
Only register torch backend if it is installed,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
Q[...] = V[...] @ diag(L[...]),0
R[...] = Q[...] @ V[...].T,0
Only register cp backend if it is installed,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
Q[...] = V[...] @ diag(L[...]),0
R[...] = Q[...] @ V[...].T,0
todo(okachaiev): replace this with a more reasonable implementation,1
Only register tensorflow backend if it is installed,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Compute the mean barycenter,0
Init the covariance barycenter,0
fixed point update,0
check convergence,0
ensure that Cov_s is the largest covariance matrix,0
that is m >= n,0
compte and sort eigenvalues decerasingly,0
compute the gaussien Gromov-Wasserstein distance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
compute the gaussien Gromov-Wasserstein dis,0
estimate mean and covariance,0
compute and sort eigenvalues/eigenvectors decreasingly,0
select the sign of the eigenvalues,0
compute the gaussien Gromov-Wasserstein dis,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
compute loss,0
compute gradient,0
wrap the callable function to handle numpy arrays,0
convert to numpy,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
after that we are all in torch,0
set blur value and p,0
force gradients for computing dual,0
compute value,0
get dual potentials,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Alexander Tong <alexander.tong@yale.edu>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
in case of multiple histograms,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionary,0
geometric interpolation,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
oldidx = nx.copy(idx),0
the above terminates when any entry in idx equals the corresponding,0
value in dims this leaves other dimensions incomplete; the remaining,0
terms of the dual solution must be filled-in,0
define forward/backward relations for pytorch,0
function body here,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
quantiles of F_u evaluated in F_v^\theta,0
Deal with 1,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
Put negative values at the end,0
Compute absciss,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
Compute icdf,0
can probably be improved by computing only relevant values,1
Code inspired from https://gitlab.gwdg.de/shundri/circularOT/-/tree/master/,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
if empty array given then use uniform distributions,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
if empty array given then use uniform distributions,0
store original tensors,0
convert to numpy,0
ensure that same mass,0
variable change matrix to reduce the problem to a Wasserstein Barycenter (WB),0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
compute marginals for global alignment,0
compute global alignment,0
compute local alignments,0
randomly partition the space,0
compute attributed graph partitions potentially using the auxiliary structure,0
"format partitions over (C1, F1) and (C2, F2)",0
call to partitioned quantized fused gromov-wasserstein solver,0
compute the transport cost on structures,0
randomly partition the space,0
randomly select representant in each partition,0
compute attributed partitions and representants,0
"format partitions over (C1, F1) and (C2, F2)",0
call to partitioned quantized fused gromov-wasserstein solver,0
compute the transport cost on structures,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check first marginal of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check first marginal of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
the new cost can be deduced from the line search quadratic function,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of transport plans and C (if not provided by user),0
initial structure is constant so we add a small random noise,0
to avoid getting stuck at init,0
we first compute an initial informative barycenter structure,0
on graphs we can compress,0
then use it on graphs to expand,0
get transport plans,0
update barycenters,0
update convergence criterion,0
"Initialization of transport plans, C and X (if not provided by user)",0
both init_X and init_C are simply deduced from transport plans,0
if not initialized,0
initial structure is constant so we add a small random noise,0
to avoid getting stuck at init,0
more computationally costly inits could be used on structures,0
so we assume affordable a Kmeans-like init for features,0
and use it by default.,0
relies on partitioning of inputs,0
we first compute an initial informative barycenter structure,0
on graphs we can compress,0
then use it on graphs to expand,0
get transport plans,0
update barycenters,0
update convergence criterion,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
POT backend,0
"Initialize weights a, b",0
"Compute rank (see Section 3.1, def 1)",0
Dykstra won't converge if 1/rank < alpha (see Section 3.2),0
"Initial values for LR couplings (Q, R, g) with LOT",0
Gamma initialization,0
initial value of error,0
Compute cost matrices,0
Compute C*R dot using the lr decomposition of C,0
Compute C.T * Q using the lr decomposition of C,0
Compute omega,0
Rescale gamma at each iteration,0
Update couplings with LR Dykstra algorithm,0
Update error with kullback-divergence,0
fix divide by zero,0
Update low rank costs,0
Compute lazy plan (using LazyTensor class),0
Compute value_quad,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
alignment of both structure seen as feature matrices,0
alignment of both structure seen as feature matrices,0
alignment of both structure seen as feature matrices,0
Handle initialization via structure information,0
compute fluid partitioning on the biggest graph,0
compute spectral partitioning on the biggest graph,0
compute spectral partitioning on the biggest graph,0
Add feature information solving a semi-relaxed Wasserstein problem,0
get minimum by rows as binary mask,0
compute coefficients for the barycenter coming from marginals,0
compute coefficients for the barycenter coming from Ts and Cs,0
###########################################################################,0
Methods related to fused unbalanced GW and unbalanced Co-Optimal Transport.,0
###########################################################################,0
Support functions for BCD schemes,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Define gradients,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random euclidean distance matrix (if not provided by user),0
Initialization of Y,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
simple get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
init marginals if set as None,0
compute separate terms for gradients and log,0
the new cost is deduced from the line search quadratic function,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
Alexis Thual <alexis.thual@cea.fr>,0
,0
License: MIT License,0
MAIN FUNCTION,0
hyperparameters,0
constant input variables,0
measures on rows and columns,0
initialize coupling and dual vectors,0
shortcut functions,0
initialize log,0
Update feature coupling,0
Update sample coupling,0
get L1 error,0
sanity check,0
measures on rows and columns,0
extract parameters,0
calculate marginals,0
calculate subgradients,0
set gradients,0
measures on rows and columns,0
calculate marginals,0
calculate subgradients,0
set gradients,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Yikun Bai < yikun.bai@vanderbilt.edu >,0
,0
License: MIT License,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
simple get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
formula to check for partial FGW,0
the new cost is deduced from the line search quadratic function,0
update the gradient for next cg iteration,0
Check marginals of G0,0
Setup gradient computation,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cedric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Handle backend of non-optional arguments,0
Handle backend of optional arguments,0
Initialize randomly structures of dictionary atoms based on samples,0
batch sampling,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
Initialization for our numpy implementation of adam optimizer,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
Initialize randomly structures of dictionary atoms based on samples,0
Initialize randomly features of dictionary atoms based on samples distribution by feature component,0
Batch iterations,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
"modeling (C,Y)",0
constants depending on q,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
structure,0
feature,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
polynomial coefficients from quadratic objective (with respect to w) on structures,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
polynomial coefficient from quadratic objective (with respect to w) on features,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
%%,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
%%,0
Comparison of the OT matrices,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
use fast 1D solver,0
Equivalent to,0
"G0 = ot.emd(a, b, M)",0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: ../_static/images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have access to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan visualization,0
`````````````````````````````````,0
,0
A good visualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: ../_static/images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Empirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Define Group lasso regularization and gradient,0
------------------------------------------------,0
The groups are the first and second half of the columns of G,0
%%,0
Set up parameters for solvers and solve,0
---------------------------------------,0
balanced OT,0
unbalanced OT KL,0
unbalanced OT L2,0
unbalanced OT TV,0
#############################################################################,0
Plot plans,0
----------,0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
"pl.xlim((-7,23))",0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
"pl.xlim((-7,23))",0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
########################################################################################,0
Compare the Euclidean Wasserstein distance with the Wasserstein distance on the  circle,0
---------------------------------------------------------------------------------------,0
This examples illustrates the periodicity of the Wasserstein distance on the circle.,0
We choose as target distribution a von Mises distribution with mean :math:`\mu_{\mathrm{target}}`,0
"and :math:`\kappa=20`. Then, we compare the distances with samples obtained from a von Mises distribution",0
with parameters :math:`\mu_{\mathrm{source}}` and :math:`\kappa=20`.,0
The Wasserstein distance on the circle takes into account the periodicity,0
and attains its maximum in :math:`\mu_{\mathrm{target}}+1` (the antipodal point) contrary to the,0
Euclidean version.,0
%% Compute and plot distributions,0
"np.random.vonmises deals with data on [-pi, pi[",0
"Put data on S^1=[0,1[",0
#######################################################################,0
Wasserstein distance between von Mises and uniform for different kappa,0
----------------------------------------------------------------------,0
"When :math:`\kappa=0`, the von Mises distribution is the uniform distribution on :math:`S^1`.",0
%% Compute Wasserstein between Von Mises and uniform,0
"np.random.vonmises deals with data on [-pi, pi[",0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with squared l2 regularization,0
%% Sparsity-constrained OT,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Generating the fitting data,0
%%,0
Fitting the Nearest Brenier Potential,0
%%,0
Plotting the images of the source data,0
%%,0
Computing the predictions (images by nabla phi) for random samples of the source distribution,0
%%,0
Plot predictions for the gradient of the lower-bounding potential,0
%%,0
Plot predictions for the gradient of the upper-bounding potential,0
-*- coding: utf-8 -*-,0
Author: Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Plot data,0
-------------,0
#############################################################################,0
Compute EWCA,0
-------------,0
#############################################################################,0
"Plot data, first component, and projected data",0
-------------,0
#############################################################################,0
Plot transport plan,0
-------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
Julie Delon <julie.delon@math.cnrs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
Generate GMMOT plan plot it,0
---------------------------,0
#############################################################################,0
Generate GMMOT maps and plot them over plan,0
-------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generate data,0
-------------,0
The source and clean target matrices are generated by,0
":math:`X_{i,j} = \cos(\frac{i}{n_1} \pi) + \cos(\frac{j}{d_1} \pi)` and",0
":math:`Y_{i,j} = \cos(\frac{i}{n_2} \pi) + \cos(\frac{j}{d_2} \pi)`.",0
The target matrix is then contaminated by adding 5 row outliers.,0
"Intuitively, we expect that the estimated sample distribution should ignore these outliers,",0
i.e. their weights should be zero.,0
Generate clean target data mixed with outliers,0
%%,0
Optimize the COOT distance with respect to the sample marginal distribution,0
---------------------------------------------------------------------------,0
Estimated sample marginal distribution and training loss curve,0
%%,0
Visualizing the row and column alignments with the estimated sample marginal distribution,0
-----------------------------------------------------------------------------------------,0
,0
"Clearly, the learned marginal distribution completely and successfully ignores the 5 outliers.",0
%%,0
"Now, let see if we can use unbalanced Co-Optimal Transport to recover the clean OT plans,",0
without the need of learning the marginal distribution as in Co-Optimal Transport.,0
-----------------------------------------------------------------------------------------,0
%%,0
Visualizing the row and column alignments learned by unbalanced Co-Optimal Transport.,0
-----------------------------------------------------------------------------------------,0
,0
"Similar to Co-Optimal Transport, we are also be able to fully recover the clean OT plans.",0
-*- coding: utf-8 -*-,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
Gaussian distribution,0
Source and target distribution,0
#############################################################################,0
Solve Low rank sinkhorn,0
------------,0
%%,0
Solve low rank sinkhorn,0
#############################################################################,0
Sinkhorn vs Low Rank Sinkhorn,0
-----------------------,0
Compare Sinkhorn and Low rank sinkhorn with different regularizations and ranks.,0
%% Sinkhorn,0
Compute cost matrix for sinkhorn OT,0
Solve sinkhorn with different regularizations using ot.solve,0
%% Low rank sinkhorn,0
Solve low rank sinkhorn with different ranks using ot.solve_sample,0
%%,0
Plot sinkhorn vs low rank sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%% Load modules,0
%%,0
Data for logo,0
-------------,0
Letter P,0
Letter O,0
Scaling and translation for letter O,0
Letter T,0
Translating the T,0
Concatenate all letters,0
Horizontal and vertical scaling,0
%%,0
Plot the logo (clear background),0
--------------------------------,0
Solve OT problem between the points,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo.png', dpi=150, transparent=True, bbox_inches='tight')",0
%%,0
Plot the logo (dark background),0
--------------------------------,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo_dark.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo_dark.png', dpi=150, transparent=True, bbox_inches='tight')",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generating two random matrices,0
%%,0
Visualizing the matrices,0
%%,0
"Visualizing the alignments of rows and columns, and calculating the CO-Optimal Transport distance",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data an plot it,0
------------------------,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
#############################################################################,0
Compute Weak OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% Weak OT,0
#############################################################################,0
Plot weak OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
%%,0
Generating 2 distributions,0
-----,0
Gaussian distributions,0
%%,0
"Minimize the distances among distributions, identify the Barycenter",0
-----,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
L2 Iteration,0
%%,0
Compare Barycenters in both methods,0
-----,0
"pl.plot(x, barys[i], 'g-*')",0
%%,0
More than 2 distributions,0
--------------------------------------------------,0
Generate 7 pseudorandom gaussian distributions with 50 bins.,0
%%,0
Minimizing Distances Among Many Distributions,0
---------------,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
Perform gradient descent optimization using the d-MMOT method.,0
"after minimization, any distribution can be used as a estimate of barycenter.",0
Compute 1D Wasserstein barycenter using the L2/LP method,0
%%,0
Compare Barycenters in both methods,0
---------,0
%%,0
Compare with original distributions,0
---------,0
"pl.plot(x, barys[i], 'g')",0
%%,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
Julie Delon <julie.delon@math.cnrs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data and plot it,0
-------------------------,0
#############################################################################,0
Gradient descent loop,0
------------------------,0
#############################################################################,0
Last step visualisation,0
------------------------,0
#############################################################################,0
Steps visualisation,0
------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinuous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinuous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
Generate 2D and 3D curves,0
Source and target distribution,0
#############################################################################,0
Plot data,0
------------,0
%%,0
Plot the source and target samples,0
#############################################################################,0
Entropic Gromov-Wasserstein,0
------------,0
%%,0
Compute cost matrices,0
Scale cost matrices,0
Solve entropic gw,0
Plot entropic gw,0
#############################################################################,0
Low rank squared euclidean cost matrices,0
------------,0
%%,0
Compute the low rank sqeuclidean cost decompositions,0
Scale the low rank cost matrices,0
#############################################################################,0
Low rank Gromov-Wasserstein,0
------------,0
%%,0
Solve low rank gromov-wasserstein with different ranks,0
%%,0
Plot low rank GW with different ranks,0
%%,0
Compare computation time between entropic GW and low rank GW,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data an plot it,0
------------------------,0
parameters and data generation,0
%% plot samples,0
%%,0
Compute Factored OT and exact OT solutions,0
------------------------------------------,0
%% EMD,0
%% factored OT OT,0
%%,0
Plot factored OT and exact OT solutions,0
---------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labeled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
Gaussian (linear) Monge mapping estimation,0
Gaussian (linear) GW mapping estimation,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
Monge mapping,0
gaussian GW mapping,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
Labels,0
Ticks,0
##############################################################################,0
Spherical Sliced Wasserstein for different seeds and number of projections,0
--------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Spherical Sliced Wasserstein,0
---------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
%%,0
plot the transported mass,0
-------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@ensae.fr>,0
License: MIT License,0
#############################################################################,0
Setting parameters,0
-------------,0
%% parameters,0
#############################################################################,0
Compute entropic kl-regularized UOT with Sinkhorn and Translation Invariant Sinkhorn,0
-----------,0
loss matrix,0
#############################################################################,0
Plot the results,0
----------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------------------------------------------------------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------------------,0
,0
The OT plan is plotted as a function of $\gamma$ that is the inverse of the,0
weight on the marginal relaxations.,0
%% fully relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for UOT l2,0
-----------------------------------,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-----------------------------------------,0
%% semi-relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for semi-relaxed UOT l2,0
------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
"Compute entropic kl-regularized UOT, kl- and l2-regularized UOT",0
-----------,0
#############################################################################,0
Plot the results,0
----------------,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
----------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
--------------------------------------------------------,0
The adjacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
-------------------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the node in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating dual variables for entropic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize the dual loss,0
%%,0
Plot the estimated entropic OT plan,0
-----------------------------------,0
%%,0
Estimating dual variables for quadratic OT,0
------------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize the dual loss,0
%%,0
Plot the estimated quadratic OT plan,0
------------------------------------,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
----------------------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
---------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
-----------------------------------------,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate samples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
--------------------------------------------------,0
#############################################################################,0
Plotting the reweighted source distribution,0
-------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating deep dual variables for entropic OT,0
----------------------------------------------,0
define the MLP model,0
number of iteration,0
generate noise samples,0
minus because we maximize the dual loss,0
%%,0
Plot the density on target for a given source sample,0
----------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Gradient descent,0
----------------,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
"pl.subplot(3, 3, i + 1)",0
ax = pl.axes(projection='3d'),0
"ax.axis(""off"")",0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
compute OT sparsity level,0
Methods using Sinkhorn projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Compute GW with scalable stochastic methods with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
############################################################################,0
,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
-----------------------------------------------------------------------------------------------,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability,",0
and variable cluster proportions.,0
Visualize samples,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the srGW barycenter from the dataset and visualize embeddings,0
-----------------------------------------------------------,0
Here we use the Fluid partitioning method to deduce initial transport plans,0
for the barycenter problem. An initlal structure is also deduced from these,0
initial transport plans. Then a warmstart strategy is used iteratively to,0
init each individual srGW problem within the BCD algorithm.,0
Compute the 2D representation of the embeddings living in the 2-simplex of probability,0
############################################################################,0
,0
Endow the dataset with node features,0
------------------------------------,0
"node labels, corresponding to the true SBM cluster assignments,",0
are set for each graph as one-hot encoded node features.,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the srFGW barycenter from the attributed graphs and visualize embeddings,0
-----------------------------------------------------------,0
We emphasize the dependence to the trade-off parameter alpha that weights the,0
"relative importance between structures (alpha=1) and features (alpha=0),",0
knowing that embeddings that perfectly cluster graphs w.r.t their features,0
should ease the identification of the number of clusters in the graphs.,0
Compute the 2D representation of the embeddings living in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
############################################################################,0
,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
-----------------------------------------------------------------------------------------------,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",0
Visualize samples,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the Gromov-Wasserstein dictionary from the dataset,0
-----------------------------------------------------------,0
visualize loss evolution over epochs,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Compute the 2D representation of the unmixing living in the 2-simplex of probability,0
############################################################################,0
,0
Endow the dataset with node features,0
------------------------------------,0
We follow this feature assignment on all nodes of a graph depending on its label/number of clusters,0
1 cluster --> 0 as nodes feature,0
2 clusters --> 1 as nodes feature,0
3 clusters --> 2 as nodes feature,0
features are one-hot encoded following these assignments,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs,0
------------------------------------------------------------------------------------,0
visualize loss evolution,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
scaled_F = 2 * (Fatom - min_features) / (max_features - min_features),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Visualize unmixings in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
#############################################################################,0
Compute FGW/GW,0
--------------,0
Computing FGW and GW,0
reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
visu OT matrix,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their entropic-regularized semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW_e(C2, h2, C3)",0
"2) srGW_e(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the entropic-regularized semi-relaxed Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the entropic srGW matching.,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW_e(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the entropic semi-relaxed Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
############################################################################,0
,0
Generate graphs,0
--------------------------------------------------------------------------,0
,0
Create two graphs following Stochastic Block models of 2 and 3 clusters.,0
Add weights on the edges for visualization later on,0
setup for graph visualization,0
get graphs partition and their coloring,0
############################################################################,0
,0
Compute their quantized Gromov-Wasserstein distance without using the wrapper,0
---------------------------------------------------------,0
,0
We detail next the steps implemented within the wrapper that preprocess graphs,0
"to form partitioned graphs, which are then passed as input to the generic qFGW solver.",0
1-a) Partition C1 and C2 in 2 and 3 clusters respectively using Louvain,0
algorithm from Networkx. Then encode these partitions via vectors of assignments.,0
1-b) Select representant in each partition using the Pagerank algorithm,0
implementation from networkx.,0
1-c) Format partitions such that:,0
CR contains relations between representants in each space.,0
list_R contains relations between samples and representants within each partition.,0
list_h contains samples relative importance within each partition.,0
1-d) call to partitioned quantized gromov-wasserstein solver,0
Visualization of the graph pre-processing,0
############################################################################,0
,0
Compute the quantized Gromov-Wasserstein distance using the wrapper,0
---------------------------------------------------------,0
,0
"Compute qGW(spC1, h1, spC2, h2). We also illustrate the use of auxiliary matrices",0
such that the adjacency matrices `C1_aux=C1` and `C2_aux=C2` to partition the graph using,0
"Louvain algorithm, and the Pagerank algorithm for selecting representant within",0
"each partition. Notice that `C1_aux` and `C2_aux` are optional, if they are not",0
specified these pre-processing algorithms will be applied to spC2 and spC3.,0
no node features are considered on this synthetic dataset. Hence we simply,0
"let F1, F2 = None and set alpha = 1.",0
############################################################################,0
,0
Visualization of the quantized Gromov-Wasserstein matching,0
--------------------------------------------------------------,0
,0
We color nodes of the graph based on the respective partition of each graph.,0
On the first plot we illustrate the qGW matching between both shortest path matrices.,0
While the GW matching across representants of each space is illustrated on the right.,0
get graphs partition and their coloring,0
############################################################################,0
,0
Generate attributed point clouds,0
--------------------------------------------------------------------------,0
,0
"Create two attributed point clouds representing curves in 2D and 3D respectively,",0
whose samples are further associated to various color intensities.,0
Generate 2D and 3D curves,0
Source and target distribution across spaces encoded respectively via their,0
squared euclidean distance matrices.,0
Further associated to color intensity features derived from z,0
############################################################################,0
,0
Visualize partitioned attributed point clouds,0
--------------------------------------------------------------------------,0
,0
Compute the partitioning and representant selection further used within,0
"qFGW wrapper, both provided by a K-means algorithm. Then visualize partitioned spaces.",0
Plot the source and target samples as distributions,0
############################################################################,0
,0
Compute the quantized Fused Gromov-Wasserstein distance between samples using the wrapper,0
---------------------------------------------------------,0
,0
"Compute qFGW(X, FX, hX, Y, FY, HY), setting the trade-off parameter between",0
structures and features `alpha=0.5`. This solver considers a squared euclidean structure,0
"for each distribution X and Y, and partition each of them into 4 clusters using",0
the K-means algorithm before computing qFGW.,0
Plot low rank GW with different ranks,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create 2 classes of stochastic block models (SBM) graphs with 1 block and 2 blocks respectively.,0
edge probabilities for the SBMs,0
block sizes,0
node features,0
split the data into train and test sets,0
%%,0
#############################################################################,0
Plot data,0
---------,0
plot one graph of each class,0
%%,0
#############################################################################,0
Pooling architecture using the TFGW layer,0
---------,0
#############################################################################,0
Graph classification training,0
---------,0
store latent embeddings and classes for TSNE visualization,0
store last classes and embeddings for TSNE visualization,0
Test,0
%%,0
#############################################################################,0
TSNE visualization of graph classification,0
---------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
Compute pairwise euclidean distance between node features,0
############################################################################,0
,0
Compute their Fused Gromov-Wasserstein distances,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
Alternated Bregman Projected Gradient algorithm with Kullback-Leibler as proximal operator,0
compute OT sparsity level,0
Methods using Sinkhorn/Bregman projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Visualization of the Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the FGW matchings,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
"For each matching, all node sizes are proportionnal to their mass computed",0
from marginals of the OT plan to illustrate potential feasibility errors.,0
NB: colors refer to clusters - not to node features,0
Add weights on the edges for visualization later on,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
--------------------------------------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW(C2, h2, C3)",0
"2) srGW(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Gromov-Wasserstein matchings,0
--------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srGW matching,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
-----------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Fused Gromov-Wasserstein matchings,0
--------------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Authors: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
%%,0
Define Gaussian Covariances and distributions,0
---------------------------------------------,0
%%,0
Plot the distributions,0
----------------------,0
"pl.scatter(mu[0],mu[1],color=color, marker='x')",0
%%,0
Compute Bures-Wasserstein barycenters and plot them,0
-------------------------------------------,0
basis for bilinear interpolation,0
weights are constructed by bilinear interpolation,0
-*- coding: utf-8 -*-,0
Authors: Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
%%,0
General Parameters,0
------------------,0
%%,0
Generate Data,0
-------------,0
%%,0
Inspect generated distributions,0
-------------------------------,0
%%,0
Interpolating Empirical Distributions,0
-------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#######################,0
Generate and plot data,0
----------------------,0
Input measures,0
Input measure locations in their respective 2D spaces,0
Input measure weights,0
Projections 3D -> 2D,0
Barycenter weights,0
Number of barycenter points to compute,0
Send the input measures into 3D space for visualization,0
Plot the input data,0
################################,0
Barycenter computation and plot,0
-------------------------------,0
############################,0
Plotting projection matches,0
---------------------------,0
#############################################,0
Rotation animation,0
--------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Authors: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data,0
-------------,0
%%,0
Compute free support Wasserstein barycenter,0
-------------------------------------------,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
%%,0
Compute free support Sinkhorn barycenter,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
set numpy print options : TODO update tests when all release use modern numpy,1
make sure TF doesn't allocate entire GPU,0
allow numpy API for TF,0
Author: Laurène DAVID <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test computation of low rank cost matrices M1 and M2,0
test low rank sinkhorn,0
check constraints for P,0
check if lazy_plan is equal to the fully computed plan,0
check if value_linear is correct with its original formula,0
check warn parameter when Dykstra algorithm doesn't converge,0
test lowrank inits,0
"test ImportError if init=""kmeans"" and sklearn not imported",0
check constraints for P,0
Test warning for value of alpha,0
Test lr sinkhorn with different init strategies,0
check constraints for P,0
Test low rank sinkhorn for different backends,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
check constraints,0
test weak ot solver for different backends,0
check constraints,0
check constraints,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
generate gaussian dataset,0
compute first 3 components with BCD,0
test that U contains the principal components,0
compute first 3 components with MM,0
test that U contains the principal components,0
compute last 3 components,0
test that U contains the last principal components,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
chaeck that identity is recovered,0
check G is identity,0
check constraints,0
test weak ot solver for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
check transported mass,0
check constraints,0
check transported mass,0
check constraints,0
Author: Eloi Tanguy <eloi.tanguy@u-paris>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
Julie Delon <julie.delon@math.cnrs.fr>,0
,0
License: MIT License,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check that an error is raised if the metric is not a Minkowski one,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test binary_search_circle and wasserstein_circle give similar results as emd,0
check loss is similar,0
test semidiscrete_wasserstein2_unif_circle versus wasserstein_circle,0
"w_u = rng.uniform(0., 1., n)",0
w_u = w_u / w_u.sum(),0
check loss is similar,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
set readable ids for each param,0
solve unif weights,0
solve signe weights,0
check some attributes,0
"print(""dual = {}"".format(sol.potentials))",0
"assert_allclose_sol(sol0, sol)",0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
"Note, gradients aer invariant to change in constant so we center them",0
solve unif weights,0
solve signe weights,0
solve in backend,0
test not implemented and check raise,0
check some attributes,0
solve in backend,0
solve in backend,0
test not implemented and check raise,0
detect partial not implemented and error detect in value,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve signe weights,0
test solve_sample when is_Lazy = False,0
solve signe weights,0
check some attributes (no need ),0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
create a lazy tensor,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
"For each column of X, find top max_nz values and",0
their corresponding indices. This incurs a sort.,0
Project the top max_nz values onto the simplex.,0
This incurs a second sort.,0
Put the projection of max_nz_values to their original indices,0
and set all other values zero.,0
check that two versions produce consistent results,0
test timing,0
"np.testing.assert_allclose(0.1, t, rtol=1e-1, atol=1e-1)",0
very slow macos github action equality not possible,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
test print,0
tets get citation,0
"i,j can be integers or slices, x1,x2 have to be passed as keyword arguments",0
create a lazy tensor,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
total sum,0
sum over axis 0,0
sum over axis 1,0
test otehr reduction function,0
test 3D tensors,0
create a lazy tensor,0
total sum,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
labels are shifted,0
labels are shifted but the shift if expected,0
test on non-negative tensors,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check this only if GPU is available,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Barycenter initialization,0
"Obvious barycenter locations. Take a look on test_ot.py, test_free_support_barycenter",0
Calculate free support barycenter w/ Sinkhorn algorithm. We set the entropic regularization,0
"term to 1, but this should be, in general, fine-tuned to the problem.",0
Verifies if calculated barycenter matches ground-truth,0
Gaussian distributions,0
creating matrix A containing all distributions,0
assymetric loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
First image,0
Second image,0
Creating matrix A containing all distributions,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check this only if GPU is available,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
call with log = False,0
check equality of plans,0
check error on wrong metric,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
Test sinkhorn divergence,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
Compute loss using dmmot_monge_1dgrid_loss,0
Compute loss using exact OT solver with absolute ground metric,0
deal with C-contiguous error from tensorflow backend (not sure why),0
compute loss,0
test discrete_mmot_converge result,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test couplings,0
test divergence,0
test couplings,0
test divergence,0
test couplings,0
test divergence,0
linear part,0
test couplings,0
test divergence,0
test couplings,0
test divergence,0
test divergence,0
test couplings,0
test divergence,0
test divergence,0
linear part,0
test couplings,0
test divergence,0
test couplings,0
test divergence,0
test couplings,0
test divergence,0
raise error of divergence,0
raise error of solver,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for mass mismatch,0
check with empty inputs,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd2 and emd2 with openmp for simple identity,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two Diracs,0
obvious barycenter location between two Diracs,0
obvious barycenter location between two 2D Diracs,0
test without log and no init,0
test with log and init,0
obvious barycenter between two Diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test that types mathcing different backends in input raise an error,0
Check that subclassing a numpy array does not break get_backend,0
note: This is only tested for numpy as this is hard to be consistent,0
with other backends,0
Sparse tensors test,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
"test without log but with X_classes, a, b and other init method",0
"'new' input isn't new, so should be equal to target",0
test with no log but classes,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Test weights argument,0
test with closed form for diagonal covariance matrices,0
no log,0
no log + skewness,0
test the other way around (target to source),0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict,0
predict on batch,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict on batch,0
Test the TW layer by passing two graphs through the layer and doing backpropagation.,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test couplings,0
test marginal distributions,0
test entropic COOT distance,0
test couplings,0
test marginal distributions,0
test COOT distance,0
raise value error of method sinkhorn,0
raise value error for epsilon,0
raise value error for alpha,0
initialize warmstart,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test with coot distance,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
prepare semi-supervised labels,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
prepare semi-supervised labels,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test diffeernt transform and inverse transform,0
test diffeernt transform,0
test its computed,0
test dimensions of coupling,0
test coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
Mapping tests,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
"'new' input isn't new, so should be equal to target",0
test all margin constraints with gaussian similarity and disp regularisation,0
previously used implementation for the cost estimator,0
new vectorized implementation for the cost estimator,0
hard-coded params from the original code,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
check if the marginals come close to the true ones when large reg,0
check if mm_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test when G0 is given,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
test generalized sinkhorn for unbalanced OT,0
check in case no histogram is provided or histogram is None,0
test generalized sinkhorn for unbalanced OT,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
options for reg_m,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
options for reg_m,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
"reg_type=""entropy"" as multiple inputs does not work for KL yet",0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric - testing various initialization of the OT plan.,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
create directed sbm with C2 as connectivity matrix,0
asymmetric structure - checking constraints and values,0
asymmetric - check consistency between srFGW and srFGW2,0
symmetric structures + checking losses + inits,0
checking consistency with srFGW and srFGW2 solvers,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric - testing various initialization of the OT plan.,0
check constraints,0
comparison between srGW and srGW2 solvers,0
check constraints,0
setup,0
create directed sbm with C2 as connectivity matrix,0
asymmetric structure - checking constraints and values,0
check constraints,0
symmetric structures + checking losses + inits,0
checking consistency with srFGW and srFGW2 solvers,0
setup,0
test on admissible stopping criterion,0
test consistency of outputs across backends with 'square_loss',0
using different losses,0
+ tests on different inits,0
test of gromov_barycenters with `log` on,0
test consistency across backends with larger barycenter than inputs,0
test providing init_C,0
test consistency across backends with 'kl_loss',0
test of gromov_barycenters with `log` on,0
providing init_C similarly than in the function.,0
test edge cases for gw barycenters:,0
unique input structure,0
test correspondance with utils function,0
Tests with `fixed_structure=False` and `fixed_features=True`,0
add test with 'kl_loss',0
test correspondance with utils function,0
test consistency of outputs across backends with 'square_loss',0
with various initialization of G0,0
"test while providing advanced T inits and init_X != None, and init_C !=None",0
test consistency of backends while barycenter size not strictly inferior to sizes,0
test edge cases for semirelaxed fgw barycenters:,0
unique input structure,0
Author: Laurène DAVID <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test flat product operator,0
test value,0
test low rank gromov wasserstein,0
check constraints for P,0
check if lazy_plan is equal to the fully computed plan,0
check warn parameter when low rank GW algorithm doesn't converge,0
check warn parameter when Dykstra algorithm doesn't converge,0
Test warning for value of alpha and rank,0
Test lr sinkhorn with different init strategies,0
check constraints for P,0
Test low rank sinkhorn for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
Cédric Vincent-Cuat <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
clean samples,0
add noise,0
check consistency across backends and stability w.r.t loss/marginals/sym,0
precision error while doubling numbers of computations with symmetric=False,0
some instability can occur with kl. to investigate further.,0
changing log offset in _transform_matrix was a way to solve it,0
but it also negatively affects some other solvers in the API,0
tests with different number of samples across spaces,0
Edge cases - tests with m=1 set by default (coincide with gw),0
tests for pGW2,0
tests integers,0
computing necessary inputs to the line-search,0
perform line-search,0
clean samples,0
add noise,0
check consistency across backends and stability w.r.t loss/marginals/sym,0
tests with m is None,0
tests with different number of samples across spaces,0
tests for pGW2,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: compare reconstruction error using initial dictionary and dictionary learned using this initialization,0
> Compute initial reconstruction of samples on this random dictionary without backend,0
> Learn the dictionary using this init,0
> Compute reconstruction of samples on learned dictionary without backend,0
Test: Perform same experiments after going through backend,0
Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
knowing than the initialization scheme is the same than implemented to set the benchmarked initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
and testing other optimization settings untested until now.,0
We pass previously estimated dictionaries to speed up the process.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: Compute initial reconstruction of samples on this random dictionary,0
> Learn a dictionary using this given initialization and check that the reconstruction loss,0
on the learned dictionary is lower than the one using its initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Compare both,0
Test: Perform same experiments after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform similar experiment without providing the initial dictionary being an optional input,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
"Test: without using adam optimizer, with log and verbose set to True",0
> Experiment providing previously estimated dictionary to speed up the test compared to providing initial random init.,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
> Compare results with/without backend,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
test edge cases for the update of the barycenter with `p != None`,0
and `target=False`,0
test not supported metrics,0
test not supported method,0
tests consistency across backends with m > n,0
tests consistency across backends with m = n,0
tests consistency across backends with m > n,0
tests consistency across backends with m = n,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
Tests with marginal_loss = False,0
check constraints,0
check constraints,0
setup,0
test with 'kl_loss' and log=True,0
"providing init_C, init_Y",0
add tests with fixed_structures or fixed_features,0
test edge cases for fgw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
providing init_C,0
test edge cases for gw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
test sinkhorn,0
entropic gw and fgw,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
linear part,0
test couplings,0
test divergence,0
linear part,0
test divergence,0
linear part,0
test divergence,0
linear part,0
test divergence,0
linear part,0
test divergence,0
linear part,0
test divergence,0
raise error of divergence,0
raise error of solver,0
linear part,0
test couplings,0
linear part,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
classical gradients,0
Test with exact line-search,0
Test with armijo line-search,0
classical gradients,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
providing init_C,0
test edge cases for gw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
check constraints,0
check constraints,0
add features,0
check constraints,0
check constraints,0
Tests with kl-loss:,0
check constraints,0
check constraints,0
add features,0
check constraints,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
test correspondance with utils function,0
add test with 'kl_loss',0
test correspondance with utils function,0
test edge cases for fgw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
complementary tests for utils functions,0
tests for edge cases of the graph partitioning,0
tests for edge cases of the representant selection,0
tests for edge cases of the format_partitioned_graph function,0
Tests in qFGW solvers,0
for non admissible values of alpha,0
for non-consistent feature information provided,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
tests for edge cases of the representant selection,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
complementary tests for utils functions,0
tests for edge cases of the format_partitioned_graph function,0
for non-consistent feature information provided,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
"html_css_files = [""css/custom.css""]",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
the transport has been computed,0
check if classes are really separated,0
check the necessary inputs parameters are here,0
pairwise distance,0
"missing_labels is a (ns, nt) matrix of {0, 1} such that",0
"the cells (i, j) has 0 iff either ys[i] or yt[j] is masked",0
"labels_match is a (ns, nt) matrix of {True, False} such that",0
"the cells (i, j) has False if ys[i] != yt[i]",0
"cost correction is a (ns, nt) matrix of {-Inf, float, Inf} such",0
"that he cells (i, j) has -Inf where there's no correction necessary",0
by 'correction' we mean setting cost to a large value when,0
labels do not match,0
we suppress potential RuntimeWarning caused by Inf multiplication,0
(as we explicitly cover potential NANs later),0
this operation is necessary because 0 * Inf = NAN,0
thus is irrelevant when limit_max is finite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
coupling estimation,0
deal with the value of log,0
check the necessary inputs parameters are here,0
get the nearest neighbor in the source domain,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
init uniform,0
weak OT loss,0
weak OT gradient,0
solve with conditional gradient and return solution,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
solve the barycenter,0
solve OT with template,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
Main function,0
constant input variables,0
measures on rows and columns,0
pre-calculate cost constants,0
initialize coupling and dual vectors,0
initialize log,0
update sample coupling,0
update feature coupling,0
update error,0
COOT part,0
Entropic part,0
sanity check,0
measures on rows and columns,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
Yikun Bai < yikun.bai@vanderbilt.edu >,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
convert to humpy,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
convert back to backend,0
"Next 3 lines equivalent to K=nx.exp(-M/reg), but faster to compute",0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
optimise the plan,0
optimise the values phi and the gradients G,0
convert back to backend,0
lower bound,0
upper bound,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
###############################################################################,0
Losses for stochastic optimization,0
###############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Jakub Zadrozny <jakub.r.zadrozny@gmail.com>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
marginals,0
print iterations,0
loop,0
Solve transport,0
Solve PCA,0
block coordinate descent,0
majorization-minimization,0
stop or not,0
print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
scipy<1.8.0,0
The corresponding scipy function does not work for matrices,0
it's necessary to check boundary condition here for the coefficient,0
as the callback could be evaluated for negative value of alpha by,0
`scalar_search_armijo` function here:,0
,0
https://github.com/scipy/scipy/blob/11509c4a98edded6c59423ac44ca1b7f28fba1fd/scipy/optimize/linesearch.py#L686,0
,0
see more details https://github.com/PythonOT/POT/issues/502,0
The callable function operates on nx backend,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
to not change G0 in place.,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
get minimum by rows as binary mask,0
return by default an empty inner_log,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"V[nx.newaxis, :], max_nz, z, axis=1).ravel()",0
"For each row of V, find top max_nz values; arrange the",0
corresponding column indices such that their values are,0
in a descending order.,0
Extract the top max_nz values for each row,0
and then project to simplex.,0
"rho = nx.count_nonzero(cond, axis=1)",0
Put the projection of max_nz_values to their original column indices,0
while keeping other values zero.,0
"in Jax, we need to use the `at` property of `jax.numpy.ndarray`",0
to do in-place array modificatons.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
I assume that other solvers may return directly,0
some primal objects?,0
"In the code below, let's define the main quantities",0
that may be of interest to users.,0
An OT solver returns an object that inherits from OTResult,0
(e.g. SinkhornOTResult) and implements the relevant,0
"methods (e.g. ""plan"" and ""lazy_plan"" but not ""sparse_plan"", etc.).",0
log is a dictionary containing potential information about the solver,0
Dual potentials --------------------------------------------,0
Transport plan -------------------------------------------,0
N.B.: We may catch out-of-memory errors and suggest,0
the use of lazy_plan or sparse_plan when appropriate.,0
Loss values --------------------------------,0
Marginal constraints -------------------------,0
Barycentric mappings -------------------------,0
Return the displacement vectors as an array,0
"that has the same shape as ""xa""/""xb"" (for samples)",0
"or ""a""/""b"" * D (for images)?",0
# Wasserstein barycenters ----------------------,0
@property,0
def masses(self):,0
"""""""Masses for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
@property,0
def samples(self):,0
"""""""Sample locations for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
Miscellaneous --------------------------------,0
The string below refers to the POT library:,0
successor methods may concatenate the relevant references,0
"to the original definitions, solvers and underlying numerical backends.",0
set attributes for named arguments/arrays,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
Tianlin Liu <t.liu@unibas.ch>,0
"For each column of X, find entries that are not among the top max_nz.",0
Set these entries to -inf.,0
Project the scaled X onto the simplex with sparsity constraint.,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
convert to humpy,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
Use envelope theorem differentiation for memory saving,0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for EMD solver,0
default values for exact unbalanced OT,0
default values for sinkhorn,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for solver,0
default values for EMD solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['log_u'], log['log_v'])  #TODO",0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v'])",0
default values for solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
for uniform weights,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
lazy solver of memory complexity O(n),0
lazy OT plan,0
Use envelope theorem differentiation for memory saving,0
automatic solver,0
force O(n) memory efficient solver,0
force pre-computed cost matrix,0
use multiscale solver,0
One can play with speed (small scaling factor) and precision (scaling close to 1),0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
recover the lazy low rank plan,0
recover the full low rank plan,0
recover the squared Gaussian Bures-Wasserstein distance,0
recover the squared Wasserstein distances,0
compute cost matrix M and use solve function,0
Detect backend,0
default values for solutions,0
return scaled potentials (to be consistent with other solvers),0
compute potentials,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test if sklearn is installed for linux-minimal-deps,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
First low rank decomposition of the cost matrix (A),0
Second low rank decomposition of the cost matrix (B),0
POT backend if None,0
----------------- Initialisation of Dykstra algorithm -----------------,0
--------------------- Dykstra algorithm -------------------------,0
"See Section 3.3 - ""Algorithm 2 LR-Dykstra"" in paper",0
Compute u^{(1)} and u^{(2)},0
"Compute g, g^{(3)}_1 and update \tilde{g}",0
Compute new value of g with \prod,0
Compute v^{(1)} and v^{(2)},0
"Compute q^{(1)}, q^{(2)} and q^{(3)}_2",0
"Update values of \tilde{v}^{(1)}, \tilde{v}^{(2)} and \tilde{g}",0
Compute error,0
"Compute low rank matrices Q, R",0
POT backend,0
"Initialize weights a, b",0
"Compute rank (see Section 3.1, def 1)",0
Dykstra won't converge if 1/rank < alpha (see Section 3.2),0
Low rank decomposition of the sqeuclidean cost matrix,0
"Initialize the low rank matrices Q, R, g",0
Gamma initialization,0
-------------------------- Low rank algorithm ------------------------------,0
"see ""Section 3.3, Algorithm 3 LOT""",0
Compute C*R dot using the lr decomposition of C,0
Compute C.T * Q using the lr decomposition of C,0
Compute omega,0
Rescale gamma at each iteration,0
LR Dykstra algorithm,0
"----------------- Compute lazy_plan, value and value_linear  ------------------",0
"see ""Section 3.2: The Low-rank OT Problem"" in the paper",0
Compute lazy plan (using LazyTensor class),0
Compute value_linear (using trace formula),0
"Compute value with entropy reg (see ""Section 3.2"" in the paper)",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Mapping between argument types and the existing backend,0
check that all arguments matched or not the type,0
Otherwise return an error,0
check that some arrays given,0
convert batch of tensors to numpy,0
convert a tensor to numpy,0
convert batch of arrays from numpy,0
convert an array from numpy,0
No gradients for numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
Only register jax backend if it is installed,0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
"Since version 1.11.0, interpolation is available",0
"Else, use numpy",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
Only register torch backend if it is installed,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
Only register cp backend if it is installed,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
todo(okachaiev): replace this with a more reasonable implementation,1
Only register tensorflow backend if it is installed,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Compute the mean barycenter,0
Init the covariance barycenter,0
fixed point update,0
check convergence,0
ensure that Cov_s is the largest covariance matrix,0
that is m >= n,0
compte and sort eigenvalues decerasingly,0
compute the gaussien Gromov-Wasserstein distance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
compute the gaussien Gromov-Wasserstein dis,0
estimate mean and covariance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
select the sign of the eigenvalues,0
compute the gaussien Gromov-Wasserstein dis,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
compute loss,0
compute gradient,0
convert to numpy,0
wrap the callable function to handle numpy arrays,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
after that we are all in torch,0
set blur value and p,0
force gradients for computing dual,0
compute value,0
get dual potentials,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Alexander Tong <alexander.tong@yale.edu>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
in case of multiple historgrams,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
oldidx = nx.copy(idx),0
the above terminates when any entry in idx equals the corresponding,0
value in dims this leaves other dimensions incomplete; the remaining,0
terms of the dual solution must be filled-in,0
define forward/backward relations for pytorch,0
function body here,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
quantiles of F_u evaluated in F_v^\theta,0
Deal with 1,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
Put negative values at the end,0
Compute absciss,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
Compute icdf,0
can probably be improved by computing only relevant values,1
Code inspired from https://gitlab.gwdg.de/shundri/circularOT/-/tree/master/,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
if empty array given then use uniform distributions,0
store original tensors,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
if empty array given then use uniform distributions,0
store original tensors,0
convert to numpy,0
ensure that same mass,0
variable change matrix to reduce the problem to a Wasserstein Barycenter (WB),0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
compute marginals for global alignment,0
compute global alignment,0
compute local alignments,0
randomly partition the space,0
compute attributed graph partitions potentially using the auxiliary structure,0
"format partitions over (C1, F1) and (C2, F2)",0
call to partitioned quantized fused gromov-wasserstein solver,0
compute the transport cost on structures,0
randomly partition the space,0
randomly select representant in each partition,0
compute attributed partitions and representants,0
"format partitions over (C1, F1) and (C2, F2)",0
call to partitioned quantized fused gromov-wasserstein solver,0
compute the transport cost on structures,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check first marginal of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check first marginal of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
the new cost can be deduced from the line search quadratic function,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
POT backend,0
"Initialize weights a, b",0
"Compute rank (see Section 3.1, def 1)",0
Dykstra won't converge if 1/rank < alpha (see Section 3.2),0
"Initial values for LR couplings (Q, R, g) with LOT",0
Gamma initialization,0
initial value of error,0
Compute cost matrices,0
Compute C*R dot using the lr decomposition of C,0
Compute C.T * Q using the lr decomposition of C,0
Compute omega,0
Rescale gamma at each iteration,0
Update couplings with LR Dykstra algorithm,0
Update error with kullback-divergence,0
fix divide by zero,0
Update low rank costs,0
Compute lazy plan (using LazyTensor class),0
Compute value_quad,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
tens -= tens.min(),0
Correct order mistake in Equation 14 in [12],0
Correct order mistake in Equation 15 in [12],0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Define gradients,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random euclidean distance matrix (if not provided by user),0
Initialization of Y,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
simple get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
init marginals if set as None,0
compute separate terms for gradients and log,0
the new cost is deduced from the line search quadratic function,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cedric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Handle backend of non-optional arguments,0
Handle backend of optional arguments,0
Initialize randomly structures of dictionary atoms based on samples,0
batch sampling,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
Initialization for our numpy implementation of adam optimizer,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
Initialize randomly structures of dictionary atoms based on samples,0
Initialize randomly features of dictionary atoms based on samples distribution by feature component,0
Batch iterations,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
"modeling (C,Y)",0
constants depending on q,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
structure,0
feature,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
polynomial coefficients from quadratic objective (with respect to w) on structures,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
polynomial coefficient from quadratic objective (with respect to w) on features,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
%%,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
%%,0
Comparison of the OT matrices,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
use fast 1D solver,0
Equivalent to,0
"G0 = ot.emd(a, b, M)",0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: ../_static/images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have access to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan visualization,0
`````````````````````````````````,0
,0
A good visualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: ../_static/images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Empirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Define Group lasso regularization and gradient,0
------------------------------------------------,0
The groups are the first and second half of the columns of G,0
%%,0
Set up parameters for solvers and solve,0
---------------------------------------,0
balanced OT,0
unbalanced OT KL,0
unbalanced OT L2,0
unbalanced OT TV,0
#############################################################################,0
Plot plans,0
----------,0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
"pl.xlim((-7,23))",0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
"pl.xlim((-7,23))",0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
########################################################################################,0
Compare the Euclidean Wasserstein distance with the Wasserstein distance on the  circle,0
---------------------------------------------------------------------------------------,0
This examples illustrates the periodicity of the Wasserstein distance on the circle.,0
We choose as target distribution a von Mises distribution with mean :math:`\mu_{\mathrm{target}}`,0
"and :math:`\kappa=20`. Then, we compare the distances with samples obtained from a von Mises distribution",0
with parameters :math:`\mu_{\mathrm{source}}` and :math:`\kappa=20`.,0
The Wasserstein distance on the circle takes into account the periodicity,0
and attains its maximum in :math:`\mu_{\mathrm{target}}+1` (the antipodal point) contrary to the,0
Euclidean version.,0
%% Compute and plot distributions,0
"np.random.vonmises deals with data on [-pi, pi[",0
"Put data on S^1=[0,1[",0
#######################################################################,0
Wasserstein distance between von Mises and uniform for different kappa,0
----------------------------------------------------------------------,0
"When :math:`\kappa=0`, the von Mises distribution is the uniform distribution on :math:`S^1`.",0
%% Compute Wasserstein between Von Mises and uniform,0
"np.random.vonmises deals with data on [-pi, pi[",0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with squared l2 regularization,0
%% Sparsity-constrained OT,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Generating the fitting data,0
%%,0
Fitting the Nearest Brenier Potential,0
%%,0
Plotting the images of the source data,0
%%,0
Computing the predictions (images by nabla phi) for random samples of the source distribution,0
%%,0
Plot predictions for the gradient of the lower-bounding potential,0
%%,0
Plot predictions for the gradient of the upper-bounding potential,0
-*- coding: utf-8 -*-,0
Author: Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Plot data,0
-------------,0
#############################################################################,0
Compute EWCA,0
-------------,0
#############################################################################,0
"Plot data, first component, and projected data",0
-------------,0
#############################################################################,0
Plot transport plan,0
-------------,0
-*- coding: utf-8 -*-,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
Gaussian distribution,0
Source and target distribution,0
#############################################################################,0
Solve Low rank sinkhorn,0
------------,0
%%,0
Solve low rank sinkhorn,0
#############################################################################,0
Sinkhorn vs Low Rank Sinkhorn,0
-----------------------,0
Compare Sinkhorn and Low rank sinkhorn with different regularizations and ranks.,0
%% Sinkhorn,0
Compute cost matrix for sinkhorn OT,0
Solve sinkhorn with different regularizations using ot.solve,0
%% Low rank sinkhorn,0
Solve low rank sinkhorn with different ranks using ot.solve_sample,0
%%,0
Plot sinkhorn vs low rank sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generate data,0
-------------,0
The source and clean target matrices are generated by,0
":math:`X_{i,j} = \cos(\frac{i}{n_1} \pi) + \cos(\frac{j}{d_1} \pi)` and",0
":math:`Y_{i,j} = \cos(\frac{i}{n_2} \pi) + \cos(\frac{j}{d_2} \pi)`.",0
The target matrix is then contaminated by adding 5 row outliers.,0
"Intuitively, we expect that the estimated sample distribution should ignore these outliers,",0
i.e. their weights should be zero.,0
Generate clean target data mixed with outliers,0
%%,0
Optimize the COOT distance with respect to the sample marginal distribution,0
---------------------------------------------------------------------------,0
Estimated sample marginal distribution and training loss curve,0
%%,0
Visualizing the row and column alignments with the estimated sample marginal distribution,0
-----------------------------------------------------------------------------------------,0
,0
"Clearly, the learned marginal distribution completely and successfully ignores the 5 outliers.",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%% Load modules,0
%%,0
Data for logo,0
-------------,0
Letter P,0
Letter O,0
Scaling and translation for letter O,0
Letter T,0
Translating the T,0
Concatenate all letters,0
Horizontal and vertical scaling,0
%%,0
Plot the logo (clear background),0
--------------------------------,0
Solve OT problem between the points,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo.png', dpi=150, transparent=True, bbox_inches='tight')",0
%%,0
Plot the logo (dark background),0
--------------------------------,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo_dark.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo_dark.png', dpi=150, transparent=True, bbox_inches='tight')",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generating two random matrices,0
%%,0
Visualizing the matrices,0
%%,0
"Visualizing the alignments of rows and columns, and calculating the CO-Optimal Transport distance",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data an plot it,0
------------------------,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
#############################################################################,0
Compute Weak OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% Weak OT,0
#############################################################################,0
Plot weak OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
%%,0
Generating 2 distributions,0
-----,0
Gaussian distributions,0
%%,0
"Minimize the distances among distributions, identify the Barycenter",0
-----,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
L2 Iteration,0
%%,0
Compare Barycenters in both methods,0
-----,0
"pl.plot(x, barys[i], 'g-*')",0
%%,0
More than 2 distributions,0
--------------------------------------------------,0
Generate 7 pseudorandom gaussian distributions with 50 bins.,0
%%,0
Minimizing Distances Among Many Distributions,0
---------------,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
Perform gradient descent optimization using the d-MMOT method.,0
"after minimization, any distribution can be used as a estimate of barycenter.",0
Compute 1D Wasserstein barycenter using the L2/LP method,0
%%,0
Compare Barycenters in both methods,0
---------,0
%%,0
Compare with original distributions,0
---------,0
"pl.plot(x, barys[i], 'g')",0
%%,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinuous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinuous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
Generate 2D and 3D curves,0
Source and target distribution,0
#############################################################################,0
Plot data,0
------------,0
%%,0
Plot the source and target samples,0
#############################################################################,0
Entropic Gromov-Wasserstein,0
------------,0
%%,0
Compute cost matrices,0
Scale cost matrices,0
Solve entropic gw,0
Plot entropic gw,0
#############################################################################,0
Low rank squared euclidean cost matrices,0
------------,0
%%,0
Compute the low rank sqeuclidean cost decompositions,0
Scale the low rank cost matrices,0
#############################################################################,0
Low rank Gromov-Wasserstein,0
------------,0
%%,0
Solve low rank gromov-wasserstein with different ranks,0
%%,0
Plot low rank GW with different ranks,0
%%,0
Compare computation time between entropic GW and low rank GW,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data an plot it,0
------------------------,0
parameters and data generation,0
%% plot samples,0
%%,0
Compute Factored OT and exact OT solutions,0
------------------------------------------,0
%% EMD,0
%% factored OT OT,0
%%,0
Plot factored OT and exact OT solutions,0
---------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labeled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
Gaussian (linear) Monge mapping estimation,0
Gaussian (linear) GW mapping estimation,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
Monge mapping,0
gaussian GW mapping,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
Labels,0
Ticks,0
##############################################################################,0
Spherical Sliced Wasserstein for different seeds and number of projections,0
--------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Spherical Sliced Wasserstein,0
---------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
%%,0
plot the transported mass,0
-------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------------------------------------------------------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------------------,0
,0
The OT plan is plotted as a function of $\gamma$ that is the inverse of the,0
weight on the marginal relaxations.,0
%% fully relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for UOT l2,0
-----------------------------------,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-----------------------------------------,0
%% semi-relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for semi-relaxed UOT l2,0
------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
"Compute entropic kl-regularized UOT, kl- and l2-regularized UOT",0
-----------,0
#############################################################################,0
Plot the results,0
----------------,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
----------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
--------------------------------------------------------,0
The adjacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
-------------------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating dual variables for entropic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated entropic OT plan,0
-----------------------------------,0
%%,0
Estimating dual variables for quadratic OT,0
------------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated quadratic OT plan,0
------------------------------------,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
----------------------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
---------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
-----------------------------------------,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
--------------------------------------------------,0
#############################################################################,0
Plotting the reweighted source distribution,0
-------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating deep dual variables for entropic OT,0
----------------------------------------------,0
define the MLP model,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the density on target for a given source sample,0
----------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Gradient descent,0
----------------,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
"pl.subplot(3, 3, i + 1)",0
ax = pl.axes(projection='3d'),0
"ax.axis(""off"")",0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
compute OT sparsity level,0
Methods using Sinkhorn projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Compute GW with scalable stochastic methods with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
############################################################################,0
,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
-----------------------------------------------------------------------------------------------,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",0
Visualize samples,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the Gromov-Wasserstein dictionary from the dataset,0
-----------------------------------------------------------,0
visualize loss evolution over epochs,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Compute the 2D representation of the unmixing living in the 2-simplex of probability,0
############################################################################,0
,0
Endow the dataset with node features,0
------------------------------------,0
We follow this feature assignment on all nodes of a graph depending on its label/number of clusters,0
1 cluster --> 0 as nodes feature,0
2 clusters --> 1 as nodes feature,0
3 clusters --> 2 as nodes feature,0
features are one-hot encoded following these assignments,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs,0
------------------------------------------------------------------------------------,0
visualize loss evolution,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
scaled_F = 2 * (Fatom - min_features) / (max_features - min_features),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Visualize unmixings in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
#############################################################################,0
Compute FGW/GW,0
--------------,0
Computing FGW and GW,0
reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
visu OT matrix,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their entropic-regularized semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW_e(C2, h2, C3)",0
"2) srGW_e(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the entropic-regularized semi-relaxed Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the entropic srGW matching.,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW_e(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the entropic semi-relaxed Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
############################################################################,0
,0
Generate graphs,0
--------------------------------------------------------------------------,0
,0
Create two graphs following Stochastic Block models of 2 and 3 clusters.,0
Add weights on the edges for visualization later on,0
setup for graph visualization,0
get graphs partition and their coloring,0
############################################################################,0
,0
Compute their quantized Gromov-Wasserstein distance without using the wrapper,0
---------------------------------------------------------,0
,0
We detail next the steps implemented within the wrapper that preprocess graphs,0
"to form partitioned graphs, which are then passed as input to the generic qFGW solver.",0
1-a) Partition C1 and C2 in 2 and 3 clusters respectively using Louvain,0
algorithm from Networkx. Then encode these partitions via vectors of assignments.,0
1-b) Select representant in each partition using the Pagerank algorithm,0
implementation from networkx.,0
1-c) Formate partitions such that:,0
CR contains relations between representants in each space.,0
list_R contains relations between samples and representants within each partition.,0
list_h contains samples relative importance within each partition.,0
1-d) call to partitioned quantized gromov-wasserstein solver,0
Visualization of the graph pre-processing,0
############################################################################,0
,0
Compute the quantized Gromov-Wasserstein distance using the wrapper,0
---------------------------------------------------------,0
,0
"Compute qGW(spC1, h1, spC2, h2). We also illustrate the use of auxiliary matrices",0
such that the adjacency matrices `C1_aux=C1` and `C2_aux=C2` to partition the graph using,0
"Louvain algorithm, and the Pagerank algorithm for selecting representant within",0
"each partition. Notice that `C1_aux` and `C2_aux` are optional, if they are not",0
specified these pre-processing algorithms will be applied to spC2 and spC3.,0
no node features are considered on this synthetic dataset. Hence we simply,0
"let F1, F2 = None and set alpha = 1.",0
############################################################################,0
,0
Visualization of the quantized Gromov-Wasserstein matching,0
--------------------------------------------------------------,0
,0
We color nodes of the graph based on the respective partition of each graph.,0
On the first plot we illustrate the qGW matching between both shortest path matrices.,0
While the GW matching across representants of each space is illustrated on the right.,0
get graphs partition and their coloring,0
############################################################################,0
,0
Generate attributed point clouds,0
--------------------------------------------------------------------------,0
,0
"Create two attributed point clouds representing curves in 2D and 3D respectively,",0
whose samples are further associated to various color intensities.,0
Generate 2D and 3D curves,0
Source and target distribution across spaces encoded respectively via their,0
squared euclidean distance matrices.,0
Further associated to color intensity features derived from z,0
############################################################################,0
,0
Visualize partitioned attributed point clouds,0
--------------------------------------------------------------------------,0
,0
Compute the partitioning and representant selection further used within,0
"qFGW wrapper, both provided by a K-means algorithm. Then visualize partitioned spaces.",0
Plot the source and target samples as distributions,0
############################################################################,0
,0
Compute the quantized Fused Gromov-Wasserstein distance between samples using the wrapper,0
---------------------------------------------------------,0
,0
"Compute qFGW(X, FX, hX, Y, FY, HY), setting the trade-off parameter between",0
structures and features `alpha=0.5`. This solver considers a squared euclidean structure,0
"for each distribution X and Y, and partition each of them into 4 clusters using",0
the K-means algorithm before computing qFGW.,0
Plot low rank GW with different ranks,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create 2 classes of stochastic block models (SBM) graphs with 1 block and 2 blocks respectively.,0
edge probabilities for the SBMs,0
block sizes,0
node features,0
split the data into train and test sets,0
%%,0
#############################################################################,0
Plot data,0
---------,0
plot one graph of each class,0
%%,0
#############################################################################,0
Pooling architecture using the TFGW layer,0
---------,0
#############################################################################,0
Graph classification training,0
---------,0
store latent embeddings and classes for TSNE visualization,0
store last classes and embeddings for TSNE visualization,0
Test,0
%%,0
#############################################################################,0
TSNE visualization of graph classification,0
---------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
Compute pairwise euclidean distance between node features,0
############################################################################,0
,0
Compute their Fused Gromov-Wasserstein distances,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
Alternated Bregman Projected Gradient algorithm with Kullback-Leibler as proximal operator,0
compute OT sparsity level,0
Methods using Sinkhorn/Bregman projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Visualization of the Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the FGW matchings,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
"For each matching, all node sizes are proportionnal to their mass computed",0
from marginals of the OT plan to illustrate potential feasibility errors.,0
NB: colors refer to clusters - not to node features,0
Add weights on the edges for visualization later on,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
--------------------------------------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW(C2, h2, C3)",0
"2) srGW(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Gromov-Wasserstein matchings,0
--------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srGW matching,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
-----------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Fused Gromov-Wasserstein matchings,0
--------------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Authors: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
%%,0
Define Gaussian Covariances and distributions,0
---------------------------------------------,0
%%,0
Plot the distributions,0
----------------------,0
"pl.scatter(mu[0],mu[1],color=color, marker='x')",0
%%,0
Compute Bures-Wasserstein barycenters and plot them,0
-------------------------------------------,0
basis for bilinear interpolation,0
weights are constructed by bilinear interpolation,0
-*- coding: utf-8 -*-,0
Authors: Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
%%,0
General Parameters,0
------------------,0
%%,0
Generate Data,0
-------------,0
%%,0
Inspect generated distributions,0
-------------------------------,0
%%,0
Interpolating Empirical Distributions,0
-------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#######################,0
Generate and plot data,0
----------------------,0
Input measures,0
Input measure locations in their respective 2D spaces,0
Input measure weights,0
Projections 3D -> 2D,0
Barycenter weights,0
Number of barycenter points to compute,0
Send the input measures into 3D space for visualization,0
Plot the input data,0
################################,0
Barycenter computation and plot,0
-------------------------------,0
############################,0
Plotting projection matches,0
---------------------------,0
#############################################,0
Rotation animation,0
--------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Authors: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data,0
-------------,0
%%,0
Compute free support Wasserstein barycenter,0
-------------------------------------------,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
%%,0
Compute free support Sinkhorn barycenter,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
make sure TF doesn't allocate entire GPU,0
allow numpy API for TF,0
Author: Laurène DAVID <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test computation of low rank cost matrices M1 and M2,0
test low rank sinkhorn,0
check constraints for P,0
check if lazy_plan is equal to the fully computed plan,0
check if value_linear is correct with its original formula,0
check warn parameter when Dykstra algorithm doesn't converge,0
test lowrank inits,0
"test ImportError if init=""kmeans"" and sklearn not imported",0
check constraints for P,0
Test warning for value of alpha,0
Test lr sinkhorn with different init strategies,0
check constraints for P,0
Test low rank sinkhorn for different backends,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
options for reg_m,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check if the marginals come close to the true ones when large reg,0
check if mm_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test when G0 is given,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
check constraints,0
test weak ot solver for different backends,0
check constraints,0
check constraints,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
generate gaussian dataset,0
compute first 3 components with BCD,0
test that U contains the principal components,0
compute first 3 components with MM,0
test that U contains the principal components,0
compute last 3 components,0
test that U contains the last principal components,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
chaeck that identity is recovered,0
check G is identity,0
check constraints,0
test weak ot solver for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
check transported mass,0
check constraints,0
check transported mass,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test binary_search_circle and wasserstein_circle give similar results as emd,0
check loss is similar,0
test semidiscrete_wasserstein2_unif_circle versus wasserstein_circle,0
"w_u = rng.uniform(0., 1., n)",0
w_u = w_u / w_u.sum(),0
check loss is similar,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
set readable ids for each param,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
"Note, gradients aer invariant to change in constant so we center them",0
solve unif weights,0
solve signe weights,0
solve in backend,0
test not implemented and check raise,0
check some attributes,0
solve in backend,0
solve in backend,0
test not implemented and check raise,0
detect partial not implemented and error detect in value,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve signe weights,0
test solve_sample when is_Lazy = False,0
solve signe weights,0
check some attributes (no need ),0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
create a lazy tensor,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
"For each column of X, find top max_nz values and",0
their corresponding indices. This incurs a sort.,0
Project the top max_nz values onto the simplex.,0
This incurs a second sort.,0
Put the projection of max_nz_values to their original indices,0
and set all other values zero.,0
check that two versions produce consistent results,0
test timing,0
"np.testing.assert_allclose(0.1, t, rtol=1e-1, atol=1e-1)",0
very slow macos github action equality not possible,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
test print,0
tets get citation,0
"i,j can be integers or slices, x1,x2 have to be passed as keyword arguments",0
create a lazy tensor,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
total sum,0
sum over axis 0,0
sum over axis 1,0
test otehr reduction function,0
test 3D tensors,0
create a lazy tensor,0
total sum,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
labels are shifted,0
labels are shifted but the shift if expected,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check this only if GPU is available,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Barycenter initialization,0
"Obvious barycenter locations. Take a look on test_ot.py, test_free_support_barycenter",0
Calculate free support barycenter w/ Sinkhorn algorithm. We set the entropic regularization,0
"term to 1, but this should be, in general, fine-tuned to the problem.",0
Verifies if calculated barycenter matches ground-truth,0
Gaussian distributions,0
creating matrix A containing all distributions,0
assymetric loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
First image,0
Second image,0
Creating matrix A containing all distributions,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check this only if GPU is available,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
call with log = False,0
check equality of plans,0
check error on wrong metric,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
Test sinkhorn divergence,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
Compute loss using dmmot_monge_1dgrid_loss,0
Compute loss using exact OT solver with absolute ground metric,0
deal with C-contiguous error from tensorflow backend (not sure why),0
compute loss,0
test discrete_mmot_converge result,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for mass mismatch,0
check with empty inputs,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd2 and emd2 with openmp for simple identity,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two Diracs,0
obvious barycenter location between two Diracs,0
obvious barycenter location between two 2D Diracs,0
test without log and no init,0
test with log and init,0
obvious barycenter between two Diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test that types mathcing different backends in input raise an error,0
Check that subclassing a numpy array does not break get_backend,0
note: This is only tested for numpy as this is hard to be consistent,0
with other backends,0
Sparse tensors test,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
"test without log but with X_classes, a, b and other init method",0
"'new' input isn't new, so should be equal to target",0
test with no log but classes,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Test weights argument,0
test with closed form for diagonal covariance matrices,0
no log,0
no log + skewness,0
test the other way around (target to source),0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict,0
predict on batch,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict on batch,0
Test the TW layer by passing two graphs through the layer and doing backpropagation.,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test couplings,0
test marginal distributions,0
test entropic COOT distance,0
test couplings,0
test marginal distributions,0
test COOT distance,0
raise value error of method sinkhorn,0
raise value error for epsilon,0
raise value error for alpha,0
initialize warmstart,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test with coot distance,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
prepare semi-supervised labels,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
prepare semi-supervised labels,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test diffeernt transform and inverse transform,0
test diffeernt transform,0
test its computed,0
test dimensions of coupling,0
test coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
Mapping tests,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
"'new' input isn't new, so should be equal to target",0
test all margin constraints with gaussian similarity and disp regularisation,0
previously used implementation for the cost estimator,0
new vectorized implementation for the cost estimator,0
hard-coded params from the original code,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
Author: Laurène DAVID <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test flat product operator,0
test value,0
test low rank gromov wasserstein,0
check constraints for P,0
check if lazy_plan is equal to the fully computed plan,0
check warn parameter when low rank GW algorithm doesn't converge,0
check warn parameter when Dykstra algorithm doesn't converge,0
Test warning for value of alpha and rank,0
Test lr sinkhorn with different init strategies,0
check constraints for P,0
Test low rank sinkhorn for different backends,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: compare reconstruction error using initial dictionary and dictionary learned using this initialization,0
> Compute initial reconstruction of samples on this random dictionary without backend,0
> Learn the dictionary using this init,0
> Compute reconstruction of samples on learned dictionary without backend,0
Test: Perform same experiments after going through backend,0
Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
knowing than the initialization scheme is the same than implemented to set the benchmarked initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
and testing other optimization settings untested until now.,0
We pass previously estimated dictionaries to speed up the process.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: Compute initial reconstruction of samples on this random dictionary,0
> Learn a dictionary using this given initialization and check that the reconstruction loss,0
on the learned dictionary is lower than the one using its initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Compare both,0
Test: Perform same experiments after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform similar experiment without providing the initial dictionary being an optional input,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
"Test: without using adam optimizer, with log and verbose set to True",0
> Experiment providing previously estimated dictionary to speed up the test compared to providing initial random init.,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
> Compare results with/without backend,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
Tests with marginal_loss = False,0
check constraints,0
check constraints,0
setup,0
test with 'kl_loss' and log=True,0
"providing init_C, init_Y",0
add tests with fixed_structures or fixed_features,0
test edge cases for fgw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
providing init_C,0
test edge cases for gw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
test sinkhorn,0
entropic gw and fgw,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
classical gradients,0
Test with exact line-search,0
Test with armijo line-search,0
classical gradients,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
providing init_C,0
test edge cases for gw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
check constraints,0
check constraints,0
add features,0
check constraints,0
check constraints,0
Tests with kl-loss:,0
check constraints,0
check constraints,0
add features,0
check constraints,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
test correspondance with utils function,0
add test with 'kl_loss',0
test correspondance with utils function,0
test edge cases for fgw barycenters:,0
C1 as list,0
"p1, p2 as lists",0
unique input structure,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
complementary tests for utils functions,0
tests for edge cases of the graph partitioning,0
tests for edge cases of the representant selection,0
tests for edge cases of the format_partitioned_graph function,0
Tests in qFGW solvers,0
for non admissible values of alpha,0
for non-consistent feature information provided,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
tests for edge cases of the representant selection,0
check constraints,0
"The inner test T_global[i, j] != 0. can lead to different",0
computation of 1D OT computations between partition depending,0
on the different float errors across backend,0
complementary tests for utils functions,0
tests for edge cases of the format_partitioned_graph function,0
for non-consistent feature information provided,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
"html_css_files = [""css/custom.css""]",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
check the necessary inputs parameters are here,0
pairwise distance,0
"missing_labels is a (ns, nt) matrix of {0, 1} such that",0
"the cells (i, j) has 0 iff either ys[i] or yt[j] is masked",0
"labels_match is a (ns, nt) matrix of {True, False} such that",0
"the cells (i, j) has False if ys[i] != yt[i]",0
"cost correction is a (ns, nt) matrix of {-Inf, float, Inf} such",0
"that he cells (i, j) has -Inf where there's no correction necessary",0
by 'correction' we mean setting cost to a large value when,0
labels do not match,0
we suppress potential RuntimeWarning caused by Inf multiplication,0
(as we explicitly cover potential NANs later),0
this operation is necessary because 0 * Inf = NAN,0
thus is irrelevant when limit_max is finite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
init uniform,0
weak OT loss,0
weak OT gradient,0
solve with conditional gradient and return solution,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
solve the barycenter,0
solve OT with template,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
Main function,0
constant input variables,0
measures on rows and columns,0
pre-calculate cost constants,0
initialize coupling and dual vectors,0
initialize log,0
update sample coupling,0
update feature coupling,0
update error,0
COOT part,0
Entropic part,0
sanity check,0
measures on rows and columns,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
convert to humpy,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
convert back to backend,0
"Next 3 lines equivalent to K=nx.exp(-M/reg), but faster to compute",0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
optimise the plan,0
optimise the values phi and the gradients G,0
convert back to backend,0
lower bound,0
upper bound,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
###############################################################################,0
Losses for stochastic optimization,0
###############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Jakub Zadrozny <jakub.r.zadrozny@gmail.com>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
marginals,0
print iterations,0
loop,0
Solve transport,0
Solve PCA,0
block coordinate descent,0
majorization-minimization,0
stop or not,0
print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
it's necessary to check boundary condition here for the coefficient,0
as the callback could be evaluated for negative value of alpha by,0
`scalar_search_armijo` function here:,0
,0
https://github.com/scipy/scipy/blob/11509c4a98edded6c59423ac44ca1b7f28fba1fd/scipy/optimize/linesearch.py#L686,0
,0
see more details https://github.com/PythonOT/POT/issues/502,0
The callable function operates on nx backend,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
to not change G0 in place.,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
get minimum by rows as binary mask,0
return by default an empty inner_log,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"V[nx.newaxis, :], max_nz, z, axis=1).ravel()",0
"For each row of V, find top max_nz values; arrange the",0
corresponding column indices such that their values are,0
in a descending order.,0
Extract the top max_nz values for each row,0
and then project to simplex.,0
"rho = nx.count_nonzero(cond, axis=1)",0
Put the projection of max_nz_values to their original column indices,0
while keeping other values zero.,0
"in Jax, we need to use the `at` property of `jax.numpy.ndarray`",0
to do in-place array modificatons.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
I assume that other solvers may return directly,0
some primal objects?,0
"In the code below, let's define the main quantities",0
that may be of interest to users.,0
An OT solver returns an object that inherits from OTResult,0
(e.g. SinkhornOTResult) and implements the relevant,0
"methods (e.g. ""plan"" and ""lazy_plan"" but not ""sparse_plan"", etc.).",0
log is a dictionary containing potential information about the solver,0
Dual potentials --------------------------------------------,0
Transport plan -------------------------------------------,0
N.B.: We may catch out-of-memory errors and suggest,0
the use of lazy_plan or sparse_plan when appropriate.,0
Loss values --------------------------------,0
Marginal constraints -------------------------,0
Barycentric mappings -------------------------,0
Return the displacement vectors as an array,0
"that has the same shape as ""xa""/""xb"" (for samples)",0
"or ""a""/""b"" * D (for images)?",0
# Wasserstein barycenters ----------------------,0
@property,0
def masses(self):,0
"""""""Masses for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
@property,0
def samples(self):,0
"""""""Sample locations for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
Miscellaneous --------------------------------,0
The string below refers to the POT library:,0
successor methods may concatenate the relevant references,0
"to the original definitions, solvers and underlying numerical backends.",0
set attributes for named arguments/arrays,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
Tianlin Liu <t.liu@unibas.ch>,0
"For each column of X, find entries that are not among the top max_nz.",0
Set these entries to -inf.,0
Project the scaled X onto the simplex with sparsity constraint.,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
convert to humpy,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for EMD solver,0
default values for exact unbalanced OT,0
default values for sinkhorn,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for solver,0
default values for EMD solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['log_u'], log['log_v'])  #TODO",0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v'])",0
default values for solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
for uniform weights,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
lazy solver of memory complexity O(n),0
lazy OT plan,0
automatic solver,0
force O(n) memory efficient solver,0
force pre-computed cost matrix,0
use multiscale solver,0
One can play with speed (small scaling factor) and precision (scaling close to 1),0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
recover the lazy low rank plan,0
recover the full low rank plan,0
recover the squared Gaussian Bures-Wasserstein distance,0
recover the squared Wasserstein distances,0
compute cost matrix M and use solve function,0
Detect backend,0
default values for solutions,0
return scaled potentials (to be consistent with other solvers),0
compute potentials,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test if sklearn is installed for linux-minimal-deps,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
First low rank decomposition of the cost matrix (A),0
Second low rank decomposition of the cost matrix (B),0
POT backend if None,0
----------------- Initialisation of Dykstra algorithm -----------------,0
--------------------- Dykstra algorithm -------------------------,0
"See Section 3.3 - ""Algorithm 2 LR-Dykstra"" in paper",0
Compute u^{(1)} and u^{(2)},0
"Compute g, g^{(3)}_1 and update \tilde{g}",0
Compute new value of g with \prod,0
Compute v^{(1)} and v^{(2)},0
"Compute q^{(1)}, q^{(2)} and q^{(3)}_2",0
"Update values of \tilde{v}^{(1)}, \tilde{v}^{(2)} and \tilde{g}",0
Compute error,0
"Compute low rank matrices Q, R",0
POT backend,0
"Initialize weights a, b",0
"Compute rank (see Section 3.1, def 1)",0
Dykstra won't converge if 1/rank < alpha (see Section 3.2),0
Low rank decomposition of the sqeuclidean cost matrix,0
"Initialize the low rank matrices Q, R, g",0
Gamma initialization,0
-------------------------- Low rank algorithm ------------------------------,0
"see ""Section 3.3, Algorithm 3 LOT""",0
Compute C*R dot using the lr decomposition of C,0
Compute C.T * Q using the lr decomposition of C,0
Compute omega,0
Rescale gamma at each iteration,0
LR Dykstra algorithm,0
"----------------- Compute lazy_plan, value and value_linear  ------------------",0
"see ""Section 3.2: The Low-rank OT Problem"" in the paper",0
Compute lazy plan (using LazyTensor class),0
Compute value_linear (using trace formula),0
"Compute value with entropy reg (see ""Section 3.2"" in the paper)",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Mapping between argument types and the existing backend,0
check that all arguments matched or not the type,0
Otherwise return an error,0
check that some arrays given,0
convert batch of tensors to numpy,0
convert a tensor to numpy,0
convert batch of arrays from numpy,0
convert an array from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
Only register jax backend if it is installed,0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
"Since version 1.11.0, interpolation is available",0
"Else, use numpy",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
Only register torch backend if it is installed,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
Only register cp backend if it is installed,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
todo(okachaiev): replace this with a more reasonable implementation,1
Only register tensorflow backend if it is installed,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Compute the mean barycenter,0
Init the covariance barycenter,0
fixed point update,0
check convergence,0
ensure that Cov_s is the largest covariance matrix,0
that is m >= n,0
compte and sort eigenvalues decerasingly,0
compute the gaussien Gromov-Wasserstein distance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
compute the gaussien Gromov-Wasserstein dis,0
estimate mean and covariance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
select the sign of the eigenvalues,0
compute the gaussien Gromov-Wasserstein dis,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
compute loss,0
compute gradient,0
convert to numpy,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
after that we are all in torch,0
set blur value and p,0
force gradients for computing dual,0
compute value,0
get dual potentials,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Alexander Tong <alexander.tong@yale.edu>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
in case of multiple historgrams,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
oldidx = nx.copy(idx),0
the above terminates when any entry in idx equals the corresponding,0
value in dims this leaves other dimensions incomplete; the remaining,0
terms of the dual solution must be filled-in,0
define forward/backward relations for pytorch,0
function body here,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
quantiles of F_u evaluated in F_v^\theta,0
Deal with 1,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
Put negative values at the end,0
Compute absciss,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
Compute icdf,0
can probably be improved by computing only relevant values,1
Code inspired from https://gitlab.gwdg.de/shundri/circularOT/-/tree/master/,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
ensure that same mass,0
variable change matrix to reduce the problem to a Wasserstein Barycenter (WB),0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check first marginal of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
the new cost can be deduced from the line search quadratic function,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
tens -= tens.min(),0
Correct order mistake in Equation 14 in [12],0
Correct order mistake in Equation 15 in [12],0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Define gradients,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random euclidean distance matrix (if not provided by user),0
Initialization of Y,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
simple get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
init marginals if set as None,0
compute separate terms for gradients and log,0
the new cost is deduced from the line search quadratic function,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cedric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Handle backend of non-optional arguments,0
Handle backend of optional arguments,0
Initialize randomly structures of dictionary atoms based on samples,0
batch sampling,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
Initialization for our numpy implementation of adam optimizer,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
Initialize randomly structures of dictionary atoms based on samples,0
Initialize randomly features of dictionary atoms based on samples distribution by feature component,0
Batch iterations,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
"modeling (C,Y)",0
constants depending on q,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
structure,0
feature,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
polynomial coefficients from quadratic objective (with respect to w) on structures,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
polynomial coefficient from quadratic objective (with respect to w) on features,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
%%,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
%%,0
Comparison of the OT matrices,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
use fast 1D solver,0
Equivalent to,0
"G0 = ot.emd(a, b, M)",0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: ../_static/images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have access to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan visualization,0
`````````````````````````````````,0
,0
A good visualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: ../_static/images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Empirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
"pl.xlim((-7,23))",0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
"pl.xlim((-7,23))",0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
########################################################################################,0
Compare the Euclidean Wasserstein distance with the Wasserstein distance on the  circle,0
---------------------------------------------------------------------------------------,0
This examples illustrates the periodicity of the Wasserstein distance on the circle.,0
We choose as target distribution a von Mises distribution with mean :math:`\mu_{\mathrm{target}}`,0
"and :math:`\kappa=20`. Then, we compare the distances with samples obtained from a von Mises distribution",0
with parameters :math:`\mu_{\mathrm{source}}` and :math:`\kappa=20`.,0
The Wasserstein distance on the circle takes into account the periodicity,0
and attains its maximum in :math:`\mu_{\mathrm{target}}+1` (the antipodal point) contrary to the,0
Euclidean version.,0
%% Compute and plot distributions,0
"np.random.vonmises deals with data on [-pi, pi[",0
"Put data on S^1=[0,1[",0
#######################################################################,0
Wasserstein distance between von Mises and uniform for different kappa,0
----------------------------------------------------------------------,0
"When :math:`\kappa=0`, the von Mises distribution is the uniform distribution on :math:`S^1`.",0
%% Compute Wasserstein between Von Mises and uniform,0
"np.random.vonmises deals with data on [-pi, pi[",0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with squared l2 regularization,0
%% Sparsity-constrained OT,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Generating the fitting data,0
%%,0
Fitting the Nearest Brenier Potential,0
%%,0
Plotting the images of the source data,0
%%,0
Computing the predictions (images by nabla phi) for random samples of the source distribution,0
%%,0
Plot predictions for the gradient of the lower-bounding potential,0
%%,0
Plot predictions for the gradient of the upper-bounding potential,0
-*- coding: utf-8 -*-,0
Author: Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Plot data,0
-------------,0
#############################################################################,0
Compute EWCA,0
-------------,0
#############################################################################,0
"Plot data, first component, and projected data",0
-------------,0
#############################################################################,0
Plot transport plan,0
-------------,0
-*- coding: utf-8 -*-,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
Gaussian distribution,0
Source and target distribution,0
#############################################################################,0
Solve Low rank sinkhorn,0
------------,0
%%,0
Solve low rank sinkhorn,0
#############################################################################,0
Sinkhorn vs Low Rank Sinkhorn,0
-----------------------,0
Compare Sinkhorn and Low rank sinkhorn with different regularizations and ranks.,0
%% Sinkhorn,0
Compute cost matrix for sinkhorn OT,0
Solve sinkhorn with different regularizations using ot.solve,0
%% Low rank sinkhorn,0
Solve low rank sinkhorn with different ranks using ot.solve_sample,0
%%,0
Plot sinkhorn vs low rank sinkhorn,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generate data,0
-------------,0
The source and clean target matrices are generated by,0
":math:`X_{i,j} = \cos(\frac{i}{n_1} \pi) + \cos(\frac{j}{d_1} \pi)` and",0
":math:`Y_{i,j} = \cos(\frac{i}{n_2} \pi) + \cos(\frac{j}{d_2} \pi)`.",0
The target matrix is then contaminated by adding 5 row outliers.,0
"Intuitively, we expect that the estimated sample distribution should ignore these outliers,",0
i.e. their weights should be zero.,0
Generate clean target data mixed with outliers,0
%%,0
Optimize the COOT distance with respect to the sample marginal distribution,0
---------------------------------------------------------------------------,0
Estimated sample marginal distribution and training loss curve,0
%%,0
Visualizing the row and column alignments with the estimated sample marginal distribution,0
-----------------------------------------------------------------------------------------,0
,0
"Clearly, the learned marginal distribution completely and successfully ignores the 5 outliers.",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%% Load modules,0
%%,0
Data for logo,0
-------------,0
Letter P,0
Letter O,0
Scaling and translation for letter O,0
Letter T,0
Translating the T,0
Concatenate all letters,0
Horizontal and vertical scaling,0
%%,0
Plot the logo (clear background),0
--------------------------------,0
Solve OT problem between the points,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo.png', dpi=150, transparent=True, bbox_inches='tight')",0
%%,0
Plot the logo (dark background),0
--------------------------------,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo_dark.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo_dark.png', dpi=150, transparent=True, bbox_inches='tight')",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generating two random matrices,0
%%,0
Visualizing the matrices,0
%%,0
"Visualizing the alignments of rows and columns, and calculating the CO-Optimal Transport distance",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data an plot it,0
------------------------,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
#############################################################################,0
Compute Weak OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% Weak OT,0
#############################################################################,0
Plot weak OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
%%,0
Generating 2 distributions,0
-----,0
Gaussian distributions,0
%%,0
"Minimize the distances among distributions, identify the Barycenter",0
-----,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
L2 Iteration,0
%%,0
Compare Barycenters in both methods,0
-----,0
"pl.plot(x, barys[i], 'g-*')",0
%%,0
More than 2 distributions,0
--------------------------------------------------,0
Generate 7 pseudorandom gaussian distributions with 50 bins.,0
%%,0
Minimizing Distances Among Many Distributions,0
---------------,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
Perform gradient descent optimization using the d-MMOT method.,0
"after minimization, any distribution can be used as a estimate of barycenter.",0
Compute 1D Wasserstein barycenter using the L2/LP method,0
%%,0
Compare Barycenters in both methods,0
---------,0
%%,0
Compare with original distributions,0
---------,0
"pl.plot(x, barys[i], 'g')",0
%%,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinuous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinuous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data an plot it,0
------------------------,0
parameters and data generation,0
%% plot samples,0
%%,0
Compute Factored OT and exact OT solutions,0
------------------------------------------,0
%% EMD,0
%% factored OT OT,0
%%,0
Plot factored OT and exact OT solutions,0
---------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labeled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
Gaussian (linear) Monge mapping estimation,0
Gaussian (linear) GW mapping estimation,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
Monge mapping,0
gaussian GW mapping,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
Labels,0
Ticks,0
##############################################################################,0
Spherical Sliced Wasserstein for different seeds and number of projections,0
--------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Spherical Sliced Wasserstein,0
---------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
%%,0
plot the transported mass,0
-------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------------------------------------------------------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------------------,0
,0
The OT plan is plotted as a function of $\gamma$ that is the inverse of the,0
weight on the marginal relaxations.,0
%% fully relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for UOT l2,0
-----------------------------------,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-----------------------------------------,0
%% semi-relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for semi-relaxed UOT l2,0
------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
"Compute entropic kl-regularized UOT, kl- and l2-regularized UOT",0
-----------,0
#############################################################################,0
Plot the results,0
----------------,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
----------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
--------------------------------------------------------,0
The adjacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
-------------------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating dual variables for entropic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated entropic OT plan,0
-----------------------------------,0
%%,0
Estimating dual variables for quadratic OT,0
------------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated quadratic OT plan,0
------------------------------------,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
----------------------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
---------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
-----------------------------------------,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
--------------------------------------------------,0
#############################################################################,0
Plotting the reweighted source distribution,0
-------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating deep dual variables for entropic OT,0
----------------------------------------------,0
define the MLP model,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the density on target for a given source sample,0
----------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Gradient descent,0
----------------,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
"pl.subplot(3, 3, i + 1)",0
ax = pl.axes(projection='3d'),0
"ax.axis(""off"")",0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
compute OT sparsity level,0
Methods using Sinkhorn projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Compute GW with scalable stochastic methods with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
############################################################################,0
,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
-----------------------------------------------------------------------------------------------,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",0
Visualize samples,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the Gromov-Wasserstein dictionary from the dataset,0
-----------------------------------------------------------,0
visualize loss evolution over epochs,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Compute the 2D representation of the unmixing living in the 2-simplex of probability,0
############################################################################,0
,0
Endow the dataset with node features,0
------------------------------------,0
We follow this feature assignment on all nodes of a graph depending on its label/number of clusters,0
1 cluster --> 0 as nodes feature,0
2 clusters --> 1 as nodes feature,0
3 clusters --> 2 as nodes feature,0
features are one-hot encoded following these assignments,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs,0
------------------------------------------------------------------------------------,0
visualize loss evolution,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
scaled_F = 2 * (Fatom - min_features) / (max_features - min_features),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Visualize unmixings in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
#############################################################################,0
Compute FGW/GW,0
--------------,0
Computing FGW and GW,0
reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
visu OT matrix,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their entropic-regularized semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW_e(C2, h2, C3)",0
"2) srGW_e(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the entropic-regularized semi-relaxed Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the entropic srGW matching.,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW_e(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the entropic semi-relaxed Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create 2 classes of stochastic block models (SBM) graphs with 1 block and 2 blocks respectively.,0
edge probabilities for the SBMs,0
block sizes,0
node features,0
split the data into train and test sets,0
%%,0
#############################################################################,0
Plot data,0
---------,0
plot one graph of each class,0
%%,0
#############################################################################,0
Pooling architecture using the TFGW layer,0
---------,0
#############################################################################,0
Graph classification training,0
---------,0
store latent embeddings and classes for TSNE visualization,0
store last classes and embeddings for TSNE visualization,0
Test,0
%%,0
#############################################################################,0
TSNE visualization of graph classification,0
---------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
Compute pairwise euclidean distance between node features,0
############################################################################,0
,0
Compute their Fused Gromov-Wasserstein distances,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
Alternated Bregman Projected Gradient algorithm with Kullback-Leibler as proximal operator,0
compute OT sparsity level,0
Methods using Sinkhorn/Bregman projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Visualization of the Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the FGW matchings,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
"For each matching, all node sizes are proportionnal to their mass computed",0
from marginals of the OT plan to illustrate potential feasibility errors.,0
NB: colors refer to clusters - not to node features,0
Add weights on the edges for visualization later on,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
--------------------------------------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW(C2, h2, C3)",0
"2) srGW(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Gromov-Wasserstein matchings,0
--------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srGW matching,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
-----------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Fused Gromov-Wasserstein matchings,0
--------------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Authors: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
%%,0
Define Gaussian Covariances and distributions,0
---------------------------------------------,0
%%,0
Plot the distributions,0
----------------------,0
"pl.scatter(mu[0],mu[1],color=color, marker='x')",0
%%,0
Compute Bures-Wasserstein barycenters and plot them,0
-------------------------------------------,0
basis for bilinear interpolation,0
weights are constructed by bilinear interpolation,0
-*- coding: utf-8 -*-,0
Authors: Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
%%,0
General Parameters,0
------------------,0
%%,0
Generate Data,0
-------------,0
%%,0
Inspect generated distributions,0
-------------------------------,0
%%,0
Interpolating Empirical Distributions,0
-------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#######################,0
Generate and plot data,0
----------------------,0
Input measures,0
Input measure locations in their respective 2D spaces,0
Input measure weights,0
Projections 3D -> 2D,0
Barycenter weights,0
Number of barycenter points to compute,0
Send the input measures into 3D space for visualization,0
Plot the input data,0
################################,0
Barycenter computation and plot,0
-------------------------------,0
############################,0
Plotting projection matches,0
---------------------------,0
#############################################,0
Rotation animation,0
--------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Authors: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data,0
-------------,0
%%,0
Compute free support Wasserstein barycenter,0
-------------------------------------------,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
%%,0
Compute free support Sinkhorn barycenter,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
make sure TF doesn't allocate entire GPU,0
allow numpy API for TF,0
Author: Laurène DAVID <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test computation of low rank cost matrices M1 and M2,0
test low rank sinkhorn,0
check constraints for P,0
check if lazy_plan is equal to the fully computed plan,0
check if value_linear is correct with its original formula,0
check warn parameter when Dykstra algorithm doesn't converge,0
test lowrank inits,0
"test ImportError if init=""kmeans"" and sklearn not imported",0
check constraints for P,0
Test warning for value of alpha,0
Test lr sinkhorn with different init strategies,0
check constraints for P,0
Test low rank sinkhorn for different backends,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
options for reg_m,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check if the marginals come close to the true ones when large reg,0
check if mm_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test when G0 is given,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
check constraints,0
test weak ot solver for different backends,0
check constraints,0
check constraints,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
generate gaussian dataset,0
compute first 3 components with BCD,0
test that U contains the principal components,0
compute first 3 components with MM,0
test that U contains the principal components,0
compute last 3 components,0
test that U contains the last principal components,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
chaeck that identity is recovered,0
check G is identity,0
check constraints,0
test weak ot solver for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
check transported mass,0
check constraints,0
check transported mass,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test binary_search_circle and wasserstein_circle give similar results as emd,0
check loss is similar,0
test semidiscrete_wasserstein2_unif_circle versus wasserstein_circle,0
"w_u = rng.uniform(0., 1., n)",0
w_u = w_u / w_u.sum(),0
check loss is similar,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
set readable ids for each param,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
solve unif weights,0
solve signe weights,0
solve in backend,0
test not implemented and check raise,0
pairs of incompatible divergences,0
check some attributes,0
solve in backend,0
solve in backend,0
test not implemented and check raise,0
detect partial not implemented and error detect in value,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve signe weights,0
test solve_sample when is_Lazy = False,0
solve signe weights,0
check some attributes (no need ),0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
create a lazy tensor,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
"For each column of X, find top max_nz values and",0
their corresponding indices. This incurs a sort.,0
Project the top max_nz values onto the simplex.,0
This incurs a second sort.,0
Put the projection of max_nz_values to their original indices,0
and set all other values zero.,0
check that two versions produce consistent results,0
test timing,0
"np.testing.assert_allclose(0.1, t, rtol=1e-1, atol=1e-1)",0
very slow macos github action equality not possible,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
test print,0
tets get citation,0
"i,j can be integers or slices, x1,x2 have to be passed as keyword arguments",0
create a lazy tensor,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
total sum,0
sum over axis 0,0
sum over axis 1,0
test otehr reduction function,0
test 3D tensors,0
create a lazy tensor,0
total sum,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
labels are shifted,0
labels are shifted but the shift if expected,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check this only if GPU is available,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Barycenter initialization,0
"Obvious barycenter locations. Take a look on test_ot.py, test_free_support_barycenter",0
Calculate free support barycenter w/ Sinkhorn algorithm. We set the entropic regularization,0
"term to 1, but this should be, in general, fine-tuned to the problem.",0
Verifies if calculated barycenter matches ground-truth,0
Gaussian distributions,0
creating matrix A containing all distributions,0
assymetric loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
First image,0
Second image,0
Creating matrix A containing all distributions,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check this only if GPU is available,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
call with log = False,0
check equality of plans,0
check error on wrong metric,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
Test sinkhorn divergence,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
Compute loss using dmmot_monge_1dgrid_loss,0
Compute loss using exact OT solver with absolute ground metric,0
deal with C-contiguous error from tensorflow backend (not sure why),0
compute loss,0
test discrete_mmot_converge result,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
classical gradients,0
Test with exact line-search,0
Test with armijo line-search,0
classical gradients,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
Tests with marginal_loss = False,0
check constraints,0
check constraints,0
setup,0
test with 'kl_loss' and log=True,0
"providing init_C, init_Y",0
add tests with fixed_structures or fixed_features,0
check constraints,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
providing init_C,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
providing init_C,0
check constraints,0
check constraints,0
add features,0
check constraints,0
check constraints,0
Tests with kl-loss:,0
check constraints,0
check constraints,0
add features,0
check constraints,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
test correspondance with utils function,0
add test with 'kl_loss',0
test correspondance with utils function,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: compare reconstruction error using initial dictionary and dictionary learned using this initialization,0
> Compute initial reconstruction of samples on this random dictionary without backend,0
> Learn the dictionary using this init,0
> Compute reconstruction of samples on learned dictionary without backend,0
Test: Perform same experiments after going through backend,0
Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
knowing than the initialization scheme is the same than implemented to set the benchmarked initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
and testing other optimization settings untested until now.,0
We pass previously estimated dictionaries to speed up the process.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: Compute initial reconstruction of samples on this random dictionary,0
> Learn a dictionary using this given initialization and check that the reconstruction loss,0
on the learned dictionary is lower than the one using its initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Compare both,0
Test: Perform same experiments after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform similar experiment without providing the initial dictionary being an optional input,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
"Test: without using adam optimizer, with log and verbose set to True",0
> Experiment providing previously estimated dictionary to speed up the test compared to providing initial random init.,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
> Compare results with/without backend,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
test sinkhorn,0
entropic gw and fgw,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for mass mismatch,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd2 and emd2 with openmp for simple identity,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two Diracs,0
obvious barycenter location between two Diracs,0
obvious barycenter location between two 2D Diracs,0
test without log and no init,0
test with log and init,0
obvious barycenter between two Diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test that types mathcing different backends in input raise an error,0
Check that subclassing a numpy array does not break get_backend,0
note: This is only tested for numpy as this is hard to be consistent,0
with other backends,0
Sparse tensors test,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
"test without log but with X_classes, a, b and other init method",0
"'new' input isn't new, so should be equal to target",0
test with no log but classes,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Test weights argument,0
test with closed form for diagonal covariance matrices,0
no log,0
no log + skewness,0
test the other way around (target to source),0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict,0
predict on batch,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict on batch,0
Test the TW layer by passing two graphs through the layer and doing backpropagation.,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test couplings,0
test marginal distributions,0
test entropic COOT distance,0
test couplings,0
test marginal distributions,0
test COOT distance,0
raise value error of method sinkhorn,0
raise value error for epsilon,0
raise value error for alpha,0
initialize warmstart,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test with coot distance,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
prepare semi-supervised labels,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
Mapping tests,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
"'new' input isn't new, so should be equal to target",0
test all margin constraints with gaussian similarity and disp regularisation,0
previously used implementation for the cost estimator,0
new vectorized implementation for the cost estimator,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
"html_css_files = [""css/custom.css""]",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
check the necessary inputs parameters are here,0
pairwise distance,0
zeros where source label is missing (masked with -1),0
zeros where labels match,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
init uniform,0
weak OT loss,0
weak OT gradient,0
solve with conditional gradient and return solution,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
solve the barycenter,0
solve OT with template,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
Main function,0
constant input variables,0
measures on rows and columns,0
pre-calculate cost constants,0
initialize coupling and dual vectors,0
initialize log,0
update sample coupling,0
update feature coupling,0
update error,0
COOT part,0
Entropic part,0
sanity check,0
measures on rows and columns,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
convert to humpy,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
convert back to backend,0
"Next 3 lines equivalent to K=nx.exp(-M/reg), but faster to compute",0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
optimise the plan,0
optimise the values phi and the gradients G,0
convert back to backend,0
lower bound,0
upper bound,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
###############################################################################,0
Losses for stochastic optimization,0
###############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Jakub Zadrozny <jakub.r.zadrozny@gmail.com>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
marginals,0
print iterations,0
loop,0
Solve transport,0
Solve PCA,0
block coordinate descent,0
majorization-minimization,0
stop or not,0
print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
it's necessary to check boundary condition here for the coefficient,0
as the callback could be evaluated for negative value of alpha by,0
`scalar_search_armijo` function here:,0
,0
https://github.com/scipy/scipy/blob/11509c4a98edded6c59423ac44ca1b7f28fba1fd/scipy/optimize/linesearch.py#L686,0
,0
see more details https://github.com/PythonOT/POT/issues/502,0
The callable function operates on nx backend,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
to not change G0 in place.,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
get minimum by rows as binary mask,0
return by default an empty inner_log,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"V[nx.newaxis, :], max_nz, z, axis=1).ravel()",0
"For each row of V, find top max_nz values; arrange the",0
corresponding column indices such that their values are,0
in a descending order.,0
Extract the top max_nz values for each row,0
and then project to simplex.,0
"rho = nx.count_nonzero(cond, axis=1)",0
Put the projection of max_nz_values to their original column indices,0
while keeping other values zero.,0
"in Jax, we need to use the `at` property of `jax.numpy.ndarray`",0
to do in-place array modificatons.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
I assume that other solvers may return directly,0
some primal objects?,0
"In the code below, let's define the main quantities",0
that may be of interest to users.,0
An OT solver returns an object that inherits from OTResult,0
(e.g. SinkhornOTResult) and implements the relevant,0
"methods (e.g. ""plan"" and ""lazy_plan"" but not ""sparse_plan"", etc.).",0
log is a dictionary containing potential information about the solver,0
Dual potentials --------------------------------------------,0
Transport plan -------------------------------------------,0
N.B.: We may catch out-of-memory errors and suggest,0
the use of lazy_plan or sparse_plan when appropriate.,0
Loss values --------------------------------,0
Marginal constraints -------------------------,0
Barycentric mappings -------------------------,0
Return the displacement vectors as an array,0
"that has the same shape as ""xa""/""xb"" (for samples)",0
"or ""a""/""b"" * D (for images)?",0
# Wasserstein barycenters ----------------------,0
@property,0
def masses(self):,0
"""""""Masses for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
@property,0
def samples(self):,0
"""""""Sample locations for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
Miscellaneous --------------------------------,0
The string below refers to the POT library:,0
successor methods may concatenate the relevant references,0
"to the original definitions, solvers and underlying numerical backends.",0
set attributes for named arguments/arrays,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
Tianlin Liu <t.liu@unibas.ch>,0
"For each column of X, find entries that are not among the top max_nz.",0
Set these entries to -inf.,0
Project the scaled X onto the simplex with sparsity constraint.,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
convert to humpy,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for EMD solver,0
default values for exact unbalanced OT,0
default values for sinkhorn,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for solver,0
default values for EMD solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
default values for solver,0
"potentials = (log['log_u'], log['log_v'])  #TODO",0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v'])",0
default values for solver,0
default values for solver,0
default values for solver,0
"potentials = (log['u'], log['v']) TODO",0
for uniform weights,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
lazy solver of memory complexity O(n),0
lazy OT plan,0
automatic solver,0
force O(n) memory efficient solver,0
force pre-computed cost matrix,0
use multiscale solver,0
One can play with speed (small scaling factor) and precision (scaling close to 1),0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
recover the lazy low rank plan,0
recover the full low rank plan,0
recover the squared Gaussian Bures-Wasserstein distance,0
recover the squared Wasserstein distances,0
compute cost matrix M and use solve function,0
Detect backend,0
default values for solutions,0
return scaled potentials (to be consistent with other solvers),0
compute potentials,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test if sklearn is installed for linux-minimal-deps,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
Init g,0
Init Q,0
Init R,0
First low rank decomposition of the cost matrix (A),0
Second low rank decomposition of the cost matrix (B),0
POT backend if None,0
----------------- Initialisation of Dykstra algorithm -----------------,0
--------------------- Dykstra algorithm -------------------------,0
"See Section 3.3 - ""Algorithm 2 LR-Dykstra"" in paper",0
Compute u^{(1)} and u^{(2)},0
"Compute g, g^{(3)}_1 and update \tilde{g}",0
Compute new value of g with \prod,0
Compute v^{(1)} and v^{(2)},0
"Compute q^{(1)}, q^{(2)} and q^{(3)}_2",0
"Update values of \tilde{v}^{(1)}, \tilde{v}^{(2)} and \tilde{g}",0
Compute error,0
"Compute low rank matrices Q, R",0
POT backend,0
"Initialize weights a, b",0
"Compute rank (see Section 3.1, def 1)",0
Dykstra won't converge if 1/rank < alpha (see Section 3.2),0
Low rank decomposition of the sqeuclidean cost matrix,0
"Initialize the low rank matrices Q, R, g",0
Gamma initialization,0
-------------------------- Low rank algorithm ------------------------------,0
"see ""Section 3.3, Algorithm 3 LOT""",0
Compute C*R dot using the lr decomposition of C,0
Compute C.T * Q using the lr decomposition of C,0
Compute omega,0
Rescale gamma at each iteration,0
LR Dykstra algorithm,0
"----------------- Compute lazy_plan, value and value_linear  ------------------",0
"see ""Section 3.2: The Low-rank OT Problem"" in the paper",0
Compute lazy plan (using LazyTensor class),0
Compute value_linear (using trace formula),0
"Compute value with entropy reg (see ""Section 3.2"" in the paper)",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Mapping between argument types and the existing backend,0
check that all arguments matched or not the type,0
Otherwise return an error,0
check that some arrays given,0
convert batch of tensors to numpy,0
convert a tensor to numpy,0
convert batch of arrays from numpy,0
convert an array from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
Only register jax backend if it is installed,0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
"Since version 1.11.0, interpolation is available",0
"Else, use numpy",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
Only register torch backend if it is installed,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
Only register cp backend if it is installed,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
todo(okachaiev): replace this with a more reasonable implementation,1
Only register tensorflow backend if it is installed,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Compute the mean barycenter,0
Init the covariance barycenter,0
fixed point update,0
check convergence,0
ensure that Cov_s is the largest covariance matrix,0
that is m >= n,0
compte and sort eigenvalues decerasingly,0
compute the gaussien Gromov-Wasserstein distance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
compute the gaussien Gromov-Wasserstein dis,0
estimate mean and covariance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
select the sign of the eigenvalues,0
compute the gaussien Gromov-Wasserstein dis,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
compute loss,0
compute gradient,0
convert to numpy,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
after that we are all in torch,0
set blur value and p,0
force gradients for computing dual,0
compute value,0
get dual potentials,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Alexander Tong <alexander.tong@yale.edu>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
in case of multiple historgrams,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
oldidx = nx.copy(idx),0
the above terminates when any entry in idx equals the corresponding,0
value in dims this leaves other dimensions incomplete; the remaining,0
terms of the dual solution must be filled-in,0
define forward/backward relations for pytorch,0
function body here,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
quantiles of F_u evaluated in F_v^\theta,0
Deal with 1,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
Put negative values at the end,0
Compute absciss,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
Compute icdf,0
can probably be improved by computing only relevant values,1
Code inspired from https://gitlab.gwdg.de/shundri/circularOT/-/tree/master/,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
ensure that same mass,0
variable change matrix to reduce the problem to a Wasserstein Barycenter (WB),0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check first marginal of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
the new cost can be deduced from the line search quadratic function,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
tens -= tens.min(),0
Correct order mistake in Equation 14 in [12],0
Correct order mistake in Equation 15 in [12],0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Define gradients,0
rows update,0
columns update,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random euclidean distance matrix (if not provided by user),0
Initialization of Y,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
simple get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
init marginals if set as None,0
compute separate terms for gradients and log,0
the new cost is deduced from the line search quadratic function,0
Initialization of C : random SPD matrix (if not provided by user),0
get transport plans,0
update barycenters,0
update convergence criterion,0
get transport plans,0
update barycenters,0
update convergence criterion,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cedric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Handle backend of non-optional arguments,0
Handle backend of optional arguments,0
Initialize randomly structures of dictionary atoms based on samples,0
batch sampling,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
Initialization for our numpy implementation of adam optimizer,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
Initialize randomly structures of dictionary atoms based on samples,0
Initialize randomly features of dictionary atoms based on samples distribution by feature component,0
Batch iterations,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
"modeling (C,Y)",0
constants depending on q,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
structure,0
feature,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
polynomial coefficients from quadratic objective (with respect to w) on structures,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
polynomial coefficient from quadratic objective (with respect to w) on features,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
%%,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
%%,0
Comparison of the OT matrices,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
use fast 1D solver,0
Equivalent to,0
"G0 = ot.emd(a, b, M)",0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: ../_static/images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have access to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan visualization,0
`````````````````````````````````,0
,0
A good visualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: ../_static/images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Empirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
"pl.xlim((-7,23))",0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
"pl.xlim((-7,23))",0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
########################################################################################,0
Compare the Euclidean Wasserstein distance with the Wasserstein distance on the  circle,0
---------------------------------------------------------------------------------------,0
This examples illustrates the periodicity of the Wasserstein distance on the circle.,0
We choose as target distribution a von Mises distribution with mean :math:`\mu_{\mathrm{target}}`,0
"and :math:`\kappa=20`. Then, we compare the distances with samples obtained from a von Mises distribution",0
with parameters :math:`\mu_{\mathrm{source}}` and :math:`\kappa=20`.,0
The Wasserstein distance on the circle takes into account the periodicity,0
and attains its maximum in :math:`\mu_{\mathrm{target}}+1` (the antipodal point) contrary to the,0
Euclidean version.,0
%% Compute and plot distributions,0
"np.random.vonmises deals with data on [-pi, pi[",0
"Put data on S^1=[0,1[",0
#######################################################################,0
Wasserstein distance between von Mises and uniform for different kappa,0
----------------------------------------------------------------------,0
"When :math:`\kappa=0`, the von Mises distribution is the uniform distribution on :math:`S^1`.",0
%% Compute Wasserstein between Von Mises and uniform,0
"np.random.vonmises deals with data on [-pi, pi[",0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with squared l2 regularization,0
%% Sparsity-constrained OT,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Generating the fitting data,0
%%,0
Fitting the Nearest Brenier Potential,0
%%,0
Plotting the images of the source data,0
%%,0
Computing the predictions (images by nabla phi) for random samples of the source distribution,0
%%,0
Plot predictions for the gradient of the lower-bounding potential,0
%%,0
Plot predictions for the gradient of the upper-bounding potential,0
-*- coding: utf-8 -*-,0
Author: Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Plot data,0
-------------,0
#############################################################################,0
Compute EWCA,0
-------------,0
#############################################################################,0
"Plot data, first component, and projected data",0
-------------,0
#############################################################################,0
Plot transport plan,0
-------------,0
-*- coding: utf-8 -*-,0
Author: Laurène David <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
Gaussian distribution,0
Source and target distribution,0
#############################################################################,0
Solve Low rank sinkhorn,0
------------,0
%%,0
Solve low rank sinkhorn,0
#############################################################################,0
Sinkhorn vs Low Rank Sinkhorn,0
-----------------------,0
Compare Sinkhorn and Low rank sinkhorn with different regularizations and ranks.,0
%% Sinkhorn,0
Compute cost matrix for sinkhorn OT,0
Solve sinkhorn with different regularizations using ot.solve,0
%% Low rank sinkhorn,0
Solve low rank sinkhorn with different ranks using ot.solve_sample,0
%%,0
Plot sinkhorn vs low rank sinkhorn,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generate data,0
-------------,0
The source and clean target matrices are generated by,0
":math:`X_{i,j} = \cos(\frac{i}{n_1} \pi) + \cos(\frac{j}{d_1} \pi)` and",0
":math:`Y_{i,j} = \cos(\frac{i}{n_2} \pi) + \cos(\frac{j}{d_2} \pi)`.",0
The target matrix is then contaminated by adding 5 row outliers.,0
"Intuitively, we expect that the estimated sample distribution should ignore these outliers,",0
i.e. their weights should be zero.,0
Generate clean target data mixed with outliers,0
%%,0
Optimize the COOT distance with respect to the sample marginal distribution,0
---------------------------------------------------------------------------,0
Estimated sample marginal distribution and training loss curve,0
%%,0
Visualizing the row and column alignments with the estimated sample marginal distribution,0
-----------------------------------------------------------------------------------------,0
,0
"Clearly, the learned marginal distribution completely and successfully ignores the 5 outliers.",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%% Load modules,0
%%,0
Data for logo,0
-------------,0
Letter P,0
Letter O,0
Scaling and translation for letter O,0
Letter T,0
Translating the T,0
Concatenate all letters,0
Horizontal and vertical scaling,0
%%,0
Plot the logo (clear background),0
--------------------------------,0
Solve OT problem between the points,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo.png', dpi=150, transparent=True, bbox_inches='tight')",0
%%,0
Plot the logo (dark background),0
--------------------------------,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo_dark.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo_dark.png', dpi=150, transparent=True, bbox_inches='tight')",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generating two random matrices,0
%%,0
Visualizing the matrices,0
%%,0
"Visualizing the alignments of rows and columns, and calculating the CO-Optimal Transport distance",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data an plot it,0
------------------------,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
#############################################################################,0
Compute Weak OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% Weak OT,0
#############################################################################,0
Plot weak OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
%%,0
Generating 2 distributions,0
-----,0
Gaussian distributions,0
%%,0
"Minimize the distances among distributions, identify the Barycenter",0
-----,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
L2 Iteration,0
%%,0
Compare Barycenters in both methods,0
-----,0
"pl.plot(x, barys[i], 'g-*')",0
%%,0
More than 2 distributions,0
--------------------------------------------------,0
Generate 7 pseudorandom gaussian distributions with 50 bins.,0
%%,0
Minimizing Distances Among Many Distributions,0
---------------,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
Perform gradient descent optimization using the d-MMOT method.,0
"after minimization, any distribution can be used as a estimate of barycenter.",0
Compute 1D Wasserstein barycenter using the L2/LP method,0
%%,0
Compare Barycenters in both methods,0
---------,0
%%,0
Compare with original distributions,0
---------,0
"pl.plot(x, barys[i], 'g')",0
%%,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinuous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinuous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data an plot it,0
------------------------,0
parameters and data generation,0
%% plot samples,0
%%,0
Compute Factored OT and exact OT solutions,0
------------------------------------------,0
%% EMD,0
%% factored OT OT,0
%%,0
Plot factored OT and exact OT solutions,0
---------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labeled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
Gaussian (linear) Monge mapping estimation,0
Gaussian (linear) GW mapping estimation,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
Monge mapping,0
gaussian GW mapping,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
Labels,0
Ticks,0
##############################################################################,0
Spherical Sliced Wasserstein for different seeds and number of projections,0
--------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Spherical Sliced Wasserstein,0
---------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
%%,0
plot the transported mass,0
-------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------------------------------------------------------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------------------,0
,0
The OT plan is plotted as a function of $\gamma$ that is the inverse of the,0
weight on the marginal relaxations.,0
%% fully relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for UOT l2,0
-----------------------------------,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-----------------------------------------,0
%% semi-relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for semi-relaxed UOT l2,0
------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
"Compute entropic kl-regularized UOT, kl- and l2-regularized UOT",0
-----------,0
#############################################################################,0
Plot the results,0
----------------,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
----------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
--------------------------------------------------------,0
The adjacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
-------------------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating dual variables for entropic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated entropic OT plan,0
-----------------------------------,0
%%,0
Estimating dual variables for quadratic OT,0
------------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated quadratic OT plan,0
------------------------------------,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
----------------------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
---------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
-----------------------------------------,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
--------------------------------------------------,0
#############################################################################,0
Plotting the reweighted source distribution,0
-------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating deep dual variables for entropic OT,0
----------------------------------------------,0
define the MLP model,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the density on target for a given source sample,0
----------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Gradient descent,0
----------------,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
"pl.subplot(3, 3, i + 1)",0
ax = pl.axes(projection='3d'),0
"ax.axis(""off"")",0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
compute OT sparsity level,0
Methods using Sinkhorn projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Compute GW with scalable stochastic methods with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
############################################################################,0
,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
-----------------------------------------------------------------------------------------------,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",0
Visualize samples,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the Gromov-Wasserstein dictionary from the dataset,0
-----------------------------------------------------------,0
visualize loss evolution over epochs,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Compute the 2D representation of the unmixing living in the 2-simplex of probability,0
############################################################################,0
,0
Endow the dataset with node features,0
------------------------------------,0
We follow this feature assignment on all nodes of a graph depending on its label/number of clusters,0
1 cluster --> 0 as nodes feature,0
2 clusters --> 1 as nodes feature,0
3 clusters --> 2 as nodes feature,0
features are one-hot encoded following these assignments,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs,0
------------------------------------------------------------------------------------,0
visualize loss evolution,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
scaled_F = 2 * (Fatom - min_features) / (max_features - min_features),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Visualize unmixings in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
#############################################################################,0
Compute FGW/GW,0
--------------,0
Computing FGW and GW,0
reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
visu OT matrix,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their entropic-regularized semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW_e(C2, h2, C3)",0
"2) srGW_e(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the entropic-regularized semi-relaxed Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the entropic srGW matching.,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW_e(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the entropic semi-relaxed Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create 2 classes of stochastic block models (SBM) graphs with 1 block and 2 blocks respectively.,0
edge probabilities for the SBMs,0
block sizes,0
node features,0
split the data into train and test sets,0
%%,0
#############################################################################,0
Plot data,0
---------,0
plot one graph of each class,0
%%,0
#############################################################################,0
Pooling architecture using the TFGW layer,0
---------,0
#############################################################################,0
Graph classification training,0
---------,0
store latent embeddings and classes for TSNE visualization,0
store last classes and embeddings for TSNE visualization,0
Test,0
%%,0
#############################################################################,0
TSNE visualization of graph classification,0
---------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
Compute pairwise euclidean distance between node features,0
############################################################################,0
,0
Compute their Fused Gromov-Wasserstein distances,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
Alternated Bregman Projected Gradient algorithm with Kullback-Leibler as proximal operator,0
compute OT sparsity level,0
Methods using Sinkhorn/Bregman projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Visualization of the Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the FGW matchings,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
"For each matching, all node sizes are proportionnal to their mass computed",0
from marginals of the OT plan to illustrate potential feasibility errors.,0
NB: colors refer to clusters - not to node features,0
Add weights on the edges for visualization later on,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
--------------------------------------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW(C2, h2, C3)",0
"2) srGW(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Gromov-Wasserstein matchings,0
--------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srGW matching,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
-----------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Fused Gromov-Wasserstein matchings,0
--------------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Authors: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
%%,0
Define Gaussian Covariances and distributions,0
---------------------------------------------,0
%%,0
Plot the distributions,0
----------------------,0
"pl.scatter(mu[0],mu[1],color=color, marker='x')",0
%%,0
Compute Bures-Wasserstein barycenters and plot them,0
-------------------------------------------,0
basis for bilinear interpolation,0
weights are constructed by bilinear interpolation,0
-*- coding: utf-8 -*-,0
Authors: Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
%%,0
General Parameters,0
------------------,0
%%,0
Generate Data,0
-------------,0
%%,0
Inspect generated distributions,0
-------------------------------,0
%%,0
Interpolating Empirical Distributions,0
-------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#######################,0
Generate and plot data,0
----------------------,0
Input measures,0
Input measure locations in their respective 2D spaces,0
Input measure weights,0
Projections 3D -> 2D,0
Barycenter weights,0
Number of barycenter points to compute,0
Send the input measures into 3D space for visualization,0
Plot the input data,0
################################,0
Barycenter computation and plot,0
-------------------------------,0
############################,0
Plotting projection matches,0
---------------------------,0
#############################################,0
Rotation animation,0
--------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Authors: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data,0
-------------,0
%%,0
Compute free support Wasserstein barycenter,0
-------------------------------------------,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
%%,0
Compute free support Sinkhorn barycenter,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
make sure TF doesn't allocate entire GPU,0
allow numpy API for TF,0
Author: Laurène DAVID <laurene.david@ip-paris.fr>,0
,0
License: MIT License,0
test computation of low rank cost matrices M1 and M2,0
test low rank sinkhorn,0
check constraints for P,0
check if lazy_plan is equal to the fully computed plan,0
check if value_linear is correct with its original formula,0
check warn parameter when Dykstra algorithm doesn't converge,0
test lowrank inits,0
"test ImportError if init=""kmeans"" and sklearn not imported",0
check constraints for P,0
Test warning for value of alpha,0
Test lr sinkhorn with different init strategies,0
check constraints for P,0
Test low rank sinkhorn for different backends,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
options for reg_m,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check if the marginals come close to the true ones when large reg,0
check if mm_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test when G0 is given,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
check constraints,0
test weak ot solver for different backends,0
check constraints,0
check constraints,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
generate gaussian dataset,0
compute first 3 components with BCD,0
test that U contains the principal components,0
compute first 3 components with MM,0
test that U contains the principal components,0
compute last 3 components,0
test that U contains the last principal components,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
chaeck that identity is recovered,0
check G is identity,0
check constraints,0
test weak ot solver for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
check transported mass,0
check constraints,0
check transported mass,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test binary_search_circle and wasserstein_circle give similar results as emd,0
check loss is similar,0
test semidiscrete_wasserstein2_unif_circle versus wasserstein_circle,0
"w_u = rng.uniform(0., 1., n)",0
w_u = w_u / w_u.sum(),0
check loss is similar,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
set readable ids for each param,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
solve unif weights,0
solve signe weights,0
solve in backend,0
test not implemented and check raise,0
pairs of incompatible divergences,0
check some attributes,0
solve in backend,0
solve in backend,0
test not implemented and check raise,0
detect partial not implemented and error detect in value,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
test solve_sample when is_Lazy = False,0
solve with ot.solve,0
solve signe weights,0
test solve_sample when is_Lazy = False,0
solve signe weights,0
check some attributes (no need ),0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
create a lazy tensor,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
"For each column of X, find top max_nz values and",0
their corresponding indices. This incurs a sort.,0
Project the top max_nz values onto the simplex.,0
This incurs a second sort.,0
Put the projection of max_nz_values to their original indices,0
and set all other values zero.,0
check that two versions produce consistent results,0
test timing,0
"np.testing.assert_allclose(0.1, t, rtol=1e-1, atol=1e-1)",0
very slow macos github action equality not possible,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
test print,0
tets get citation,0
"i,j can be integers or slices, x1,x2 have to be passed as keyword arguments",0
create a lazy tensor,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
total sum,0
sum over axis 0,0
sum over axis 1,0
test otehr reduction function,0
test 3D tensors,0
create a lazy tensor,0
total sum,0
get the full tensor (not lazy),0
get one component,0
get one row,0
get one column with slices,0
labels are shifted,0
labels are shifted but the shift if expected,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check this only if GPU is available,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Barycenter initialization,0
"Obvious barycenter locations. Take a look on test_ot.py, test_free_support_barycenter",0
Calculate free support barycenter w/ Sinkhorn algorithm. We set the entropic regularization,0
"term to 1, but this should be, in general, fine-tuned to the problem.",0
Verifies if calculated barycenter matches ground-truth,0
Gaussian distributions,0
creating matrix A containing all distributions,0
assymetric loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
First image,0
Second image,0
Creating matrix A containing all distributions,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check this only if GPU is available,0
Create the array of images to test,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Create the array of images to test,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Using the Tensorflow backend,0
Create the array of images to test,0
Check that everything stays on the CPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
help in checking if log and verbose do not bug the function,0
Test that the dtype and device are the same after the computation,0
Check that everything happens on the GPU,0
wasserstein,0
Compute the barycenter with numpy,0
Compute the barycenter with the backend,0
"Convert the backend result to numpy, to compare with the numpy result",0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
call with log = False,0
check equality of plans,0
check error on wrong metric,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
Test sinkhorn divergence,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
Compute loss using dmmot_monge_1dgrid_loss,0
Compute loss using exact OT solver with absolute ground metric,0
deal with C-contiguous error from tensorflow backend (not sure why),0
compute loss,0
test discrete_mmot_converge result,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
classical gradients,0
Test with exact line-search,0
Test with armijo line-search,0
classical gradients,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
complete test with marginal loss = True,0
check constraints,0
check constraints,0
Tests with marginal_loss = False,0
check constraints,0
check constraints,0
setup,0
test with 'kl_loss' and log=True,0
"providing init_C, init_Y",0
add tests with fixed_structures or fixed_features,0
check constraints,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
providing init_C,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
providing init_C,0
check constraints,0
check constraints,0
add features,0
check constraints,0
check constraints,0
Tests with kl-loss:,0
check constraints,0
check constraints,0
add features,0
check constraints,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
test correspondance with utils function,0
add test with 'kl_loss',0
test correspondance with utils function,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: compare reconstruction error using initial dictionary and dictionary learned using this initialization,0
> Compute initial reconstruction of samples on this random dictionary without backend,0
> Learn the dictionary using this init,0
> Compute reconstruction of samples on learned dictionary without backend,0
Test: Perform same experiments after going through backend,0
Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
knowing than the initialization scheme is the same than implemented to set the benchmarked initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
and testing other optimization settings untested until now.,0
We pass previously estimated dictionaries to speed up the process.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: Compute initial reconstruction of samples on this random dictionary,0
> Learn a dictionary using this given initialization and check that the reconstruction loss,0
on the learned dictionary is lower than the one using its initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Compare both,0
Test: Perform same experiments after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform similar experiment without providing the initial dictionary being an optional input,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
"Test: without using adam optimizer, with log and verbose set to True",0
> Experiment providing previously estimated dictionary to speed up the test compared to providing initial random init.,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
> Compare results with/without backend,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
test sinkhorn,0
entropic gw and fgw,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for mass mismatch,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd2 and emd2 with openmp for simple identity,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two Diracs,0
obvious barycenter location between two Diracs,0
obvious barycenter location between two 2D Diracs,0
test without log and no init,0
test with log and init,0
obvious barycenter between two Diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test that types mathcing different backends in input raise an error,0
Check that subclassing a numpy array does not break get_backend,0
note: This is only tested for numpy as this is hard to be consistent,0
with other backends,0
Sparse tensors test,0
Author: Eloi Tanguy <eloi.tanguy@u-paris.fr>,0
,0
License: MIT License,0
"test without log but with X_classes, a, b and other init method",0
"'new' input isn't new, so should be equal to target",0
test with no log but classes,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Test weights argument,0
test with closed form for diagonal covariance matrices,0
no log,0
no log + skewness,0
test the other way around (target to source),0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict,0
predict on batch,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict on batch,0
Test the TW layer by passing two graphs through the layer and doing backpropagation.,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test couplings,0
test marginal distributions,0
test entropic COOT distance,0
test couplings,0
test marginal distributions,0
test COOT distance,0
raise value error of method sinkhorn,0
raise value error for epsilon,0
raise value error for alpha,0
initialize warmstart,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test with coot distance,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
prepare semi-supervised labels,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
Mapping tests,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
"'new' input isn't new, so should be equal to target",0
test all margin constraints with gaussian similarity and disp regularisation,0
previously used implementation for the cost estimator,0
new vectorized implementation for the cost estimator,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
"html_css_files = [""css/custom.css""]",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
init uniform,0
weak OT loss,0
weak OT gradient,0
solve with conditional gradient and return solution,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
solve the barycenter,0
solve OT with template,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
Main function,0
constant input variables,0
measures on rows and columns,0
pre-calculate cost constants,0
initialize coupling and dual vectors,0
initialize log,0
update sample coupling,0
update feature coupling,0
update error,0
COOT part,0
Entropic part,0
sanity check,0
measures on rows and columns,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
in case of multiple historgrams,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
convert to humpy,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
convert back to backend,0
"Next 3 lines equivalent to K=nx.exp(-M/reg), but faster to compute",0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
###############################################################################,0
Losses for stochastic optimization,0
###############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Jakub Zadrozny <jakub.r.zadrozny@gmail.com>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
marginals,0
print iterations,0
loop,0
Solve transport,0
Solve PCA,0
block coordinate descent,0
majorization-minimization,0
stop or not,0
print,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
The callable function operates on nx backend,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
to not change G0 in place.,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
get minimum by rows as binary mask,0
return by default an empty inner_log,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"V[nx.newaxis, :], max_nz, z, axis=1).ravel()",0
"For each row of V, find top max_nz values; arrange the",0
corresponding column indices such that their values are,0
in a descending order.,0
Extract the top max_nz values for each row,0
and then project to simplex.,0
"rho = nx.count_nonzero(cond, axis=1)",0
Put the projection of max_nz_values to their original column indices,0
while keeping other values zero.,0
"in Jax, we need to use the `at` property of `jax.numpy.ndarray`",0
to do in-place array modificatons.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
I assume that other solvers may return directly,0
some primal objects?,0
"In the code below, let's define the main quantities",0
that may be of interest to users.,0
An OT solver returns an object that inherits from OTResult,0
(e.g. SinkhornOTResult) and implements the relevant,0
"methods (e.g. ""plan"" and ""lazy_plan"" but not ""sparse_plan"", etc.).",0
log is a dictionary containing potential information about the solver,0
Dual potentials --------------------------------------------,0
Transport plan -------------------------------------------,0
N.B.: We may catch out-of-memory errors and suggest,0
the use of lazy_plan or sparse_plan when appropriate.,0
Loss values --------------------------------,0
Marginal constraints -------------------------,0
Barycentric mappings -------------------------,0
Return the displacement vectors as an array,0
"that has the same shape as ""xa""/""xb"" (for samples)",0
"or ""a""/""b"" * D (for images)?",0
# Wasserstein barycenters ----------------------,0
@property,0
def masses(self):,0
"""""""Masses for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
@property,0
def samples(self):,0
"""""""Sample locations for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
Miscellaneous --------------------------------,0
The string below refers to the POT library:,0
successor methods may concatenate the relevant references,0
"to the original definitions, solvers and underlying numerical backends.",0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
Tianlin Liu <t.liu@unibas.ch>,0
"For each column of X, find entries that are not among the top max_nz.",0
Set these entries to -inf.,0
Project the scaled X onto the simplex with sparsity constraint.,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
convert to humpy,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for EMD solver,0
default values for exact unbalanced OT,0
default values for sinkhorn,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Mapping between argument types and the existing backend,0
check that all arguments matched or not the type,0
Oterwise return an error,0
check that some arrays given,0
convert batch of tensors to numpy,0
convert a tensor to numpy,0
convert batch of arrays from numpy,0
convert an array from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
Only register jax backend if it is installed,0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
"Since version 1.11.0, interpolation is available",0
"Else, use numpy",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
Only register torch backend if it is installed,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
Only register cp backend if it is installed,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
Only register tensorflow backend if it is installed,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
ensure that Cov_s is the largest covariance matrix,0
that is m >= n,0
compte and sort eigenvalues decerasingly,0
compute the gaussien Gromov-Wasserstein distance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
compute the gaussien Gromov-Wasserstein dis,0
estimate mean and covariance,0
compte and sort eigenvalues/eigenvectors decreasingly,0
select the sign of the eigenvalues,0
compute the gaussien Gromov-Wasserstein dis,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
compute loss,0
compute gradient,0
convert to humpy,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
if alpha is zero the emd distance is used,0
iterate over the graphs in the batch,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
oldidx = nx.copy(idx),0
the above terminates when any entry in idx equals the corresponding,0
value in dims this leaves other dimensions incomplete; the remaining,0
terms of the dual solution must be filled-in,0
define forward/backward relations for pytorch,0
function body here,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
quantiles of F_u evaluated in F_v^\theta,0
Deal with 1,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warning related to non-contiguous arrays,0
Put negative values at the end,0
Compute absciss,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
Compute icdf,0
can probably be improved by computing only relevant values,1
Code inspired from https://gitlab.gwdg.de/shundri/circularOT/-/tree/master/,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
ensure that same mass,0
variable change matrix to reduce the problem to a Wasserstein Barycenter (WB),0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check first marginal of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
partial get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
the new cost can be deduced from the line search quadratic function,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Check first marginal of G0,0
compute the kernel,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
tens -= tens.min(),0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
initialize potentials to cope with ot.sinkhorn initialization,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
Initialization of Y,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
simple get_backend as the full one will be handled in gromov_wasserstein,0
init marginals if set as None,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
init marginals if set as None,0
the new cost is deduced from the line search quadratic function,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cedric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Handle backend of non-optional arguments,0
Handle backend of optional arguments,0
Initialize randomly structures of dictionary atoms based on samples,0
batch sampling,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
Initialization for our numpy implementation of adam optimizer,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
Initialize randomly structures of dictionary atoms based on samples,0
Initialize randomly features of dictionary atoms based on samples distribution by feature component,0
Batch iterations,0
BCD solver for Gromov-Wasserstein linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
"modeling (C,Y)",0
constants depending on q,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
structure,0
feature,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
polynomial coefficients from quadratic objective (with respect to w) on structures,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
polynomial coefficient from quadratic objective (with respect to w) on features,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
%%,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
%%,0
Comparison of the OT matrices,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
use fast 1D solver,0
Equivalent to,0
"G0 = ot.emd(a, b, M)",0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: ../_static/images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have access to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan visualization,0
`````````````````````````````````,0
,0
A good visualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: ../_static/images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Empirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
"pl.xlim((-7,23))",0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
"pl.xlim((-7,23))",0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
########################################################################################,0
Compare the Euclidean Wasserstein distance with the Wasserstein distance on the  circle,0
---------------------------------------------------------------------------------------,0
This examples illustrates the periodicity of the Wasserstein distance on the circle.,0
We choose as target distribution a von Mises distribution with mean :math:`\mu_{\mathrm{target}}`,0
"and :math:`\kappa=20`. Then, we compare the distances with samples obtained from a von Mises distribution",0
with parameters :math:`\mu_{\mathrm{source}}` and :math:`\kappa=20`.,0
The Wasserstein distance on the circle takes into account the periodicity,0
and attains its maximum in :math:`\mu_{\mathrm{target}}+1` (the antipodal point) contrary to the,0
Euclidean version.,0
%% Compute and plot distributions,0
"np.random.vonmises deals with data on [-pi, pi[",0
"Put data on S^1=[0,1[",0
#######################################################################,0
Wasserstein distance between von Mises and uniform for different kappa,0
----------------------------------------------------------------------,0
"When :math:`\kappa=0`, the von Mises distribution is the uniform distribution on :math:`S^1`.",0
%% Compute Wasserstein between Von Mises and uniform,0
"np.random.vonmises deals with data on [-pi, pi[",0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with squared l2 regularization,0
%% Sparsity-constrained OT,0
-*- coding: utf-8 -*-,0
Author: Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Plot data,0
-------------,0
#############################################################################,0
Compute EWCA,0
-------------,0
#############################################################################,0
"Plot data, first component, and projected data",0
-------------,0
#############################################################################,0
Plot transport plan,0
-------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generate data,0
-------------,0
The source and clean target matrices are generated by,0
":math:`X_{i,j} = \cos(\frac{i}{n_1} \pi) + \cos(\frac{j}{d_1} \pi)` and",0
":math:`Y_{i,j} = \cos(\frac{i}{n_2} \pi) + \cos(\frac{j}{d_2} \pi)`.",0
The target matrix is then contaminated by adding 5 row outliers.,0
"Intuitively, we expect that the estimated sample distribution should ignore these outliers,",0
i.e. their weights should be zero.,0
Generate clean target data mixed with outliers,0
%%,0
Optimize the COOT distance with respect to the sample marginal distribution,0
---------------------------------------------------------------------------,0
Estimated sample marginal distribution and training loss curve,0
%%,0
Visualizing the row and column alignments with the estimated sample marginal distribution,0
-----------------------------------------------------------------------------------------,0
,0
"Clearly, the learned marginal distribution completely and successfully ignores the 5 outliers.",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%% Load modules,0
%%,0
Data for logo,0
-------------,0
Letter P,0
Letter O,0
Scaling and translation for letter O,0
Letter T,0
Translating the T,0
Concatenate all letters,0
Horizontal and vertical scaling,0
%%,0
Plot the logo (clear background),0
--------------------------------,0
Solve OT problem between the points,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo.png', dpi=150, transparent=True, bbox_inches='tight')",0
%%,0
Plot the logo (dark background),0
--------------------------------,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo_dark.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo_dark.png', dpi=150, transparent=True, bbox_inches='tight')",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generating two random matrices,0
%%,0
Visualizing the matrices,0
%%,0
"Visualizing the alignments of rows and columns, and calculating the CO-Optimal Transport distance",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data an plot it,0
------------------------,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
#############################################################################,0
Compute Weak OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% Weak OT,0
#############################################################################,0
Plot weak OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
%%,0
Generating 2 distributions,0
-----,0
Gaussian distributions,0
%%,0
"Minimize the distances among distributions, identify the Barycenter",0
-----,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
L2 Iteration,0
%%,0
Compare Barycenters in both methods,0
-----,0
"pl.plot(x, barys[i], 'g-*')",0
%%,0
More than 2 distributions,0
--------------------------------------------------,0
Generate 7 pseudorandom gaussian distributions with 50 bins.,0
%%,0
Minimizing Distances Among Many Distributions,0
---------------,0
"The objective being minimized is different for both methods, so the objective",0
values cannot be compared.,0
Perform gradient descent optimization using the d-MMOT method.,0
"after minimization, any distribution can be used as a estimate of barycenter.",0
Compute 1D Wasserstein barycenter using the L2/LP method,0
%%,0
Compare Barycenters in both methods,0
---------,0
%%,0
Compare with original distributions,0
---------,0
"pl.plot(x, barys[i], 'g')",0
%%,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinuous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinuous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data an plot it,0
------------------------,0
parameters and data generation,0
%% plot samples,0
%%,0
Compute Factored OT and exact OT solutions,0
------------------------------------------,0
%% EMD,0
%% factored OT OT,0
%%,0
Plot factored OT and exact OT solutions,0
---------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labeled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
Gaussian (linear) Monge mapping estimation,0
Gaussian (linear) GW mapping estimation,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
Monge mapping,0
gaussian GW mapping,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
Labels,0
Ticks,0
##############################################################################,0
Spherical Sliced Wasserstein for different seeds and number of projections,0
--------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Spherical Sliced Wasserstein,0
---------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
%%,0
plot the transported mass,0
-------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------------------------------------------------------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------------------,0
,0
The OT plan is plotted as a function of $\gamma$ that is the inverse of the,0
weight on the marginal relaxations.,0
%% fully relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for UOT l2,0
-----------------------------------,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-----------------------------------------,0
%% semi-relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for semi-relaxed UOT l2,0
------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
"Compute entropic kl-regularized UOT, kl- and l2-regularized UOT",0
-----------,0
#############################################################################,0
Plot the results,0
----------------,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
----------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
--------------------------------------------------------,0
The adjacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
-------------------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating dual variables for entropic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated entropic OT plan,0
-----------------------------------,0
%%,0
Estimating dual variables for quadratic OT,0
------------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated quadratic OT plan,0
------------------------------------,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
----------------------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
---------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
-----------------------------------------,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
--------------------------------------------------,0
#############################################################################,0
Plotting the reweighted source distribution,0
-------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating deep dual variables for entropic OT,0
----------------------------------------------,0
define the MLP model,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the density on target for a given source sample,0
----------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Gradient descent,0
----------------,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
"pl.subplot(3, 3, i + 1)",0
ax = pl.axes(projection='3d'),0
"ax.axis(""off"")",0
%%,0
Animate trajectories of generated samples along iteration,0
---------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
compute OT sparsity level,0
Methods using Sinkhorn projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Compute GW with scalable stochastic methods with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
############################################################################,0
,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
-----------------------------------------------------------------------------------------------,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",0
Visualize samples,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the Gromov-Wasserstein dictionary from the dataset,0
-----------------------------------------------------------,0
visualize loss evolution over epochs,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Compute the 2D representation of the unmixing living in the 2-simplex of probability,0
############################################################################,0
,0
Endow the dataset with node features,0
------------------------------------,0
We follow this feature assignment on all nodes of a graph depending on its label/number of clusters,0
1 cluster --> 0 as nodes feature,0
2 clusters --> 1 as nodes feature,0
3 clusters --> 2 as nodes feature,0
features are one-hot encoded following these assignments,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs,0
------------------------------------------------------------------------------------,0
visualize loss evolution,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
-----------------------------------------------,0
scaled_F = 2 * (Fatom - min_features) / (max_features - min_features),0
############################################################################,0
,0
Visualization of the embedding space,0
------------------------------------,0
Visualize unmixings in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
#############################################################################,0
Compute FGW/GW,0
--------------,0
Computing FGW and GW,0
reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
visu OT matrix,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their entropic-regularized semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW_e(C2, h2, C3)",0
"2) srGW_e(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the entropic-regularized semi-relaxed Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the entropic srGW matching.,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW_e(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the entropic semi-relaxed Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%%,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
We create 2 classes of stochastic block models (SBM) graphs with 1 block and 2 blocks respectively.,0
edge probabilities for the SBMs,0
block sizes,0
node features,0
split the data into train and test sets,0
%%,0
#############################################################################,0
Plot data,0
---------,0
plot one graph of each class,0
%%,0
#############################################################################,0
Pooling architecture using the TFGW layer,0
---------,0
#############################################################################,0
Graph classification training,0
---------,0
store latent embeddings and classes for TSNE visualization,0
store last classes and embeddings for TSNE visualization,0
Test,0
%%,0
#############################################################################,0
TSNE visualization of graph classification,0
---------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
Compute pairwise euclidean distance between node features,0
############################################################################,0
,0
Compute their Fused Gromov-Wasserstein distances,0
---------------------------------------------,0
Conditional Gradient algorithm,0
Proximal Point algorithm with Kullback-Leibler as proximal operator,0
Projected Gradient algorithm with entropic regularization,0
compute OT sparsity level,0
Methods using Sinkhorn projections tend to produce feasibility errors on the,0
marginal constraints,0
############################################################################,0
,0
Visualization of the Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the FGW matchings,0
We adjust the intensity of links across domains proportionaly to the mass,0
"sent, adding a minimal intensity of 0.1 if mass sent is not zero.",0
"For each matching, all node sizes are proportionnal to their mass computed",0
from marginals of the OT plan to illustrate potential feasibility errors.,0
NB: colors refer to clusters - not to node features,0
Add weights on the edges for visualization later on,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
--------------------------------------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW(C2, h2, C3)",0
"2) srGW(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Gromov-Wasserstein matchings,0
--------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srGW matching,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
-----------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Fused Gromov-Wasserstein matchings,0
--------------------------------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Authors: Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
%%,0
General Parameters,0
------------------,0
%%,0
Generate Data,0
-------------,0
%%,0
Inspect generated distributions,0
-------------------------------,0
%%,0
Interpolating Empirical Distributions,0
-------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#######################,0
Generate and plot data,0
----------------------,0
Input measures,0
Input measure locations in their respective 2D spaces,0
Input measure weights,0
Projections 3D -> 2D,0
Barycenter weights,0
Number of barycenter points to compute,0
Send the input measures into 3D space for visualization,0
Plot the input data,0
################################,0
Barycenter computation and plot,0
-------------------------------,0
############################,0
Plotting projection matches,0
---------------------------,0
#############################################,0
Rotation animation,0
--------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Authors: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data,0
-------------,0
%%,0
Compute free support Wasserstein barycenter,0
-------------------------------------------,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
%%,0
Compute free support Sinkhorn barycenter,0
%%,0
Plot the Wasserstein barycenter,0
-------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check if the marginals come close to the true ones when large reg,0
check if mm_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test when G0 is given,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
check constraints,0
test weak ot solver for different backends,0
check constraints,0
check constraints,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Antoine Collas <antoine.collas@inria.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
generate gaussian dataset,0
compute first 3 components with BCD,0
test that U contains the principal components,0
compute first 3 components with MM,0
test that U contains the principal components,0
compute last 3 components,0
test that U contains the last principal components,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
chaeck that identity is recovered,0
check G is identity,0
check constraints,0
test weak ot solver for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
check transported mass,0
check constraints,0
check transported mass,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test binary_search_circle and wasserstein_circle give similar results as emd,0
check loss is similar,0
test semidiscrete_wasserstein2_unif_circle versus wasserstein_circle,0
"w_u = rng.uniform(0., 1., n)",0
w_u = w_u / w_u.sum(),0
check loss is similar,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
solve unif weights,0
solve signe weights,0
solve in backend,0
test not implemented and check raise,0
pairs of incompatible divergences,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
"For each column of X, find top max_nz values and",0
their corresponding indices. This incurs a sort.,0
Project the top max_nz values onto the simplex.,0
This incurs a second sort.,0
Put the projection of max_nz_values to their original indices,0
and set all other values zero.,0
check that two versions produce consistent results,0
test timing,0
"np.testing.assert_allclose(0.1, t, rtol=1e-1, atol=1e-1)",0
very slow macos github action equality not possible,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
test print,0
tets get citation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Barycenter initialization,0
"Obvious barycenter locations. Take a look on test_ot.py, test_free_support_barycenter",0
Calculate free support barycenter w/ Sinkhorn algorithm. We set the entropic regularization,0
"term to 1, but this should be, in general, fine-tuned to the problem.",0
Verifies if calculated barycenter matches ground-truth,0
Gaussian distributions,0
creating matrix A containing all distributions,0
assymetric loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
Test sinkhorn divergence,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Ronak Mehta <ronakrm@cs.wisc.edu>,0
Xizheng Yu <xyu354@wisc.edu>,0
,0
License: MIT License,0
Compute loss using dmmot_monge_1dgrid_loss,0
Compute loss using exact OT solver with absolute ground metric,0
deal with C-contiguous error from tensorflow backend (not sure why),0
compute loss,0
test discrete_mmot_converge result,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
classical gradients,0
Test with exact line-search,0
Test with armijo line-search,0
classical gradients,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
test with 'kl_loss' and log=True,0
"providing init_C, init_Y",0
check constraints,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
providing init_C,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
providing init_C,0
check constraints,0
check constraints,0
add features,0
check constraints,0
check constraints,0
Tests with kl-loss:,0
check constraints,0
check constraints,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
add test with 'kl_loss',0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: compare reconstruction error using initial dictionary and dictionary learned using this initialization,0
> Compute initial reconstruction of samples on this random dictionary without backend,0
> Learn the dictionary using this init,0
> Compute reconstruction of samples on learned dictionary without backend,0
Test: Perform same experiments after going through backend,0
Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
knowing than the initialization scheme is the same than implemented to set the benchmarked initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
and testing other optimization settings untested until now.,0
We pass previously estimated dictionaries to speed up the process.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: Compute initial reconstruction of samples on this random dictionary,0
> Learn a dictionary using this given initialization and check that the reconstruction loss,0
on the learned dictionary is lower than the one using its initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Compare both,0
Test: Perform same experiments after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform similar experiment without providing the initial dictionary being an optional input,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
"Test: without using adam optimizer, with log and verbose set to True",0
> Experiment providing previously estimated dictionary to speed up the test compared to providing initial random init.,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
> Compare results with/without backend,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
full gradients with alpha,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
setup,0
test sinkhorn,0
entropic gw and fgw,0
exact and entropic srgw and srfgw loss functions,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for mass mismatch,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd2 and emd2 with openmp for simple identity,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two Diracs,0
obvious barycenter location between two Diracs,0
obvious barycenter location between two 2D Diracs,0
test without log and no init,0
test with log and init,0
obvious barycenter between two Diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test that types mathcing different backends in input raise an error,0
Check that subclassing a numpy array does not break get_backend,0
note: This is only tested for numpy as this is hard to be consistent,0
with other backends,0
Sparse tensors test,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
no log,0
no log + skewness,0
test the other way around (target to source),0
Author: Sonia Mazelet <sonia.mazelet@ens-paris-saclay.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict,0
predict on batch,0
Test the TFGW layer by passing two graphs through the layer and doing backpropagation.,0
predict on batch,0
Test the TW layer by passing two graphs through the layer and doing backpropagation.,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test couplings,0
test marginal distributions,0
test entropic COOT distance,0
test couplings,0
test marginal distributions,0
test COOT distance,0
raise value error of method sinkhorn,0
raise value error for epsilon,0
raise value error for alpha,0
initialize warmstart,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test with coot distance,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
Mapping tests,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
get data,0
squared l2 regularisation,0
check constraints,0
kl regularisation,0
check constraints,0
sparsity-constrained regularisation,0
check marginal constraints,0
check sparsity constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
"html_css_files = [""css/custom.css""]",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
init uniform,0
weak OT loss,0
weak OT gradient,0
solve with conditional gradient and return solution,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
solve the barycenter,0
solve OT with template,0
-*- coding: utf-8 -*-,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
Main function,0
constant input variables,0
measures on rows and columns,0
pre-calculate cost constants,0
initialize coupling and dual vectors,0
initialize log,0
update sample coupling,0
update feature coupling,0
update error,0
COOT part,0
Entropic part,0
sanity check,0
measures on rows and columns,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
in case of multiple historgrams,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
convert to humpy,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
convert back to backend,0
"Next 3 lines equivalent to K=nx.exp(-M/reg), but faster to compute",0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
###############################################################################,0
Losses for stochastic optimization,0
###############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Jakub Zadrozny <jakub.r.zadrozny@gmail.com>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
The callable function operates on nx backend,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
prevent bug from nx.to_numpy that can look for .cpu or .gpu,0
to not change G0 in place.,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
get minimum by rows as binary mask,0
return by default an empty inner_log,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
"Uniforms and independent samples on the Stiefel manifold V_{d,2}",0
Projection on S^1,0
Projection on plane,0
Projection on sphere,0
"Get coordinates on [0,1[",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
I assume that other solvers may return directly,0
some primal objects?,0
"In the code below, let's define the main quantities",0
that may be of interest to users.,0
An OT solver returns an object that inherits from OTResult,0
(e.g. SinkhornOTResult) and implements the relevant,0
"methods (e.g. ""plan"" and ""lazy_plan"" but not ""sparse_plan"", etc.).",0
log is a dictionary containing potential information about the solver,0
Dual potentials --------------------------------------------,0
Transport plan -------------------------------------------,0
N.B.: We may catch out-of-memory errors and suggest,0
the use of lazy_plan or sparse_plan when appropriate.,0
Loss values --------------------------------,0
Marginal constraints -------------------------,0
Barycentric mappings -------------------------,0
Return the displacement vectors as an array,0
"that has the same shape as ""xa""/""xb"" (for samples)",0
"or ""a""/""b"" * D (for images)?",0
# Wasserstein barycenters ----------------------,0
@property,0
def masses(self):,0
"""""""Masses for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
@property,0
def samples(self):,0
"""""""Sample locations for the Wasserstein barycenter.""""""",0
raise NotImplementedError(),0
Miscellaneous --------------------------------,0
The string below refers to the POT library:,0
successor methods may concatenate the relevant references,0
"to the original definitions, solvers and underlying numerical backends.",0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
convert to humpy,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
"default is ``""KL""`` regularization (``reg_type=""KL""``)",0
or for original Sinkhorn paper formulation [2],0
"default is ``""KL""``",0
quadratic unbalanced OT,0
TV = partial OT,0
"default is ``""KL""`` for both",0
quadratic unbalanced OT with KL regularization,0
both quadratic,0
detect backend,0
create uniform weights if not given,0
default values for solutions,0
default values for EMD solver,0
default values for exact unbalanced OT,0
default values for sinkhorn,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check that some arrays given,0
check all same type,0
convert batch of tensors to numpy,0
convert a tensor to numpy,0
convert batch of arrays from numpy,0
convert an array from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
compute loss,0
compute gradient,0
convert to humpy,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
quantiles of F_u evaluated in F_v^\theta,0
Deal with 1,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
Put negative values at the end,0
Compute absciss,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
Compute icdf,0
can probably be improved by computing only relevant values,1
Code inspired from https://gitlab.gwdg.de/shundri/circularOT/-/tree/master/,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
ensure that same mass,0
variable change matrix to reduce the problem to a Wasserstein Barycenter (WB),0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check first marginal of G0,0
Check marginals of G0,0
the new cost can be deduced from the line search quadratic function,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
tens -= tens.min(),0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Tanguy Kerdoncuff <tanguy.kerdoncuff@laposte.net>,0
,0
License: MIT License,0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
simple get_backend as the full one will be handled in gromov_wasserstein,0
Check marginals of G0,0
cg for GW is implemented using numpy on CPU,0
the new cost is deduced from the line search quadratic function,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Cedric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
All submodules and packages,0
-*- coding: utf-8 -*-,0
Author: Rémi Flamary <remi.flamary@unice.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
Handle backend of non-optional arguments,0
Handle backend of optional arguments,0
Initialize randomly structures of dictionary atoms based on samples,0
batch sampling,0
BCD solver for Gromov-Wassersteisn linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
Initialization for our numpy implementation of adam optimizer,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
Initialize randomly structures of dictionary atoms based on samples,0
Initialize randomly features of dictionary atoms based on samples distribution by feature component,0
Batch iterations,0
BCD solver for Gromov-Wassersteisn linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
"modeling (C,Y)",0
constants depending on q,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
structure,0
feature,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
polynomial coefficients from quadratic objective (with respect to w) on structures,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
polynomial coefficient from quadratic objective (with respect to w) on features,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
%%,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
%%,0
Comparison of the OT matrices,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
use fast 1D solver,0
Equivalent to,0
"G0 = ot.emd(a, b, M)",0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: ../_static/images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have acess to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan vizualization,0
`````````````````````````````````,0
,0
A good vizualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: ../_static/images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
"pl.xlim((-7,23))",0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
"pl.xlim((-7,23))",0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
########################################################################################,0
Compare the Euclidean Wasserstein distance with the Wasserstein distance on the  circle,0
---------------------------------------------------------------------------------------,0
This examples illustrates the periodicity of the Wasserstein distance on the circle.,0
We choose as target distribution a von Mises distribution with mean :math:`\mu_{\mathrm{target}}`,0
"and :math:`\kappa=20`. Then, we compare the distances with samples obtained from a von Mises distribution",0
with parameters :math:`\mu_{\mathrm{source}}` and :math:`\kappa=20`.,0
The Wasserstein distance on the circle takes into account the periodicity,0
and attains its maximum in :math:`\mu_{\mathrm{target}}+1` (the antipodal point) contrary to the,0
Euclidean version.,0
%% Compute and plot distributions,0
"np.random.vonmises deals with data on [-pi, pi[",0
"Put data on S^1=[0,1[",0
#######################################################################,0
Wasserstein distance between von Mises and uniform for different kappa,0
----------------------------------------------------------------------,0
"When :math:`\kappa=0`, the von Mises distribution is the uniform distribution on :math:`S^1`.",0
%% Compute Wasserstein between Von Mises and uniform,0
"np.random.vonmises deals with data on [-pi, pi[",0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 6,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generate data,0
-------------,0
The source and clean target matrices are generated by,0
":math:`X_{i,j} = \cos(\frac{i}{n_1} \pi) + \cos(\frac{j}{d_1} \pi)` and",0
":math:`Y_{i,j} = \cos(\frac{i}{n_2} \pi) + \cos(\frac{j}{d_2} \pi)`.",0
The target matrix is then contaminated by adding 5 row outliers.,0
"Intuitively, we expect that the estimated sample distribution should ignore these outliers,",0
i.e. their weights should be zero.,0
Generate clean target data mixed with outliers,0
%%,0
Optimize the COOT distance with respect to the sample marginal distribution,0
---------------------------------------------------------------------------,0
Estimated sample marginal distribution and training loss curve,0
%%,0
Visualizing the row and column alignments with the estimated sample marginal distribution,0
-----------------------------------------------------------------------------------------,0
,0
"Clearly, the learned marginal distribution completely and successfully ignores the 5 outliers.",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%% Load modules,0
%%,0
Data for logo,0
-------------,0
Letter P,0
Letter O,0
Scaling and translation for letter O,0
Letter T,0
Translating the T,0
Concatenate all letters,0
Horizontal and vertical scaling,0
%%,0
Plot the logo (clear background),0
--------------------------------,0
Solve OT problem between the points,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo.png', dpi=150, transparent=True, bbox_inches='tight')",0
%%,0
Plot the logo (dark background),0
--------------------------------,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo_dark.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo_dark.png', dpi=150, transparent=True, bbox_inches='tight')",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
License: MIT License,0
%%,0
Generating two random matrices,0
%%,0
Visualizing the matrices,0
%%,0
"Visualizing the alignments of rows and columns, and calculating the CO-Optimal Transport distance",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data an plot it,0
------------------------,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
#############################################################################,0
Compute Weak OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% Weak OT,0
#############################################################################,0
Plot weak OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data an plot it,0
------------------------,0
parameters and data generation,0
%% plot samples,0
%%,0
Compute Factore OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% factored OT OT,0
%%,0
Plot factored OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
Labels,0
Ticks,0
##############################################################################,0
Spherical Sliced Wasserstein for different seeds and number of projections,0
--------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Spherical Sliced Wasserstein,0
---------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
%%,0
plot the transported mass,0
-------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------,0
,0
The OT plan is ploted as a function of $\gamma$ that is the inverse of the,0
weight on the marginal relaxations.,0
%% fully relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for UOT l2,0
------------------------,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-------------------,0
%% semi-relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for semi-relaxed UOT l2,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
"Compute entropic kl-regularized UOT, kl- and l2-regularized UOT",0
-----------,0
#############################################################################,0
Plot the results,0
----------------,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
---------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
------------------------------------------------,0
The adajacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
--------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating dual variables for entropic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot teh estimated entropic OT plan,0
-----------------------------------,0
%%,0
Estimating dual variables for quadratic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated quadratic OT plan,0
-----------------------------------,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
---------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
---------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
-----------------------------------------,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
-------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
---------------------------------------------------,0
#############################################################################,0
Ploting the reweighted source distribution,0
------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating deep dual variables for entropic OT,0
----------------------------------------------,0
define the MLP model,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the density on arget for a given source sample,0
---------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Clément Bonet <clement.bonet@univ-ubs.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Gradient descent,0
----------------,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
"pl.subplot(3, 3, i + 1)",0
ax = pl.axes(projection='3d'),0
"ax.axis(""off"")",0
%%,0
Animate trajectories of generated samples along iteration,0
-------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
############################################################################,0
,0
Compute GW with a scalable stochastic method with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
############################################################################,0
,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
---------------------------------------------,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",0
Visualize samples,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate the gromov-wasserstein dictionary from the dataset,0
---------------------------------------------,0
visualize loss evolution over epochs,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
---------------------------------------------,0
Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white),0
############################################################################,0
,0
Visualization of the embedding space,0
---------------------------------------------,0
Compute the 2D representation of the unmixing living in the 2-simplex of probability,0
############################################################################,0
,0
Endow the dataset with node features,0
---------------------------------------------,0
We follow this feature assignment on all nodes of a graph depending on its label/number of clusters,0
1 cluster --> 0 as nodes feature,0
2 clusters --> 1 as nodes feature,0
3 clusters --> 2 as nodes feature,0
features are one-hot encoded following these assignments,0
get 2d position for nodes,0
############################################################################,0
,0
Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs,0
---------------------------------------------,0
visualize loss evolution,0
############################################################################,0
,0
Visualization of the estimated dictionary atoms,0
---------------------------------------------,0
scaled_F = 2 * (Fatom - min_features) / (max_features - min_features),0
############################################################################,0
,0
Visualization of the embedding space,0
---------------------------------------------,0
Visualize unmixings in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
--------------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
############################################################################,0
,0
Generate two graphs following Stochastic Block models of 2 and 3 clusters.,0
---------------------------------------------,0
Add weights on the edges for visualization later on,0
############################################################################,0
,0
Compute their semi-relaxed Gromov-Wasserstein divergences,0
---------------------------------------------,0
"0) GW(C2, h2, C3, h3) for reference",0
"1) srGW(C2, h2, C3)",0
"2) srGW(C3, h3, C2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srGW matching,0
We make more visible connections between activated nodes,0
get graphs partition and their coloring,0
T: getting colors assignment from argmin of columns,0
############################################################################,0
,0
Add node features,0
---------------------------------------------,0
We add node features with given mean - by clusters,0
and inversely proportional to clusters' intra-connectivity,0
############################################################################,0
,0
Compute their semi-relaxed Fused Gromov-Wasserstein divergences,0
---------------------------------------------,0
Compute pairwise euclidean distance between node features,0
"0) FGW_alpha(C2, F2, h2, C3, F3, h3) for reference",0
"1) srFGW(C2, F2, h2, C3, F3)",0
"2) srFGW(C3, F3, h3, C2, F2)",0
############################################################################,0
,0
Visualization of the semi-relaxed Fused Gromov-Wasserstein matchings,0
---------------------------------------------,0
,0
We color nodes of the graph on the right - then project its node colors,0
based on the optimal transport plan from the srFGW matching,0
NB: colors refer to clusters - not to node features,0
-*- coding: utf-8 -*-,0
Authors: Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
%%,0
General Parameters,0
------------------,0
%%,0
Generate Data,0
-------------,0
%%,0
Inspect generated distributions,0
-------------------------------,0
%%,0
Interpolating Empirical Distributions,0
-------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
-*- coding: utf-8 -*-,0
Author: Eloi Tanguy <eloi.tanguy@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#######################,0
Generate and plot data,0
----------------------,0
Input measures,0
Input measure locations in their respective 2D spaces,0
Input measure weights,0
Projections 3D -> 2D,0
Barycenter weights,0
Number of barycenter points to compute,0
Send the input measures into 3D space for visualisation,0
Plot the input data,0
################################,0
Barycenter computation and plot,0
-------------------------------,0
############################,0
Plotting projection matches,0
---------------------------,0
#############################################,0
Rotation animation,0
--------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Authors: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data,0
-------------,0
%%,0
Compute free support Wasserstein barycenter,0
-------------------------------,0
%%,0
Plot the Wasserstein barycenter,0
---------,0
%%,0
Compute free support Sinkhorn barycenter,0
%%,0
Plot the Wasserstein barycenter,0
---------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check if the marginals come close to the true ones when large reg,0
check if mm_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test when G0 is given,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
check constraints,0
test weak ot solver for different backends,0
check constraints,0
check constraints,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
chaeck that identity is recovered,0
check G is identity,0
check constraints,0
test weak ot solver for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
check transported mass,0
check constraints,0
check transported mass,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test binary_search_circle and wasserstein_circle give similar results as emd,0
check loss is similar,0
test semidiscrete_wasserstein2_unif_circle versus wasserstein_circle,0
"w_u = rng.uniform(0., 1., n)",0
w_u = w_u / w_u.sum(),0
check loss is similar,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
solve unif weights,0
solve signe weights,0
check some attributes,0
solve in backend,0
test not implemented unbalanced and check raise,0
test not implemented reg_type and check raise,0
solve unif weights,0
solve signe weights,0
solve in backend,0
test not implemented and check raise,0
pairs of incompatible divergences,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
test timing,0
"np.testing.assert_allclose(0.1, t, rtol=1e-1, atol=1e-1)",0
very slow macos github action equality not possible,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
test print,0
tets get citation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
Eduardo Fernandes Montesuma <eduardo.fernandes-montesuma@universite-paris-saclay.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Barycenter initialization,0
"Obvious barycenter locations. Take a look on test_ot.py, test_free_support_barycenter",0
Calculate free support barycenter w/ Sinkhorn algorithm. We set the entropic regularization,0
"term to 1, but this should be, in general, fine-tuned to the problem.",0
Verifies if calculated barycenter matches ground-truth,0
Gaussian distributions,0
creating matrix A containing all distributions,0
assymetric loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
Test sinkhorn divergence,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Generate warmstart from dual vectors of unregularized OT,0
Optimal plan with uniform warmstart,0
Optimal plan with warmstart generated from unregularized OT,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedvincentcuaz@gmail.com>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Test with exact line-search,0
Test with armijo line-search,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
setup,0
check constraints,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
check constraints,0
check constraints,0
add features,0
check constraints,0
check constraints,0
Tests with kl-loss:,0
check constraints,0
check constraints,0
calls with nx=None,0
feed the precomputed local optimum Gb to cg,0
feed the precomputed local optimum Gb to cg,0
check constraints,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: compare reconstruction error using initial dictionary and dictionary learned using this initialization,0
> Compute initial reconstruction of samples on this random dictionary without backend,0
> Learn the dictionary using this init,0
> Compute reconstruction of samples on learned dictionary without backend,0
Test: Perform same experiments after going through backend,0
Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
knowing than the initialization scheme is the same than implemented to set the benchmarked initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
and testing other optimization settings untested until now.,0
We pass previously estimated dictionaries to speed up the process.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: Compute initial reconstruction of samples on this random dictionary,0
> Learn a dictionary using this given initialization and check that the reconstruction loss,0
on the learned dictionary is lower than the one using its initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Compare both,0
Test: Perform same experiments after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform similar experiment without providing the initial dictionary being an optional input,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
"Test: without using adam optimizer, with log and verbose set to True",0
> Experiment providing previously estimated dictionary to speed up the test compared to providing initial random init.,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
> Compare results with/without backend,0
unbalanced proportions,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
create directed sbm with C2 as connectivity matrix,0
asymmetric,0
check constraints,0
check constraints,0
symmetric,0
check constraints,0
check constraints,0
semirelaxed solvers do not support gradients over masses yet.,0
calls with nx=None,0
feed the precomputed local optimum Gb to semirelaxed_cg,0
check constraints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for mass mismatch,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd2 and emd2 with openmp for simple identity,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter location between two 2D diracs,0
test without log and no init,0
test with log and init,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test torch,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
Sparse tensors test,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Theo Gnassounou <theo.gnassounou@inria.fr>,0
Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
Author: Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test couplings,0
test marginal distributions,0
test entropic COOT distance,0
test couplings,0
test marginal distributions,0
test COOT distance,0
raise value error of method sinkhorn,0
raise value error for epsilon,0
raise value error for alpha,0
initialize warmstart,0
test couplings,0
test marginal distributions,0
test COOT distance,0
test with coot distance,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
Mapping tests,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
"html_css_files = [""css/custom.css""]",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
init uniform,0
weak OT loss,0
weak OT gradient,0
solve with conditional gradient and return solution,0
Author: Remi Flamary <remi.flamary@polytehnique.edu>,0
,0
License: MIT License,0
solve the barycenter,0
solve OT with template,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
"Next 3 lines equivalent to K=np.exp(-M/reg), but faster to compute",0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
###############################################################################,0
Losses for stochastic optimization,0
###############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
Jakub Zadrozny <jakub.r.zadrozny@gmail.com>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
Check marginals of G0,0
Check marginals of G0,0
Check marginals of G0,0
Check marginals of G0,0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
Handle backend of non-optional arguments,0
Handle backend of optional arguments,0
Initialize randomly structures of dictionary atoms based on samples,0
batch sampling,0
BCD solver for Gromov-Wassersteisn linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
Initialization for our numpy implementation of adam optimizer,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
Initialize randomly structures of dictionary atoms based on samples,0
Initialize randomly features of dictionary atoms based on samples distribution by feature component,0
Batch iterations,0
BCD solver for Gromov-Wassersteisn linear unmixing used independently on each structure of the sampled batch,0
Stochastic projected gradient step over dictionary atoms,0
"modeling (C,Y)",0
constants depending on q,0
Trackers for BCD convergence,0
"1. Solve GW transport between (C,p) and (\sum_d Cdictionary[d],q) fixing the unmixing w",0
2. Solve linear unmixing problem over w with a fixed transport plan T,0
1) Compute gradient at current point w,0
structure,0
feature,0
2) Conditional gradient direction finding: x= \argmin_x x^T.grad_w,0
"3) Line-search step: solve \argmin_{\gamma \in [0,1]} a*gamma^2 + b*gamma + c",0
4) Updates: w <-- (1-gamma)*w + gamma*x,0
polynomial coefficients from quadratic objective (with respect to w) on structures,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
polynomial coefficient from quadratic objective (with respect to w) on features,0
Constant factor appearing in the factorization a*gamma^2 + b*g + c of the Gromov-Wasserstein reconstruction loss,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check that some arrays given,0
check all same type,0
convert batch of tensors to numpy,0
convert a tensor to numpy,0
convert batch of arrays from numpy,0
convert an array from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
%%,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 5,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
%%,0
Comparison of the OT matrices,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
use fast 1D solver,0
Equivalent to,0
"G0 = ot.emd(a, b, M)",0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: ../_static/images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have acess to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan vizualization,0
`````````````````````````````````,0
,0
A good vizualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: ../_static/images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
"pl.xlim((-7,23))",0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
"pl.xlim((-7,23))",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 6,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
%% Load modules,0
%%,0
Data for logo,0
-------------,0
Letter P,0
Letter O,0
Scaling and translation for letter O,0
Letter T,0
Translating the T,0
Concatenate all letters,0
Horizontal and vertical scaling,0
%%,0
Plot the logo (clear background),0
--------------------------------,0
Solve OT problem between the points,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo.png', dpi=150, transparent=True, bbox_inches='tight')",0
%%,0
Plot the logo (dark background),0
--------------------------------,0
plot the OT plan,0
plot the samples,0
Save logo file,0
"pl.savefig('logo_dark.svg', dpi=150, transparent=True, bbox_inches='tight')",0
"pl.savefig('logo_dark.png', dpi=150, transparent=True, bbox_inches='tight')",0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data an plot it,0
------------------------,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
#############################################################################,0
Compute Weak OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% Weak OT,0
#############################################################################,0
Plot weak OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data an plot it,0
------------------------,0
parameters and data generation,0
%% plot samples,0
%%,0
Compute Factore OT and exact OT solutions,0
--------------------------------------,0
%% EMD,0
%% factored OT OT,0
%%,0
Plot factored OT and exact OT solutions,0
--------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
%%,0
plot the transported mass,0
-------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------,0
,0
The OT plan is ploted as a function of $\gamma$ that is the inverse of the,0
weight on the marginal relaxations.,0
%% fully relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for UOT l2,0
------------------------,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-------------------,0
%% semi-relaxed l2-penalized UOT,0
%%,0
Animation of the regpath for semi-relaxed UOT l2,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
"Compute entropic kl-regularized UOT, kl- and l2-regularized UOT",0
-----------,0
#############################################################################,0
Plot the results,0
----------------,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
---------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
------------------------------------------------,0
The adajacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
--------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating dual variables for entropic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot teh estimated entropic OT plan,0
-----------------------------------,0
%%,0
Estimating dual variables for quadratic OT,0
-----------------------------------------,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the estimated quadratic OT plan,0
-----------------------------------,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
---------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
-------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
-------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
---------------------------------------------------,0
#############################################################################,0
Ploting the reweighted source distribution,0
------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
one of the target mode changes its variance (no linear mapping),0
%%,0
Plot data,0
---------,0
%%,0
Convert data to torch tensors,0
-----------------------------,0
%%,0
Estimating deep dual variables for entropic OT,0
----------------------------------------------,0
define the MLP model,0
number of iteration,0
generate noise samples,0
minus because we maximize te dual loss,0
%%,0
Plot the density on arget for a given source sample,0
---------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
############################################################################,0
,0
Compute GW with a scalable stochastic method with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
%%,0
=============================================================================,0
"Generate a dataset composed of graphs following Stochastic Block models of 1, 2 and 3 clusters.",0
=============================================================================,0
"For every number of clusters, we generate SBM with fixed inter/intra-clusters probability.",0
Visualize samples,0
get 2d position for nodes,0
%%,0
=============================================================================,0
Estimate the gromov-wasserstein dictionary from the dataset,0
=============================================================================,0
visualize loss evolution over epochs,0
%%,0
=============================================================================,0
Visualization of the estimated dictionary atoms,0
=============================================================================,0
Continuous connections between nodes of the atoms are colored in shades of grey (1: dark / 2: white),0
%%,0
=============================================================================,0
Visualization of the embedding space,0
=============================================================================,0
Compute the 2D representation of the unmixing living in the 2-simplex of probability,0
%%,0
=============================================================================,0
Endow the dataset with node features,0
=============================================================================,0
We follow this feature assignment on all nodes of a graph depending on its label/number of clusters,0
1 cluster --> 0 as nodes feature,0
2 clusters --> 1 as nodes feature,0
3 clusters --> 2 as nodes feature,0
features are one-hot encoded following these assignments,0
get 2d position for nodes,0
%%,0
=============================================================================,0
Estimate a Fused Gromov-Wasserstein dictionary from the dataset of attributed graphs,0
=============================================================================,0
visualize loss evolution,0
%%,0
=============================================================================,0
Visualization of the estimated dictionary atoms,0
=============================================================================,0
scaled_F = 2 * (Fatom - min_features) / (max_features - min_features),0
%%,0
=============================================================================,0
Visualization of the embedding space,0
=============================================================================,0
Visualize unmixings in the 2-simplex of probability,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
--------------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Authors: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
%%,0
Generate data,0
-------------,0
%%,0
Compute free support barycenter,0
-------------------------------,0
%%,0
Plot the barycenter,0
---------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Authors: Kilian Fatras <kilian.fatras@gmail.com>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
Laetitia Chapel <laetitia.chapel@univ-ubs.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check if the marginals come close to the true ones when large reg,0
check if mm_unbalanced2 returns the correct loss,0
check in case no histogram is provided,0
test when G0 is given,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
check constraints,0
test weak ot solver for different backends,0
check constraints,0
check constraints,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test weak ot solver and identity stationary point,0
check constraints,0
chaeck that identity is recovered,0
check G is identity,0
check constraints,0
test weak ot solver for different backends,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
test timing,0
"np.testing.assert_allclose(0.1, t, rtol=1e-1, atol=1e-1)",0
very slow macos github action equality not possible,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Cédric Vincent-Cuaz <cedric.vincent-cuaz@inria.fr>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
check constraints,0
check constraints,0
setup,0
check constraints,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
check constraints,0
check constraints,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: compare reconstruction error using initial dictionary and dictionary learned using this initialization,0
> Compute initial reconstruction of samples on this random dictionary without backend,0
> Learn the dictionary using this init,0
> Compute reconstruction of samples on learned dictionary without backend,0
Test: Perform same experiments after going through backend,0
Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
knowing than the initialization scheme is the same than implemented to set the benchmarked initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform same comparison without providing the initial dictionary being an optional input,0
and testing other optimization settings untested until now.,0
We pass previously estimated dictionaries to speed up the process.,0
> Compute reconstruction of samples on learned dictionary,0
Test: Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Tests without regularization,0
Tests with regularization,0
create dataset composed from 2 structures which are repeated 5 times,0
"Provide initialization for the graph dictionary of shape (n_atoms, shape, shape)",0
following the same procedure than implemented in gromov_wasserstein_dictionary_learning.,0
Test: Compute initial reconstruction of samples on this random dictionary,0
> Learn a dictionary using this given initialization and check that the reconstruction loss,0
on the learned dictionary is lower than the one using its initialization.,0
> Compute reconstruction of samples on learned dictionary,0
Compare both,0
Test: Perform same experiments after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
Test: Perform similar experiment without providing the initial dictionary being an optional input,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
"Test: without using adam optimizer, with log and verbose set to True",0
> Experiment providing previously estimated dictionary to speed up the test compared to providing initial random init.,0
> Compute reconstruction of samples on learned dictionary,0
> Same after going through backend,0
> Compute reconstruction of samples on learned dictionary,0
> Compare results with/without backend,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test torch,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
Sparse tensors test,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
Mapping tests,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
"Next 3 lines equivalent to K=np.exp(-M/reg), but faster to compute",0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check that some arrays given,0
check all same type,0
convert to numpy,0
convert from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"tmp2=np.einsum('i,ij,j->j', u, K, v)",0
"res = np.einsum('ik,ij,jk,ij->k', u, K, v, M) (explodes cupy memory)",0
define sinkhorn as sinkhorn_knopp,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have acess to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan vizualization,0
`````````````````````````````````,0
,0
A good vizualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 6,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------,0
%% fully relaxed l2-penalized UOT,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-------------------,0
%% semi-relaxed l2-penalized UOT,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
---------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
------------------------------------------------,0
The adajacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
--------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
---------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
-------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
-------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
---------------------------------------------------,0
#############################################################################,0
Ploting the reweighted source distribution,0
------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
############################################################################,0
,0
Compute GW with a scalable stochastic method with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
--------------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Compute free support barycenter,0
-------------------------------,0
#############################################################################,0
Plot data,0
---------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
check raise not implemented wrong metric,0
run all on gpu,0
run sinkhorn for multiple targets,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
np sinkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
check constraints,0
check constraints,0
setup,0
check constraints,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
check constraints,0
check constraints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test torch,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
Sparse tensors test,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
"Next 3 lines equivalent to K=np.exp(-M/reg), but faster to compute",0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
perftable {,0
perftable table{,0
"perftable th, #perftable td {",0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check that some arrays given,0
check all same type,0
convert to numpy,0
convert from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
"available_devices = jax.devices(""cpu"")",0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
No gradients for cupy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
Taken from,0
https://github.com/scipy/scipy/blob/v1.7.1/scipy/special/_logsumexp.py#L7-L127,0
cupy has implicit type conversion so,0
we automatically validate the test for type,0
inner product,0
matrix vector,0
if type_as is not None:,0
"sparse_tensor = self.from_numpy(sparse_tensor, type_as=type_as)",0
SparseTensor are not subscriptable so we use dense tensors,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"tmp2=np.einsum('i,ij,j->j', u, K, v)",0
"res = np.einsum('ik,ij,jk,ij->k', u, K, v, M) (explodes cupy memory)",0
define sinkhorn as sinkhorn_knopp,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have acess to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan vizualization,0
`````````````````````````````````,0
,0
A good vizualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 6,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------,0
%% fully relaxed l2-penalized UOT,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-------------------,0
%% semi-relaxed l2-penalized UOT,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
---------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
------------------------------------------------,0
The adajacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
--------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we  optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
---------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
-------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
-------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
---------------------------------------------------,0
#############################################################################,0
Ploting the reweighted source distribution,0
------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
############################################################################,0
,0
Compute GW with a scalable stochastic method with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
--------------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Compute free support barycenter,0
-------------------------------,0
#############################################################################,0
Plot data,0
---------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
check raise not implemented wrong metric,0
run all on gpu,0
run sinkhorn for multiple targets,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
tests that every metric runs correctly,0
weighted minkowski but with no weights,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
np sinkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
setup,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
check constraints,0
check constraints,0
setup,0
check constraints,0
check constraints,0
test of gromov_barycenters with `log` on,0
test of gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
test of entropic_gromov_barycenters with `log` on,0
check constraints,0
check constraints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
"Testing for bug #309, checking for scaling of gradient",0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test torch,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
test not unique types in input,0
Sparse tensors test,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return 0. for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Check that everything stays on the CPU,0
Check that everything happens on the GPU,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
source_suffix = '.rst',0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Tensorflow should be the last one to be benchmarked because,0
"as far as I'm aware, there is no way to force it to release",0
"GPU memory. Hence, if any other backend is benchmarked after",0
"Tensorflow and requires the usage of a GPU, it will not have the",0
full memory available and you may have a GPU Out Of Memory error,0
even though your GPU can technically hold your tensors in memory.,0
make bitsize header,0
make device header,0
make param_name / backend header,0
make results rows,0
/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks PyPI for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati100@gmail.com>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
log and verbose print,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
debiased Sinkhorn does not converge monotonically,0
guarantee a few iterations are done before stopping,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
"Next 3 lines equivalent to K=np.exp(-M/reg), but faster to compute",0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
"pre-compute reg_c,c'",0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
initialization,0
Return the second order matrix of the displacements: sum_ij { (pi)_ij (X_i-Y_j)(X_i-Y_j)^T }.,0
Projected cost matrix,0
Sinkhorn update,0
Riemannian gradient descent,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
scalar_search_armijo can return alpha > 1,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty   <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sort u in ascending order,0
take the descending order,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
It is always better to sample from the biggest distribution first.,0
"If T is sparse, it probably mean that PoGroW was used, thus the number of sample is reduced",0
The number of sample along the first dimension is without replacement.,0
"For each of the row sampled, the column is sampled.",0
Initialize with default marginal,0
"To limit the number of non 0, the values below the threshold are set to 0.",0
The most natural way to define nb_sample is with a simple integer.,0
"As the sampling along the first dimension is done without replacement, the rest is reported to the second",0
dimension.,0
continue_loop allows to stop the loop if there is several successive small modification of T.,0
The gradient of GW is more complex if the two matrices are not symmetric.,0
"If the matrices C are not symmetric, the gradient has 2 terms, thus the term is chosen randomly.",0
This division by the max is here to facilitate the choice of epsilon.,0
Set to infinity all the numbers below exp(-200) to avoid log of 0.,0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check that some arrays given,0
check all same type,0
convert to numpy,0
convert from numpy,0
No gradients for numpy,0
this is a not very efficient way to make numpy,1
searchsorted work on 2d arrays,0
numpy has implicit type conversion so we automatically validate the test,0
this is a not very efficient way to make jax numpy,1
searchsorted work on 2d arrays,0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"Currently, JAX does not support sparse matrices",0
"No need to copy, JAX arrays are immutable",0
define a function that takes inputs val and grads,0
ad returns a val tensor with proper gradients,0
the gradients are grad,0
pad_width is an array of ndim tuples indicating how many 0 before and after,0
"we need to add. We first need to make it compliant with torch syntax, that",0
"starts with the last dim, then second last, etc.",0
Versions older than 1.9 do not support CSR tensors. PyTorch 1.9 and 1.10 offer a very limited support,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
t = phi - gamma * delta,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
initialization,0
compute the intercept and slope of solutions in current iteration,0
compute the next lambda when removing a point from the active set,0
"if the positivity constraint is violated, we remove id_pop",0
"from active set, otherwise we add ik to active set",0
compute the solution of current segment,0
correct the last solution and gamma,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"tmp2=np.einsum('i,ij,j->j', u, K, v)",0
"res = np.einsum('ik,ij,jk,ij->k', u, K, v, M) (explodes cupy memory)",0
define sinkhorn as sinkhorn_knopp,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
"This code is adapted for a large part from the astropy openmp helpers, which",0
can be found at: https://github.com/astropy/extension-helpers/blob/master/extension_helpers/_openmp_helpers.py  # noqa,0
Default flag for GCC and clang:,0
include <omp.h>,0
include <stdio.h>,0
pragma omp parallel,0
Since we can't run the test program when cross-compiling,0
assume that openmp is supported if the program can be,0
compiled.,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
extra_(pre/post)args can be a callable to make it possible to get its,0
value from the compiler,0
Write test program,0
"Compile, test program",0
Link test program,0
Run test program if not cross compiling,0
will raise a CalledProcessError if return code was non-zero,0
Return an empty output if we are cross compiling,0
as we cannot run the test_program,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
this is to ensure the best performance for torch searchsorted,0
and avoid a warninng related to non-contiguous arrays,0
if empty array given then use uniform distributions,0
ensure that same mass,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
convert to numpy if list,0
convert to numpy,0
ensure float64,0
if empty array given then use uniform distributions,0
ensure that same mass,0
convert to numpy,0
if empty array given then use uniform distributions,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C are stored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
coding: utf-8,0
"Author: Remi Flamary, Nicolas Courty, Aurelie Boisbunon",0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
#############################################################################,0
POT Python Optimal Transport Toolbox,0
------------------------------------,0
,0
POT installation,0
```````````````````,0
,0
* Install with pip::,0
,0
pip install pot,0
* Install with conda::,0
,0
conda install -c conda-forge pot,0
,0
Import the toolbox,0
```````````````````,0
,0
#############################################################################,0
Getting help,0
`````````````,0
,0
Online  documentation : `<https://pythonot.github.io/all.html>`_,0
,0
Or inline help:,0
,0
#############################################################################,0
First OT Problem,0
----------------,0
,0
We will solve the Bakery/Cafés problem of transporting croissants from a,0
number of Bakeries to Cafés in a City (in this case Manhattan). We did a,0
quick google map search in Manhattan for bakeries and Cafés:,0
,0
.. image:: images/bak.png,0
:align: center,0
:alt: bakery-cafe-manhattan,0
:width: 600px,0
:height: 280px,0
,0
We extracted from this search their positions and generated fictional,0
production and sale number (that both sum to the same value).,0
,0
We have acess to the position of Bakeries ``bakery_pos`` and their,0
respective production ``bakery_prod`` which describe the source,0
distribution. The Cafés where the croissants are sold are defined also by,0
"their position ``cafe_pos`` and ``cafe_prod``, and describe the target",0
distribution. For fun we also provide a,0
map ``Imap`` that will illustrate the position of these shops in the city.,0
,0
,0
Now we load the data,0
,0
,0
#############################################################################,0
Plotting bakeries in the city,0
-----------------------------,0
,0
Next we plot the position of the bakeries and cafés on the map. The size of,0
the circle is proportional to their production.,0
,0
#############################################################################,0
Cost matrix,0
-----------,0
,0
,0
"We can now compute the cost matrix between the bakeries and the cafés, which",0
will be the transport cost matrix. This can be done using the,0
`ot.dist <https://pythonot.github.io/all.html#ot.dist>`_ function that,0
defaults to squared Euclidean distance but can return other things such as,0
cityblock (or Manhattan distance).,0
,0
#############################################################################,0
The red cells in the matrix image show the bakeries and cafés that are,0
"further away, and thus more costly to transport from one to the other, while",0
"the blue ones show those that are very close to each other, with respect to",0
the squared Euclidean distance.,0
#############################################################################,0
Solving the OT problem with `ot.emd <https://pythonot.github.io/all.html#ot.emd>`_,0
-----------------------------------------------------------------------------------,0
#############################################################################,0
"The function returns the transport matrix, which we can then visualize (next section).",0
#############################################################################,0
Transportation plan vizualization,0
`````````````````````````````````,0
,0
A good vizualization of the OT matrix in the 2D plane is to denote the,0
transportation of mass between a Bakery and a Café by a line. This can easily,0
be done with a double ``for`` loop.,0
,0
In order to make it more interpretable one can also use the ``alpha``,0
"parameter of plot and set it to ``alpha=G[i,j]/G.max()``.",0
Plot the matrix and the map,0
#############################################################################,0
The transport matrix gives the number of croissants that can be transported,0
from each bakery to each café. We can see that the bakeries only need to,0
"transport croissants to one or two cafés, the transport matrix being very",0
sparse.,0
#############################################################################,0
OT loss and dual variables,0
--------------------------,0
,0
The resulting wasserstein loss loss is of the form:,0
,0
.. math::,0
"W=\sum_{i,j}\gamma_{i,j}C_{i,j}",0
,0
where :math:`\gamma` is the optimal transport matrix.,0
,0
#############################################################################,0
Regularized OT with Sinkhorn,0
----------------------------,0
,0
The Sinkhorn algorithm is very simple to code. You can implement it directly,0
using the following pseudo-code,0
,0
.. image:: images/sinkhorn.png,0
:align: center,0
:alt: Sinkhorn algorithm,0
:width: 440px,0
:height: 240px,0
,0
"In this algorithm, :math:`\oslash` corresponds to the element-wise division.",0
,0
An alternative is to use the POT toolbox with,0
`ot.sinkhorn <https://pythonot.github.io/all.html#ot.sinkhorn>`_,0
,0
Be careful of numerical problems. A good pre-processing for Sinkhorn is to,0
divide the cost matrix ``C`` by its maximum value.,0
#############################################################################,0
Algorithm,0
`````````,0
Compute Sinkhorn transport matrix from algorithm,0
Compute Sinkhorn transport matrix with POT,0
Difference between the 2,0
#############################################################################,0
Plot the matrix and the map,0
```````````````````````````,0
#############################################################################,0
"We notice right away that the matrix is not sparse at all with Sinkhorn,",0
"each bakery delivering croissants to all 5 cafés with that solution. Also,",0
"this solution gives a transport with fractions, which does not make sense",0
in the case of croissants. This was not the case with EMD.,0
#############################################################################,0
Varying the regularization parameter in Sinkhorn,0
````````````````````````````````````````````````,0
,0
"Compute the Wasserstein loss for Sinkhorn, and compare with EMD",0
#############################################################################,0
This series of graph shows that the solution of Sinkhorn starts with something,0
very similar to EMD (although not sparse) for very small values of the,0
"regularization parameter, and tends to a more uniform solution as the",0
regularization parameter increases.,0
,0
#############################################################################,0
Wasserstein loss and computational time,0
```````````````````````````````````````,0
,0
Plot the matrix and the map,0
#############################################################################,0
"In this last graph, we show the impact of the regularization parameter on",0
the Wasserstein loss. We can see that higher,0
values of ``reg`` leads to a much higher Wasserstein loss.,0
,0
The Wasserstein loss of EMD is displayed for,0
comparison. The Wasserstein loss of Sinkhorn can be a little lower than that,0
"of EMD for low values of ``reg``, but it quickly gets much higher.",0
,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
-------------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 6,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
---------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
##############################################################################,0
Sliced Wasserstein distance for different seeds and number of projections,0
-------------------------------------------------------------------------,0
%% Compute statistics,0
##############################################################################,0
Plot Sliced Wasserstein Distance,0
--------------------------------,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
-------------------------,0
Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot 2 distribution samples,0
#############################################################################,0
Compute semi-relaxed and fully relaxed regularization paths,0
-----------,0
%%,0
#############################################################################,0
Plot the regularization path,0
----------------,0
%% fully relaxed l2-penalized UOT,0
#############################################################################,0
Plot the semi-relaxed regularization path,0
-------------------,0
%% semi-relaxed l2-penalized UOT,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Graph generation,0
---------------,0
get 2d position for nodes,0
%%,0
Optimizing GW w.r.t. the weights on a template structure,0
------------------------------------------------,0
The adajacency matrix C1 is block diagonal with 3 blocks. We want to,0
optimize the weights of a simple template C0=eye(3) and see if we can,0
recover the proportion of classes from the SBM (up to a permutation).,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
%%,0
It is clear that the optimization has converged and that we recover the,0
ratio of the different classes in the SBM graph up to a permutation.,0
%%,0
Community clustering with uniform and estimated weights,0
--------------------------------------------,0
The GW OT  plan can be used to perform a clustering of the nodes of a graph,0
when computing the GW with a simple template like C0 by labeling nodes in,0
the original graph using by the index of the noe in the template receiving,0
the most mass.,0
,0
We show here the result of such a clustering when using uniform weights on,0
the template C0 and when using the optimal weights previously estimated.,0
%%,0
Graph compression with GW,0
-------------------------,0
Now we  optimize both the weights and structure of a small graph that,0
minimize the GW distance wrt our data graph. This can be seen as graph,0
compression but can also recover important properties of an SBM such,0
as its class proportion but also its matrix of probability of links between,0
classes,0
use pyTorch for our data,0
"print(""{:03d} | {}"".format(i, loss_iter[-1]))",0
performs a step of projected gradient descent,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
enforce sum to one on the support,0
use pyTorch for our data,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
plot one curve every 10 iterations,0
%%,0
Wasserstein barycenter,0
---------,0
"In this example, we consider the following Wasserstein barycenter problem",0
"$$ \\eta^* = \\min_\\eta\;\;\; (1-t)W(\\mu,\\eta) + tW(\\eta,\\nu)$$",0
"where :math:`\\mu` and :math:`\\nu` are reference 1D measures, and :math:`t`",0
"is a parameter :math:`\in [0,1]`. The problem is handled by a project gradient",0
"descent method, where the gradient is computed by pyTorch automatic differentiation.",0
The projection on the simplex ensures that the iterate will remain on the,0
probability simplex.,0
,0
This example illustrates both `wasserstein_1d` function and backend use within the,0
POT framework.,0
use pyTorch for our data,0
instant of the interpolation,0
Compute the Wasserstein 1D with torch backend,0
record the corresponding loss value,0
performs a step of projected gradient descent,0
Author: Rémi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
%%,0
Loading the data,0
%%,0
Sliced Wasserstein gradient flow with Pytorch,0
---------------------------------------------,0
use pyTorch for our data,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the gradient flow along iteration,0
-------------------------------------------------------,0
%%,0
Compute the Sliced Wasserstein Barycenter,0
,0
generator for random permutations,0
performs a step of projected gradient descent,0
%%,0
Animate trajectories of the barycenter along gradient descent,0
-------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
%%,0
Data generation,0
---------------,0
%%,0
Plot data,0
---------,0
plot the distributions,0
%%,0
Generator Model,0
---------------,0
define the MLP model,0
%%,0
Training the model,0
------------------,0
number of iteration and size of the batches,0
generate statis samples to see their trajectory along training,0
generate noise samples,0
generate data samples,0
generate sample along iterations,0
generate smaples and compte distance matrix,0
%%,0
Plot trajectories of generated samples along iterations,0
-------------------------------------------------------,0
%%,0
Animate trajectories of generated samples along iteration,0
-------------------------------------------------------,0
%%,0
Generate and visualize data,0
---------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% Data,0
Sample reweighting matrix H,0
each columns sums to 1 and has weights only for samples form the,0
corresponding source distribution,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Optimization of the model wrt the Wasserstein distance,0
------------------------------------------------------,0
%% Weights optimization with gradient descent,0
convert numpy arrays to torch tensors,0
weights for the source distributions,0
uniform weights for target,0
loss for the minimal Wasserstein estimator,0
#############################################################################,0
Estimated weights and convergence of the objective,0
---------------------------------------------------,0
#############################################################################,0
Ploting the reweighted source distribution,0
------------------------------------------,0
compute source weights,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
############################################################################,0
,0
Compute GW with a scalable stochastic method with any loss function,0
----------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
------------------------------------------------------------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
-------------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
--------------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
----------------------------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 1,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati100@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Debiased barycenter of 1D Gaussians,0
------------------------------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% barycenter computation,0
#############################################################################,0
Debiased barycenter of 2D images,0
---------------------------------,0
#############################################################################,0
Display the input images,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Compute free support barycenter,0
-------------------------------,0
#############################################################################,0
Plot data,0
---------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
check raise not implemented wrong metric,0
run all on gpu,0
run sinkhorn for multiple targets,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constraints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constraints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constraints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constraints,0
Test gaussian,0
check constraints,0
-*- coding: utf-8 -*-,0
Configuration file for pytest,0
License: MIT License,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Haoran Wu <haoran.wu@univ-ubs.fr>,0
,0
License: MIT License,0
source and target distributions,0
loss matrix,0
source and target distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Minhui Huang <mhhuang@ucdavis.edu>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
generate gaussian dataset,0
First measure : uniform on the hypercube,0
Second measure : fragmentation,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check transported mass,0
check constraints,0
check constraints,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test 1 : wasserstein_1d should be close to scipy W_1 implementation,0
test 2 : wasserstein_1d should be close to one when only translating the support,0
test 3 : arrays test,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test on matrix when projection is done on axis 0,0
all projections should sum to 1,0
all projections should sum to 3,0
tets on vector,0
all projections should sum to 1,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
low atol because jax forces float32,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Quang Huy Tran <quang-huy.tran@univ-ubs.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
test sinkhorn,0
test sinkhorn,0
warn set to False to avoid catching a convergence warning instead,0
test sinkhorn,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constraints,0
test sinkhorn,0
check constraints,0
Test sinkhorn divergence,0
check constraints,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
np sinkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
,0
License: MIT License,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
check constraints,0
check constraints,0
setup,0
check constraints,0
check constraints,0
setup,0
check constraints,0
check constraints,0
check constraints,0
check constraints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
assert len(w) == 1,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@polytechnique.edu>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
error if no parameters,0
error if unknown types,0
test torch,0
test not unique types in input,0
test not unique types in input,0
Sparse tensors test,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Should not throw an exception and return None for alpha,0
check line search armijo,0
chech the case where the optimum is on the direction,0
check the case where the direction is not far enough,0
check the case where checking the wrong direction,0
check the case where the point is not a vector,0
Author: Adrien Corenflos <adrien.corenflos@aalto.fi>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
check that it does not crash when derphi is very close to 0,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
get data,0
check constraints,0
kl regularisation,0
check constraints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks Pipy for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati@inria.fr>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
"print('b',np.max(abs(aviol -viol)),np.max(abs(aviol_2 - viol_2)))",0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
"Next 3 lines equivalent to K=np.exp(-M/reg), but faster to compute",0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Ensure that distances between vectors and themselves are set to 0.0.,0
This may not be the case due to floating point rounding errors.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
XXX use random state,1
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
XXX : should use a random state and not use the global seed,1
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"tmp2=np.einsum('i,ij,j->j', u, K, v)",0
"res = np.einsum('ik,ij,jk,ij->k', u, K, v, M) (explodes cupy memory)",0
define sinkhorn as sinkhorn_knopp,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
Copyright 2001-2013 Python Software Foundation; All Rights Reserved,0
Once '__signature__' will be added to 'C'-level,0
"callables, this check won't be necessary",0
Unbound method: the first parameter becomes positional-only,0
In this case we skip the first parameter of the underlying,0
function (usually `self` or `cls`).,0
Was this function wrapped by a decorator?,0
"We set a new default value, because the following code",0
is correct:,0
,0
>>> def foo(a): print(a),0
">>> print(partial(partial(foo, a=10), a=20)())",0
20,0
">>> print(partial(partial(foo, a=10), a=20)(a=30))",0
30,0
,0
"So, with 'partial' objects, passing a keyword argument is",0
like setting a new default value for the corresponding,0
parameter,0
,0
We also mark this parameter with '_partial_kwarg',0
"flag.  Later, in '_bind', the 'default' value of this",0
"parameter will be added to 'kwargs', to simulate",0
the 'functools.partial' real call.,0
obj is a class or a metaclass,0
"First, let's see if it has an overloaded __call__ defined",0
in its metaclass,0
Now we check if the 'obj' class has a '__new__' method,0
"Finally, we should have at least __init__ implemented",0
An object with __call__,0
We also check that the 'obj' is not an instance of,0
_WrapperDescriptor or _MethodWrapper to avoid,0
infinite recursion (and even potential segfault),0
For classes and objects we skip the first parameter of their,0
"__call__, __new__, or __init__ methods",0
Raise a nicer error message for builtins,0
Add annotation and default value,0
Keyword arguments mapped by 'functools.partial',0
(Parameter._partial_kwarg is True) are mapped,0
"in 'BoundArguments.kwargs', along with VAR_KEYWORD &",0
KEYWORD_ONLY,0
We're done here. Other arguments,0
will be mapped in 'BoundArguments.kwargs',0
*args,0
plain argument,0
**kwargs,0
plain keyword argument,0
Parameter information.,0
Non-keyword-only parameters w/o defaults.,0
... w/ defaults.,0
*args,0
Keyword-only parameters.,0
**kwargs,0
Support for binding arguments to 'functools.partial' objects.,0
See 'functools.partial' case in 'signature()' implementation,0
for details.,0
Simulating 'functools.partial' behavior,0
Let's iterate through the positional arguments and corresponding,0
parameters,0
No more positional arguments,0
No more parameters. That's it. Just need to check that,0
we have no `kwargs` after this while loop,0
"That's OK, just empty *args.  Let's start parsing",0
kwargs,0
That's fine too - we have a default value for this,0
"parameter.  So, lets start parsing `kwargs`, starting",0
with the current parameter,0
We have a positional argument to process,0
Looks like we have no parameter for this positional,0
argument,0
"We have an '*args'-like argument, let's fill it with",0
all positional arguments we have left and move on to,0
the next phase,0
"Now, we iterate through the remaining parameters to process",0
keyword arguments,0
This should never happen in case of a properly built,0
Signature object (but let's have this check here,0
to ensure correct behaviour just in case),0
Memorize that we have a '**kwargs'-like parameter,0
"We have no value for this parameter.  It's fine though,",0
"if it has a default value, or it is an '*args'-like",0
"parameter, left alone by the processing of positional",0
arguments.,0
Process our '**kwargs'-like parameter,0
"OK, we have an '*args'-like parameter, so we won't need",0
a '*' to separate keyword-only arguments,0
We have a keyword-only parameter to render and we haven't,0
"rendered an '*args'-like parameter before, so add a '*'",0
"separator to the parameters list (""foo(arg1, *, arg2)"" case)",0
"This condition should be only triggered once, so",0
reset the flag,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
if empty array given then use uniform distributions,0
problem with pikling Forks,0
if empty array given then use uniform distributions,0
if empty array given then use uniform distributions,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 6,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
--------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
Compute the Transportation Matrix for the Semi-Dual Problem,0
-----------------------------------------------------------,0
,0
Discrete case,0
`````````````,0
,0
Sample two discrete measures for the discrete case and compute their cost,0
matrix c.,0
############################################################################,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
############################################################################,0
Semi-Continuous Case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
"case, the points where source and target measures are defined and compute the",0
cost matrix.,0
############################################################################,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case.,0
############################################################################,0
Compare the results with the Sinkhorn algorithm,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SAG,0
#############################################################################,0
For ASGD,0
#############################################################################,0
For Sinkhorn,0
############################################################################,0
Compute the Transportation Matrix for the Dual Problem,0
------------------------------------------------------,0
,0
Semi-continuous case,0
````````````````````,0
,0
"Sample one general measure a, one discrete measures b for the semi-continuous",0
case and compute the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semi-continuous case,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
```````````````````````````````````````````````,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot Transportation Matrices,0
````````````````````````````,0
,0
For SGD,0
#############################################################################,0
For Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
#############################################################################,0
Generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
--------------,0
Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 2,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 3,0
#############################################################################,0
Generate data,0
---------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
---------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
---------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
---------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
---------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Compute free support barycenter,0
-------------------------------,0
#############################################################################,0
Plot data,0
---------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
sphinx_gallery_thumbnail_number = 4,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
check raise not implemented wrong metric,0
run all on gpu,0
run sinkhorn for multiple targets,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constratints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constratints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constratints,0
Test gaussian,0
check constratints,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
check transported mass,0
check constratints,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constratints,0
test sinkhorn,0
check constratints,0
check constratints,0
check constratints,0
test empty weights greenkhorn,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constratints,0
Test sinkhorn divergence,0
check constratints,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test emd1d gives similar results as emd,0
check loss is similar,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks Pipy for handling markdown now,0
clean cython output is clean is called,0
add platform dependant optional compilation argument,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated samples,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping for each source domain,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the sources domains,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
check the necessary inputs parameters are here,0
perform label propagation,0
set nans to 0,0
compute propagated labels,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati@inria.fr>,0
Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
Alexander Tong <alexander.tong@yale.edu>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
"print('b',np.max(abs(aviol -viol)),np.max(abs(aviol_2 - viol_2)))",0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
build the convolution operator,0
this is equivalent to blurring on horizontal then vertical directions,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
log dictionary,0
"For each source domain, build cost matrices M, Gibbs kernels K and corresponding matrices D_1 and D_2",0
format classes to start from 0 for convenience,0
build the corresponding D_1 and D_2 matrices,0
build the cost matrix and the Gibbs kernel,0
uniform target distribution,0
update coupling matrices for marginal constraints w.r.t. uniform target distribution,0
"update coupling matrices for marginal constraints w.r.t. unknown proportions based on [Prop 4., 27]",0
check if bottleneck module exists,0
"by default, we keep only 50% of the sample data points",0
calculate the Gibbs kernel,0
----------------------------------------------------------------------------------------------------------------#,0
Step 1: Screening pre-processing                                       #,0
----------------------------------------------------------------------------------------------------------------#,0
"full number of budget points (ns, nt) = (ns_budget, nt_budget)",0
sum of rows and columns of K,0
active sets I and J (see Lemma 1 in [26]),0
"Ic, Jc: complementary of the active sets I and J",0
"a_I, b_J, a_Ic, b_Jc",0
box constraints in L-BFGS-B (see Proposition 1 in [26]),0
pre-calculated constants for the objective,0
initialisation,0
pre-calculed constants for Restricted Sinkhorn (see Algorithm 1 in supplementary of [26]),0
"gradients of Psi_(kappa,epsilon) w.r.t u and v",0
objective,0
gradient,0
----------------------------------------------------------------------------------------------------------------#,0
Step 2: L-BFGS-B solver                                              #,0
----------------------------------------------------------------------------------------------------------------#,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
trick to fasten the computation: select only the subset of columns/lines,0
that can have marginals greater than 0 (that is to say M < 0),0
"extend a, b, M with ""reservoir"" or ""dummy"" points",0
"Next 3 lines equivalent to K=np.exp(-M/reg), but faster to compute",0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Ensure that distances between vectors and themselves are set to 0.0.,0
This may not be the case due to floating point rounding errors.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
XXX use random state,1
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
XXX : should use a random state and not use the global seed,1
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
compute change in barycenter,0
if barycenter did not change + at least 10 iterations - stop,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"tmp2=np.einsum('i,ij,j->j', u, K, v)",0
"res = np.einsum('ik,ij,jk,ij->k', u, K, v, M) (explodes cupy memory)",0
define sinkhorn as sinkhorn_knopp,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
Copyright 2001-2013 Python Software Foundation; All Rights Reserved,0
Once '__signature__' will be added to 'C'-level,0
"callables, this check won't be necessary",0
Unbound method: the first parameter becomes positional-only,0
In this case we skip the first parameter of the underlying,0
function (usually `self` or `cls`).,0
Was this function wrapped by a decorator?,0
"We set a new default value, because the following code",0
is correct:,0
,0
>>> def foo(a): print(a),0
">>> print(partial(partial(foo, a=10), a=20)())",0
20,0
">>> print(partial(partial(foo, a=10), a=20)(a=30))",0
30,0
,0
"So, with 'partial' objects, passing a keyword argument is",0
like setting a new default value for the corresponding,0
parameter,0
,0
We also mark this parameter with '_partial_kwarg',0
"flag.  Later, in '_bind', the 'default' value of this",0
"parameter will be added to 'kwargs', to simulate",0
the 'functools.partial' real call.,0
obj is a class or a metaclass,0
"First, let's see if it has an overloaded __call__ defined",0
in its metaclass,0
Now we check if the 'obj' class has a '__new__' method,0
"Finally, we should have at least __init__ implemented",0
An object with __call__,0
We also check that the 'obj' is not an instance of,0
_WrapperDescriptor or _MethodWrapper to avoid,0
infinite recursion (and even potential segfault),0
For classes and objects we skip the first parameter of their,0
"__call__, __new__, or __init__ methods",0
Raise a nicer error message for builtins,0
Add annotation and default value,0
Keyword arguments mapped by 'functools.partial',0
(Parameter._partial_kwarg is True) are mapped,0
"in 'BoundArguments.kwargs', along with VAR_KEYWORD &",0
KEYWORD_ONLY,0
We're done here. Other arguments,0
will be mapped in 'BoundArguments.kwargs',0
*args,0
plain argument,0
**kwargs,0
plain keyword argument,0
Parameter information.,0
Non-keyword-only parameters w/o defaults.,0
... w/ defaults.,0
*args,0
Keyword-only parameters.,0
**kwargs,0
Support for binding arguments to 'functools.partial' objects.,0
See 'functools.partial' case in 'signature()' implementation,0
for details.,0
Simulating 'functools.partial' behavior,0
Let's iterate through the positional arguments and corresponding,0
parameters,0
No more positional arguments,0
No more parameters. That's it. Just need to check that,0
we have no `kwargs` after this while loop,0
"That's OK, just empty *args.  Let's start parsing",0
kwargs,0
That's fine too - we have a default value for this,0
"parameter.  So, lets start parsing `kwargs`, starting",0
with the current parameter,0
We have a positional argument to process,0
Looks like we have no parameter for this positional,0
argument,0
"We have an '*args'-like argument, let's fill it with",0
all positional arguments we have left and move on to,0
the next phase,0
"Now, we iterate through the remaining parameters to process",0
keyword arguments,0
This should never happen in case of a properly built,0
Signature object (but let's have this check here,0
to ensure correct behaviour just in case),0
Memorize that we have a '**kwargs'-like parameter,0
"We have no value for this parameter.  It's fine though,",0
"if it has a default value, or it is an '*args'-like",0
"parameter, left alone by the processing of positional",0
arguments.,0
Process our '**kwargs'-like parameter,0
"OK, we have an '*args'-like parameter, so we won't need",0
a '*' to separate keyword-only arguments,0
We have a keyword-only parameter to render and we haven't,0
"rendered an '*args'-like parameter before, so add a '*'",0
"separator to the parameters list (""foo(arg1, *, arg2)"" case)",0
"This condition should be only triggered once, so",0
reset the flag,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
"if no weights are provided, use uniform",0
compute constant that balances the weighted sums of the duals,0
update duals,0
binary indexing of non-zeros weights,0
compute dual constraints violation,0
Compute largest violation per line and columns,0
update corrects violation of,0
if empty array given then use uniform distributions,0
problem with pikling Forks,0
if empty array given then use uniform distributions,0
if empty array given then use uniform distributions,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c and vectors,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Define the graph,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c and vectors,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Define the graph,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
--------------,0
Sinkhorn,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Laetitia Chapel <laetitia.chapel@irisa.fr>,0
License: MIT License,0
necessary for 3d plot even if not used,0
############################################################################,0
,0
Sample two 2D Gaussian distributions and plot them,0
--------------------------------------------------,0
,0
"For demonstration purpose, we sample two Gaussian distributions in 2-d",0
spaces and add some random noise.,0
############################################################################,0
,0
Compute partial Wasserstein plans and distance,0
----------------------------------------------,0
############################################################################,0
,0
Sample one 2D and 3D Gaussian distributions and plot them,0
---------------------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Compute partial Gromov-Wasserstein plans and distance,0
-----------------------------------------------------,0
transport 100% of the mass,0
transport 2/3 of the mass,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
---------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
---------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
---------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
---------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
---------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%%,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Instantiate Sinkhorn transport algorithm and fit them for all source domains,0
----------------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
#############################################################################,0
Instantiate JCPOT adaptation algorithm and fit it,0
----------------------------------------------------------------------------,0
#############################################################################,0
Run oracle transport algorithm with known proportions,0
----------------------------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Compute free support barycenter,0
-------------,0
#############################################################################,0
Plot data,0
---------,0
-*- coding: utf-8 -*-,0
Authors: Ievgen Redko <ievgen.redko@univ-st-etienne.fr>,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
EMD Transport with Laplacian regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
--------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Author: Mokhtar Z. Alaya <mokhtarzahdi.alaya@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Screenkhorn,0
-----------------------,0
Screenkhorn,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
DISCRETE CASE:,0
,0
Sample two discrete measures for the discrete case,0
---------------------------------------------,0
,0
"Define 2 discrete measures a and b, the points where are defined the source",0
and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
---------------------------------------------,0
,0
"Define the method ""SAG"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
SEMICONTINOUS CASE:,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define the method ""ASGD"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
PLOT TRANSPORTATION MATRIX,0
#############################################################################,0
#############################################################################,0
Plot SAG results,0
----------------,0
#############################################################################,0
Plot ASGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
SEMICONTINOUS CASE:,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semicontinous case,0
---------------------------------------------,0
,0
Call ot.solve_dual_entropic and plot the results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot  SGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
check raise not implemented wrong metric,0
run all on gpu,0
run sinkhorn for multiple targets,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constratints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constratints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constratints,0
Test gaussian,0
check constratints,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
Author:,0
Laetitia Chapel <laetitia.chapel@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
check transported mass,0
check constratints,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constratints,0
test sinkhorn,0
check constratints,0
check constratints,0
check constratints,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constratints,0
Test sinkhorn divergence,0
check constratints,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test screenkhorn,0
sinkhorn,0
screenkhorn,0
check marginals,0
test for image with height not equal width,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for dimension mismatch,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
test emd1d gives similar results as emd,0
check loss is similar,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
check G is the same,0
check value,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check label propagation,0
check inverse label propagation,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test margin constraints w.r.t. uniform target weights for each coupling matrix,0
test margin constraints w.r.t. modified source weights for each source domain,0
test transform,0
check that the oos method is working,0
check label propagation,0
check inverse label propagation,0
test its computed,0
test dimensions of coupling,0
test all margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
check label propagation,0
check inverse label propagation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
"sys.modules.update((mod_name, Mock()) for mod_name in MOCK_MODULES)",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks Pipy for handling markdown now,0
add platform dependant optional compilation argument,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Nathalie Gayraud <nat.gayraud@gmail.com>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
check the necessary inputs parameters are here,0
deal with the value of log,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
"print('b',np.max(abs(aviol -viol)),np.max(abs(aviol_2 - viol_2)))",0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
build the convolution operator,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Ensure that distances between vectors and themselves are set to 0.0.,0
This may not be the case due to floating point rounding errors.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
XXX use random state,1
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
XXX : should use a random state and not use the global seed,1
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"T is N,ns",0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
License: MIT License,0
"from .utils import unif, dist",0
we assume that no distances are null except those of the diagonal of,0
distances,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"tmp2=np.einsum('i,ij,j->j', u, K, v)",0
"res = np.einsum('ik,ij,jk,ij->k', u, K, v, M) (explodes cupy memory)",0
define sinkhorn as sinkhorn_knopp,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
Copyright 2001-2013 Python Software Foundation; All Rights Reserved,0
Once '__signature__' will be added to 'C'-level,0
"callables, this check won't be necessary",0
Unbound method: the first parameter becomes positional-only,0
In this case we skip the first parameter of the underlying,0
function (usually `self` or `cls`).,0
Was this function wrapped by a decorator?,0
"We set a new default value, because the following code",0
is correct:,0
,0
>>> def foo(a): print(a),0
">>> print(partial(partial(foo, a=10), a=20)())",0
20,0
">>> print(partial(partial(foo, a=10), a=20)(a=30))",0
30,0
,0
"So, with 'partial' objects, passing a keyword argument is",0
like setting a new default value for the corresponding,0
parameter,0
,0
We also mark this parameter with '_partial_kwarg',0
"flag.  Later, in '_bind', the 'default' value of this",0
"parameter will be added to 'kwargs', to simulate",0
the 'functools.partial' real call.,0
obj is a class or a metaclass,0
"First, let's see if it has an overloaded __call__ defined",0
in its metaclass,0
Now we check if the 'obj' class has a '__new__' method,0
"Finally, we should have at least __init__ implemented",0
An object with __call__,0
We also check that the 'obj' is not an instance of,0
_WrapperDescriptor or _MethodWrapper to avoid,0
infinite recursion (and even potential segfault),0
For classes and objects we skip the first parameter of their,0
"__call__, __new__, or __init__ methods",0
Raise a nicer error message for builtins,0
Add annotation and default value,0
Keyword arguments mapped by 'functools.partial',0
(Parameter._partial_kwarg is True) are mapped,0
"in 'BoundArguments.kwargs', along with VAR_KEYWORD &",0
KEYWORD_ONLY,0
We're done here. Other arguments,0
will be mapped in 'BoundArguments.kwargs',0
*args,0
plain argument,0
**kwargs,0
plain keyword argument,0
Parameter information.,0
Non-keyword-only parameters w/o defaults.,0
... w/ defaults.,0
*args,0
Keyword-only parameters.,0
**kwargs,0
Support for binding arguments to 'functools.partial' objects.,0
See 'functools.partial' case in 'signature()' implementation,0
for details.,0
Simulating 'functools.partial' behavior,0
Let's iterate through the positional arguments and corresponding,0
parameters,0
No more positional arguments,0
No more parameters. That's it. Just need to check that,0
we have no `kwargs` after this while loop,0
"That's OK, just empty *args.  Let's start parsing",0
kwargs,0
That's fine too - we have a default value for this,0
"parameter.  So, lets start parsing `kwargs`, starting",0
with the current parameter,0
We have a positional argument to process,0
Looks like we have no parameter for this positional,0
argument,0
"We have an '*args'-like argument, let's fill it with",0
all positional arguments we have left and move on to,0
the next phase,0
"Now, we iterate through the remaining parameters to process",0
keyword arguments,0
This should never happen in case of a properly built,0
Signature object (but let's have this check here,0
to ensure correct behaviour just in case),0
Memorize that we have a '**kwargs'-like parameter,0
"We have no value for this parameter.  It's fine though,",0
"if it has a default value, or it is an '*args'-like",0
"parameter, left alone by the processing of positional",0
arguments.,0
Process our '**kwargs'-like parameter,0
"OK, we have an '*args'-like parameter, so we won't need",0
a '*' to separate keyword-only arguments,0
We have a keyword-only parameter to render and we haven't,0
"rendered an '*args'-like parameter before, so add a '*'",0
"separator to the parameters list (""foo(arg1, *, arg2)"" case)",0
"This condition should be only triggered once, so",0
reset the flag,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
if empty array given then use uniform distributions,0
problem with pikling Forks,0
if empty array given then use uniform distributions,0
if empty array given then use uniform distributions,0
"If we do not return G (log==False), then we should not to cast it to dense",0
(useless overhead),0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
--------------,0
Sinkhorn,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
---------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
---------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
---------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
---------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
---------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Compute free support barycenter,0
-------------,0
#############################################################################,0
Plot data,0
---------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Stair Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
--------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
DISCRETE CASE:,0
,0
Sample two discrete measures for the discrete case,0
---------------------------------------------,0
,0
"Define 2 discrete measures a and b, the points where are defined the source",0
and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
---------------------------------------------,0
,0
"Define the method ""SAG"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
SEMICONTINOUS CASE:,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define the method ""ASGD"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
PLOT TRANSPORTATION MATRIX,0
#############################################################################,0
#############################################################################,0
Plot SAG results,0
----------------,0
#############################################################################,0
Plot ASGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
SEMICONTINOUS CASE:,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semicontinous case,0
---------------------------------------------,0
,0
Call ot.solve_dual_entropic and plot the results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot  SGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
check raise not implemented wrong metric,0
run all on gpu,0
run sinkhorn for multiple targets,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constratints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constratints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constratints,0
Test gaussian,0
check constratints,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
check if sinkhorn_unbalanced2 returns the correct loss,0
test generalized sinkhorn for unbalanced OT,0
make dists unbalanced,0
check fixed point equations,0
in log-domain,0
test if stable version matches sinkhorn,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
check fixed point equations,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constratints,0
test sinkhorn,0
check constratints,0
check constratints,0
check constratints,0
test sinkhorn,0
check values,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
test sinkhorn,0
check constratints,0
Test sinkhorn divergence,0
check constratints,0
test if stable version matches sinkhorn,0
for multidimensional inputs,0
Gaussian distributions,0
creating matrix A containing all distributions,0
test generalized sinkhorn for unbalanced OT barycenter,0
make dists unbalanced,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
test emd1d gives similar results as emd,0
check loss is similar,0
check loss is similar to scipy's implementation for Euclidean metric,0
check constraints,0
check G is similar,0
check AssertionError is raised if called on non 1d arrays,0
test emd1d gives similar results as emd,0
check loss is similar,0
test emd and emd2 for simple identity,0
check G is identity,0
check constraints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
make distributions unbalanced,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
plot distributions and loss matrix,0
#############################################################################,0
Solve Unbalanced Sinkhorn,0
--------------,0
Sinkhorn,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Hicham Janati <hicham.janati@inria.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
parameters,0
bin positions,0
Gaussian distributions,0
make unbalanced dists,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
non weighted barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
barycenter interpolation,0
plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
---------,0
%% parameters,0
We create two 1D random measures,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Create structure matrices and across-feature distance matrix,0
---------,0
%% Structure matrices and across-features distance matrix,0
#############################################################################,0
Plot matrices,0
---------,0
%%,0
"pl.ylabel(""$l$"",fontsize=fs)",0
#############################################################################,0
Compute FGW/GW,0
---------,0
%% Computing FGW and GW,0
%reload_ext WGW,0
#############################################################################,0
Visualize transport matrices,0
---------,0
%% visu OT matrix,0
"pl.xlabel(""$y$"",fontsize=fs)",0
-*- coding: utf-8 -*-,0
Author: Titouan Vayer <titouan.vayer@irisa.fr>,0
,0
License: MIT License,0
%% load libraries,0
%% Graph functions,0
#############################################################################,0
Generate data,0
-------------,0
%% circular dataset,0
We build a dataset of noisy circular graphs.,0
Noise is added on the structures by random connections and on the features by gaussian noise.,0
#############################################################################,0
Plot data,0
---------,0
%% Plot graphs,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% We compute the barycenter using FGW. Structure matrices are computed using the shortest_path distance in the graph,0
Features distances are the euclidean distances,0
#############################################################################,0
Plot Barycenter,0
-------------------------,0
%% Create the barycenter,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Compute free support barycenter,0
-------------,0
#############################################################################,0
Plot data,0
---------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Kilian Fatras <kilian.fatras@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
#############################################################################,0
Emprirical Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
--------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
DISCRETE CASE:,0
,0
Sample two discrete measures for the discrete case,0
---------------------------------------------,0
,0
"Define 2 discrete measures a and b, the points where are defined the source",0
and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
---------------------------------------------,0
,0
"Define the method ""SAG"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
SEMICONTINOUS CASE:,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define the method ""ASGD"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
PLOT TRANSPORTATION MATRIX,0
#############################################################################,0
#############################################################################,0
Plot SAG results,0
----------------,0
#############################################################################,0
Plot ASGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
SEMICONTINOUS CASE:,0
,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semicontinous case,0
---------------------------------------------,0
,0
Call ot.solve_dual_entropic and plot the results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot  SGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
thanks Pipy for handling markdown now,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
coupling estimation,0
deal with the value of log,0
re compute inverse mapping,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
aviol = (G@one_m - a),0
aviol_2 = (G.T@one_n - b),0
"print('b',np.max(abs(aviol -viol)),np.max(abs(aviol_2 - viol_2)))",0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print('err=',err,' cpt=',cpt)",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
build the convolution operator,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Optimization toolbox for SEMI - DUAL problems,0
#############################################################################,0
#############################################################################,0
Optimization toolbox for DUAL problems,0
#############################################################################,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Ensure that distances between vectors and themselves are set to 0.0.,0
This may not be the case due to floating point rounding errors.,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
"Copyright (c) 2018, Mathieu Blondel",0
All rights reserved.,0
,0
"Redistribution and use in source and binary forms, with or without",0
"modification, are permitted provided that the following conditions are met:",0
,0
"1. Redistributions of source code must retain the above copyright notice, this",0
list of conditions and the following disclaimer.,0
,0
"2. Redistributions in binary form must reproduce the above copyright notice,",0
this list of conditions and the following disclaimer in the documentation and/or,0
other materials provided with the distribution.,0
,0
"THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND",0
"ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",0
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.,0
"IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,",0
"INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT",0
"NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,",0
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF,0
"LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR",0
"OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF",0
THE POSSIBILITY OF SUCH DAMAGE.,0
Author: Mathieu Blondel,0
Remi Flamary <remi.flamary@unice.fr>,0
"X[:, j] = alpha + beta[j] - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
Unpack alpha and beta.,0
Pack grad_alpha and grad_beta.,0
We need to maximize the dual.,0
"Unfortunately, `minimize` only supports functions whose argument is a",0
"vector. So, we need to concatenate alpha and beta.",0
"X[:, j] = alpha - C[:, j]",0
val.shape = len(b),0
G.shape = len(a) x len(b),0
We need to maximize the semi-dual.,0
solve dual,0
reconstruct transport matrix,0
solve dual,0
reconstruct transport matrix,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
Rémi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
tens -= tens.min(),0
compute the gradient,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
"Next 3 lines equivalent to K= np.exp(-M/reg), but faster to compute",0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
compute right marginal tmp2= (diag(u)Kdiag(v))^T1,0
"tmp2=np.einsum('i,ij,j->j', u, K, v)",0
"res = np.einsum('ik,ij,jk,ij->k', u, K, v, M) (explodes cupy memory)",0
define sinkhorn as sinkhorn_knopp,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
Copyright 2001-2013 Python Software Foundation; All Rights Reserved,0
Once '__signature__' will be added to 'C'-level,0
"callables, this check won't be necessary",0
Unbound method: the first parameter becomes positional-only,0
In this case we skip the first parameter of the underlying,0
function (usually `self` or `cls`).,0
Was this function wrapped by a decorator?,0
"We set a new default value, because the following code",0
is correct:,0
,0
>>> def foo(a): print(a),0
">>> print(partial(partial(foo, a=10), a=20)())",0
20,0
">>> print(partial(partial(foo, a=10), a=20)(a=30))",0
30,0
,0
"So, with 'partial' objects, passing a keyword argument is",0
like setting a new default value for the corresponding,0
parameter,0
,0
We also mark this parameter with '_partial_kwarg',0
"flag.  Later, in '_bind', the 'default' value of this",0
"parameter will be added to 'kwargs', to simulate",0
the 'functools.partial' real call.,0
obj is a class or a metaclass,0
"First, let's see if it has an overloaded __call__ defined",0
in its metaclass,0
Now we check if the 'obj' class has a '__new__' method,0
"Finally, we should have at least __init__ implemented",0
An object with __call__,0
We also check that the 'obj' is not an instance of,0
_WrapperDescriptor or _MethodWrapper to avoid,0
infinite recursion (and even potential segfault),0
For classes and objects we skip the first parameter of their,0
"__call__, __new__, or __init__ methods",0
Raise a nicer error message for builtins,0
Add annotation and default value,0
Keyword arguments mapped by 'functools.partial',0
(Parameter._partial_kwarg is True) are mapped,0
"in 'BoundArguments.kwargs', along with VAR_KEYWORD &",0
KEYWORD_ONLY,0
We're done here. Other arguments,0
will be mapped in 'BoundArguments.kwargs',0
*args,0
plain argument,0
**kwargs,0
plain keyword argument,0
Parameter information.,0
Non-keyword-only parameters w/o defaults.,0
... w/ defaults.,0
*args,0
Keyword-only parameters.,0
**kwargs,0
Support for binding arguments to 'functools.partial' objects.,0
See 'functools.partial' case in 'signature()' implementation,0
for details.,0
Simulating 'functools.partial' behavior,0
Let's iterate through the positional arguments and corresponding,0
parameters,0
No more positional arguments,0
No more parameters. That's it. Just need to check that,0
we have no `kwargs` after this while loop,0
"That's OK, just empty *args.  Let's start parsing",0
kwargs,0
That's fine too - we have a default value for this,0
"parameter.  So, lets start parsing `kwargs`, starting",0
with the current parameter,0
We have a positional argument to process,0
Looks like we have no parameter for this positional,0
argument,0
"We have an '*args'-like argument, let's fill it with",0
all positional arguments we have left and move on to,0
the next phase,0
"Now, we iterate through the remaining parameters to process",0
keyword arguments,0
This should never happen in case of a properly built,0
Signature object (but let's have this check here,0
to ensure correct behaviour just in case),0
Memorize that we have a '**kwargs'-like parameter,0
"We have no value for this parameter.  It's fine though,",0
"if it has a default value, or it is an '*args'-like",0
"parameter, left alone by the processing of positional",0
arguments.,0
Process our '**kwargs'-like parameter,0
"OK, we have an '*args'-like parameter, so we won't need",0
a '*' to separate keyword-only arguments,0
We have a keyword-only parameter to render and we haven't,0
"rendered an '*args'-like parameter before, so add a '*'",0
"separator to the parameters list (""foo(arg1, *, arg2)"" case)",0
"This condition should be only triggered once, so",0
reset the flag,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
row constraints,0
columns constraints,0
full problem,0
cvxopt not installed or interior point,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
if empty array given then use unifor distributions,0
if empty array given then use unifor distributions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Compute free support barycenter,0
-------------,0
#############################################################################,0
Plot data,0
---------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
--------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
DISCRETE CASE,0
Sample two discrete measures for the discrete case,0
---------------------------------------------,0
,0
"Define 2 discrete measures a and b, the points where are defined the source",0
and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
---------------------------------------------,0
,0
"Define the method ""SAG"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
SEMICONTINOUS CASE,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define the method ""ASGD"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
PLOT TRANSPORTATION MATRIX,0
#############################################################################,0
#############################################################################,0
Plot SAG results,0
----------------,0
#############################################################################,0
Plot ASGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
SEMICONTINOUS CASE,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semicontinous case,0
---------------------------------------------,0
,0
Call ot.solve_dual_entropic and plot the results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot  SGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
check raise not implemented wrong metric,0
run all on gpu,0
run sinkhorn for multiple targets,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TEST FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SAG algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test sag,0
check constratints,0
############################################################################,0
,0
TEST ASGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test asgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SAG and ASGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a learning rate and a number of iteration",0
test all algorithms,0
check constratints,0
############################################################################,0
COMPUTE TEST FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
,0
TEST SGD algorithm,0
---------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test sgd,0
check constratints,0
############################################################################,0
,0
TEST Convergence SGD toward Sinkhorn's solution,0
--------------------------------------------------------,0
2 identical discrete measures u defined on the same space with a,0
"regularization term, a batch_size and a number of iteration",0
test all dual algorithms,0
Test uniform,0
check constratints,0
Test gaussian,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
dist0 default to linear sampling with quadratic loss,0
does nothing,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constratints,0
test sinkhorn,0
check constratints,0
check constratints,0
check constratints,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
creating matrix A containing all distributions,0
wasserstein,0
help in checking if log and verbose do not bug the function,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
check constratints,0
check constratints,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test lp solver,0
test bregman solver,0
test emd and emd2 for simple identity,0
check G is identity,0
check constratints,0
check loss=0,0
test emd and emd2 for simple identity,0
check G is identity,0
check constratints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
obvious barycenter between two diracs,0
obvious barycenter location between two diracs,0
obvious barycenter between two diracs,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
get data,0
check constratints,0
kl regyularisation,0
check constratints,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
############################################################################,0
,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
############################################################################,0
,0
Plotting the distributions,0
--------------------------,0
############################################################################,0
,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
############################################################################,0
,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
those are the four corners coordinates that will be interpolated by bilinear,0
interpolation,0
#############################################################################,0
Barycenter computation and visualization,0
----------------------------------------,0
,0
regularization parameter,0
weights are constructed by bilinear interpolation,0
call to barycenter computation,0
-*- coding: utf-8 -*-,0
Author: Vivien Seguy <vivien.seguy@iip.ist.i.kyoto-u.ac.jp>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
#############################################################################,0
Compute free support barycenter,0
-------------,0
#############################################################################,0
Plot data,0
---------,0
!/usr/bin/env python3,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
source samples,0
target samples,0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Estimate linear mapping and transport,0
-------------------------------------,0
#############################################################################,0
Plot transported samples,0
------------------------,0
#############################################################################,0
Load image data,0
---------------,0
Loading images,0
#############################################################################,0
Estimate mapping and adapt,0
----------------------------,0
%%,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
import ot.lp.cvx as cvx,0
#############################################################################,0
Gaussian Data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Dirac Data,0
----------,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% parameters,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Final figure,0
------------,0
,0
%% plot,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
#############################################################################,0
Solve Smooth OT,0
--------------,0
%% Smooth OT with KL regularization,0
%% Smooth OT with KL regularization,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
Author: Kilian Fatras <kilian.fatras@gmail.com>,0
,0
License: MIT License,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR SEMI-DUAL PROBLEM,0
############################################################################,0
############################################################################,0
DISCRETE CASE,0
Sample two discrete measures for the discrete case,0
---------------------------------------------,0
,0
"Define 2 discrete measures a and b, the points where are defined the source",0
and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SAG"" method to find the transportation matrix in the discrete case",0
---------------------------------------------,0
,0
"Define the method ""SAG"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
SEMICONTINOUS CASE,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""ASGD"" method to find the transportation matrix in the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define the method ""ASGD"", call ot.solve_semi_dual_entropic and plot the",0
results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
PLOT TRANSPORTATION MATRIX,0
#############################################################################,0
#############################################################################,0
Plot SAG results,0
----------------,0
#############################################################################,0
Plot ASGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
############################################################################,0
COMPUTE TRANSPORTATION MATRIX FOR DUAL PROBLEM,0
############################################################################,0
############################################################################,0
SEMICONTINOUS CASE,0
"Sample one general measure a, one discrete measures b for the semicontinous",0
case,0
---------------------------------------------,0
,0
"Define one general measure a, one discrete measures b, the points where",0
are defined the source and the target measures and finally the cost matrix c.,0
############################################################################,0
,0
"Call the ""SGD"" dual method to find the transportation matrix in the",0
semicontinous case,0
---------------------------------------------,0
,0
Call ot.solve_dual_entropic and plot the results.,0
############################################################################,0
,0
Compare the results with the Sinkhorn algorithm,0
---------------------------------------------,0
,0
Call the Sinkhorn algorithm from POT,0
#############################################################################,0
Plot  SGD results,0
-----------------,0
#############################################################################,0
Plot Sinkhorn results,0
---------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst if pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
aply the delta to the interpolation,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print('err=',err,' cpt=',cpt)",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
"a is shape (n, f) and b shape (m, f). Return matrix c of shape (n, m).",0
First compute in c_GPU the squared euclidean distance. And return its,0
"square root. At each cell [i,j] of c, we want to have",0
"sum{k in range(f)} ( (a[i,k] - b[j,k])^2 ). We know that",0
(a-b)^2 = a^2 -2ab +b^2. Thus we want to have in each cell of c:,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2).",0
"Multiply a by b transpose to obtain in each cell [i,j] of c the",0
"value sum{k in range(f)} ( a[i,k]b[j,k] )",0
"multiply by -2 to have sum{k in range(f)} ( -2a[i,k]b[j,k] )",0
Compute the vectors of the sum of squared elements.,0
Add the vectors in each columns (respectivly rows) of c.,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] )",0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2)",0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
if empty array given then use unifor distributions,0
if empty array given then use unifor distributions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
#############################################################################,0
Plotting the distributions,0
--------------------------,0
#############################################################################,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
#############################################################################,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
dist0 default to linear sampling with quadratic loss,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constratints,0
test sinkhorn,0
check constratints,0
check constratints,0
check constratints,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test lp solver,0
test bregman solver,0
test emd and emd2 for simple identity,0
check G is identity,0
check constratints,0
check loss=0,0
test emd and emd2 for simple identity,0
check G is identity,0
check constratints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
linear mapping,0
nonlinear mapping,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
#############################################################################,0
Plotting the distributions,0
--------------------------,0
#############################################################################,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
#############################################################################,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst if pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
,0
License: MIT License,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
aply the delta to the interpolation,0
check the necessary inputs parameters are here,0
pairwise distance,0
assumes labeled source samples occupy the first rows,0
and labeled target samples occupy the first columns,0
all the coefficients corresponding to a source sample,0
and a target sample :,0
with different labels get a infinite,0
distribution estimation,0
store arrays of samples,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
get the nearest neighbor in the source domain,0
transport the source samples,0
define the transported points,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
perform out of sample mapping,0
transport the target samples,0
define the transported points,0
coupling estimation,0
deal with the value of log,0
coupling estimation,0
check the necessary inputs parameters are here,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
deal with the value of log,0
check the necessary inputs parameters are here,0
perform standard barycentric mapping,0
set nans to 0,0
compute transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(reg),0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print('err=',err,' cpt=',cpt)",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of,0
distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
we recombine the current selection from dictionnary,0
geometric interpolation,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
"Adapted from http://wiki.python.org/moin/PythonDecoratorLibrary,",0
but with many changes.,0
FIXME: we should probably reset __new__ for full generality,1
fetch the constructor or the original constructor before,0
deprecation wrapping if any,0
No explicit constructor to introspect,0
introspect the constructor arguments to find the model parameters,0
to represent,0
Consider the constructor parameters excluding 'self',0
Extract and sort argument names excluding 'self',0
We need deprecation warnings to always be on in order to,0
catch deprecated param values.,0
This is set in utils/__init__.py but it gets overwritten,0
when running under python3 somehow.,0
"if the parameter is deprecated, don't show it",0
XXX: should we rather test if instance of estimator?,1
Simple optimisation to gain speed (inspect is slow),0
"for key, value in iteritems(params):",0
nested objects case,0
simple objects case,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Initialization of C : random SPD matrix (if not provided by user),0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
class 1,0
class 1,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Nicolas Courty <ncourty@irisa.fr>,0
Michael Perrot <michael.perrot@univ-st-etienne.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
"a is shape (n, f) and b shape (m, f). Return matrix c of shape (n, m).",0
First compute in c_GPU the squared euclidean distance. And return its,0
"square root. At each cell [i,j] of c, we want to have",0
"sum{k in range(f)} ( (a[i,k] - b[j,k])^2 ). We know that",0
(a-b)^2 = a^2 -2ab +b^2. Thus we want to have in each cell of c:,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2).",0
"Multiply a by b transpose to obtain in each cell [i,j] of c the",0
"value sum{k in range(f)} ( a[i,k]b[j,k] )",0
"multiply by -2 to have sum{k in range(f)} ( -2a[i,k]b[j,k] )",0
Compute the vectors of the sum of squared elements.,0
Add the vectors in each columns (respectivly rows) of c.,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] )",0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2)",0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
Leo Gautheron <https://github.com/aje>,0
,0
License: MIT License,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
import compiled emd,0
if empty array given then use unifor distributions,0
if empty array given then use unifor distributions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
#############################################################################,0
Plotting the distributions,0
--------------------------,0
#############################################################################,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
#############################################################################,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
generate gaussian dataset,0
generate gaussian dataset,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test timing,0
test toc vs toq,0
gaussian kernel  has ones on the diagonal,0
dist shoul return squared euclidean,0
dist0 default to linear sampling with quadratic loss,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test sinkhorn,0
check constratints,0
test sinkhorn,0
check constratints,0
check constratints,0
check constratints,0
test sinkhorn,0
check values,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
wasserstein,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
check constratints,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test lp solver,0
test bregman solver,0
test emd and emd2 for simple identity,0
check G is identity,0
check constratints,0
check loss=0,0
test emd and emd2 for simple identity,0
check G is identity,0
check constratints,0
check loss=0,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
emd loss 1 proc,0
emd loss multipro proc,0
emd loss multipro proc with log,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
emd loss 1 proc,0
Check symmetry,0
Check with closed-form solution for gaussians,0
Check that both cost computations are equivalent,0
Check that dual and primal cost are equal,0
Check that reduced cost is zero on transport arcs,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
bin positions,0
Gaussian distributions,0
loss matrix,0
bin positions,0
Gaussian distributions,0
loss matrix,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
check everything runs well with log=True,0
test its computed,0
test dimensions of coupling,0
test margin constraints,0
test transform,0
check that the oos method is working,0
test inverse transform,0
check that the oos method is working,0
test fit_transform,0
test unsupervised vs semi-supervised mode,0
check that the cost matrix norms are indeed different,0
check that the coupling forbids mass transport between labeled source,0
and labeled target samples,0
"we need to use a small tolerance here, otherwise the test breaks",0
#########################################################################,0
kernel == linear mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
#########################################################################,0
kernel == gaussian mapping tests,0
#########################################################################,0
check computation and dimensions if bias == False,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check computation and dimensions if bias == True,0
test margin constraints,0
test transform,0
check that the oos method is working,0
check everything runs well with log=True,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
linear mapping,0
nonlinear mapping,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named #'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
one of the target mode changes its variance (no linear mapping),0
#############################################################################,0
Plot data,0
---------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
MappingTransport with linear kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the linear mapping",0
MappingTransport with gaussian kernel,0
"for original source samples, transform applies barycentric mapping",0
"for out of source samples, transform applies the gaussian mapping",0
#############################################################################,0
Plot transported samples,0
------------------------,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Sample two Gaussian distributions (2D and 3D),0
---------------------------------------------,0
,0
The Gromov-Wasserstein distance allows to compute distances with samples that,0
"do not belong to the same metric space. For demonstration purpose, we sample",0
two Gaussian distributions in 2- and 3-dimensional spaces.,0
#############################################################################,0
Plotting the distributions,0
--------------------------,0
#############################################################################,0
"Compute distance kernels, normalize them and then display",0
---------------------------------------------------------,0
#############################################################################,0
Compute Gromov-Wasserstein plans and distance,0
---------------------------------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Transport source samples onto target samples,0
--------------------------------------------,0
unsupervised domain adaptation,0
semi-supervised domain adaptation,0
semi supervised DA uses available labaled target samples to modify the cost,0
matrix involved in the OT problem. The cost of transporting a source sample,0
"of class A onto a target sample of class B != A is set to infinite, or a",0
very large value,0
note that in the present case we consider that all the target samples are,0
"labeled. For daily applications, some target sample might not have labels,",0
in this case the element of yt corresponding to these samples should be,0
filled with -1.,0
Warning: we recall that -1 cannot be used as a class label,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
"the optimal coupling in the semi-supervised DA case will exhibit "" shape",0
"similar"" to the cost matrix, (block diagonal matrix)",0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Dataset 1 : uniform sampling,0
----------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 1 : Plot OT Matrices,0
----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
#############################################################################,0
Dataset 2 : Partial circle,0
--------------------------,0
loss matrix,0
loss matrix,0
loss matrix,0
Data,0
Cost matrices,0
#############################################################################,0
Dataset 2 : Plot  OT Matrices,0
-----------------------------,0
%% EMD,0
OT matrices,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve EMD with Frobenius norm regularization,0
--------------------------------------------,0
%% Example with Frobenius norm regularization,0
#############################################################################,0
Solve EMD with entropic regularization,0
--------------------------------------,0
%% Example with entropic regularization,0
#############################################################################,0
Solve EMD with Frobenius norm + entropic regularization,0
-------------------------------------------------------,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
#############################################################################,0
Plot distributions and loss matrix,0
----------------------------------,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
#############################################################################,0
Solve EMD,0
---------,0
%% EMD,0
#############################################################################,0
Solve Sinkhorn,0
--------------,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
necessary for 3d plot even if not used,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Barycenter computation,0
----------------------,0
%% barycenter computation,0
l2bary,0
wasserstein,0
#############################################################################,0
Barycentric interpolation,0
-------------------------,0
%% barycenter interpolation,0
%% plot interpolation,0
-*- coding: utf-8 -*-,0
Author: Erwan Vautier <erwan.vautier@gmail.com>,0
Nicolas Courty <ncourty@irisa.fr>,0
,0
License: MIT License,0
#############################################################################,0
Smacof MDS,0
----------,0
,0
This function allows to find an embedding of points given a dissimilarity matrix,0
that will be given by the output of the algorithm,0
#############################################################################,0
Data preparation,0
----------------,0
,0
The four distributions are constructed from 4 simple images,0
#############################################################################,0
Barycenter computation,0
----------------------,0
#############################################################################,0
Visualization,0
-------------,0
,0
The PCA helps in getting consistency between the rotations,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Domain adaptation for pixel distribution transfer,0
-------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
#############################################################################,0
Plot original images,0
--------------------,0
#############################################################################,0
Plot pixel values distribution,0
------------------------------,0
#############################################################################,0
Plot transformed images,0
-----------------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
Sinkhorn Transport with Group lasso regularization l1l2,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples,0
---------------------------------------,0
#############################################################################,0
Fig 2 : plot optimal couplings and transported samples,0
------------------------------------------------------,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters and data generation,0
loss matrix,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute EMD,0
-----------,0
%% EMD,0
#############################################################################,0
Compute Sinkhorn,0
----------------,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
generate circle dataset,0
#############################################################################,0
Plot data,0
---------,0
%% plot samples,0
#############################################################################,0
Compute Fisher Discriminant Analysis,0
------------------------------------,0
%% Compute FDA,0
#############################################################################,0
Compute Wasserstein Discriminant Analysis,0
-----------------------------------------,0
%% Compute WDA,0
#############################################################################,0
Plot 2D projections,0
-------------------,0
%% plot samples,0
-*- coding: utf-8 -*-,0
Author: Remi Flamary <remi.flamary@unice.fr>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
#############################################################################,0
Plot data,0
---------,0
%% plot the distributions,0
#############################################################################,0
Compute EMD for the different losses,0
------------------------------------,0
%% Compute and plot distributions and loss matrix,0
#############################################################################,0
Compute Sinkhorn for the different losses,0
-----------------------------------------,0
%%,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
Generate data,0
-------------,0
Loading images,0
training samples,0
#############################################################################,0
Plot original image,0
-------------------,0
#############################################################################,0
Scatter plot of colors,0
----------------------,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMDTransport,0
SinkhornTransport,0
prediction between images (using out of sample prediction as in [6]),0
#############################################################################,0
Plot new images,0
---------------,0
-*- coding: utf-8 -*-,0
Authors: Remi Flamary <remi.flamary@unice.fr>,0
Stanislas Chambon <stan.chambon@gmail.com>,0
,0
License: MIT License,0
#############################################################################,0
generate data,0
-------------,0
Cost matrix,0
#############################################################################,0
Instantiate the different transport algorithms and fit them,0
-----------------------------------------------------------,0
EMD Transport,0
Sinkhorn Transport,0
Sinkhorn Transport with Group lasso regularization,0
transport source samples onto target samples,0
#############################################################################,0
Fig 1 : plots source and target samples + matrix of pairwise distance,0
---------------------------------------------------------------------,0
#############################################################################,0
Fig 2 : plots optimal couplings for the different methods,0
---------------------------------------------------------,0
#############################################################################,0
Fig 3 : plot transported samples,0
--------------------------------,0
display transported samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst if pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print(reg),0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print('err=',err,' cpt=',cpt)",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
"a is shape (n, f) and b shape (m, f). Return matrix c of shape (n, m).",0
First compute in c_GPU the squared euclidean distance. And return its,0
"square root. At each cell [i,j] of c, we want to have",0
"sum{k in range(f)} ( (a[i,k] - b[j,k])^2 ). We know that",0
(a-b)^2 = a^2 -2ab +b^2. Thus we want to have in each cell of c:,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2).",0
"Multiply a by b transpose to obtain in each cell [i,j] of c the",0
"value sum{k in range(f)} ( a[i,k]b[j,k] )",0
"multiply by -2 to have sum{k in range(f)} ( -2a[i,k]b[j,k] )",0
Compute the vectors of the sum of squared elements.,0
Add the vectors in each columns (respectivly rows) of c.,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] )",0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2)",0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
-*- coding: utf-8 -*-,0
import compiled emd,0
if empty array given then use unifor distributions,0
if empty array given then use unifor distributions,0
"res=[emd2_c(a,b[:,i].copy(),M) for i in range(nb)]",0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
loss matrix,0
loss matrix,0
%% plot samples,0
%% EMD,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
generate circle dataset,0
%% plot samples,0
%% Compute FDA,0
%% Compute WDA,0
%% plot samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
%% plot the distributions,0
%% Compute and plot distributions and loss matrix,0
%%,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
test lp solver,0
test bregman solver,0
!/usr/bin/env python2,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
%%,0
emd loss 1 proc,0
emd loss multipro proc,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
%% Sinkhorn,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
loss matrix,0
loss matrix,0
%% plot samples,0
%% EMD,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
pl.figure(1),0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('Source and traget distributions'),0
,0
pl.figure(2),0
"pl.imshow(M,interpolation='nearest')",0
pl.title('Cost matrix M'),0
,0
%% EMD,0
pl.figure(3),0
"pl.imshow(G0,interpolation='nearest')",0
pl.title('OT matrix G0'),0
,0
pl.figure(4),0
"ot.plot.plot2D_samples_mat(xs,xt,G0,c=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix with samples'),0
%% sinkhorn,0
reg term,0
pl.figure(5),0
"pl.imshow(Gs,interpolation='nearest')",0
pl.title('OT matrix sinkhorn'),0
,0
pl.figure(6),0
"ot.plot.plot2D_samples_mat(xs,xt,Gs,color=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix Sinkhorn with samples'),0
,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
%% plot the distributions,0
%% barycenter computation,0
%%,0
%%,0
we assume that no distances are null except those of the diagonal of distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
%% barycenter interpolation,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% plot distributions and loss matrix,0
%% plot samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
%% plot the distributions,0
%% Compute and plot distributions and loss matrix,0
%%,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst if pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
the transport has been computed. Check if classes are really,0
separated,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print(reg),0
print(np.min(K)),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
test if multiple target,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print(np.min(K)),0
sinkhorn update,0
remove numerical problems and store them in K,0
we can speed up the process by checking for the error only all the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print('err=',err,' cpt=',cpt)",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of distances,0
print(np.min(K)),0
we can speed up the process by checking for the error only all the 10th iterations,0
"print('err=',err,' cpt=',cpt)",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
data split between classes,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
"a is shape (n, f) and b shape (m, f). Return matrix c of shape (n, m).",0
First compute in c_GPU the squared euclidean distance. And return its,0
"square root. At each cell [i,j] of c, we want to have",0
"sum{k in range(f)} ( (a[i,k] - b[j,k])^2 ). We know that",0
(a-b)^2 = a^2 -2ab +b^2. Thus we want to have in each cell of c:,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2).",0
"Multiply a by b transpose to obtain in each cell [i,j] of c the",0
"value sum{k in range(f)} ( a[i,k]b[j,k] )",0
"multiply by -2 to have sum{k in range(f)} ( -2a[i,k]b[j,k] )",0
Compute the vectors of the sum of squared elements.,0
Add the vectors in each columns (respectivly rows) of c.,0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] )",0
"sum{k in range(f)} ( a[i,k]^2 -2a[i,k]b[j,k] +b[j,k]^2)",0
the transport has been computed. Check if classes are really,0
separated,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of,0
distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all,0
the 10th iterations,0
-*- coding: utf-8 -*-,0
-*- coding: utf-8 -*-,0
import compiled emd,0
if empty array given then use unifor distributions,0
if empty array given then use unifor distributions,0
"res=[emd2_c(a,b[:,i].copy(),M) for i in range(nb)]",0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
loss matrix,0
loss matrix,0
%% plot samples,0
%% EMD,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
generate circle dataset,0
%% plot samples,0
%% Compute FDA,0
%% Compute WDA,0
%% plot samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
%% plot the distributions,0
%% Compute and plot distributions and loss matrix,0
%%,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
test lp solver,0
test bregman solver,0
!/usr/bin/env python2,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
%%,0
emd loss 1 proc,0
emd loss multipro proc,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!! This should be commented when executing sphinx-gallery,0
"'autograd.numpy','pymanopt.manifolds','pymanopt.solvers',",0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
%% Sinkhorn,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
loss matrix,0
loss matrix,0
%% plot samples,0
%% EMD,0
pl.legend(loc=0),0
pl.legend(loc=0),0
pl.legend(loc=0),0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
pl.figure(1),0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('Source and traget distributions'),0
,0
pl.figure(2),0
"pl.imshow(M,interpolation='nearest')",0
pl.title('Cost matrix M'),0
,0
%% EMD,0
pl.figure(3),0
"pl.imshow(G0,interpolation='nearest')",0
pl.title('OT matrix G0'),0
,0
pl.figure(4),0
"ot.plot.plot2D_samples_mat(xs,xt,G0,c=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix with samples'),0
%% sinkhorn,0
reg term,0
pl.figure(5),0
"pl.imshow(Gs,interpolation='nearest')",0
pl.title('OT matrix sinkhorn'),0
,0
pl.figure(6),0
"ot.plot.plot2D_samples_mat(xs,xt,Gs,color=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix Sinkhorn with samples'),0
,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
%% plot the distributions,0
%% barycenter computation,0
%%,0
%%,0
we assume that no distances are null except those of the diagonal of distances,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
%% barycenter interpolation,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% plot distributions and loss matrix,0
%% plot samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix and normalization,0
%% plot the distributions,0
%% Compute and plot distributions and loss matrix,0
%%,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print 'err=',err,' cpt=',cpt",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of distances,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
data split between classes,0
compute uniform weighs,0
wda loss,0
loss inversed because minimization,0
declare manifold and problem,0
declare solver and solve,0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
-*- coding: utf-8 -*-,0
import compiled emd,0
if empty array given then use unifor distributions,0
if empty array given then use unifor distributions,0
"res=[emd2_c(a,b[:,i].copy(),M) for i in range(nb)]",0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% plot distributions and loss matrix,0
%% plot samples,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
test lp solver,0
test bregman solver,0
!/usr/bin/env python2,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
M/=M.max(),0
%%,0
emd loss 1 proc,0
emd loss multipro proc,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
# check whether in the source directory...,0
,0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
%% Sinkhorn,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
pl.figure(1),0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('Source and traget distributions'),0
,0
pl.figure(2),0
"pl.imshow(M,interpolation='nearest')",0
pl.title('Cost matrix M'),0
,0
%% EMD,0
pl.figure(3),0
"pl.imshow(G0,interpolation='nearest')",0
pl.title('OT matrix G0'),0
,0
pl.figure(4),0
"ot.plot.plot2D_samples_mat(xs,xt,G0,c=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix with samples'),0
%% sinkhorn,0
reg term,0
pl.figure(5),0
"pl.imshow(Gs,interpolation='nearest')",0
pl.title('OT matrix sinkhorn'),0
,0
pl.figure(6),0
"ot.plot.plot2D_samples_mat(xs,xt,Gs,color=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix Sinkhorn with samples'),0
,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print 'err=',err,' cpt=',cpt",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of distances,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
problem linearization,0
solve linear program with Sinkhorn,0
"Gc = sinkhorn_stabilized(a,b, Mi, reg1, numItermax = numInnerItermax)",0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
test lp solver,0
test bregman solver,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
!!!! allow readthedoc compilation,0
!!!!,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"'sphinx_gallery.gen_gallery',",0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
%% Sinkhorn,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenius norm regularization,0
%% Example with entropic regularization,0
%% Example with Frobenius norm + entropic regularization with gcg,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
pl.figure(1),0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('Source and traget distributions'),0
,0
pl.figure(2),0
"pl.imshow(M,interpolation='nearest')",0
pl.title('Cost matrix M'),0
,0
%% EMD,0
pl.figure(3),0
"pl.imshow(G0,interpolation='nearest')",0
pl.title('OT matrix G0'),0
,0
pl.figure(4),0
"ot.plot.plot2D_samples_mat(xs,xt,G0,c=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix with samples'),0
%% sinkhorn,0
reg term,0
pl.figure(5),0
"pl.imshow(Gs,interpolation='nearest')",0
pl.title('OT matrix sinkhorn'),0
,0
pl.figure(6),0
"ot.plot.plot2D_samples_mat(xs,xt,Gs,color=[.5,.5,1])",0
"pl.plot(xs[:,0],xs[:,1],'+b',label='Source samples')",0
"pl.plot(xt[:,0],xt[:,1],'xr',label='Target samples')",0
pl.legend(loc=0),0
pl.title('OT matrix Sinkhorn with samples'),0
,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
%% barycenter interpolation,0
%% plot interpolation,0
"pl.subplot(1,2,1)",0
"pl.subplot(1,2,1)",0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
non-convex Group lasso regularization,0
True Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print 'err=',err,' cpt=',cpt",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of distances,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
try:,0
except ImportError:,0
from mock import MagicMock,0
sys.setrecursionlimit(1500),0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
we have reached the machine precision,0
come back to previous solution and quit loop,0
"print 'err=',err,' cpt=',cpt",0
init data,0
nrelative umerical precision with 64 bits,0
we assume that no distances are null except those of the diagonal of distances,0
print np.min(K),0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
linear mapping estimation,0
nonlinear mapping estimation,0
%% plot images,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
try:,0
except ImportError:,0
from mock import MagicMock,0
sys.setrecursionlimit(1500),0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
try:,0
except ImportError:,0
from mock import MagicMock,0
sys.setrecursionlimit(1500),0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
init loop,0
update G,0
update L,0
ls regu,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
RKHS regul,0
ls regul,0
K0 = K1.T.dot(K1)+eta*I,0
Kreg=I,0
proper kernel ridge,0
init loop,0
update G,0
update L,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
set M positive,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% Loading images,0
%% Plot images,0
%% Image conversion and dataset generation,0
training samples,0
%% Plot image distributions,0
pl.imshow(I2),0
%% domain adaptation between images,0
LP problem,0
sinkhorn regularization,0
%% prediction between images (using out of sample prediction as in [6]),0
%% plot all images,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% dataset generation,0
one of the target mode changes its variance (no linear mapping),0
%% plot samples,0
%% OT linear mapping estimation,0
%% Kernel mapping estimation,0
%% Plotting the mapped samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
try:,0
except ImportError:,0
from mock import MagicMock,0
sys.setrecursionlimit(1500),0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
%% plot samples,0
%% OT estimation,0
LP problem,0
sinkhorn regularization,0
Group lasso regularization,0
%% plot interpolated source samples,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
try:,0
except ImportError:,0
from mock import MagicMock,0
sys.setrecursionlimit(1500),0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
import glob,0
dirty but working,0
"The beautiful part is, I don't even need to check exceptions here.",0
"If something messes up, let the build process fail noisy, BEFORE my release!",0
convert markdown readme to rst in pypandoc installed,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
import glob,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
import glob,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
!/usr/bin/env python,0
import glob,0
additional C++ source files,0
-*- coding: utf-8 -*-,0
init data,0
the transport has been computed. Check if classes are really separated,0
now we majorize the unlabelled by the min of the majorizations,0
do it only for unlabbled data,0
-*- coding: utf-8 -*-,0
init data,0
we assume that no distances are null except those of the diagonal of distances,0
print reg,0
print np.min(K),0
we have reached the machine precision,0
come back to previous solution and quit loop,0
we can speed up the process by checking for the error only all the 10th iterations,0
"print 'err=',err,' cpt=',cpt",0
"return np.dot(np.diag(p/np.maximum(np.sum(gamma,axis=1),1e-10)),gamma)",0
"return (np.dot(np.diag(q/np.maximum(np.sum(gamma,axis=0),1e-10)),gamma.T)).T",0
M = M/np.median(M) # suggested by G. Peyre,0
log and verbose print,0
M = M/np.median(M),0
M0 = M0/np.median(M0),0
"log = {'niter':0, 'all_err':[]}",0
pl.axis('off'),0
"pl.ylim((0,n))",0
pl.axis('off'),0
-*- coding: utf-8 -*-,0
The corresponding scipy function does not work for matrices,0
problem linearization,0
solve linear program,0
line search,0
test convergence,0
-*- coding: utf-8 -*-,0
class 1,0
class 1,0
All submodules and packages,0
OT functions,0
utils functions,0
beware M and C anre strored in row major C style!!!,0
Get the number of non zero coordinates for r and c,0
Define the graph,0
"Set supply and demand, don't account for 0 values (faster)",0
Demand is actually negative supply...,0
Set the cost of each edge,0
Solve the problem with the network simplex algorithm,0
-*- coding: utf-8 -*-,0
import compiled emd,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
creating matrix A containing all distributions,0
loss matrix + normalization,0
%% plot the distributions,0
%% barycenter computation,0
l2bary,0
wasserstein,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% plot the distributions,0
%% plot distributions and loss matrix,0
%% EMD,0
%% Sinkhorn,0
-*- coding: utf-8 -*-,0
%% parameters,0
bin positions,0
Gaussian distributions,0
loss matrix,0
%% EMD,0
%% Example with Frobenisu norm regularization,0
%% Examlple with entropic regularization,0
-*- coding: utf-8 -*-,0
%% parameters and data generation,0
loss matrix,0
%% plot samples,0
%% EMD,0
%% sinkhorn,0
reg term,0
-*- coding: utf-8 -*-,0
%% parameters,0
loss matrix,0
M/=M.max(),0
%% plot samples,0
%% OT estimation,0
EMD,0
sinkhorn,0
Group lasso regularization,0
%% visu matrices,0
%% sample interpolation,0
-*- coding: utf-8 -*-,0
,0
"POT documentation build configuration file, created by",0
sphinx-quickstart on Mon Oct 24 11:10:10 2016.,0
,0
This file is execfile()d with the current directory set to its,0
containing dir.,0
,0
Note that not all possible configuration values are present in this,0
autogenerated file.,0
,0
All configuration values have a default; values that are commented out,0
serve to show the default.,0
"If extensions (or modules to document with autodoc) are in another directory,",0
add these directories to sys.path here. If the directory is relative to the,0
"documentation root, use os.path.abspath to make it absolute, like shown here.",0
"sys.path.insert(0, os.path.abspath('.'))",0
-- General configuration ------------------------------------------------,0
"If your documentation needs a minimal Sphinx version, state it here.",0
needs_sphinx = '1.0',0
"Add any Sphinx extension module names here, as strings. They can be",0
extensions coming with Sphinx (named 'sphinx.ext.*') or your custom,0
ones.,0
"Add any paths that contain templates here, relative to this directory.",0
The suffix(es) of source filenames.,0
You can specify multiple suffix as a list of string:,0
"source_suffix = ['.rst', '.md']",0
The encoding of source files.,0
source_encoding = 'utf-8-sig',0
The master toctree document.,0
General information about the project.,0
"The version info for the project you're documenting, acts as replacement for",0
"|version| and |release|, also used in various other places throughout the",0
built documents.,0
,0
The short X.Y version.,0
"The full version, including alpha/beta/rc tags.",0
The language for content autogenerated by Sphinx. Refer to documentation,0
for a list of supported languages.,0
,0
This is also used if you do content translation via gettext catalogs.,0
"Usually you set ""language"" from the command line for these cases.",0
"There are two options for replacing |today|: either, you set today to some",0
"non-false value, then it is used:",0
today = '',0
"Else, today_fmt is used as the format for a strftime call.",0
"today_fmt = '%B %d, %Y'",0
"List of patterns, relative to source directory, that match files and",0
directories to ignore when looking for source files.,0
The reST default role (used for this markup: `text`) to use for all,0
documents.,0
default_role = None,0
"If true, '()' will be appended to :func: etc. cross-reference text.",0
add_function_parentheses = True,0
"If true, the current module name will be prepended to all description",0
unit titles (such as .. function::).,0
add_module_names = True,0
"If true, sectionauthor and moduleauthor directives will be shown in the",0
output. They are ignored by default.,0
show_authors = False,0
The name of the Pygments (syntax highlighting) style to use.,0
A list of ignored prefixes for module index sorting.,0
modindex_common_prefix = [],0
"If true, keep warnings as ""system message"" paragraphs in the built documents.",0
keep_warnings = False,0
"If true, `todo` and `todoList` produce output, else they produce nothing.",1
-- Options for HTML output ----------------------------------------------,0
The theme to use for HTML and HTML Help pages.  See the documentation for,0
a list of builtin themes.,0
Theme options are theme-specific and customize the look and feel of a theme,0
"further.  For a list of options available for each theme, see the",0
documentation.,0
html_theme_options = {},0
"Add any paths that contain custom themes here, relative to this directory.",0
html_theme_path = [],0
"The name for this set of Sphinx documents.  If None, it defaults to",0
"""<project> v<release> documentation"".",0
html_title = None,0
A shorter title for the navigation bar.  Default is the same as html_title.,0
html_short_title = None,0
The name of an image file (relative to this directory) to place at the top,0
of the sidebar.,0
html_logo = None,0
The name of an image file (relative to this directory) to use as a favicon of,0
the docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32,0
pixels large.,0
html_favicon = None,0
"Add any paths that contain custom static files (such as style sheets) here,",0
"relative to this directory. They are copied after the builtin static files,",0
"so a file named ""default.css"" will overwrite the builtin ""default.css"".",0
Add any extra paths that contain custom files (such as robots.txt or,0
".htaccess) here, relative to this directory. These files are copied",0
directly to the root of the documentation.,0
html_extra_path = [],0
"If not '', a 'Last updated on:' timestamp is inserted at every page bottom,",0
using the given strftime format.,0
"html_last_updated_fmt = '%b %d, %Y'",0
"If true, SmartyPants will be used to convert quotes and dashes to",0
typographically correct entities.,0
html_use_smartypants = True,0
"Custom sidebar templates, maps document names to template names.",0
html_sidebars = {},0
"Additional templates that should be rendered to pages, maps page names to",0
template names.,0
html_additional_pages = {},0
"If false, no module index is generated.",0
html_domain_indices = True,0
"If false, no index is generated.",0
html_use_index = True,0
"If true, the index is split into individual pages for each letter.",0
html_split_index = False,0
"If true, links to the reST sources are added to the pages.",0
html_show_sourcelink = True,0
"If true, ""Created using Sphinx"" is shown in the HTML footer. Default is True.",0
html_show_sphinx = True,0
"If true, ""(C) Copyright ..."" is shown in the HTML footer. Default is True.",0
html_show_copyright = True,0
"If true, an OpenSearch description file will be output, and all pages will",0
contain a <link> tag referring to it.  The value of this option must be the,0
base URL from which the finished HTML is served.,0
html_use_opensearch = '',0
"This is the file name suffix for HTML files (e.g. "".xhtml"").",0
html_file_suffix = None,0
Language to be used for generating the HTML full-text search index.,0
Sphinx supports the following languages:,0
"'da', 'de', 'en', 'es', 'fi', 'fr', 'hu', 'it', 'ja'",0
"'nl', 'no', 'pt', 'ro', 'ru', 'sv', 'tr'",0
html_search_language = 'en',0
"A dictionary with options for the search language support, empty by default.",0
Now only 'ja' uses this config value,0
html_search_options = {'type': 'default'},0
The name of a javascript file (relative to the configuration directory) that,0
"implements a search results scorer. If empty, the default will be used.",0
html_search_scorer = 'scorer.js',0
Output file base name for HTML help builder.,0
-- Options for LaTeX output ---------------------------------------------,0
The paper size ('letterpaper' or 'a4paper').,0
"'papersize': 'letterpaper',",0
"The font size ('10pt', '11pt' or '12pt').",0
"'pointsize': '10pt',",0
Additional stuff for the LaTeX preamble.,0
"'preamble': '',",0
Latex figure (float) alignment,0
"'figure_align': 'htbp',",0
Grouping the document tree into LaTeX files. List of tuples,0
"(source start file, target name, title,",0
"author, documentclass [howto, manual, or own class]).",0
The name of an image file (relative to this directory) to place at the top of,0
the title page.,0
latex_logo = None,0
"For ""manual"" documents, if this is true, then toplevel headings are parts,",0
not chapters.,0
latex_use_parts = False,0
"If true, show page references after internal links.",0
latex_show_pagerefs = False,0
"If true, show URL addresses after external links.",0
latex_show_urls = False,0
Documents to append as an appendix to all manuals.,0
latex_appendices = [],0
"If false, no module index is generated.",0
latex_domain_indices = True,0
-- Options for manual page output ---------------------------------------,0
One entry per manual page. List of tuples,0
"(source start file, name, description, authors, manual section).",0
"If true, show URL addresses after external links.",0
man_show_urls = False,0
-- Options for Texinfo output -------------------------------------------,0
Grouping the document tree into Texinfo files. List of tuples,0
"(source start file, target name, title, author,",0
"dir menu entry, description, category)",0
Documents to append as an appendix to all manuals.,0
texinfo_appendices = [],0
"If false, no module index is generated.",0
texinfo_domain_indices = True,0
"How to display URL addresses: 'footnote', 'no', or 'inline'.",0
texinfo_show_urls = 'footnote',0
"If true, do not generate a @detailmenu in the ""Top"" node's menu.",0
texinfo_no_detailmenu = False,0
Example configuration for intersphinx: refer to the Python standard library.,0
